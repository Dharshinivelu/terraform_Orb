(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{"2sp+":function(t,e,n){"use strict";n.d(e,"a",function(){return i});class i{static mapAddress(t){var e,n,i,o,r,s,l,a,c;let d,u,b,v,p,h,m,f,g=null===(e=null==t?void 0:t.getPlace())||void 0===e?void 0:e.name;null===(i=null===(n=null==t?void 0:t.getPlace())||void 0===n?void 0:n.address_components)||void 0===i||i.forEach(t=>{var e,n,i,o,r,s,l,a;-1!==(null===(e=null==t?void 0:t.types)||void 0===e?void 0:e.findIndex(t=>"country"===t))&&(d=t.long_name),-1!==(null===(n=null==t?void 0:t.types)||void 0===n?void 0:n.findIndex(t=>"administrative_area_level_1"===t))&&(u=t.long_name),-1!==(null===(i=null==t?void 0:t.types)||void 0===i?void 0:i.findIndex(t=>"locality"===t))&&(b=t.long_name),-1!==(null===(o=null==t?void 0:t.types)||void 0===o?void 0:o.findIndex(t=>"postal_code"===t))&&(v=t.long_name),-1!==(null===(r=null==t?void 0:t.types)||void 0===r?void 0:r.findIndex(t=>"neighborhood"===t))&&(p=t.long_name),-1!==(null===(s=null==t?void 0:t.types)||void 0===s?void 0:s.findIndex(t=>"sublocality_level_3"===t))&&(h=t.long_name),-1!==(null===(l=null==t?void 0:t.types)||void 0===l?void 0:l.findIndex(t=>"sublocality_level_2"===t))&&(m=t.long_name),-1!==(null===(a=null==t?void 0:t.types)||void 0===a?void 0:a.findIndex(t=>"sublocality_level_1"===t))&&(f=t.long_name)});const S=this.concatFields(g,h||p),E=this.concatFields(m,f),T=null===(s=null===(r=null===(o=null==t?void 0:t.getPlace())||void 0===o?void 0:o.geometry)||void 0===r?void 0:r.location)||void 0===s?void 0:s.lat(),I=null===(c=null===(a=null===(l=null==t?void 0:t.getPlace())||void 0===l?void 0:l.geometry)||void 0===a?void 0:a.location)||void 0===c?void 0:c.lng();return{streetAddress:S,streetAddress2:E,zipCode:v,country:d,state:u,city:b,lat:T,lng:I}}static concatFields(...t){let e;return null==t||t.forEach(t=>{e||!t?t&&(e=`${e}, ${t}`):e=t}),e}static convertToAddress({streetAddress:t,streetAddress2:e,zipCode:n,country:i,state:o,city:r,lat:s,lng:l}){return{line1:t,line2:e,city:r,state:o,pin:n,zipCode:n,country:i,location:null,lat:s,lng:l,poBox:null}}}},"5iDH":function(t,e,n){"use strict";n.d(e,"a",function(){return o});var i=n("fXoL");let o=(()=>{class t{constructor(t){this.el=t}static scrollToElement(t){if(t){const e=window.pageYOffset-Math.abs(t.getBoundingClientRect().y);window.scroll({behavior:"smooth",left:0,top:t.getBoundingClientRect().top+window.scrollY-150}),setTimeout(()=>{t.focus(),t.blur(),t.focus()},e)}}static markFormGroupTouched(e){Object.values(e.controls).forEach(e=>{e.markAsTouched(),e.controls&&t.markFormGroupTouched(e)})}onSubmit(e){if(e.preventDefault(),!this.formGroup.valid){t.markFormGroupTouched(this.formGroup);const e=this.el.nativeElement.querySelector(".ng-invalid");if(e)return t.scrollToElement(e);{const e=this.el.nativeElement.querySelectorAll("form .ng-invalid");if(e&&e.length)return t.scrollToElement(e[0])}return t.scrollToElement(this.el.nativeElement)}}}return t.\u0275fac=function(e){return new(e||t)(i.Rb(i.l))},t.\u0275dir=i.Mb({type:t,selectors:[["","appScrollToFirstInvalid",""]],hostBindings:function(t,e){1&t&&i.ec("submit",function(t){return e.onSubmit(t)})},inputs:{formGroup:"formGroup"}}),t})()},QKQc:function(t,e,n){"use strict";n.r(e),n.d(e,"SiteModule",function(){return oe});var i=n("bA1+"),o=n("tyNb"),r=n("T5gh"),s=n("AytR"),l=n("Dwgb"),a=n("qQcL"),c=n("fXoL"),d=n("dEAy"),u=n("ofXK"),b=n("OzZK"),v=n("RwU8"),p=n("C2AL"),h=n("dRHE");function m(t,e){if(1&t){const t=c.Yb();c.Vb(0),c.Xb(1,"p"),c.Xc(2),c.jc(3,"translate"),c.Wb(),c.Xb(4,"button",2),c.ec("click",function(){return c.Lc(t),c.ic().reassignToDelete()}),c.Xc(5),c.jc(6,"translate"),c.Wb(),c.Ub()}2&t&&(c.Db(2),c.Zc(" ",c.kc(3,2,"SITE.ASSIGN_PATIENTS_TO_OTHER_SITE"),""),c.Db(3),c.Yc(c.kc(6,4,"COMMON.BTN_OK")))}function f(t,e){if(1&t){const t=c.Yb();c.Xb(0,"p"),c.Xc(1),c.jc(2,"translate"),c.Wb(),c.Xb(3,"button",2),c.ec("click",function(){return c.Lc(t),c.ic().confirmDelete()}),c.Xc(4),c.jc(5,"translate"),c.Wb()}2&t&&(c.Db(1),c.Zc("",c.kc(2,2,"SITE.PROCEED_TO_DELETE"),"?"),c.Db(3),c.Yc(c.kc(5,4,"COMMON.BTN_CONFIRM")))}let g=(()=>{class t extends a.a{constructor(t){super(),this._modalRef=t,this.NO_USERS="No Users"}ngOnInit(){var t,e,n;this.detailsOfUsers=this.countOfUsers&&(this.countOfUsers.patientsCount||this.countOfUsers.monitoringStaffCount||this.countOfUsers.physicianCount)?`${null===(t=this.countOfUsers)||void 0===t?void 0:t.physicianCount} physicians, ${null===(e=this.countOfUsers)||void 0===e?void 0:e.monitoringStaffCount} monitoring staff and ${null===(n=this.countOfUsers)||void 0===n?void 0:n.patientsCount} patients`:this.NO_USERS}reassignToDelete(){this._modalRef.close(!1)}confirmDelete(){this._modalRef.close(!0)}}return t.\u0275fac=function(e){return new(e||t)(c.Rb(d.e))},t.\u0275cmp=c.Lb({type:t,selectors:[["app-delete-site"]],inputs:{countOfUsers:"countOfUsers"},features:[c.Ab],decls:9,vars:9,consts:[[4,"ngIf","ngIfElse"],["proceedToDelete",""],["nz-button","","nzType","primary",3,"click"]],template:function(t,e){if(1&t&&(c.Xc(0),c.jc(1,"translate"),c.Xb(2,"b"),c.Xc(3),c.Wb(),c.Xc(4),c.jc(5,"translate"),c.Vc(6,m,7,6,"ng-container",0),c.Vc(7,f,6,6,"ng-template",null,1,c.Wc)),2&t){const t=c.Ic(8);c.Zc("",c.kc(1,5,"SITE.THERE_ARE"),"\n"),c.Db(3),c.Yc(e.detailsOfUsers),c.Db(1),c.Zc("\n",c.kc(5,7,"SITE.ASSIGNED_TO_THIS_SITE"),"\n"),c.Db(2),c.rc("ngIf",e.detailsOfUsers!==e.NO_USERS)("ngIfElse",t)}},directives:[u.q,b.a,v.a,p.a],pipes:[h.a],styles:["button[_ngcontent-%COMP%]{float:right;margin-top:7px;width:110px;height:30px}p[_ngcontent-%COMP%]{margin-top:10px}"]}),t})();var S=n("WoUL"),E=n("pLZG"),T=n("1G5W"),I=n("BoNt");let _=(()=>{class t extends a.a{constructor(t,e){super(),this._translationService=t,this._modalRef=e,this.strings=["SITE.CHANGING_DEFAULT_SITE_TO_NEW_SITE_MESSAGE"]}ngOnInit(){this._translationService.getMultiple(...this.strings).pipe(Object(T.a)(this.unsubscribed)).subscribe(t=>{this.translatedStrings=t,this.message=this.translatedStrings.get("SITE.CHANGING_DEFAULT_SITE_TO_NEW_SITE_MESSAGE").replace("{SITE_NAME}",this.siteName)})}onOkayClick(){this._modalRef.close(!0)}}return t.\u0275fac=function(e){return new(e||t)(c.Rb(S.a),c.Rb(d.e))},t.\u0275cmp=c.Lb({type:t,selectors:[["app-change-default-site"]],inputs:{siteName:"siteName"},features:[c.Ab],decls:5,vars:4,consts:[["nz-button","","nzType","primary",3,"click"]],template:function(t,e){1&t&&(c.Xb(0,"p"),c.Xc(1),c.Wb(),c.Xb(2,"button",0),c.ec("click",function(){return e.onOkayClick()}),c.Xc(3),c.jc(4,"translate"),c.Wb()),2&t&&(c.Db(1),c.Yc(e.message),c.Db(2),c.Yc(c.kc(4,2,"COMMON.BTN_CONFIRM")))},directives:[b.a,v.a,p.a],pipes:[h.a],styles:["button[_ngcontent-%COMP%]{float:right;width:110px;height:30px}"]}),t})();var D=n("igu/"),z=n("bNXi"),A=n("PzCk"),C=n("B+r4"),X=n("rMZv"),N=n("Szod"),y=n("ZKr6"),O=n("glKu"),W=n("nJia"),M=n("eHCX"),x=n("t2pg");function F(t,e){1&t&&(c.Xb(0,"th"),c.Xc(1," Sub Tenant "),c.Wb())}function P(t,e){if(1&t&&(c.Xb(0,"td"),c.Xc(1),c.jc(2,"tenantName"),c.Wb()),2&t){const t=c.ic().$implicit;c.Db(1),c.Zc(" ",c.kc(2,1,t.tenantId)," ")}}function R(t,e){if(1&t){const t=c.Yb();c.Xb(0,"app-icons",14),c.ec("click",function(){c.Lc(t);const e=c.ic().$implicit;return c.ic(2).editSite(e.id)}),c.Wb()}}function L(t,e){if(1&t){const t=c.Yb();c.Xb(0,"app-icons",15),c.ec("click",function(){c.Lc(t);const e=c.ic().$implicit;return c.ic(2).makeDefault(e)}),c.jc(1,"translate"),c.Wb()}if(2&t){const t=c.ic().$implicit;c.sc("nzTooltipTitle",c.kc(1,2,null!=t&&t.primarySite?"SITE.THIS_IS_YOUR_DEFAULT_SITE":"SITE.SET_AS_DEFAULT_SITE")),c.rc("color",null!=t&&t.primarySite?"#A7C853":"#8A8A8A")}}function k(t,e){if(1&t){const t=c.Yb();c.Xb(0,"app-icons",16),c.ec("click",function(){c.Lc(t);const e=c.ic().$implicit,n=c.ic(2),i=c.Ic(2);return n.deleteSite(e.id,i)}),c.Wb()}if(2&t){const t=c.ic().$implicit;c.Jb("disabled",null==t?null:t.primarySite)}}const U=function(){return["EDIT_SITE"]},V=function(){return["MARK_AS_DEFAULT_SITE"]},w=function(){return["DELETE_SITE"]};function j(t,e){if(1&t&&(c.Xb(0,"tr"),c.Xb(1,"td"),c.Xc(2),c.Wb(),c.Vc(3,P,3,3,"td",7),c.Xb(4,"td",10),c.Vc(5,R,1,0,"app-icons",11),c.Vc(6,L,2,4,"app-icons",12),c.Vc(7,k,1,2,"app-icons",13),c.Wb(),c.Wb()),2&t){const t=e.$implicit;c.Db(2),c.Yc(t.name),c.Db(3),c.rc("isFeaturePermitted",c.xc(4,U)),c.Db(1),c.rc("isFeaturePermitted",c.xc(5,V)),c.Db(1),c.rc("isFeaturePermitted",c.xc(6,w))}}function G(t,e){if(1&t&&(c.Vb(0),c.Xc(1),c.Ub()),2&t){const t=c.ic(3);c.Db(1),c.Yc(t.pageIndex*t.pageSize)}}function Y(t,e){if(1&t&&(c.Vb(0),c.Xc(1),c.Ub()),2&t){const t=c.ic(3);c.Db(1),c.Yc(t.totalCount)}}function Z(t,e){if(1&t&&(c.Xb(0,"h5",17),c.Xc(1),c.jc(2,"translate"),c.jc(3,"translate"),c.Vc(4,G,2,1,"ng-container",18),c.Vc(5,Y,2,1,"ng-container",18),c.Xc(6),c.Wb()),2&t){const t=c.ic(2);c.Db(1),c.bd(" ",c.kc(2,6,"COMMON.SHOWING")," ",(t.pageIndex-1)*t.pageSize+1," ",c.kc(3,8,"TABLEHEADER.TO")," "),c.Db(3),c.rc("ngIf",t.pageIndex*t.pageSize<t.totalCount),c.Db(1),c.rc("ngIf",t.pageIndex*t.pageSize>=t.totalCount),c.Db(1),c.Zc(" of ",t.totalCount," ")}}const H=function(){return{x:"1250px"}};function q(t,e){if(1&t){const t=c.Yb();c.Xb(0,"div",2),c.Xb(1,"div",3),c.Xb(2,"div",4),c.Xb(3,"nz-table",5,6),c.ec("nzPageIndexChange",function(e){return c.Lc(t),c.ic().getSitesOnPage(e)}),c.jc(5,"translate"),c.Xb(6,"thead"),c.Xb(7,"tr"),c.Xb(8,"th"),c.Xc(9),c.jc(10,"translate"),c.Wb(),c.Vc(11,F,2,0,"th",7),c.Xb(12,"th"),c.Xc(13),c.jc(14,"translate"),c.Wb(),c.Wb(),c.Wb(),c.Xb(15,"tbody"),c.Vc(16,j,8,7,"tr",8),c.Wb(),c.Wb(),c.Vc(17,Z,7,10,"ng-template",null,9,c.Wc),c.Wb(),c.Wb(),c.Wb()}if(2&t){const t=c.Ic(4),e=c.Ic(18),n=c.ic();c.Db(3),c.sc("nzNoResult",c.kc(5,13,"SITE.NO_SITES_FOUND")),c.rc("nzLoading",n.loading)("nzData",n.sites)("nzShowPagination",!0)("nzPageIndex",n.pageIndex)("nzFrontPagination",!1)("nzTotal",n.totalCount)("nzShowTotal",e)("nzWidthConfig",n.widthConfig)("nzScroll",c.xc(19,H)),c.Db(6),c.Yc(c.kc(10,15,"SITES")),c.Db(4),c.Yc(c.kc(14,17,"TABLEHEADER.ACTIONS")),c.Db(3),c.rc("ngForOf",t.data)}}function B(t,e){1&t&&(c.Xb(0,"h4",19),c.Xc(1),c.jc(2,"translate"),c.Wb()),2&t&&(c.Db(1),c.Yc(c.kc(2,1,"SITE.DELETE_SITE")))}const $=function(){return["VIEW_SITE","ADD_SITE","EDIT_SITE","DELETE_SITE","MARK_AS_DEFAULT_SITE"]};let Q=(()=>{class t extends a.a{constructor(t,e,n,i,o,r){super(),this._siteService=t,this._router=e,this.modalService=n,this._dataSharingService=i,this._translationService=o,this._notificationService=r,this.totalCount=0,this.pageSize=s.g.pageSize,this.displayedColumns=["name","actions"],this.sites=[],this.pageIndex=1,this.loading=!0,this.strings=["SITE.DELETE_SITE","SITE.CHANGING_DEFAULT_SITE_TO_NEW_SITE"],this.widthConfig=["80%","20%"],this._routeHelperService.getSearch().pipe(Object(E.a)(t=>null!==t),Object(T.a)(this.unsubscribed)).subscribe(t=>this.applyFilter(t)),this._routeHelperService.isPrimaryActionTriggered().pipe(Object(E.a)(t=>!!t),Object(T.a)(this.unsubscribed)).subscribe(()=>this.gotoAddSite()),this.widthConfig=this.isAccessAcrossSubTenants?["40%","40%","20%"]:["80%","20%"]}ngOnInit(){this._dataSharingService.onSubTenantChange().subscribe(t=>this.onSubTenantChange(t)),this._translationService.getMultiple(...this.strings).pipe(Object(T.a)(this.unsubscribed)).subscribe(t=>{this.translatedStrings=t}),this.getSitesOnPage(1)}onSubTenantChange(t){"object"!=typeof t||""==t||null==t||null==t||(this.requestTenantIds=t.join()),this.getSitesOnPage(1)}getSitesOnPage(t){this.pageIndex=t,this.loading=!0,this._siteService.getAllSites(this.pageIndex-1,this.pageSize,null,!1,this.requestTenantIds).subscribe(t=>{this.totalCount=null==t?void 0:t.totalCount,this.sites=null==t?void 0:t.result,this.loading=!1},t=>{var e;this.loading=!1,this._notificationService.error("Error",null===(e=null==t?void 0:t.error)||void 0===e?void 0:e.message)})}applyFilter(t){this.loading=!0,this._siteService.getAllSites(0,this.pageSize,t,!1,this.requestTenantIds).subscribe(t=>{var e;this.loading=!1,this.sites=null==t?void 0:t.result,(null===(e=this.sites)||void 0===e?void 0:e.length)>0&&(this.totalCount=t.totalCount)},t=>{this.loading=!1},()=>{this.loading=!1})}gotoAddSite(){this._router.navigate(["sites/add"])}editSite(t){this._router.navigate(["sites/edit",t])}makeDefault(t){!0!==(null==t?void 0:t.primarySite)&&this.modalService.create({nzTitle:this.translatedStrings.get("SITE.CHANGING_DEFAULT_SITE_TO_NEW_SITE").replace("{NEW_DEFAULT_SITE}",t.name),nzContent:_,nzComponentParams:{siteName:t.name},nzWidth:"662px",nzBodyStyle:{padding:"0px 36px 18px 36px",height:"100px"},nzStyle:{top:"200px"},nzFooter:null}).afterClose.subscribe(e=>{e&&this._siteService.makeDefault(t.id).subscribe(t=>{this._notificationService.success("Default Site","Default site updated"),window.location.reload()},t=>{this._notificationService.error("Error","Default site updation failed")})})}deleteSite(t,e){this._siteService.getSiteById(t).subscribe(n=>{var i;(null===(i=null==n?void 0:n.site)||void 0===i?void 0:i.primarySite)||this.modalService.create({nzTitle:e,nzContent:g,nzComponentParams:{countOfUsers:n.count},nzWidth:"662px",nzBodyStyle:{height:"120px",padding:"0 35px 18px"},nzStyle:{top:"200px"},nzFooter:null}).afterClose.subscribe(e=>{e&&this._siteService.deleteSite(t).subscribe(t=>{this._notificationService.success("Delete Site","Site Deleted"),this.getSitesOnPage(this.pageIndex)},t=>{this._notificationService.error("Error","Site deletion failed")})})})}}return t.\u0275fac=function(e){return new(e||t)(c.Rb(I.a),c.Rb(o.g),c.Rb(d.f),c.Rb(D.a),c.Rb(S.a),c.Rb(z.b))},t.\u0275cmp=c.Lb({type:t,selectors:[["sites"]],features:[c.Cb([l.a]),c.Ab],decls:3,vars:2,consts:[["class","container",4,"anyFeaturePermitted"],["deleteSiteTitle",""],[1,"container"],["nz-row","","nzGutter","64"],["nz-col","","nzSpan","24"],[3,"nzLoading","nzData","nzShowPagination","nzNoResult","nzPageIndex","nzFrontPagination","nzTotal","nzShowTotal","nzWidthConfig","nzScroll","nzPageIndexChange"],["sitesTable",""],[4,"isAccessAcrossTenantEnabled"],[4,"ngFor","ngForOf"],["totalSitesCount",""],[1,"actions"],["name","edit","size","22px",3,"click",4,"isFeaturePermitted"],["name","environment","size","22px","nz-tooltip","","nzTooltipPlacement","right",3,"color","nzTooltipTitle","click",4,"isFeaturePermitted"],["name","delete","size","22px",3,"disabled","click",4,"isFeaturePermitted"],["name","edit","size","22px",3,"click"],["name","environment","size","22px","nz-tooltip","","nzTooltipPlacement","right",3,"color","nzTooltipTitle","click"],["name","delete","size","22px",3,"click"],["nz-typography",""],[4,"ngIf"],[2,"margin-top","20px","margin-bottom","0px"]],template:function(t,e){1&t&&(c.Vc(0,q,19,20,"div",0),c.Vc(1,B,3,3,"ng-template",null,1,c.Wc)),2&t&&c.rc("anyFeaturePermitted",c.xc(1,$))},directives:[A.a,C.c,C.a,X.f,X.n,X.o,X.e,X.l,N.a,X.i,u.p,y.a,O.a,W.d,M.a,u.q],pipes:[h.a,x.a],styles:["app-icons[_ngcontent-%COMP%] + app-icons[_ngcontent-%COMP%]{margin-left:10px}td[_ngcontent-%COMP%]:first-child{font-weight:700;font-size:13.5px}.actions[_ngcontent-%COMP%]{word-spacing:5px}.disabled[_ngcontent-%COMP%]{pointer-events:none;opacity:.7}"]}),t})();var K=n("3Pt+");class J{constructor(){this.name=new K.i(null,K.D.required),this.description=new K.i,this.mobile=new K.i(null,[K.D.required,K.D.minLength(6),K.D.maxLength(15),K.D.pattern(/^(?:(?:\(?(?:00|\+)([1-4]\d\d|[1-9]\d*)\)?)[\-\.\ \\\/]?)?((?:\(?\d{1,}\)?[\-\.\ \\\/]?)+)(?:[\-\.\ \\\/]?(?:#|ext\.?|extension|x)[\-\.\ \\\/]?(\d+))?$/)]),this.siteId=new K.i,this.departmentId=new K.i(null,[K.D.required]),this.primarySite=new K.i,this.streetAddress=new K.i(null,K.D.required),this.streetAddress2=new K.i,this.city=new K.i(null,K.D.required),this.state=new K.i(null,K.D.required),this.country=new K.i(null,K.D.required),this.zipCode=new K.i(null,K.D.required),this.lat=new K.i,this.lng=new K.i,this.letterPhoneNumbers=new K.f([],K.D.required)}}var tt=function(t){return t.ORG_NPI_ID="ORG_NPI_ID",t.DEPARTMENT_ID="DEPARTMENT_ID",t}({}),et=n("2sp+"),nt=n("Kj3r"),it=n("/uUt"),ot=n("eIep"),rt=n("h51P");class st{constructor(t,e){this.templateType=t,this.phoneNumber=e}}const lt=t=>{var e,n;return null===(n=null===(e=t.get("letterPhoneNumbers"))||void 0===e?void 0:e.controls)||void 0===n?void 0:n.map(t=>{var e,n,i,o;return new st(null===(n=null===(e=null==t?void 0:t.controls)||void 0===e?void 0:e.templateType)||void 0===n?void 0:n.value,null===(o=null===(i=null==t?void 0:t.controls)||void 0===i?void 0:i.phoneNumber)||void 0===o?void 0:o.value)})},at=t=>{var e,n,i,o,r,s,l,a,c,d,u,b,v,p,h,m,f,g;return{line1:null===(n=null===(e=null==t?void 0:t.controls)||void 0===e?void 0:e.streetAddress)||void 0===n?void 0:n.value,line2:null===(o=null===(i=null==t?void 0:t.controls)||void 0===i?void 0:i.streetAddress2)||void 0===o?void 0:o.value,city:null===(s=null===(r=null==t?void 0:t.controls)||void 0===r?void 0:r.city)||void 0===s?void 0:s.value,state:null===(a=null===(l=null==t?void 0:t.controls)||void 0===l?void 0:l.state)||void 0===a?void 0:a.value,country:null===(d=null===(c=null==t?void 0:t.controls)||void 0===c?void 0:c.country)||void 0===d?void 0:d.value,pin:null===(b=null===(u=null==t?void 0:t.controls)||void 0===u?void 0:u.zipCode)||void 0===b?void 0:b.value,zipCode:null===(p=null===(v=null==t?void 0:t.controls)||void 0===v?void 0:v.zipCode)||void 0===p?void 0:p.value,lat:null===(m=null===(h=null==t?void 0:t.controls)||void 0===h?void 0:h.lat)||void 0===m?void 0:m.value,lng:null===(g=null===(f=null==t?void 0:t.controls)||void 0===f?void 0:f.lng)||void 0===g?void 0:g.value}},ct=(t,e)=>{var n,i;return{contactNumber:null===(i=null===(n=null==t?void 0:t.controls)||void 0===n?void 0:n.mobile)||void 0===i?void 0:i.value,countryCode:e}};var dt=n("r0o6"),ut=n("bp6e"),bt=n("q5r7"),vt=n("4RGM"),pt=n("pxUr"),ht=n("S5rh"),mt=n("MZxW"),ft=n("ocnv"),gt=n("5iDH"),St=n("PTRe"),Et=n("TaO5"),Tt=n("5vDB"),It=n("qAZ0");const _t=["searchAddress"],Dt=function(){return[16,48]};function zt(t,e){if(1&t){const t=c.Yb();c.Xb(0,"div",6),c.Xb(1,"div",7),c.Xb(2,"sub-tenant-select",8),c.ec("onSubTenantSelected",function(e){return c.Lc(t),c.ic(2).onSubTenantChange(e)}),c.Wb(),c.Wb(),c.Wb()}if(2&t){const t=c.ic(2);c.rc("nzGutter",c.xc(4,Dt)),c.Db(2),c.rc("disabled","edit"==t.mode)("selectedSubTenant",t.subTenantId)("showError",t.showTenantToggleError)}}function At(t,e){1&t&&(c.Vb(0),c.Xc(1),c.jc(2,"translate"),c.Ub()),2&t&&(c.Db(1),c.Zc("",c.kc(2,1,"SITE.DEFAULT_SITE")," "))}function Ct(t,e){1&t&&(c.Xc(0),c.jc(1,"translate")),2&t&&c.Yc(c.kc(1,1,"SITE.SET_AS_DEFAULT"))}function Xt(t,e){1&t&&(c.Vb(0),c.Xc(1),c.jc(2,"translate"),c.Ub()),2&t&&(c.Db(1),c.Zc(" ",c.kc(2,1,"COMMON.REQUIRED")," "))}function Nt(t,e){1&t&&(c.Vb(0),c.Xc(1),c.jc(2,"translate"),c.Ub()),2&t&&(c.Db(1),c.Zc(" ",c.kc(2,1,"SITE.SITE_WITH_SAME_NAME_ALREADY_EXISTS")," "))}function yt(t,e){if(1&t&&(c.Vc(0,Xt,3,3,"ng-container",5),c.Vc(1,Nt,3,3,"ng-container",5)),2&t){const t=e.$implicit;c.rc("ngIf",t.hasError("required")),c.Db(1),c.rc("ngIf",t.hasError("notUnique"))}}function Ot(t,e){1&t&&(c.Vb(0),c.Xc(1),c.jc(2,"translate"),c.Ub()),2&t&&(c.Db(1),c.Zc(" ",c.kc(2,1,"COMMON.REQUIRED")," "))}function Wt(t,e){1&t&&(c.Vb(0),c.Xc(1),c.jc(2,"translate"),c.Ub()),2&t&&(c.Db(1),c.Zc(" ",c.kc(2,1,"VALIDATION.PHONE_NUMBER_ATLEAST_SIX_CHARS")," "))}function Mt(t,e){1&t&&(c.Vb(0),c.Xc(1),c.jc(2,"translate"),c.Ub()),2&t&&(c.Db(1),c.Zc(" ",c.kc(2,1,"VALIDATION.PHONE_NUMBER_MAX_SIXTEEN_CHARS")," "))}function xt(t,e){1&t&&(c.Vb(0),c.Xc(1),c.jc(2,"translate"),c.Ub()),2&t&&(c.Db(1),c.Zc(" ",c.kc(2,1,"VALIDATION.PHONE_NUMBER_CONTAINS_INVALID_CHARS")," "))}function Ft(t,e){1&t&&(c.Vb(0),c.Xc(1),c.jc(2,"translate"),c.Ub()),2&t&&(c.Db(1),c.Zc(" ",c.kc(2,1,"SITE.ANOTHER_SITE_IS_USING_SAME_CONTACT_NUMBER")," "))}function Pt(t,e){if(1&t&&(c.Vc(0,Ot,3,3,"ng-container",5),c.Vc(1,Wt,3,3,"ng-container",5),c.Vc(2,Mt,3,3,"ng-container",5),c.Vc(3,xt,3,3,"ng-container",5),c.Vc(4,Ft,3,3,"ng-container",5)),2&t){const t=e.$implicit;c.rc("ngIf",t.hasError("required")),c.Db(1),c.rc("ngIf",t.hasError("minlength")),c.Db(1),c.rc("ngIf",t.hasError("maxlength")),c.Db(1),c.rc("ngIf",t.hasError("pattern")),c.Db(1),c.rc("ngIf",t.hasError("notUnique"))}}function Rt(t,e){1&t&&(c.Vb(0),c.Xc(1),c.jc(2,"translate"),c.Ub()),2&t&&(c.Db(1),c.Zc(" ",c.kc(2,1,"SITE.NPI_ID_ALREADY_IN_USE")," "))}function Lt(t,e){1&t&&c.Vc(0,Rt,3,3,"ng-container",5),2&t&&c.rc("ngIf",e.$implicit.hasError("notUnique"))}function kt(t,e){1&t&&(c.Vb(0),c.Xc(1),c.jc(2,"translate"),c.Ub()),2&t&&(c.Db(1),c.Zc(" ",c.kc(2,1,"COMMON.REQUIRED")," "))}function Ut(t,e){1&t&&c.Vc(0,kt,3,3,"ng-container",5),2&t&&c.rc("ngIf",e.$implicit.hasError("required"))}function Vt(t,e){1&t&&(c.Xb(0,"div"),c.Xb(1,"div",48),c.Xc(2),c.jc(3,"translate"),c.Wb(),c.Wb()),2&t&&(c.Db(2),c.Yc(c.kc(3,1,"COMMON.REQUIRED")))}function wt(t,e){1&t&&(c.Xb(0,"div"),c.Xb(1,"div",48),c.Xc(2),c.jc(3,"translate"),c.Wb(),c.Wb()),2&t&&(c.Db(2),c.Zc("",c.kc(3,1,"VALIDATION.PHONE_NUMBER_ATLEAST_SIX_CHARS")," "))}function jt(t,e){1&t&&(c.Xb(0,"div"),c.Xb(1,"div",48),c.Xc(2),c.jc(3,"translate"),c.Wb(),c.Wb()),2&t&&(c.Db(2),c.Yc(c.kc(3,1,"VALIDATION.PHONE_NUMBER_CONTAINS_INVALID_CHARS")))}function Gt(t,e){if(1&t&&(c.Xb(0,"div",44),c.Xb(1,"div",45),c.Xb(2,"label",46),c.Xc(3," Phone Number "),c.Sb(4,"br"),c.Xb(5,"span"),c.Xc(6),c.Wb(),c.Wb(),c.Sb(7,"input",47),c.Vc(8,Vt,4,3,"div",5),c.Vc(9,wt,4,3,"div",5),c.Vc(10,jt,4,3,"div",5),c.Wb(),c.Wb()),2&t){const t=e.$implicit,n=e.index,i=c.ic(4);c.Db(1),c.rc("formGroupName",n),c.Db(1),c.tc("nzTooltipTitle","Phone Number (",i.defaultLetterTemplateMap.get(t.value.templateType),")"),c.Db(4),c.Zc("( ",i.defaultLetterTemplateMap.get(t.value.templateType)," )"),c.Db(1),c.rc("ngClass",i.siteForm.get("letterPhoneNumbers").controls[n].controls.phoneNumber.hasError("required")&&i.siteForm.get("letterPhoneNumbers").controls[n].controls.phoneNumber.touched?"error-input":null),c.Db(1),c.rc("ngIf",i.siteForm.get("letterPhoneNumbers").controls[n].controls.phoneNumber.hasError("required")&&i.siteForm.get("letterPhoneNumbers").controls[n].controls.phoneNumber.touched),c.Db(1),c.rc("ngIf",i.siteForm.get("letterPhoneNumbers").controls[n].controls.phoneNumber.hasError("minlength")&&i.siteForm.get("letterPhoneNumbers").controls[n].controls.phoneNumber.touched),c.Db(1),c.rc("ngIf",i.siteForm.get("letterPhoneNumbers").controls[n].controls.phoneNumber.hasError("pattern")&&i.siteForm.get("letterPhoneNumbers").controls[n].controls.phoneNumber.touched)}}function Yt(t,e){if(1&t&&(c.Vb(0),c.Sb(1,"nz-divider"),c.Xb(2,"div",6),c.Xb(3,"div",41),c.Xb(4,"h3",10),c.Xc(5,"Lob Letter Template Phone Numbers"),c.Wb(),c.Wb(),c.Wb(),c.Sb(6,"br"),c.Xb(7,"nz-spin",42),c.Xb(8,"div",6),c.Vc(9,Gt,11,7,"div",43),c.Wb(),c.Wb(),c.Ub()),2&t){const t=c.ic(3);c.Db(2),c.rc("nzGutter",c.xc(4,Dt)),c.Db(5),c.rc("nzSpinning",t.loadingLobData),c.Db(1),c.rc("nzGutter",c.xc(5,Dt)),c.Db(1),c.rc("ngForOf",t.siteForm.get("letterPhoneNumbers").controls)}}const Zt=function(){return{standalone:!0}};function Ht(t,e){if(1&t){const t=c.Yb();c.Vb(0),c.Xb(1,"div",6),c.Xb(2,"div",9),c.Xb(3,"h3",10),c.Xc(4),c.jc(5,"translate"),c.Wb(),c.Wb(),c.Xb(6,"div",11),c.Xb(7,"button",12),c.ec("click",function(){return c.Lc(t),c.ic(2).makeDefault()}),c.Sb(8,"app-icons",13),c.Xc(9," \xa0 "),c.Vc(10,At,3,3,"ng-container",14),c.Vc(11,Ct,2,3,"ng-template",null,15,c.Wc),c.Wb(),c.Wb(),c.Wb(),c.Xb(13,"form",16),c.ec("ngSubmit",function(){return c.Lc(t),c.ic(2).submit()})("keydown.enter",function(t){return t.preventDefault()}),c.Xb(14,"div",6),c.Xb(15,"div",17),c.Xb(16,"label"),c.Xc(17),c.jc(18,"translate"),c.Wb(),c.Wb(),c.Xb(19,"div",17),c.Xb(20,"label"),c.Xc(21),c.jc(22,"translate"),c.Wb(),c.Wb(),c.Xb(23,"div",17),c.Xb(24,"label"),c.Xc(25),c.jc(26,"translate"),c.Wb(),c.Wb(),c.Wb(),c.Xb(27,"div",18),c.Xb(28,"div",17),c.Xb(29,"nz-form-item"),c.Xb(30,"nz-form-control",19),c.Sb(31,"input",20),c.Wb(),c.Vc(32,yt,2,2,"ng-template",null,21,c.Wc),c.Wb(),c.Wb(),c.Xb(34,"div",17),c.Xb(35,"nz-form-item"),c.Xb(36,"nz-form-control"),c.Sb(37,"input",22),c.Wb(),c.Wb(),c.Wb(),c.Xb(38,"div",17),c.Xb(39,"nz-form-item"),c.Xb(40,"nz-form-control",19),c.Xb(41,"nz-input-group",23),c.Sb(42,"input",24),c.Wb(),c.Wb(),c.Vc(43,Pt,5,5,"ng-template",null,25,c.Wc),c.Wb(),c.Wb(),c.Wb(),c.Xb(45,"div",6),c.Xb(46,"div",17),c.Xb(47,"label"),c.Xc(48),c.jc(49,"translate"),c.Wb(),c.Wb(),c.Xb(50,"div",17),c.Xb(51,"label"),c.Xc(52,"Department ID"),c.Wb(),c.Wb(),c.Wb(),c.Xb(53,"div",6),c.Xb(54,"div",17),c.Xb(55,"nz-form-item",26),c.Xb(56,"nz-form-control",19),c.Sb(57,"input",27),c.Wb(),c.Vc(58,Lt,1,1,"ng-template",null,28,c.Wc),c.Wb(),c.Xb(60,"label",29),c.ec("ngModelChange",function(e){return c.Lc(t),c.ic(2).sameAsDefaultSite=e})("ngModelChange",function(){return c.Lc(t),c.ic(2).onSameAsDefaultSiteCheck()}),c.Xc(61),c.jc(62,"translate"),c.Wb(),c.Wb(),c.Xb(63,"div",17),c.Xb(64,"nz-form-item",26),c.Xb(65,"nz-form-control",19),c.Sb(66,"input",30),c.Wb(),c.Vc(67,Ut,1,1,"ng-template",null,31,c.Wc),c.Wb(),c.Wb(),c.Wb(),c.Vc(69,Yt,10,6,"ng-container",5),c.Sb(70,"nz-divider"),c.Xb(71,"div",6),c.Xb(72,"div",9),c.Xb(73,"h3",10),c.Xc(74),c.jc(75,"translate"),c.Wb(),c.Wb(),c.Wb(),c.Xb(76,"div",6),c.Xb(77,"div",32),c.Xb(78,"label"),c.Xc(79),c.jc(80,"translate"),c.Wb(),c.Wb(),c.Xb(81,"div",32),c.Xb(82,"label"),c.Xc(83),c.jc(84,"translate"),c.Wb(),c.Wb(),c.Wb(),c.Xb(85,"div",18),c.Xb(86,"div",32),c.Xb(87,"nz-form-item"),c.Xb(88,"nz-form-control",19),c.jc(89,"translate"),c.Sb(90,"input",33,34),c.Wb(),c.Wb(),c.Wb(),c.Xb(92,"div",32),c.Xb(93,"nz-form-item"),c.Xb(94,"nz-form-control"),c.Sb(95,"input",35),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Sb(96,"div",36),c.Xb(97,"div",18),c.Xb(98,"div",17),c.Xb(99,"label"),c.Xc(100),c.jc(101,"translate"),c.Wb(),c.Wb(),c.Xb(102,"div",17),c.Xb(103,"label"),c.Xc(104),c.jc(105,"translate"),c.Wb(),c.Wb(),c.Xb(106,"div",17),c.Xb(107,"label"),c.Xc(108),c.jc(109,"translate"),c.Wb(),c.Wb(),c.Xb(110,"div",17),c.Xb(111,"label"),c.Xc(112),c.jc(113,"translate"),c.Wb(),c.Wb(),c.Wb(),c.Xb(114,"div",18),c.Xb(115,"div",17),c.Xb(116,"nz-form-item"),c.Xb(117,"nz-form-control",19),c.jc(118,"translate"),c.Sb(119,"input",37),c.Wb(),c.Wb(),c.Wb(),c.Xb(120,"div",17),c.Xb(121,"nz-form-item"),c.Xb(122,"nz-form-control",19),c.jc(123,"translate"),c.Sb(124,"input",38),c.Wb(),c.Wb(),c.Wb(),c.Xb(125,"div",17),c.Xb(126,"nz-form-item"),c.Xb(127,"nz-form-control",19),c.jc(128,"translate"),c.Sb(129,"input",39),c.Wb(),c.Wb(),c.Wb(),c.Xb(130,"div",17),c.Xb(131,"nz-form-item"),c.Xb(132,"nz-form-control",19),c.jc(133,"translate"),c.Sb(134,"input",40),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Wb(),c.Ub()}if(2&t){const t=c.Ic(12),e=c.Ic(33),n=c.Ic(44),i=c.Ic(59),o=c.Ic(68),r=c.ic(2);c.Db(1),c.rc("nzGutter",c.xc(75,Dt)),c.Db(3),c.Yc(c.kc(5,39,"COMMON.BASICINFO")),c.Db(3),c.Jb("disabled-button",!0===r.primarySite),c.Db(3),c.rc("ngIf",r.primarySite)("ngIfElse",t),c.Db(3),c.rc("formGroup",r.siteForm),c.Db(1),c.rc("nzGutter",c.xc(76,Dt)),c.Db(3),c.Zc("",c.kc(18,41,"SITE.NAME"),"*"),c.Db(4),c.Yc(c.kc(22,43,"SITE.DESCRIPTION")),c.Db(4),c.Zc("",c.kc(26,45,"COMMON.PHONE_NUMBER"),"*"),c.Db(5),c.rc("nzErrorTip",e),c.Db(10),c.rc("nzErrorTip",n),c.Db(1),c.tc("nzAddOnBefore","[",r.countryCode,"]"),c.Db(4),c.rc("nzGutter",16),c.Db(3),c.Yc(c.kc(49,47,"SITE.NPI_ID")),c.Db(5),c.rc("nzGutter",16),c.Db(3),c.rc("nzErrorTip",i),c.Db(4),c.Jb("disabled",!0===r.primarySite),c.rc("ngModel",r.sameAsDefaultSite)("ngModelOptions",c.xc(77,Zt)),c.Db(1),c.Zc(" ",c.kc(62,49,"SITE.SAME_AS_DEFAULT_SITE")," "),c.Db(4),c.rc("nzErrorTip",o),c.Db(4),c.rc("ngIf",r.lobEnabled),c.Db(2),c.rc("nzGutter",c.xc(78,Dt)),c.Db(3),c.Yc(c.kc(75,51,"COMMON.ADDRESS")),c.Db(2),c.rc("nzGutter",c.xc(79,Dt)),c.Db(3),c.Zc("",c.kc(80,53,"SITE.ADDRESS_LINE_1")," *"),c.Db(4),c.Yc(c.kc(84,55,"COMMON.LINE_2")),c.Db(5),c.sc("nzErrorTip",c.kc(89,57,"COMMON.REQUIRED")),c.Db(12),c.Zc("",c.kc(101,59,"ZIP_CODE")," *"),c.Db(4),c.Yc(c.kc(105,61,"COMMON.COUNTRY")),c.Db(4),c.Yc(c.kc(109,63,"COMMON.STATE")),c.Db(4),c.Yc(c.kc(113,65,"COMMON.CITY")),c.Db(5),c.sc("nzErrorTip",c.kc(118,67,"COMMON.REQUIRED")),c.Db(5),c.sc("nzErrorTip",c.kc(123,69,"COMMON.REQUIRED")),c.Db(5),c.sc("nzErrorTip",c.kc(128,71,"COMMON.REQUIRED")),c.Db(5),c.sc("nzErrorTip",c.kc(133,73,"COMMON.REQUIRED"))}}function qt(t,e){if(1&t&&(c.Xb(0,"div",3),c.Vc(1,zt,3,5,"div",4),c.Vc(2,Ht,135,80,"ng-container",5),c.Wb()),2&t){const t=c.ic();c.Db(2),c.rc("ngIf",t.siteForm)}}let Bt=(()=>{class t extends a.a{constructor(t,e,n,i,o,r,s,l,a,c,d,u){super(),this._router=t,this._fb=e,this._siteService=n,this._storeService=i,this.mapsAPILoader=o,this._modalService=r,this._activatedRoute=s,this._dataSharingService=l,this._translationService=a,this._notificationsService=c,this._googleLocationService=d,this._defaultLetterTemplatesService=u,this.lobEnabled=!1,this.loadingLobData=!1,this.strings=["SITES","SITE.ADD","SITE.EDIT","SITE.CHANGING_DEFAULT_SITE_TO_NEW_SITE","SITE.CREATED_SUCCESSFULLY","SITE.UPDATED_SUCCESSFULLY"],this._siteService.getDefaultSite().subscribe(t=>{t?this.defaultSite=t:(this.primarySite=!0,this.sameAsDefaultSite=!1)}),this.siteId=this._activatedRoute.snapshot.paramMap.get("id"),this.mode=this._activatedRoute.snapshot.paramMap.get("mode"),this._translationService.getMultiple(...this.strings).pipe(Object(T.a)(this.unsubscribed)).subscribe(t=>{this.translatedStrings=t,this.title=this.translatedStrings.get("edit"===this.mode?"SITE.EDIT":"SITE.ADD")})}ngOnInit(){this.initTenantConfigs()}initTenantConfigs(){var t;null===(t=this._dataSharingService.assignedTenantSettings)||void 0===t||t.pipe(Object(T.a)(this.unsubscribed)).subscribe(t=>{this.tenantConfigMap=t,this.updateTenantConfig()})}updateTenantConfig(){var t,e,n,i;"add"==this.mode&&(this.tenantConfigMap.forEach((t,e)=>{i=e}),this.subTenantId=i),this.subTenantId&&(localStorage.setItem(vt.a.REQUEST_TENANT_IDS,this.subTenantId),this.tenantConfig=this.tenantConfigMap.get(this.subTenantId),this.countryCode=null===(t=this.tenantConfig)||void 0===t?void 0:t.countryCode,this.lobEnabled=null===(n=null===(e=this.tenantConfig)||void 0===e?void 0:e.directMailConfig)||void 0===n?void 0:n.directMailEnabled),this.initializeForm()}initializeForm(){this.loadingLobData=!0,{add:()=>this.newFormInitializer(),edit:()=>this.existingSiteFormInitializer()}[this.mode]()}updateFormValidators(){var t,e,n,i,o,r;(null===(e=null===(t=this.tenantConfig)||void 0===t?void 0:t.directMailConfig)||void 0===e?void 0:e.directMailEnabled)||null===(n=this.siteForm)||void 0===n||n.get("letterPhoneNumbers").clearValidators(),(null===(o=null===(i=this.tenantConfig)||void 0===i?void 0:i.redoxConfig)||void 0===o?void 0:o.enabled)||null===(r=this.siteForm)||void 0===r||r.get("departmentId").clearValidators()}newFormInitializer(){this.siteForm=this._fb.group(new J),this.loadDefaultTemplates(),setTimeout(()=>this.searchAddress()),this.getLocationFromZipcode(),this.updateFormValidators()}existingSiteFormInitializer(){this._siteService.getSiteById(this.siteId).pipe(Object(T.a)(this.unsubscribed)).subscribe(t=>{this.primarySite=t.site.primarySite,this.subTenantId=t.site.tenantId,localStorage.setItem(vt.a.REQUEST_TENANT_IDS,this.subTenantId),this.tenantConfig=this.tenantConfigMap.get(this.subTenantId),this.siteForm=this._fb.group(((t,e)=>{var n,i,o,r,s,l,a,c,d,u,b,v;const p=new J;if(null==t||null==t.site)return p;for(const h in t.site)"letterPhoneNumbers"!==h&&(null===(n=p[h])||void 0===n||n.setValue(t.site[h]));return p.siteId.setValue((t=>{var e;return null===(e=null==t?void 0:t.find(t=>(null==t?void 0:t.source)===tt.ORG_NPI_ID))||void 0===e?void 0:e.sourceId})(t.site.externalSources)),p.departmentId.setValue((t=>{var e;return null===(e=null==t?void 0:t.find(t=>(null==t?void 0:t.source)===tt.DEPARTMENT_ID))||void 0===e?void 0:e.sourceId})(t.site.externalSources)),p.mobile.setValue(null===(r=null===(o=null===(i=t.site.siteSupport)||void 0===i?void 0:i.contacts)||void 0===o?void 0:o[0])||void 0===r?void 0:r.contactNumber),p.streetAddress.setValue(null===(s=t.site.siteAddress)||void 0===s?void 0:s.line1),p.streetAddress2.setValue(null===(l=t.site.siteAddress)||void 0===l?void 0:l.line2),p.city.setValue(null===(a=t.site.siteAddress)||void 0===a?void 0:a.city),p.state.setValue(null===(c=t.site.siteAddress)||void 0===c?void 0:c.state),p.country.setValue(null===(d=t.site.siteAddress)||void 0===d?void 0:d.country),p.zipCode.setValue(null===(u=t.site.siteAddress)||void 0===u?void 0:u.pin),p.lat.setValue(null===(b=t.site.siteAddress)||void 0===b?void 0:b.lat),p.lng.setValue(null===(v=t.site.siteAddress)||void 0===v?void 0:v.lng),p.letterPhoneNumbers.setValue([]),p})(t)),this.loadDefaultTemplates(t),setTimeout(()=>this.searchAddress()),this.getLocationFromZipcode(),this.updateFormValidators()})}loadDefaultTemplates(t){this._defaultLetterTemplatesService.fetchDefaultLetterTemplates().pipe(Object(T.a)(this.unsubscribed)).subscribe(e=>{this.defaultLetterTemplateMap=new Map,this.defaultLetterTemplateMap.clear(),null==e||e.forEach(t=>{var e;return null===(e=this.defaultLetterTemplateMap)||void 0===e?void 0:e.set(t.id,t.letterType)}),this.patchForm(t),this.loadingLobData=!1})}patchForm(t){var e;const n=this.siteForm.get("letterPhoneNumbers"),i=[];(null===(e=null==t?void 0:t.site)||void 0===e?void 0:e.letterPhoneNumbers)?this.defaultLetterTemplateMap.forEach((e,n)=>{var o,r,s;const l=(null===(s=null===(r=null===(o=null==t?void 0:t.site)||void 0===o?void 0:o.letterPhoneNumbers)||void 0===r?void 0:r.find(t=>t.templateType===n))||void 0===s?void 0:s.phoneNumber)||"";i.push(new st(n,l))}):this.defaultLetterTemplateMap.forEach((t,e)=>i.push(new st(e,""))),i.forEach(t=>n.push(new K.l({templateType:new K.i(t.templateType),phoneNumber:new K.i(t.phoneNumber,[K.D.required,K.D.minLength(6),K.D.pattern(/^(?:(?:\(?(?:00|\+)([1-4]\d\d|[1-9]\d*)\)?)[\-\.\ \\\/]?)?((?:\(?\d{1,}\)?[\-\.\ \\\/]?)+)(?:[\-\.\ \\\/]?(?:#|ext\.?|extension|x)[\-\.\ \\\/]?(\d+))?$/)])})))}getLocationFromZipcode(){var t,e,n;null===(n=null===(e=null===(t=this.siteForm)||void 0===t?void 0:t.controls)||void 0===e?void 0:e.zipCode)||void 0===n||n.valueChanges.pipe(Object(nt.a)(500),Object(it.a)(),Object(E.a)(t=>(null==t?void 0:t.length)>4),Object(ot.a)(t=>this._googleLocationService.fetchLocationFromZipCode(t))).pipe(Object(T.a)(this.unsubscribed)).subscribe(t=>{var e,n,i,o,r,s,l,a;let c,d,u;0!=(null===(e=null==t?void 0:t.results)||void 0===e?void 0:e.length)&&(null===(n=null==t?void 0:t.results)||void 0===n||n.forEach(t=>{var e;null===(e=null==t?void 0:t.address_components)||void 0===e||e.forEach(t=>{var e,n,i;-1!==(null===(e=null==t?void 0:t.types)||void 0===e?void 0:e.findIndex(t=>"country"===t))&&(c=t.long_name),-1!==(null===(n=null==t?void 0:t.types)||void 0===n?void 0:n.findIndex(t=>"administrative_area_level_1"===t))&&(d=t.long_name),-1!==(null===(i=null==t?void 0:t.types)||void 0===i?void 0:i.findIndex(t=>"locality"===t))&&(u=t.long_name)})}),null===(o=null===(i=this.siteForm)||void 0===i?void 0:i.controls)||void 0===o||o.city.setValue(u),null===(s=null===(r=this.siteForm)||void 0===r?void 0:r.controls)||void 0===s||s.state.setValue(d),null===(a=null===(l=this.siteForm)||void 0===l?void 0:l.controls)||void 0===a||a.country.setValue(c))})}searchAddress(){this.mapsAPILoader.load().then(()=>{var t;const e=new google.maps.places.Autocomplete(null===(t=this.searchElementRef)||void 0===t?void 0:t.nativeElement);e.addListener("place_changed",()=>{const t=et.a.mapAddress(e);["streetAddress","streetAddress2","city","state","country","zipCode","lat","lng"].forEach(e=>{var n,i;null===(i=null===(n=this.siteForm)||void 0===n?void 0:n.controls[e])||void 0===i||i.patchValue(t[e],{emitEvent:!1})})})})}onSubTenantChange(t){var e,n,i;t&&null!=t?(this.showTenantToggleError=!1,this.subTenantId=t,this.tenantConfig=this.tenantConfigMap.get(this.subTenantId),this.countryCode=null===(e=this.tenantConfig)||void 0===e?void 0:e.countryCode,this.lobEnabled=null===(i=null===(n=this.tenantConfig)||void 0===n?void 0:n.directMailConfig)||void 0===i?void 0:i.directMailEnabled,this.initializeForm()):this.showTenantToggleError=!0}submit(){var t;for(const o in this.siteForm.controls)this.siteForm.controls[o].markAsDirty(),this.siteForm.controls[o].updateValueAndValidity(),this.siteForm.controls[o]instanceof K.f&&this.siteForm.controls[o].value.forEach(t=>{for(const e in t.controls)t.controls[e].markAsDirty(),t.controls[e].updateValueAndValidity()});const e=((t,e,n,i,o)=>{var r,s,l,a,c,d,u,b;return{id:this.siteId,name:null===(s=null===(r=null==t?void 0:t.controls)||void 0===r?void 0:r.name)||void 0===s?void 0:s.value,npiId:null===(a=null===(l=null==t?void 0:t.controls)||void 0===l?void 0:l.siteId)||void 0===a?void 0:a.value,departmentId:null===(d=null===(c=null==t?void 0:t.controls)||void 0===c?void 0:c.departmentId)||void 0===d?void 0:d.value,description:null===(b=null===(u=null==t?void 0:t.controls)||void 0===u?void 0:u.description)||void 0===b?void 0:b.value,siteAddress:at(t),billingAddress:at(t),siteContact:ct(t,n),primarySite:i,tenantId:o,letterPhoneNumbers:lt(t)}})(this.siteForm,0,this.countryCode,this.primarySite,null===(t=this.tenantConfig)||void 0===t?void 0:t.tenantId);if(!this.subTenantId)return void(this.showTenantToggleError=!0);if("VALID"!==this.siteForm.status)return;e.tenantId=this.subTenantId;const n=this._siteService.saveSite(e),i=this._siteService.updateSite(e);Object(dt.a)(()=>!!e.id,i,n).subscribe(t=>{this._notificationsService.success(this.translatedStrings.get("SITES"),this.translatedStrings.get("edit"==this.mode?"SITE.UPDATED_SUCCESSFULLY":"SITE.CREATED_SUCCESSFULLY")),this._siteService.getAllSites(0,999,null,!1).subscribe(t=>{this._storeService.setSites(null==t?void 0:t.result)}),this._router.navigate(["/sites"])})}makeDefault(){var t,e;null!=(null===(e=null===(t=this.siteForm.controls.name)||void 0===t?void 0:t.value)||void 0===e?void 0:e.trim())?this._modalService.create({nzTitle:this.translatedStrings.get("SITE.CHANGING_DEFAULT_SITE_TO_NEW_SITE").replace("{NEW_DEFAULT_SITE}",this.siteForm.controls.name.value),nzContent:_,nzComponentParams:{siteName:this.siteForm.controls.name.value},nzWidth:"662px",nzBodyStyle:{padding:"0px 36px 18px 36px",height:"100px"},nzFooter:null}).afterClose.subscribe(t=>{t&&(this.primarySite=t)}):this.siteForm.controls.name.setErrors({required:!0})}onSameAsDefaultSiteCheck(){var t,e,n,i,o,r,s,l;this.sameAsDefaultSite?null===(n=null===(e=null===(t=this.siteForm)||void 0===t?void 0:t.controls)||void 0===e?void 0:e.siteId)||void 0===n||n.setValue(this.getSiteIdFromExternalSource(null===(o=null===(i=this.defaultSite)||void 0===i?void 0:i.site)||void 0===o?void 0:o.externalSources)):null===(l=null===(s=null===(r=this.siteForm)||void 0===r?void 0:r.controls)||void 0===s?void 0:s.siteId)||void 0===l||l.setValue(null)}getSiteIdFromExternalSource(t){var e;return null===(e=null==t?void 0:t.find(t=>(null==t?void 0:t.source)===tt.ORG_NPI_ID))||void 0===e?void 0:e.sourceId}}return t.\u0275fac=function(e){return new(e||t)(c.Rb(o.g),c.Rb(K.h),c.Rb(I.a),c.Rb(ut.a),c.Rb(pt.b),c.Rb(d.f),c.Rb(o.a),c.Rb(D.a),c.Rb(S.a),c.Rb(z.b),c.Rb(rt.a),c.Rb(bt.a))},t.\u0275cmp=c.Lb({type:t,selectors:[["site-form"]],viewQuery:function(t,e){if(1&t&&c.ed(_t,1),2&t){let t;c.Hc(t=c.fc())&&(e.searchElementRef=t.first)}},features:[c.Ab],decls:5,vars:8,consts:[[3,"defaultTitle","isSearchEnabled","isActionEnabled"],["nz-button","","nzType","primary","form","sitesForm",3,"disabled"],["class","container",4,"ngIf"],[1,"container"],["nz-row","",3,"nzGutter",4,"isAccessAcrossTenantEnabled"],[4,"ngIf"],["nz-row","",3,"nzGutter"],["nz-col","","nzSpan","6","nzOffset","18"],["mode","SINGLE",3,"disabled","selectedSubTenant","showError","onSubTenantSelected"],["nz-col","","nzSpan","8"],["nz-typography",""],["nz-col","","nzOffset","8","nzSpan","8"],["id","default-button","nz-button","","nzGhost","",3,"click"],["name","environment","size","16px","nz-tooltip","","nzTooltipPlacement","right"],[4,"ngIf","ngIfElse"],["setAsDefault",""],["id","sitesForm","nz-form","","appScrollToFirstInvalid","",3,"formGroup","ngSubmit","keydown.enter"],["nz-col","","nzSpan","6"],["nz-row","","nzGutter","16"],[3,"nzErrorTip"],["formControlName","name","nz-input","","readonly","","onfocus","this.removeAttribute('readonly')"],["nameErrors",""],["formControlName","description","nz-input","","readonly","","onfocus","this.removeAttribute('readonly')"],[3,"nzAddOnBefore"],["formControlName","mobile","nz-input","","readonly","","onfocus","this.removeAttribute('readonly')"],["mobileErrors",""],[2,"margin-bottom","10px"],["formControlName","siteId","nz-input","","readonly","","onfocus","this.removeAttribute('readonly')"],["siteIdErrors",""],["nz-checkbox","",2,"margin","0px",3,"ngModel","ngModelOptions","ngModelChange"],["formControlName","departmentId","nz-input","","readonly","","onfocus","this.removeAttribute('readonly')"],["departmentErrors",""],["nz-col","","nzSpan","12"],["formControlName","streetAddress","nz-input","","readonly","","onfocus","this.removeAttribute('readonly')"],["searchAddress",""],["formControlName","streetAddress2","nz-input","","readonly","","onfocus","this.removeAttribute('readonly')"],[1,"divider"],["formControlName","zipCode","nz-input","","readonly","","onfocus","this.removeAttribute('readonly')"],["formControlName","country","nz-input","","readonly",""],["formControlName","state","nz-input","","readonly",""],["formControlName","city","nz-input","","readonly",""],["nz-col","","nzSpan","24"],["nzTip","Please wait ...",2,"min-height","100px",3,"nzSpinning"],["nz-col","","nzXs","24","nzSm","24","nzMd","12","nzLg","12","nzXl","6","formArrayName","letterPhoneNumbers",4,"ngFor","ngForOf"],["nz-col","","nzXs","24","nzSm","24","nzMd","12","nzLg","12","nzXl","6","formArrayName","letterPhoneNumbers"],[3,"formGroupName"],["nz-tooltip","",1,"phone-label",3,"nzTooltipTitle"],["nz-input","","formControlName","phoneNumber","readonly","","onfocus","this.removeAttribute('readonly')",3,"ngClass"],[1,"required-text"]],template:function(t,e){1&t&&(c.Xb(0,"app-header",0),c.Xb(1,"button",1),c.Xc(2),c.jc(3,"translate"),c.Wb(),c.Wb(),c.Vc(4,qt,3,1,"div",2)),2&t&&(c.rc("defaultTitle",e.title)("isSearchEnabled",!1)("isActionEnabled",!1),c.Db(1),c.rc("disabled","PENDING"===(null==e.siteForm?null:e.siteForm.status)),c.Db(1),c.Zc(" ",c.kc(3,6,"COMMON.SAVE")," "),c.Db(2),c.rc("ngIf",!!e.tenantConfig))},directives:[ht.a,b.a,v.a,p.a,u.q,N.a,C.c,C.a,mt.a,M.a,O.a,W.d,K.F,K.v,ft.b,gt.a,K.m,ft.c,ft.a,K.d,St.b,K.u,K.k,St.c,Et.a,K.x,Tt.a,It.a,u.p,K.g,K.n,u.o],pipes:[h.a],styles:[".container[_ngcontent-%COMP%]{padding:40px 160px 100px 60px!important}#default-button[_ngcontent-%COMP%]{float:right;border:1px solid #2f4f4f;color:var(--tertiary-color);height:30px;padding-left:5px}#default-button[_ngcontent-%COMP%]   app-icons[_ngcontent-%COMP%]{vertical-align:middle}.disabled-button[_ngcontent-%COMP%]{pointer-events:none}label[_ngcontent-%COMP%]{font:normal normal normal 12px/16px Nunito;color:var(--tertiary-color);margin-left:5px;margin-bottom:5px;display:block}[_nghost-%COMP%]     .ant-input-group-addon{color:#8a8a8a!important;font-size:10px!important}nz-divider[_ngcontent-%COMP%]{margin:36px 0}[_nghost-%COMP%]     .ant-form-item-explain-error{text-align:right}.disabled[_ngcontent-%COMP%]{pointer-events:none;opacity:.7}.phone-label[_ngcontent-%COMP%]{line-height:1.6em;max-height:3.2em;overflow:hidden;text-overflow:ellipsis}.required-text[_ngcontent-%COMP%]{color:var(--error-color);text-align:end}.error-input[_ngcontent-%COMP%]{border-color:var(--error-color)}"]}),t})();var $t=n("0W7X");const Qt={Listing:{header:!0,title:"SITES",searchEnabled:!0,primaryAction:{title:"Add Site",permissions:[$t.a.ADD_SITE],enabled:!0},secondaryAction:{},multiAction:{},privileges:[$t.a.VIEW_SITE],showTenantToggle:!0},Form:{header:!1,showTenantToggle:!1}},Kt=[{path:"",component:Q,pathMatch:"full",data:Qt.Listing,canActivate:[r.a,i.a]},{path:":mode",component:Bt,data:Qt.Form,canActivate:[r.a,i.a]},{path:":mode/:id",component:Bt,data:Qt.Form,canActivate:[r.a,i.a]}];let Jt=(()=>{class t{}return t.\u0275mod=c.Pb({type:t}),t.\u0275inj=c.Ob({factory:function(e){return new(e||t)},imports:[[o.k.forChild(Kt)],o.k]}),t})();var te=n("rbUg"),ee=n("SHZf"),ne=n("UFn0"),ie=n("KZX/");let oe=(()=>{class t{constructor(t){this.translationService=t,t.setLanguage()}}return t.\u0275mod=c.Pb({type:t}),t.\u0275inj=c.Ob({factory:function(e){return new(e||t)(c.bc(S.a))},providers:[l.a],imports:[[Jt,u.c,te.a,K.o,K.B,ee.a.forRoot(),pt.a.forRoot({apiKey:"AIzaSyCkujBUnFmDto5Ui2EKj4AcpWXMrizEDRc",libraries:["places"]}),ne.a,ie.a]]}),t})()},h51P:function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n("tk/3"),o=n("fXoL");let r=(()=>{class t{constructor(t){this._http=t}fetchLocationFromZipCode(t){const e=new i.g({bypass:"yes"});return this._http.get(`https://maps.googleapis.com/maps/api/geocode/json?address=${t}&key=AIzaSyCySGsZgXtvenjp06bwyxsL4vtqIsAa4E4`,{headers:e})}}return t.\u0275fac=function(e){return new(e||t)(o.bc(i.c))},t.\u0275prov=o.Nb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()}}]);