!function(){function t(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,n){if(!t)return;if("string"==typeof t)return e(t,n);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return e(t,n)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function o(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=a(t);if(e){var o=a(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return r(this,n)}}function r(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function s(t,e,n){return e&&c(t.prototype,e),n&&c(t,n),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{"2sp+":function(t,e,n){"use strict";n.d(e,"a",function(){return i});var i=function(){function t(){l(this,t)}return s(t,null,[{key:"mapAddress",value:function(t){var e,n,i,o,r,a,l,c,s,u,d,b,v,f,p,m,h,g=null===(e=null==t?void 0:t.getPlace())||void 0===e?void 0:e.name;null===(i=null===(n=null==t?void 0:t.getPlace())||void 0===n?void 0:n.address_components)||void 0===i||i.forEach(function(t){var e,n,i,o,r,a,l,c;-1!==(null===(e=null==t?void 0:t.types)||void 0===e?void 0:e.findIndex(function(t){return"country"===t}))&&(u=t.long_name),-1!==(null===(n=null==t?void 0:t.types)||void 0===n?void 0:n.findIndex(function(t){return"administrative_area_level_1"===t}))&&(d=t.long_name),-1!==(null===(i=null==t?void 0:t.types)||void 0===i?void 0:i.findIndex(function(t){return"locality"===t}))&&(b=t.long_name),-1!==(null===(o=null==t?void 0:t.types)||void 0===o?void 0:o.findIndex(function(t){return"postal_code"===t}))&&(v=t.long_name),-1!==(null===(r=null==t?void 0:t.types)||void 0===r?void 0:r.findIndex(function(t){return"neighborhood"===t}))&&(f=t.long_name),-1!==(null===(a=null==t?void 0:t.types)||void 0===a?void 0:a.findIndex(function(t){return"sublocality_level_3"===t}))&&(p=t.long_name),-1!==(null===(l=null==t?void 0:t.types)||void 0===l?void 0:l.findIndex(function(t){return"sublocality_level_2"===t}))&&(m=t.long_name),-1!==(null===(c=null==t?void 0:t.types)||void 0===c?void 0:c.findIndex(function(t){return"sublocality_level_1"===t}))&&(h=t.long_name)});var S=this.concatFields(g,p||f),E=this.concatFields(m,h),T=null===(a=null===(r=null===(o=null==t?void 0:t.getPlace())||void 0===o?void 0:o.geometry)||void 0===r?void 0:r.location)||void 0===a?void 0:a.lat(),I=null===(s=null===(c=null===(l=null==t?void 0:t.getPlace())||void 0===l?void 0:l.geometry)||void 0===c?void 0:c.location)||void 0===s?void 0:s.lng();return{streetAddress:S,streetAddress2:E,zipCode:v,country:u,state:d,city:b,lat:T,lng:I}}},{key:"concatFields",value:function(){for(var t,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return null==n||n.forEach(function(e){t||!e?e&&(t="".concat(t,", ").concat(e)):t=e}),t}},{key:"convertToAddress",value:function(t){var e=t.streetAddress,n=t.streetAddress2,i=t.zipCode,o=t.country,r=t.state;return{line1:e,line2:n,city:t.city,state:r,pin:i,zipCode:i,country:o,location:null,lat:t.lat,lng:t.lng,poBox:null}}}]),t}()},"5iDH":function(t,e,n){"use strict";n.d(e,"a",function(){return o});var i=n("fXoL"),o=function(){var t=function(){function t(e){l(this,t),this.el=e}return s(t,[{key:"onSubmit",value:function(e){if(e.preventDefault(),!this.formGroup.valid){t.markFormGroupTouched(this.formGroup);var n=this.el.nativeElement.querySelector(".ng-invalid");if(n)return t.scrollToElement(n);var i=this.el.nativeElement.querySelectorAll("form .ng-invalid");return i&&i.length?t.scrollToElement(i[0]):t.scrollToElement(this.el.nativeElement)}}}],[{key:"scrollToElement",value:function(t){if(t){var e=window.pageYOffset-Math.abs(t.getBoundingClientRect().y);window.scroll({behavior:"smooth",left:0,top:t.getBoundingClientRect().top+window.scrollY-150}),setTimeout(function(){t.focus(),t.blur(),t.focus()},e)}}},{key:"markFormGroupTouched",value:function(e){Object.values(e.controls).forEach(function(e){e.markAsTouched(),e.controls&&t.markFormGroupTouched(e)})}}]),t}();return t.\u0275fac=function(e){return new(e||t)(i.Rb(i.l))},t.\u0275dir=i.Mb({type:t,selectors:[["","appScrollToFirstInvalid",""]],hostBindings:function(t,e){1&t&&i.ec("submit",function(t){return e.onSubmit(t)})},inputs:{formGroup:"formGroup"}}),t}()},QKQc:function(e,i,r){"use strict";r.r(i),r.d(i,"SiteModule",function(){return pe});var a=r("bA1+"),c=r("tyNb"),u=r("T5gh"),d=r("AytR"),b=r("Dwgb"),v=r("qQcL"),f=r("fXoL"),p=r("dEAy"),m=r("ofXK"),h=r("OzZK"),g=r("RwU8"),S=r("C2AL"),E=r("dRHE");function T(t,e){if(1&t){var n=f.Yb();f.Vb(0),f.Xb(1,"p"),f.Xc(2),f.jc(3,"translate"),f.Wb(),f.Xb(4,"button",2),f.ec("click",function(){return f.Lc(n),f.ic().reassignToDelete()}),f.Xc(5),f.jc(6,"translate"),f.Wb(),f.Ub()}2&t&&(f.Db(2),f.Zc(" ",f.kc(3,2,"SITE.ASSIGN_PATIENTS_TO_OTHER_SITE"),""),f.Db(3),f.Yc(f.kc(6,4,"COMMON.BTN_OK")))}function I(t,e){if(1&t){var n=f.Yb();f.Xb(0,"p"),f.Xc(1),f.jc(2,"translate"),f.Wb(),f.Xb(3,"button",2),f.ec("click",function(){return f.Lc(n),f.ic().confirmDelete()}),f.Xc(4),f.jc(5,"translate"),f.Wb()}2&t&&(f.Db(1),f.Zc("",f.kc(2,2,"SITE.PROCEED_TO_DELETE"),"?"),f.Db(3),f.Yc(f.kc(5,4,"COMMON.BTN_CONFIRM")))}var _,y,D=((_=function(t){n(i,t);var e=o(i);function i(t){var n;return l(this,i),(n=e.call(this))._modalRef=t,n.NO_USERS="No Users",n}return s(i,[{key:"ngOnInit",value:function(){var t,e,n;this.detailsOfUsers=this.countOfUsers&&(this.countOfUsers.patientsCount||this.countOfUsers.monitoringStaffCount||this.countOfUsers.physicianCount)?"".concat(null===(t=this.countOfUsers)||void 0===t?void 0:t.physicianCount," physicians, ").concat(null===(e=this.countOfUsers)||void 0===e?void 0:e.monitoringStaffCount," monitoring staff and ").concat(null===(n=this.countOfUsers)||void 0===n?void 0:n.patientsCount," patients"):this.NO_USERS}},{key:"reassignToDelete",value:function(){this._modalRef.close(!1)}},{key:"confirmDelete",value:function(){this._modalRef.close(!0)}}]),i}(v.a)).\u0275fac=function(t){return new(t||_)(f.Rb(p.e))},_.\u0275cmp=f.Lb({type:_,selectors:[["app-delete-site"]],inputs:{countOfUsers:"countOfUsers"},features:[f.Ab],decls:9,vars:9,consts:[[4,"ngIf","ngIfElse"],["proceedToDelete",""],["nz-button","","nzType","primary",3,"click"]],template:function(t,e){if(1&t&&(f.Xc(0),f.jc(1,"translate"),f.Xb(2,"b"),f.Xc(3),f.Wb(),f.Xc(4),f.jc(5,"translate"),f.Vc(6,T,7,6,"ng-container",0),f.Vc(7,I,6,6,"ng-template",null,1,f.Wc)),2&t){var n=f.Ic(8);f.Zc("",f.kc(1,5,"SITE.THERE_ARE"),"\n"),f.Db(3),f.Yc(e.detailsOfUsers),f.Db(1),f.Zc("\n",f.kc(5,7,"SITE.ASSIGNED_TO_THIS_SITE"),"\n"),f.Db(2),f.rc("ngIf",e.detailsOfUsers!==e.NO_USERS)("ngIfElse",n)}},directives:[m.q,h.a,g.a,S.a],pipes:[E.a],styles:["button[_ngcontent-%COMP%]{float:right;margin-top:7px;width:110px;height:30px}p[_ngcontent-%COMP%]{margin-top:10px}"]}),_),z=r("WoUL"),A=r("pLZG"),C=r("1G5W"),X=r("BoNt"),O=((y=function(e){n(r,e);var i=o(r);function r(t,e){var n;return l(this,r),(n=i.call(this))._translationService=t,n._modalRef=e,n.strings=["SITE.CHANGING_DEFAULT_SITE_TO_NEW_SITE_MESSAGE"],n}return s(r,[{key:"ngOnInit",value:function(){var e,n=this;(e=this._translationService).getMultiple.apply(e,t(this.strings)).pipe(Object(C.a)(this.unsubscribed)).subscribe(function(t){n.translatedStrings=t,n.message=n.translatedStrings.get("SITE.CHANGING_DEFAULT_SITE_TO_NEW_SITE_MESSAGE").replace("{SITE_NAME}",n.siteName)})}},{key:"onOkayClick",value:function(){this._modalRef.close(!0)}}]),r}(v.a)).\u0275fac=function(t){return new(t||y)(f.Rb(z.a),f.Rb(p.e))},y.\u0275cmp=f.Lb({type:y,selectors:[["app-change-default-site"]],inputs:{siteName:"siteName"},features:[f.Ab],decls:5,vars:4,consts:[["nz-button","","nzType","primary",3,"click"]],template:function(t,e){1&t&&(f.Xb(0,"p"),f.Xc(1),f.Wb(),f.Xb(2,"button",0),f.ec("click",function(){return e.onOkayClick()}),f.Xc(3),f.jc(4,"translate"),f.Wb()),2&t&&(f.Db(1),f.Yc(e.message),f.Db(2),f.Yc(f.kc(4,2,"COMMON.BTN_CONFIRM")))},directives:[h.a,g.a,S.a],pipes:[E.a],styles:["button[_ngcontent-%COMP%]{float:right;width:110px;height:30px}"]}),y),N=r("igu/"),W=r("bNXi"),k=r("PzCk"),M=r("B+r4"),x=r("rMZv"),F=r("Szod"),P=r("ZKr6"),R=r("glKu"),L=r("nJia"),w=r("eHCX"),U=r("t2pg");function V(t,e){1&t&&(f.Xb(0,"th"),f.Xc(1," Sub Tenant "),f.Wb())}function j(t,e){if(1&t&&(f.Xb(0,"td"),f.Xc(1),f.jc(2,"tenantName"),f.Wb()),2&t){var n=f.ic().$implicit;f.Db(1),f.Zc(" ",f.kc(2,1,n.tenantId)," ")}}function G(t,e){if(1&t){var n=f.Yb();f.Xb(0,"app-icons",14),f.ec("click",function(){f.Lc(n);var t=f.ic().$implicit;return f.ic(2).editSite(t.id)}),f.Wb()}}function Y(t,e){if(1&t){var n=f.Yb();f.Xb(0,"app-icons",15),f.ec("click",function(){f.Lc(n);var t=f.ic().$implicit;return f.ic(2).makeDefault(t)}),f.jc(1,"translate"),f.Wb()}if(2&t){var i=f.ic().$implicit;f.sc("nzTooltipTitle",f.kc(1,2,null!=i&&i.primarySite?"SITE.THIS_IS_YOUR_DEFAULT_SITE":"SITE.SET_AS_DEFAULT_SITE")),f.rc("color",null!=i&&i.primarySite?"#A7C853":"#8A8A8A")}}function Z(t,e){if(1&t){var n=f.Yb();f.Xb(0,"app-icons",16),f.ec("click",function(){f.Lc(n);var t=f.ic().$implicit,e=f.ic(2),i=f.Ic(2);return e.deleteSite(t.id,i)}),f.Wb()}if(2&t){var i=f.ic().$implicit;f.Jb("disabled",null==i?null:i.primarySite)}}var H=function(){return["EDIT_SITE"]},q=function(){return["MARK_AS_DEFAULT_SITE"]},B=function(){return["DELETE_SITE"]};function Q(t,e){if(1&t&&(f.Xb(0,"tr"),f.Xb(1,"td"),f.Xc(2),f.Wb(),f.Vc(3,j,3,3,"td",7),f.Xb(4,"td",10),f.Vc(5,G,1,0,"app-icons",11),f.Vc(6,Y,2,4,"app-icons",12),f.Vc(7,Z,1,2,"app-icons",13),f.Wb(),f.Wb()),2&t){var n=e.$implicit;f.Db(2),f.Yc(n.name),f.Db(3),f.rc("isFeaturePermitted",f.xc(4,H)),f.Db(1),f.rc("isFeaturePermitted",f.xc(5,q)),f.Db(1),f.rc("isFeaturePermitted",f.xc(6,B))}}function $(t,e){if(1&t&&(f.Vb(0),f.Xc(1),f.Ub()),2&t){var n=f.ic(3);f.Db(1),f.Yc(n.pageIndex*n.pageSize)}}function K(t,e){if(1&t&&(f.Vb(0),f.Xc(1),f.Ub()),2&t){var n=f.ic(3);f.Db(1),f.Yc(n.totalCount)}}function J(t,e){if(1&t&&(f.Xb(0,"h5",17),f.Xc(1),f.jc(2,"translate"),f.jc(3,"translate"),f.Vc(4,$,2,1,"ng-container",18),f.Vc(5,K,2,1,"ng-container",18),f.Xc(6),f.Wb()),2&t){var n=f.ic(2);f.Db(1),f.bd(" ",f.kc(2,6,"COMMON.SHOWING")," ",(n.pageIndex-1)*n.pageSize+1," ",f.kc(3,8,"TABLEHEADER.TO")," "),f.Db(3),f.rc("ngIf",n.pageIndex*n.pageSize<n.totalCount),f.Db(1),f.rc("ngIf",n.pageIndex*n.pageSize>=n.totalCount),f.Db(1),f.Zc(" of ",n.totalCount," ")}}var tt=function(){return{x:"1250px"}};function et(t,e){if(1&t){var n=f.Yb();f.Xb(0,"div",2),f.Xb(1,"div",3),f.Xb(2,"div",4),f.Xb(3,"nz-table",5,6),f.ec("nzPageIndexChange",function(t){return f.Lc(n),f.ic().getSitesOnPage(t)}),f.jc(5,"translate"),f.Xb(6,"thead"),f.Xb(7,"tr"),f.Xb(8,"th"),f.Xc(9),f.jc(10,"translate"),f.Wb(),f.Vc(11,V,2,0,"th",7),f.Xb(12,"th"),f.Xc(13),f.jc(14,"translate"),f.Wb(),f.Wb(),f.Wb(),f.Xb(15,"tbody"),f.Vc(16,Q,8,7,"tr",8),f.Wb(),f.Wb(),f.Vc(17,J,7,10,"ng-template",null,9,f.Wc),f.Wb(),f.Wb(),f.Wb()}if(2&t){var i=f.Ic(4),o=f.Ic(18),r=f.ic();f.Db(3),f.sc("nzNoResult",f.kc(5,13,"SITE.NO_SITES_FOUND")),f.rc("nzLoading",r.loading)("nzData",r.sites)("nzShowPagination",!0)("nzPageIndex",r.pageIndex)("nzFrontPagination",!1)("nzTotal",r.totalCount)("nzShowTotal",o)("nzWidthConfig",r.widthConfig)("nzScroll",f.xc(19,tt)),f.Db(6),f.Yc(f.kc(10,15,"SITES")),f.Db(4),f.Yc(f.kc(14,17,"TABLEHEADER.ACTIONS")),f.Db(3),f.rc("ngForOf",i.data)}}function nt(t,e){1&t&&(f.Xb(0,"h4",19),f.Xc(1),f.jc(2,"translate"),f.Wb()),2&t&&(f.Db(1),f.Yc(f.kc(2,1,"SITE.DELETE_SITE")))}var it,ot=function(){return["VIEW_SITE","ADD_SITE","EDIT_SITE","DELETE_SITE","MARK_AS_DEFAULT_SITE"]},rt=((it=function(e){n(r,e);var i=o(r);function r(t,e,n,o,a,c){var s;return l(this,r),(s=i.call(this))._siteService=t,s._router=e,s.modalService=n,s._dataSharingService=o,s._translationService=a,s._notificationService=c,s.totalCount=0,s.pageSize=d.g.pageSize,s.displayedColumns=["name","actions"],s.sites=[],s.pageIndex=1,s.loading=!0,s.strings=["SITE.DELETE_SITE","SITE.CHANGING_DEFAULT_SITE_TO_NEW_SITE"],s.widthConfig=["80%","20%"],s._routeHelperService.getSearch().pipe(Object(A.a)(function(t){return null!==t}),Object(C.a)(s.unsubscribed)).subscribe(function(t){return s.applyFilter(t)}),s._routeHelperService.isPrimaryActionTriggered().pipe(Object(A.a)(function(t){return!!t}),Object(C.a)(s.unsubscribed)).subscribe(function(){return s.gotoAddSite()}),s.widthConfig=s.isAccessAcrossSubTenants?["40%","40%","20%"]:["80%","20%"],s}return s(r,[{key:"ngOnInit",value:function(){var e,n=this;this._dataSharingService.onSubTenantChange().subscribe(function(t){return n.onSubTenantChange(t)}),(e=this._translationService).getMultiple.apply(e,t(this.strings)).pipe(Object(C.a)(this.unsubscribed)).subscribe(function(t){n.translatedStrings=t}),this.getSitesOnPage(1)}},{key:"onSubTenantChange",value:function(t){"object"!=typeof t||""==t||null==t||null==t||(this.requestTenantIds=t.join()),this.getSitesOnPage(1)}},{key:"getSitesOnPage",value:function(t){var e=this;this.pageIndex=t,this.loading=!0,this._siteService.getAllSites(this.pageIndex-1,this.pageSize,null,!1,this.requestTenantIds).subscribe(function(t){e.totalCount=null==t?void 0:t.totalCount,e.sites=null==t?void 0:t.result,e.loading=!1},function(t){var n;e.loading=!1,e._notificationService.error("Error",null===(n=null==t?void 0:t.error)||void 0===n?void 0:n.message)})}},{key:"applyFilter",value:function(t){var e=this;this.loading=!0,this._siteService.getAllSites(0,this.pageSize,t,!1,this.requestTenantIds).subscribe(function(t){var n;e.loading=!1,e.sites=null==t?void 0:t.result,(null===(n=e.sites)||void 0===n?void 0:n.length)>0&&(e.totalCount=t.totalCount)},function(t){e.loading=!1},function(){e.loading=!1})}},{key:"gotoAddSite",value:function(){this._router.navigate(["sites/add"])}},{key:"editSite",value:function(t){this._router.navigate(["sites/edit",t])}},{key:"makeDefault",value:function(t){var e=this;!0!==(null==t?void 0:t.primarySite)&&this.modalService.create({nzTitle:this.translatedStrings.get("SITE.CHANGING_DEFAULT_SITE_TO_NEW_SITE").replace("{NEW_DEFAULT_SITE}",t.name),nzContent:O,nzComponentParams:{siteName:t.name},nzWidth:"662px",nzBodyStyle:{padding:"0px 36px 18px 36px",height:"100px"},nzStyle:{top:"200px"},nzFooter:null}).afterClose.subscribe(function(n){n&&e._siteService.makeDefault(t.id).subscribe(function(t){e._notificationService.success("Default Site","Default site updated"),window.location.reload()},function(t){e._notificationService.error("Error","Default site updation failed")})})}},{key:"deleteSite",value:function(t,e){var n=this;this._siteService.getSiteById(t).subscribe(function(i){var o;(null===(o=null==i?void 0:i.site)||void 0===o?void 0:o.primarySite)||n.modalService.create({nzTitle:e,nzContent:D,nzComponentParams:{countOfUsers:i.count},nzWidth:"662px",nzBodyStyle:{height:"120px",padding:"0 35px 18px"},nzStyle:{top:"200px"},nzFooter:null}).afterClose.subscribe(function(e){e&&n._siteService.deleteSite(t).subscribe(function(t){n._notificationService.success("Delete Site","Site Deleted"),n.getSitesOnPage(n.pageIndex)},function(t){n._notificationService.error("Error","Site deletion failed")})})})}}]),r}(v.a)).\u0275fac=function(t){return new(t||it)(f.Rb(X.a),f.Rb(c.g),f.Rb(p.f),f.Rb(N.a),f.Rb(z.a),f.Rb(W.b))},it.\u0275cmp=f.Lb({type:it,selectors:[["sites"]],features:[f.Cb([b.a]),f.Ab],decls:3,vars:2,consts:[["class","container",4,"anyFeaturePermitted"],["deleteSiteTitle",""],[1,"container"],["nz-row","","nzGutter","64"],["nz-col","","nzSpan","24"],[3,"nzLoading","nzData","nzShowPagination","nzNoResult","nzPageIndex","nzFrontPagination","nzTotal","nzShowTotal","nzWidthConfig","nzScroll","nzPageIndexChange"],["sitesTable",""],[4,"isAccessAcrossTenantEnabled"],[4,"ngFor","ngForOf"],["totalSitesCount",""],[1,"actions"],["name","edit","size","22px",3,"click",4,"isFeaturePermitted"],["name","environment","size","22px","nz-tooltip","","nzTooltipPlacement","right",3,"color","nzTooltipTitle","click",4,"isFeaturePermitted"],["name","delete","size","22px",3,"disabled","click",4,"isFeaturePermitted"],["name","edit","size","22px",3,"click"],["name","environment","size","22px","nz-tooltip","","nzTooltipPlacement","right",3,"color","nzTooltipTitle","click"],["name","delete","size","22px",3,"click"],["nz-typography",""],[4,"ngIf"],[2,"margin-top","20px","margin-bottom","0px"]],template:function(t,e){1&t&&(f.Vc(0,et,19,20,"div",0),f.Vc(1,nt,3,3,"ng-template",null,1,f.Wc)),2&t&&f.rc("anyFeaturePermitted",f.xc(1,ot))},directives:[k.a,M.c,M.a,x.f,x.n,x.o,x.e,x.l,F.a,x.i,m.p,P.a,R.a,L.d,w.a,m.q],pipes:[E.a,U.a],styles:["app-icons[_ngcontent-%COMP%] + app-icons[_ngcontent-%COMP%]{margin-left:10px}td[_ngcontent-%COMP%]:first-child{font-weight:700;font-size:13.5px}.actions[_ngcontent-%COMP%]{word-spacing:5px}.disabled[_ngcontent-%COMP%]{pointer-events:none;opacity:.7}"]}),it),at=r("3Pt+"),lt=function t(){l(this,t),this.name=new at.i(null,at.D.required),this.description=new at.i,this.mobile=new at.i(null,[at.D.required,at.D.minLength(6),at.D.maxLength(15),at.D.pattern(/^(?:(?:\(?(?:00|\+)([1-4]\d\d|[1-9]\d*)\)?)[\-\.\ \\\/]?)?((?:\(?\d{1,}\)?[\-\.\ \\\/]?)+)(?:[\-\.\ \\\/]?(?:#|ext\.?|extension|x)[\-\.\ \\\/]?(\d+))?$/)]),this.siteId=new at.i,this.departmentId=new at.i(null,[at.D.required]),this.primarySite=new at.i,this.streetAddress=new at.i(null,at.D.required),this.streetAddress2=new at.i,this.city=new at.i(null,at.D.required),this.state=new at.i(null,at.D.required),this.country=new at.i(null,at.D.required),this.zipCode=new at.i(null,at.D.required),this.lat=new at.i,this.lng=new at.i,this.letterPhoneNumbers=new at.f([],at.D.required)},ct=function(t){return t.ORG_NPI_ID="ORG_NPI_ID",t.DEPARTMENT_ID="DEPARTMENT_ID",t}({}),st=r("2sp+"),ut=r("Kj3r"),dt=r("/uUt"),bt=r("eIep"),vt=r("h51P"),ft=function t(e,n){l(this,t),this.templateType=e,this.phoneNumber=n},pt=function(t){var e,n;return null===(n=null===(e=t.get("letterPhoneNumbers"))||void 0===e?void 0:e.controls)||void 0===n?void 0:n.map(function(t){var e,n,i,o;return new ft(null===(n=null===(e=null==t?void 0:t.controls)||void 0===e?void 0:e.templateType)||void 0===n?void 0:n.value,null===(o=null===(i=null==t?void 0:t.controls)||void 0===i?void 0:i.phoneNumber)||void 0===o?void 0:o.value)})},mt=function(t){var e,n,i,o,r,a,l,c,s,u,d,b,v,f,p,m,h,g;return{line1:null===(n=null===(e=null==t?void 0:t.controls)||void 0===e?void 0:e.streetAddress)||void 0===n?void 0:n.value,line2:null===(o=null===(i=null==t?void 0:t.controls)||void 0===i?void 0:i.streetAddress2)||void 0===o?void 0:o.value,city:null===(a=null===(r=null==t?void 0:t.controls)||void 0===r?void 0:r.city)||void 0===a?void 0:a.value,state:null===(c=null===(l=null==t?void 0:t.controls)||void 0===l?void 0:l.state)||void 0===c?void 0:c.value,country:null===(u=null===(s=null==t?void 0:t.controls)||void 0===s?void 0:s.country)||void 0===u?void 0:u.value,pin:null===(b=null===(d=null==t?void 0:t.controls)||void 0===d?void 0:d.zipCode)||void 0===b?void 0:b.value,zipCode:null===(f=null===(v=null==t?void 0:t.controls)||void 0===v?void 0:v.zipCode)||void 0===f?void 0:f.value,lat:null===(m=null===(p=null==t?void 0:t.controls)||void 0===p?void 0:p.lat)||void 0===m?void 0:m.value,lng:null===(g=null===(h=null==t?void 0:t.controls)||void 0===h?void 0:h.lng)||void 0===g?void 0:g.value}},ht=function(t,e){var n,i;return{contactNumber:null===(i=null===(n=null==t?void 0:t.controls)||void 0===n?void 0:n.mobile)||void 0===i?void 0:i.value,countryCode:e}},gt=r("r0o6"),St=r("bp6e"),Et=r("q5r7"),Tt=r("4RGM"),It=r("pxUr"),_t=r("S5rh"),yt=r("MZxW"),Dt=r("ocnv"),zt=r("5iDH"),At=r("PTRe"),Ct=r("TaO5"),Xt=r("5vDB"),Ot=r("qAZ0"),Nt=["searchAddress"],Wt=function(){return[16,48]};function kt(t,e){if(1&t){var n=f.Yb();f.Xb(0,"div",6),f.Xb(1,"div",7),f.Xb(2,"sub-tenant-select",8),f.ec("onSubTenantSelected",function(t){return f.Lc(n),f.ic(2).onSubTenantChange(t)}),f.Wb(),f.Wb(),f.Wb()}if(2&t){var i=f.ic(2);f.rc("nzGutter",f.xc(4,Wt)),f.Db(2),f.rc("disabled","edit"==i.mode)("selectedSubTenant",i.subTenantId)("showError",i.showTenantToggleError)}}function Mt(t,e){1&t&&(f.Vb(0),f.Xc(1),f.jc(2,"translate"),f.Ub()),2&t&&(f.Db(1),f.Zc("",f.kc(2,1,"SITE.DEFAULT_SITE")," "))}function xt(t,e){1&t&&(f.Xc(0),f.jc(1,"translate")),2&t&&f.Yc(f.kc(1,1,"SITE.SET_AS_DEFAULT"))}function Ft(t,e){1&t&&(f.Vb(0),f.Xc(1),f.jc(2,"translate"),f.Ub()),2&t&&(f.Db(1),f.Zc(" ",f.kc(2,1,"COMMON.REQUIRED")," "))}function Pt(t,e){1&t&&(f.Vb(0),f.Xc(1),f.jc(2,"translate"),f.Ub()),2&t&&(f.Db(1),f.Zc(" ",f.kc(2,1,"SITE.SITE_WITH_SAME_NAME_ALREADY_EXISTS")," "))}function Rt(t,e){if(1&t&&(f.Vc(0,Ft,3,3,"ng-container",5),f.Vc(1,Pt,3,3,"ng-container",5)),2&t){var n=e.$implicit;f.rc("ngIf",n.hasError("required")),f.Db(1),f.rc("ngIf",n.hasError("notUnique"))}}function Lt(t,e){1&t&&(f.Vb(0),f.Xc(1),f.jc(2,"translate"),f.Ub()),2&t&&(f.Db(1),f.Zc(" ",f.kc(2,1,"COMMON.REQUIRED")," "))}function wt(t,e){1&t&&(f.Vb(0),f.Xc(1),f.jc(2,"translate"),f.Ub()),2&t&&(f.Db(1),f.Zc(" ",f.kc(2,1,"VALIDATION.PHONE_NUMBER_ATLEAST_SIX_CHARS")," "))}function Ut(t,e){1&t&&(f.Vb(0),f.Xc(1),f.jc(2,"translate"),f.Ub()),2&t&&(f.Db(1),f.Zc(" ",f.kc(2,1,"VALIDATION.PHONE_NUMBER_MAX_SIXTEEN_CHARS")," "))}function Vt(t,e){1&t&&(f.Vb(0),f.Xc(1),f.jc(2,"translate"),f.Ub()),2&t&&(f.Db(1),f.Zc(" ",f.kc(2,1,"VALIDATION.PHONE_NUMBER_CONTAINS_INVALID_CHARS")," "))}function jt(t,e){1&t&&(f.Vb(0),f.Xc(1),f.jc(2,"translate"),f.Ub()),2&t&&(f.Db(1),f.Zc(" ",f.kc(2,1,"SITE.ANOTHER_SITE_IS_USING_SAME_CONTACT_NUMBER")," "))}function Gt(t,e){if(1&t&&(f.Vc(0,Lt,3,3,"ng-container",5),f.Vc(1,wt,3,3,"ng-container",5),f.Vc(2,Ut,3,3,"ng-container",5),f.Vc(3,Vt,3,3,"ng-container",5),f.Vc(4,jt,3,3,"ng-container",5)),2&t){var n=e.$implicit;f.rc("ngIf",n.hasError("required")),f.Db(1),f.rc("ngIf",n.hasError("minlength")),f.Db(1),f.rc("ngIf",n.hasError("maxlength")),f.Db(1),f.rc("ngIf",n.hasError("pattern")),f.Db(1),f.rc("ngIf",n.hasError("notUnique"))}}function Yt(t,e){1&t&&(f.Vb(0),f.Xc(1),f.jc(2,"translate"),f.Ub()),2&t&&(f.Db(1),f.Zc(" ",f.kc(2,1,"SITE.NPI_ID_ALREADY_IN_USE")," "))}function Zt(t,e){1&t&&f.Vc(0,Yt,3,3,"ng-container",5),2&t&&f.rc("ngIf",e.$implicit.hasError("notUnique"))}function Ht(t,e){1&t&&(f.Vb(0),f.Xc(1),f.jc(2,"translate"),f.Ub()),2&t&&(f.Db(1),f.Zc(" ",f.kc(2,1,"COMMON.REQUIRED")," "))}function qt(t,e){1&t&&f.Vc(0,Ht,3,3,"ng-container",5),2&t&&f.rc("ngIf",e.$implicit.hasError("required"))}function Bt(t,e){1&t&&(f.Xb(0,"div"),f.Xb(1,"div",48),f.Xc(2),f.jc(3,"translate"),f.Wb(),f.Wb()),2&t&&(f.Db(2),f.Yc(f.kc(3,1,"COMMON.REQUIRED")))}function Qt(t,e){1&t&&(f.Xb(0,"div"),f.Xb(1,"div",48),f.Xc(2),f.jc(3,"translate"),f.Wb(),f.Wb()),2&t&&(f.Db(2),f.Zc("",f.kc(3,1,"VALIDATION.PHONE_NUMBER_ATLEAST_SIX_CHARS")," "))}function $t(t,e){1&t&&(f.Xb(0,"div"),f.Xb(1,"div",48),f.Xc(2),f.jc(3,"translate"),f.Wb(),f.Wb()),2&t&&(f.Db(2),f.Yc(f.kc(3,1,"VALIDATION.PHONE_NUMBER_CONTAINS_INVALID_CHARS")))}function Kt(t,e){if(1&t&&(f.Xb(0,"div",44),f.Xb(1,"div",45),f.Xb(2,"label",46),f.Xc(3," Phone Number "),f.Sb(4,"br"),f.Xb(5,"span"),f.Xc(6),f.Wb(),f.Wb(),f.Sb(7,"input",47),f.Vc(8,Bt,4,3,"div",5),f.Vc(9,Qt,4,3,"div",5),f.Vc(10,$t,4,3,"div",5),f.Wb(),f.Wb()),2&t){var n=e.$implicit,i=e.index,o=f.ic(4);f.Db(1),f.rc("formGroupName",i),f.Db(1),f.tc("nzTooltipTitle","Phone Number (",o.defaultLetterTemplateMap.get(n.value.templateType),")"),f.Db(4),f.Zc("( ",o.defaultLetterTemplateMap.get(n.value.templateType)," )"),f.Db(1),f.rc("ngClass",o.siteForm.get("letterPhoneNumbers").controls[i].controls.phoneNumber.hasError("required")&&o.siteForm.get("letterPhoneNumbers").controls[i].controls.phoneNumber.touched?"error-input":null),f.Db(1),f.rc("ngIf",o.siteForm.get("letterPhoneNumbers").controls[i].controls.phoneNumber.hasError("required")&&o.siteForm.get("letterPhoneNumbers").controls[i].controls.phoneNumber.touched),f.Db(1),f.rc("ngIf",o.siteForm.get("letterPhoneNumbers").controls[i].controls.phoneNumber.hasError("minlength")&&o.siteForm.get("letterPhoneNumbers").controls[i].controls.phoneNumber.touched),f.Db(1),f.rc("ngIf",o.siteForm.get("letterPhoneNumbers").controls[i].controls.phoneNumber.hasError("pattern")&&o.siteForm.get("letterPhoneNumbers").controls[i].controls.phoneNumber.touched)}}function Jt(t,e){if(1&t&&(f.Vb(0),f.Sb(1,"nz-divider"),f.Xb(2,"div",6),f.Xb(3,"div",41),f.Xb(4,"h3",10),f.Xc(5,"Lob Letter Template Phone Numbers"),f.Wb(),f.Wb(),f.Wb(),f.Sb(6,"br"),f.Xb(7,"nz-spin",42),f.Xb(8,"div",6),f.Vc(9,Kt,11,7,"div",43),f.Wb(),f.Wb(),f.Ub()),2&t){var n=f.ic(3);f.Db(2),f.rc("nzGutter",f.xc(4,Wt)),f.Db(5),f.rc("nzSpinning",n.loadingLobData),f.Db(1),f.rc("nzGutter",f.xc(5,Wt)),f.Db(1),f.rc("ngForOf",n.siteForm.get("letterPhoneNumbers").controls)}}var te=function(){return{standalone:!0}};function ee(t,e){if(1&t){var n=f.Yb();f.Vb(0),f.Xb(1,"div",6),f.Xb(2,"div",9),f.Xb(3,"h3",10),f.Xc(4),f.jc(5,"translate"),f.Wb(),f.Wb(),f.Xb(6,"div",11),f.Xb(7,"button",12),f.ec("click",function(){return f.Lc(n),f.ic(2).makeDefault()}),f.Sb(8,"app-icons",13),f.Xc(9," \xa0 "),f.Vc(10,Mt,3,3,"ng-container",14),f.Vc(11,xt,2,3,"ng-template",null,15,f.Wc),f.Wb(),f.Wb(),f.Wb(),f.Xb(13,"form",16),f.ec("ngSubmit",function(){return f.Lc(n),f.ic(2).submit()})("keydown.enter",function(t){return t.preventDefault()}),f.Xb(14,"div",6),f.Xb(15,"div",17),f.Xb(16,"label"),f.Xc(17),f.jc(18,"translate"),f.Wb(),f.Wb(),f.Xb(19,"div",17),f.Xb(20,"label"),f.Xc(21),f.jc(22,"translate"),f.Wb(),f.Wb(),f.Xb(23,"div",17),f.Xb(24,"label"),f.Xc(25),f.jc(26,"translate"),f.Wb(),f.Wb(),f.Wb(),f.Xb(27,"div",18),f.Xb(28,"div",17),f.Xb(29,"nz-form-item"),f.Xb(30,"nz-form-control",19),f.Sb(31,"input",20),f.Wb(),f.Vc(32,Rt,2,2,"ng-template",null,21,f.Wc),f.Wb(),f.Wb(),f.Xb(34,"div",17),f.Xb(35,"nz-form-item"),f.Xb(36,"nz-form-control"),f.Sb(37,"input",22),f.Wb(),f.Wb(),f.Wb(),f.Xb(38,"div",17),f.Xb(39,"nz-form-item"),f.Xb(40,"nz-form-control",19),f.Xb(41,"nz-input-group",23),f.Sb(42,"input",24),f.Wb(),f.Wb(),f.Vc(43,Gt,5,5,"ng-template",null,25,f.Wc),f.Wb(),f.Wb(),f.Wb(),f.Xb(45,"div",6),f.Xb(46,"div",17),f.Xb(47,"label"),f.Xc(48),f.jc(49,"translate"),f.Wb(),f.Wb(),f.Xb(50,"div",17),f.Xb(51,"label"),f.Xc(52,"Department ID"),f.Wb(),f.Wb(),f.Wb(),f.Xb(53,"div",6),f.Xb(54,"div",17),f.Xb(55,"nz-form-item",26),f.Xb(56,"nz-form-control",19),f.Sb(57,"input",27),f.Wb(),f.Vc(58,Zt,1,1,"ng-template",null,28,f.Wc),f.Wb(),f.Xb(60,"label",29),f.ec("ngModelChange",function(t){return f.Lc(n),f.ic(2).sameAsDefaultSite=t})("ngModelChange",function(){return f.Lc(n),f.ic(2).onSameAsDefaultSiteCheck()}),f.Xc(61),f.jc(62,"translate"),f.Wb(),f.Wb(),f.Xb(63,"div",17),f.Xb(64,"nz-form-item",26),f.Xb(65,"nz-form-control",19),f.Sb(66,"input",30),f.Wb(),f.Vc(67,qt,1,1,"ng-template",null,31,f.Wc),f.Wb(),f.Wb(),f.Wb(),f.Vc(69,Jt,10,6,"ng-container",5),f.Sb(70,"nz-divider"),f.Xb(71,"div",6),f.Xb(72,"div",9),f.Xb(73,"h3",10),f.Xc(74),f.jc(75,"translate"),f.Wb(),f.Wb(),f.Wb(),f.Xb(76,"div",6),f.Xb(77,"div",32),f.Xb(78,"label"),f.Xc(79),f.jc(80,"translate"),f.Wb(),f.Wb(),f.Xb(81,"div",32),f.Xb(82,"label"),f.Xc(83),f.jc(84,"translate"),f.Wb(),f.Wb(),f.Wb(),f.Xb(85,"div",18),f.Xb(86,"div",32),f.Xb(87,"nz-form-item"),f.Xb(88,"nz-form-control",19),f.jc(89,"translate"),f.Sb(90,"input",33,34),f.Wb(),f.Wb(),f.Wb(),f.Xb(92,"div",32),f.Xb(93,"nz-form-item"),f.Xb(94,"nz-form-control"),f.Sb(95,"input",35),f.Wb(),f.Wb(),f.Wb(),f.Wb(),f.Sb(96,"div",36),f.Xb(97,"div",18),f.Xb(98,"div",17),f.Xb(99,"label"),f.Xc(100),f.jc(101,"translate"),f.Wb(),f.Wb(),f.Xb(102,"div",17),f.Xb(103,"label"),f.Xc(104),f.jc(105,"translate"),f.Wb(),f.Wb(),f.Xb(106,"div",17),f.Xb(107,"label"),f.Xc(108),f.jc(109,"translate"),f.Wb(),f.Wb(),f.Xb(110,"div",17),f.Xb(111,"label"),f.Xc(112),f.jc(113,"translate"),f.Wb(),f.Wb(),f.Wb(),f.Xb(114,"div",18),f.Xb(115,"div",17),f.Xb(116,"nz-form-item"),f.Xb(117,"nz-form-control",19),f.jc(118,"translate"),f.Sb(119,"input",37),f.Wb(),f.Wb(),f.Wb(),f.Xb(120,"div",17),f.Xb(121,"nz-form-item"),f.Xb(122,"nz-form-control",19),f.jc(123,"translate"),f.Sb(124,"input",38),f.Wb(),f.Wb(),f.Wb(),f.Xb(125,"div",17),f.Xb(126,"nz-form-item"),f.Xb(127,"nz-form-control",19),f.jc(128,"translate"),f.Sb(129,"input",39),f.Wb(),f.Wb(),f.Wb(),f.Xb(130,"div",17),f.Xb(131,"nz-form-item"),f.Xb(132,"nz-form-control",19),f.jc(133,"translate"),f.Sb(134,"input",40),f.Wb(),f.Wb(),f.Wb(),f.Wb(),f.Wb(),f.Ub()}if(2&t){var i=f.Ic(12),o=f.Ic(33),r=f.Ic(44),a=f.Ic(59),l=f.Ic(68),c=f.ic(2);f.Db(1),f.rc("nzGutter",f.xc(75,Wt)),f.Db(3),f.Yc(f.kc(5,39,"COMMON.BASICINFO")),f.Db(3),f.Jb("disabled-button",!0===c.primarySite),f.Db(3),f.rc("ngIf",c.primarySite)("ngIfElse",i),f.Db(3),f.rc("formGroup",c.siteForm),f.Db(1),f.rc("nzGutter",f.xc(76,Wt)),f.Db(3),f.Zc("",f.kc(18,41,"SITE.NAME"),"*"),f.Db(4),f.Yc(f.kc(22,43,"SITE.DESCRIPTION")),f.Db(4),f.Zc("",f.kc(26,45,"COMMON.PHONE_NUMBER"),"*"),f.Db(5),f.rc("nzErrorTip",o),f.Db(10),f.rc("nzErrorTip",r),f.Db(1),f.tc("nzAddOnBefore","[",c.countryCode,"]"),f.Db(4),f.rc("nzGutter",16),f.Db(3),f.Yc(f.kc(49,47,"SITE.NPI_ID")),f.Db(5),f.rc("nzGutter",16),f.Db(3),f.rc("nzErrorTip",a),f.Db(4),f.Jb("disabled",!0===c.primarySite),f.rc("ngModel",c.sameAsDefaultSite)("ngModelOptions",f.xc(77,te)),f.Db(1),f.Zc(" ",f.kc(62,49,"SITE.SAME_AS_DEFAULT_SITE")," "),f.Db(4),f.rc("nzErrorTip",l),f.Db(4),f.rc("ngIf",c.lobEnabled),f.Db(2),f.rc("nzGutter",f.xc(78,Wt)),f.Db(3),f.Yc(f.kc(75,51,"COMMON.ADDRESS")),f.Db(2),f.rc("nzGutter",f.xc(79,Wt)),f.Db(3),f.Zc("",f.kc(80,53,"SITE.ADDRESS_LINE_1")," *"),f.Db(4),f.Yc(f.kc(84,55,"COMMON.LINE_2")),f.Db(5),f.sc("nzErrorTip",f.kc(89,57,"COMMON.REQUIRED")),f.Db(12),f.Zc("",f.kc(101,59,"ZIP_CODE")," *"),f.Db(4),f.Yc(f.kc(105,61,"COMMON.COUNTRY")),f.Db(4),f.Yc(f.kc(109,63,"COMMON.STATE")),f.Db(4),f.Yc(f.kc(113,65,"COMMON.CITY")),f.Db(5),f.sc("nzErrorTip",f.kc(118,67,"COMMON.REQUIRED")),f.Db(5),f.sc("nzErrorTip",f.kc(123,69,"COMMON.REQUIRED")),f.Db(5),f.sc("nzErrorTip",f.kc(128,71,"COMMON.REQUIRED")),f.Db(5),f.sc("nzErrorTip",f.kc(133,73,"COMMON.REQUIRED"))}}function ne(t,e){if(1&t&&(f.Xb(0,"div",3),f.Vc(1,kt,3,5,"div",4),f.Vc(2,ee,135,80,"ng-container",5),f.Wb()),2&t){var n=f.ic();f.Db(2),f.rc("ngIf",n.siteForm)}}var ie,oe,re,ae=((ie=function(e){n(r,e);var i=o(r);function r(e,n,o,a,c,s,u,d,b,v,f,p){var m,h;return l(this,r),(h=i.call(this))._router=e,h._fb=n,h._siteService=o,h._storeService=a,h.mapsAPILoader=c,h._modalService=s,h._activatedRoute=u,h._dataSharingService=d,h._translationService=b,h._notificationsService=v,h._googleLocationService=f,h._defaultLetterTemplatesService=p,h.lobEnabled=!1,h.loadingLobData=!1,h.strings=["SITES","SITE.ADD","SITE.EDIT","SITE.CHANGING_DEFAULT_SITE_TO_NEW_SITE","SITE.CREATED_SUCCESSFULLY","SITE.UPDATED_SUCCESSFULLY"],h._siteService.getDefaultSite().subscribe(function(t){t?h.defaultSite=t:(h.primarySite=!0,h.sameAsDefaultSite=!1)}),h.siteId=h._activatedRoute.snapshot.paramMap.get("id"),h.mode=h._activatedRoute.snapshot.paramMap.get("mode"),(m=h._translationService).getMultiple.apply(m,t(h.strings)).pipe(Object(C.a)(h.unsubscribed)).subscribe(function(t){h.translatedStrings=t,h.title=h.translatedStrings.get("edit"===h.mode?"SITE.EDIT":"SITE.ADD")}),h}return s(r,[{key:"ngOnInit",value:function(){this.initTenantConfigs()}},{key:"initTenantConfigs",value:function(){var t,e=this;null===(t=this._dataSharingService.assignedTenantSettings)||void 0===t||t.pipe(Object(C.a)(this.unsubscribed)).subscribe(function(t){e.tenantConfigMap=t,e.updateTenantConfig()})}},{key:"updateTenantConfig",value:function(){var t,e,n,i;"add"==this.mode&&(this.tenantConfigMap.forEach(function(t,e){i=e}),this.subTenantId=i),this.subTenantId&&(localStorage.setItem(Tt.a.REQUEST_TENANT_IDS,this.subTenantId),this.tenantConfig=this.tenantConfigMap.get(this.subTenantId),this.countryCode=null===(t=this.tenantConfig)||void 0===t?void 0:t.countryCode,this.lobEnabled=null===(n=null===(e=this.tenantConfig)||void 0===e?void 0:e.directMailConfig)||void 0===n?void 0:n.directMailEnabled),this.initializeForm()}},{key:"initializeForm",value:function(){var t=this;this.loadingLobData=!0,{add:function(){return t.newFormInitializer()},edit:function(){return t.existingSiteFormInitializer()}}[this.mode]()}},{key:"updateFormValidators",value:function(){var t,e,n,i,o,r;(null===(e=null===(t=this.tenantConfig)||void 0===t?void 0:t.directMailConfig)||void 0===e?void 0:e.directMailEnabled)||null===(n=this.siteForm)||void 0===n||n.get("letterPhoneNumbers").clearValidators(),(null===(o=null===(i=this.tenantConfig)||void 0===i?void 0:i.redoxConfig)||void 0===o?void 0:o.enabled)||null===(r=this.siteForm)||void 0===r||r.get("departmentId").clearValidators()}},{key:"newFormInitializer",value:function(){var t=this;this.siteForm=this._fb.group(new lt),this.loadDefaultTemplates(),setTimeout(function(){return t.searchAddress()}),this.getLocationFromZipcode(),this.updateFormValidators()}},{key:"existingSiteFormInitializer",value:function(){var t=this;this._siteService.getSiteById(this.siteId).pipe(Object(C.a)(this.unsubscribed)).subscribe(function(e){t.primarySite=e.site.primarySite,t.subTenantId=e.site.tenantId,localStorage.setItem(Tt.a.REQUEST_TENANT_IDS,t.subTenantId),t.tenantConfig=t.tenantConfigMap.get(t.subTenantId),t.siteForm=t._fb.group(function(t,e){var n,i,o,r,a,l,c,s,u,d,b,v,f=new lt;if(null==t||null==t.site)return f;for(var p in t.site)"letterPhoneNumbers"!==p&&(null===(n=f[p])||void 0===n||n.setValue(t.site[p]));return f.siteId.setValue(function(t){var e;return null===(e=null==t?void 0:t.find(function(t){return(null==t?void 0:t.source)===ct.ORG_NPI_ID}))||void 0===e?void 0:e.sourceId}(t.site.externalSources)),f.departmentId.setValue(function(t){var e;return null===(e=null==t?void 0:t.find(function(t){return(null==t?void 0:t.source)===ct.DEPARTMENT_ID}))||void 0===e?void 0:e.sourceId}(t.site.externalSources)),f.mobile.setValue(null===(r=null===(o=null===(i=t.site.siteSupport)||void 0===i?void 0:i.contacts)||void 0===o?void 0:o[0])||void 0===r?void 0:r.contactNumber),f.streetAddress.setValue(null===(a=t.site.siteAddress)||void 0===a?void 0:a.line1),f.streetAddress2.setValue(null===(l=t.site.siteAddress)||void 0===l?void 0:l.line2),f.city.setValue(null===(c=t.site.siteAddress)||void 0===c?void 0:c.city),f.state.setValue(null===(s=t.site.siteAddress)||void 0===s?void 0:s.state),f.country.setValue(null===(u=t.site.siteAddress)||void 0===u?void 0:u.country),f.zipCode.setValue(null===(d=t.site.siteAddress)||void 0===d?void 0:d.pin),f.lat.setValue(null===(b=t.site.siteAddress)||void 0===b?void 0:b.lat),f.lng.setValue(null===(v=t.site.siteAddress)||void 0===v?void 0:v.lng),f.letterPhoneNumbers.setValue([]),f}(e)),t.loadDefaultTemplates(e),setTimeout(function(){return t.searchAddress()}),t.getLocationFromZipcode(),t.updateFormValidators()})}},{key:"loadDefaultTemplates",value:function(t){var e=this;this._defaultLetterTemplatesService.fetchDefaultLetterTemplates().pipe(Object(C.a)(this.unsubscribed)).subscribe(function(n){e.defaultLetterTemplateMap=new Map,e.defaultLetterTemplateMap.clear(),null==n||n.forEach(function(t){var n;return null===(n=e.defaultLetterTemplateMap)||void 0===n?void 0:n.set(t.id,t.letterType)}),e.patchForm(t),e.loadingLobData=!1})}},{key:"patchForm",value:function(t){var e,n=this.siteForm.get("letterPhoneNumbers"),i=[];(null===(e=null==t?void 0:t.site)||void 0===e?void 0:e.letterPhoneNumbers)?this.defaultLetterTemplateMap.forEach(function(e,n){var o,r,a,l=(null===(a=null===(r=null===(o=null==t?void 0:t.site)||void 0===o?void 0:o.letterPhoneNumbers)||void 0===r?void 0:r.find(function(t){return t.templateType===n}))||void 0===a?void 0:a.phoneNumber)||"";i.push(new ft(n,l))}):this.defaultLetterTemplateMap.forEach(function(t,e){return i.push(new ft(e,""))}),i.forEach(function(t){return n.push(new at.l({templateType:new at.i(t.templateType),phoneNumber:new at.i(t.phoneNumber,[at.D.required,at.D.minLength(6),at.D.pattern(/^(?:(?:\(?(?:00|\+)([1-4]\d\d|[1-9]\d*)\)?)[\-\.\ \\\/]?)?((?:\(?\d{1,}\)?[\-\.\ \\\/]?)+)(?:[\-\.\ \\\/]?(?:#|ext\.?|extension|x)[\-\.\ \\\/]?(\d+))?$/)])}))})}},{key:"getLocationFromZipcode",value:function(){var t,e,n,i=this;null===(n=null===(e=null===(t=this.siteForm)||void 0===t?void 0:t.controls)||void 0===e?void 0:e.zipCode)||void 0===n||n.valueChanges.pipe(Object(ut.a)(500),Object(dt.a)(),Object(A.a)(function(t){return(null==t?void 0:t.length)>4}),Object(bt.a)(function(t){return i._googleLocationService.fetchLocationFromZipCode(t)})).pipe(Object(C.a)(this.unsubscribed)).subscribe(function(t){var e,n,o,r,a,l,c,s,u,d,b;0!=(null===(e=null==t?void 0:t.results)||void 0===e?void 0:e.length)&&(null===(n=null==t?void 0:t.results)||void 0===n||n.forEach(function(t){var e;null===(e=null==t?void 0:t.address_components)||void 0===e||e.forEach(function(t){var e,n,i;-1!==(null===(e=null==t?void 0:t.types)||void 0===e?void 0:e.findIndex(function(t){return"country"===t}))&&(u=t.long_name),-1!==(null===(n=null==t?void 0:t.types)||void 0===n?void 0:n.findIndex(function(t){return"administrative_area_level_1"===t}))&&(d=t.long_name),-1!==(null===(i=null==t?void 0:t.types)||void 0===i?void 0:i.findIndex(function(t){return"locality"===t}))&&(b=t.long_name)})}),null===(r=null===(o=i.siteForm)||void 0===o?void 0:o.controls)||void 0===r||r.city.setValue(b),null===(l=null===(a=i.siteForm)||void 0===a?void 0:a.controls)||void 0===l||l.state.setValue(d),null===(s=null===(c=i.siteForm)||void 0===c?void 0:c.controls)||void 0===s||s.country.setValue(u))})}},{key:"searchAddress",value:function(){var t=this;this.mapsAPILoader.load().then(function(){var e,n=new google.maps.places.Autocomplete(null===(e=t.searchElementRef)||void 0===e?void 0:e.nativeElement);n.addListener("place_changed",function(){var e=st.a.mapAddress(n);["streetAddress","streetAddress2","city","state","country","zipCode","lat","lng"].forEach(function(n){var i,o;null===(o=null===(i=t.siteForm)||void 0===i?void 0:i.controls[n])||void 0===o||o.patchValue(e[n],{emitEvent:!1})})})})}},{key:"onSubTenantChange",value:function(t){var e,n,i;t&&null!=t?(this.showTenantToggleError=!1,this.subTenantId=t,this.tenantConfig=this.tenantConfigMap.get(this.subTenantId),this.countryCode=null===(e=this.tenantConfig)||void 0===e?void 0:e.countryCode,this.lobEnabled=null===(i=null===(n=this.tenantConfig)||void 0===n?void 0:n.directMailConfig)||void 0===i?void 0:i.directMailEnabled,this.initializeForm()):this.showTenantToggleError=!0}},{key:"submit",value:function(){var t,e=this;for(var n in this.siteForm.controls)this.siteForm.controls[n].markAsDirty(),this.siteForm.controls[n].updateValueAndValidity(),this.siteForm.controls[n]instanceof at.f&&this.siteForm.controls[n].value.forEach(function(t){for(var e in t.controls)t.controls[e].markAsDirty(),t.controls[e].updateValueAndValidity()});var i=function(t,n,i,o,r){var a,l,c,s,u,d,b,v;return{id:e.siteId,name:null===(l=null===(a=null==t?void 0:t.controls)||void 0===a?void 0:a.name)||void 0===l?void 0:l.value,npiId:null===(s=null===(c=null==t?void 0:t.controls)||void 0===c?void 0:c.siteId)||void 0===s?void 0:s.value,departmentId:null===(d=null===(u=null==t?void 0:t.controls)||void 0===u?void 0:u.departmentId)||void 0===d?void 0:d.value,description:null===(v=null===(b=null==t?void 0:t.controls)||void 0===b?void 0:b.description)||void 0===v?void 0:v.value,siteAddress:mt(t),billingAddress:mt(t),siteContact:ht(t,i),primarySite:o,tenantId:r,letterPhoneNumbers:pt(t)}}(this.siteForm,0,this.countryCode,this.primarySite,null===(t=this.tenantConfig)||void 0===t?void 0:t.tenantId);if(this.subTenantId){if("VALID"===this.siteForm.status){i.tenantId=this.subTenantId;var o=this._siteService.saveSite(i),r=this._siteService.updateSite(i);Object(gt.a)(function(){return!!i.id},r,o).subscribe(function(t){e._notificationsService.success(e.translatedStrings.get("SITES"),e.translatedStrings.get("edit"==e.mode?"SITE.UPDATED_SUCCESSFULLY":"SITE.CREATED_SUCCESSFULLY")),e._siteService.getAllSites(0,999,null,!1).subscribe(function(t){e._storeService.setSites(null==t?void 0:t.result)}),e._router.navigate(["/sites"])})}}else this.showTenantToggleError=!0}},{key:"makeDefault",value:function(){var t,e,n=this;null!=(null===(e=null===(t=this.siteForm.controls.name)||void 0===t?void 0:t.value)||void 0===e?void 0:e.trim())?this._modalService.create({nzTitle:this.translatedStrings.get("SITE.CHANGING_DEFAULT_SITE_TO_NEW_SITE").replace("{NEW_DEFAULT_SITE}",this.siteForm.controls.name.value),nzContent:O,nzComponentParams:{siteName:this.siteForm.controls.name.value},nzWidth:"662px",nzBodyStyle:{padding:"0px 36px 18px 36px",height:"100px"},nzFooter:null}).afterClose.subscribe(function(t){t&&(n.primarySite=t)}):this.siteForm.controls.name.setErrors({required:!0})}},{key:"onSameAsDefaultSiteCheck",value:function(){var t,e,n,i,o,r,a,l;this.sameAsDefaultSite?null===(n=null===(e=null===(t=this.siteForm)||void 0===t?void 0:t.controls)||void 0===e?void 0:e.siteId)||void 0===n||n.setValue(this.getSiteIdFromExternalSource(null===(o=null===(i=this.defaultSite)||void 0===i?void 0:i.site)||void 0===o?void 0:o.externalSources)):null===(l=null===(a=null===(r=this.siteForm)||void 0===r?void 0:r.controls)||void 0===a?void 0:a.siteId)||void 0===l||l.setValue(null)}},{key:"getSiteIdFromExternalSource",value:function(t){var e;return null===(e=null==t?void 0:t.find(function(t){return(null==t?void 0:t.source)===ct.ORG_NPI_ID}))||void 0===e?void 0:e.sourceId}}]),r}(v.a)).\u0275fac=function(t){return new(t||ie)(f.Rb(c.g),f.Rb(at.h),f.Rb(X.a),f.Rb(St.a),f.Rb(It.b),f.Rb(p.f),f.Rb(c.a),f.Rb(N.a),f.Rb(z.a),f.Rb(W.b),f.Rb(vt.a),f.Rb(Et.a))},ie.\u0275cmp=f.Lb({type:ie,selectors:[["site-form"]],viewQuery:function(t,e){var n;1&t&&f.ed(Nt,1),2&t&&f.Hc(n=f.fc())&&(e.searchElementRef=n.first)},features:[f.Ab],decls:5,vars:8,consts:[[3,"defaultTitle","isSearchEnabled","isActionEnabled"],["nz-button","","nzType","primary","form","sitesForm",3,"disabled"],["class","container",4,"ngIf"],[1,"container"],["nz-row","",3,"nzGutter",4,"isAccessAcrossTenantEnabled"],[4,"ngIf"],["nz-row","",3,"nzGutter"],["nz-col","","nzSpan","6","nzOffset","18"],["mode","SINGLE",3,"disabled","selectedSubTenant","showError","onSubTenantSelected"],["nz-col","","nzSpan","8"],["nz-typography",""],["nz-col","","nzOffset","8","nzSpan","8"],["id","default-button","nz-button","","nzGhost","",3,"click"],["name","environment","size","16px","nz-tooltip","","nzTooltipPlacement","right"],[4,"ngIf","ngIfElse"],["setAsDefault",""],["id","sitesForm","nz-form","","appScrollToFirstInvalid","",3,"formGroup","ngSubmit","keydown.enter"],["nz-col","","nzSpan","6"],["nz-row","","nzGutter","16"],[3,"nzErrorTip"],["formControlName","name","nz-input","","readonly","","onfocus","this.removeAttribute('readonly')"],["nameErrors",""],["formControlName","description","nz-input","","readonly","","onfocus","this.removeAttribute('readonly')"],[3,"nzAddOnBefore"],["formControlName","mobile","nz-input","","readonly","","onfocus","this.removeAttribute('readonly')"],["mobileErrors",""],[2,"margin-bottom","10px"],["formControlName","siteId","nz-input","","readonly","","onfocus","this.removeAttribute('readonly')"],["siteIdErrors",""],["nz-checkbox","",2,"margin","0px",3,"ngModel","ngModelOptions","ngModelChange"],["formControlName","departmentId","nz-input","","readonly","","onfocus","this.removeAttribute('readonly')"],["departmentErrors",""],["nz-col","","nzSpan","12"],["formControlName","streetAddress","nz-input","","readonly","","onfocus","this.removeAttribute('readonly')"],["searchAddress",""],["formControlName","streetAddress2","nz-input","","readonly","","onfocus","this.removeAttribute('readonly')"],[1,"divider"],["formControlName","zipCode","nz-input","","readonly","","onfocus","this.removeAttribute('readonly')"],["formControlName","country","nz-input","","readonly",""],["formControlName","state","nz-input","","readonly",""],["formControlName","city","nz-input","","readonly",""],["nz-col","","nzSpan","24"],["nzTip","Please wait ...",2,"min-height","100px",3,"nzSpinning"],["nz-col","","nzXs","24","nzSm","24","nzMd","12","nzLg","12","nzXl","6","formArrayName","letterPhoneNumbers",4,"ngFor","ngForOf"],["nz-col","","nzXs","24","nzSm","24","nzMd","12","nzLg","12","nzXl","6","formArrayName","letterPhoneNumbers"],[3,"formGroupName"],["nz-tooltip","",1,"phone-label",3,"nzTooltipTitle"],["nz-input","","formControlName","phoneNumber","readonly","","onfocus","this.removeAttribute('readonly')",3,"ngClass"],[1,"required-text"]],template:function(t,e){1&t&&(f.Xb(0,"app-header",0),f.Xb(1,"button",1),f.Xc(2),f.jc(3,"translate"),f.Wb(),f.Wb(),f.Vc(4,ne,3,1,"div",2)),2&t&&(f.rc("defaultTitle",e.title)("isSearchEnabled",!1)("isActionEnabled",!1),f.Db(1),f.rc("disabled","PENDING"===(null==e.siteForm?null:e.siteForm.status)),f.Db(1),f.Zc(" ",f.kc(3,6,"COMMON.SAVE")," "),f.Db(2),f.rc("ngIf",!!e.tenantConfig))},directives:[_t.a,h.a,g.a,S.a,m.q,F.a,M.c,M.a,yt.a,w.a,R.a,L.d,at.F,at.v,Dt.b,zt.a,at.m,Dt.c,Dt.a,at.d,At.b,at.u,at.k,At.c,Ct.a,at.x,Xt.a,Ot.a,m.p,at.g,at.n,m.o],pipes:[E.a],styles:[".container[_ngcontent-%COMP%]{padding:40px 160px 100px 60px!important}#default-button[_ngcontent-%COMP%]{float:right;border:1px solid #2f4f4f;color:var(--tertiary-color);height:30px;padding-left:5px}#default-button[_ngcontent-%COMP%]   app-icons[_ngcontent-%COMP%]{vertical-align:middle}.disabled-button[_ngcontent-%COMP%]{pointer-events:none}label[_ngcontent-%COMP%]{font:normal normal normal 12px/16px Nunito;color:var(--tertiary-color);margin-left:5px;margin-bottom:5px;display:block}[_nghost-%COMP%]     .ant-input-group-addon{color:#8a8a8a!important;font-size:10px!important}nz-divider[_ngcontent-%COMP%]{margin:36px 0}[_nghost-%COMP%]     .ant-form-item-explain-error{text-align:right}.disabled[_ngcontent-%COMP%]{pointer-events:none;opacity:.7}.phone-label[_ngcontent-%COMP%]{line-height:1.6em;max-height:3.2em;overflow:hidden;text-overflow:ellipsis}.required-text[_ngcontent-%COMP%]{color:var(--error-color);text-align:end}.error-input[_ngcontent-%COMP%]{border-color:var(--error-color)}"]}),ie),le=r("0W7X"),ce={Listing:{header:!0,title:"SITES",searchEnabled:!0,primaryAction:{title:"Add Site",permissions:[le.a.ADD_SITE],enabled:!0},secondaryAction:{},multiAction:{},privileges:[le.a.VIEW_SITE],showTenantToggle:!0},Form:{header:!1,showTenantToggle:!1}},se=[{path:"",component:rt,pathMatch:"full",data:ce.Listing,canActivate:[u.a,a.a]},{path:":mode",component:ae,data:ce.Form,canActivate:[u.a,a.a]},{path:":mode/:id",component:ae,data:ce.Form,canActivate:[u.a,a.a]}],ue=((oe=function t(){l(this,t)}).\u0275mod=f.Pb({type:oe}),oe.\u0275inj=f.Ob({factory:function(t){return new(t||oe)},imports:[[c.k.forChild(se)],c.k]}),oe),de=r("rbUg"),be=r("SHZf"),ve=r("UFn0"),fe=r("KZX/"),pe=((re=function t(e){l(this,t),this.translationService=e,e.setLanguage()}).\u0275mod=f.Pb({type:re}),re.\u0275inj=f.Ob({factory:function(t){return new(t||re)(f.bc(z.a))},providers:[b.a],imports:[[ue,m.c,de.a,at.o,at.B,be.a.forRoot(),It.a.forRoot({apiKey:"AIzaSyCkujBUnFmDto5Ui2EKj4AcpWXMrizEDRc",libraries:["places"]}),ve.a,fe.a]]}),re)},h51P:function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n("tk/3"),o=n("fXoL"),r=function(){var t=function(){function t(e){l(this,t),this._http=e}return s(t,[{key:"fetchLocationFromZipCode",value:function(t){var e=new i.g({bypass:"yes"});return this._http.get("https://maps.googleapis.com/maps/api/geocode/json?address=".concat(t,"&key=AIzaSyCySGsZgXtvenjp06bwyxsL4vtqIsAa4E4"),{headers:e})}}]),t}();return t.\u0275fac=function(e){return new(e||t)(o.bc(i.c))},t.\u0275prov=o.Nb({token:t,factory:t.\u0275fac,providedIn:"root"}),t}()}}])}();