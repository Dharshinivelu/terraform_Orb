!function(){function e(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"==typeof e)return t(e,n);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return t(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,i=l(e);if(t){var a=l(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return s(this,n)}}function s(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{MCT3:function(t,i,r){"use strict";r.r(i),r.d(i,"AppointmentsModule",function(){return gi});var s=r("rbUg"),l=r("ofXK"),p=r("SHZf"),d=r("UFn0"),u=r("tyNb"),b=r("3Pt+"),m=r("KZX/"),g=r("T5gh"),f=r("1G5W"),h=r("qQcL"),v=r("VGjC"),S=r("cnAw"),z=r("w7IE"),A=r("OE57"),T=r("igu/"),I=r("FH+g"),y=r("1yiY"),D=r("74vj"),C=r("MXg9"),E=r("WIjQ"),O=r("jIYg"),X=r("Z93s"),P=r("c36b"),N=r("Dm2S"),M=r("pe0G"),k=r("bA60"),L=r("+gyu"),_=r("fXoL"),W=r("bNXi"),R=r("JA5x"),w=r("eHCX"),V=r("5vDB"),F=r("B+r4"),x=r("zAKX"),j=r("rP/m"),U=r("mUB+"),H=r("mUTz"),B=r("glKu"),Y=r("nJia"),$=r("bE2y"),q=r("OzZK"),Q=r("RwU8"),Z=r("C2AL"),K=r("Szod"),G=r("FwiY"),J=r("dRHE"),ee=r("vDSh"),te=r("t2pg"),ne=r("m3lz"),ie=r("ncKW");function ae(e,t){if(1&e&&(_.Vb(0),_.Xb(1,"span",29),_.Xb(2,"span",30),_.Xc(3),_.jc(4,"tenantName"),_.Wb(),_.Wb(),_.Ub()),2&e){var n=_.ic().$implicit;_.Db(3),_.Yc(_.kc(4,1,null==n?null:n.tenantId))}}function oe(e,t){if(1&e&&(_.Vb(0),_.Xb(1,"nz-option",25),_.jc(2,"date"),_.Xb(3,"span",26),_.Xb(4,"span",27),_.Xc(5),_.jc(6,"date"),_.Wb(),_.Vc(7,ae,5,3,"ng-container",28),_.Wb(),_.Wb(),_.Ub()),2&e){var n=t.$implicit;_.Db(1),_.vc("nzLabel","",null==n?null:n.firstName," ",null==n?null:n.lastName," - ",_.lc(2,7,null==n?null:n.dateOfBirth,"mediumDate"),""),_.rc("nzValue",n),_.Db(4),_.bd(" ",null==n?null:n.firstName," ",null==n?null:n.lastName," - ",_.lc(6,10,null==n?null:n.dateOfBirth,"mediumDate")," ")}}function re(e,t){1&e&&(_.Xb(0,"nz-option",31),_.Sb(1,"app-icons",32),_.Xc(2," Loading Data... "),_.Wb())}function ce(e,t){if(1&e&&(_.Vb(0),_.Xc(1," | "),_.Xb(2,"span",30),_.Xc(3),_.jc(4,"tenantName"),_.Wb(),_.Ub()),2&e){var n=_.ic().$implicit;_.Db(3),_.Zc(" ",_.kc(4,1,null==n.nzValue?null:n.nzValue.tenantId)," ")}}function se(e,t){1&e&&(_.Xc(0),_.Vc(1,ce,5,3,"ng-container",28)),2&e&&_.Zc(" ",t.$implicit.nzLabel," ")}function le(e,t){1&e&&(_.Xb(0,"div",2),_.Xb(1,"div",3),_.Xb(2,"strong"),_.Xc(3),_.jc(4,"translate"),_.jc(5,"translate"),_.jc(6,"translate"),_.Wb(),_.Wb(),_.Wb()),2&e&&(_.rc("nzGutter",24),_.Db(1),_.rc("nzSpan",8),_.Db(2),_.bd("",_.kc(4,5,"COMMON.PHYSICIAN"),"\\",_.kc(5,7,"PATIENT.MONITORING_STAFF")," - ",_.kc(6,9,"SITE"),""))}function pe(e,t){1&e&&(_.Xb(0,"span",37),_.Sb(1,"span",38),_.Xc(2," Primary "),_.Wb())}function de(e,t){if(1&e&&(_.Vb(0),_.Xb(1,"nz-option",25),_.jc(2,"userLocations"),_.Xb(3,"span",26),_.Xb(4,"span",27),_.Xc(5),_.jc(6,"userLocations"),_.Wb(),_.Vc(7,pe,3,0,"span",36),_.Wb(),_.Wb(),_.Ub()),2&e){var n=t.$implicit,i=_.ic(3);_.Db(1),_.vc("nzLabel","",null==n?null:n.firstName," ",null==n?null:n.lastName," - ",_.kc(2,8,null==n?null:n.locations),""),_.rc("nzValue",n),_.Db(4),_.bd(" ",null==n?null:n.firstName," ",null==n?null:n.lastName," - ",_.kc(6,10,null==n?null:n.locations)," "),_.Db(2),_.rc("ngIf",i.primaryStaff.has(null==n?null:n.id))}}function ue(e,t){if(1&e&&(_.Vb(0),_.Vc(1,de,8,12,"ng-container",5),_.Ub()),2&e){var n=t.ngIf;_.Db(1),_.rc("ngForOf",n)}}function be(e,t){1&e&&(_.Xb(0,"nz-option",31),_.Sb(1,"app-icons",32),_.Xc(2," Loading Data... "),_.Wb())}function me(e,t){if(1&e){var n=_.Yb();_.Xb(0,"div",3),_.Xb(1,"nz-select",33),_.ec("ngModelChange",function(e){return _.Lc(n),_.ic().selectedCaretaker=e})("nzOnSearch",function(e){return _.Lc(n),_.ic().searchCaretakers(e)}),_.jc(2,"translate"),_.Vc(3,ue,2,1,"ng-container",34),_.jc(4,"async"),_.Vc(5,be,3,0,"ng-template",null,35,_.Wc),_.Wb(),_.Wb()}if(2&e){var i=_.Ic(6),a=_.ic();_.rc("nzSpan",8),_.Db(1),_.tc("nzPlaceHolder"," ",_.kc(2,8,"COMMON.AVAILABLE_STAFFS")," "),_.rc("nzShowSearch",!0)("nzDisabled",!(null!=a.appointment&&null!=a.appointment.schedule&&a.appointment.schedule.startDate))("ngModel",a.selectedCaretaker)("nzServerSearch",!0),_.Db(2),_.rc("ngIf",_.kc(4,10,a.caretakers$))("ngIfElse",i)}}function ge(e,t){if(1&e){var n=_.Yb();_.Xb(0,"div",3),_.Xb(1,"nz-radio-group",20),_.ec("ngModelChange",function(e){return _.Lc(n),_.ic().appointment.type=e}),_.Xb(2,"label",39),_.Xc(3),_.jc(4,"translate"),_.Wb(),_.Xb(5,"label",40),_.Xc(6),_.jc(7,"translate"),_.Wb(),_.Xb(8,"label",41),_.Xc(9),_.jc(10,"translate"),_.Wb(),_.Wb(),_.Wb()}if(2&e){var i=_.ic();_.rc("nzSpan",12),_.Db(1),_.rc("ngModel",i.appointment.type),_.Db(1),_.rc("nzDisabled",i.videoAppointmentEnabled),_.Db(1),_.Zc(" ",_.kc(4,8,"EPISODE.HOMEVISIT"),""),_.Db(2),_.rc("nzDisabled",!i.videoAppointmentEnabled),_.Db(1),_.Zc(" ",_.kc(7,10,"VIDEO_CALL"),""),_.Db(2),_.rc("nzDisabled",!i.audioAppointmentEnabled),_.Db(1),_.Zc(" ",_.kc(10,12,"AUDIO_CALL"),"")}}function fe(e,t){if(1&e&&(_.Vb(0),_.Xb(1,"label",43),_.Xc(2),_.Wb(),_.Ub()),2&e){var n=t.$implicit;_.Db(1),_.rc("nzValue",null==n?null:n.id),_.Db(1),_.Yc(null==n?null:n.episodeType)}}function he(e,t){if(1&e){var n=_.Yb();_.Xb(0,"div",2),_.Xb(1,"div",3),_.Sb(2,"br"),_.Sb(3,"br"),_.Xb(4,"h3"),_.Xc(5," This patient has some active episode(s) going on. Would you like to link this appointment with any of them? "),_.Wb(),_.Xb(6,"p"),_.Xb(7,"nz-radio-group",42),_.ec("ngModelChange",function(e){return _.Lc(n),_.ic().episodeId=e})("ngModelChange",function(){return _.Lc(n),_.ic().episodeIdUpdated()}),_.jc(8,"dateCompare"),_.Xb(9,"label",43),_.Xc(10,"None"),_.Wb(),_.Vc(11,fe,3,2,"ng-container",5),_.Wb(),_.Wb(),_.Wb(),_.Wb()}if(2&e){var i=_.ic();_.rc("nzGutter",24),_.Db(1),_.rc("nzSpan",24),_.Db(6),_.rc("ngModel",i.episodeId)("nzDisabled",!_.lc(8,7,null==i.appointment||null==i.appointment.schedule?null:i.appointment.schedule.startDate,"MONTH"))("nzDisabled",i.disableEpisodeSelection),_.Db(2),_.rc("nzValue",void 0),_.Db(2),_.rc("ngForOf",null==i.selectedPatient||null==i.selectedPatient.patientState||null==i.selectedPatient.patientState.episodeState?null:i.selectedPatient.patientState.episodeState.activeEpisodes)}}function ve(e,t){if(1&e&&(_.Vb(0),_.Sb(1,"nz-option",45),_.jc(2,"purposeLabel"),_.Ub()),2&e){var n=t.$implicit;_.Db(1),_.sc("nzLabel",_.kc(2,2,n)),_.rc("nzValue",n)}}function Se(e,t){1&e&&(_.Xb(0,"nz-option",31),_.Sb(1,"app-icons",32),_.Xc(2," Loading Data... "),_.Wb())}function ze(e,t){if(1&e){var n=_.Yb();_.Xb(0,"div",2),_.Xb(1,"div",3),_.Sb(2,"br"),_.Sb(3,"br"),_.Xb(4,"h3"),_.Xc(5," Appointment Type * "),_.Wb(),_.Xb(6,"p"),_.Xb(7,"nz-select",44),_.ec("ngModelChange",function(e){return _.Lc(n),_.ic().appointmentPurpose=e}),_.Vc(8,ve,3,4,"ng-container",5),_.Vc(9,Se,3,0,"nz-option",6),_.Wb(),_.Wb(),_.Wb(),_.Wb()}if(2&e){var i=_.ic();_.rc("nzGutter",24),_.Db(1),_.rc("nzSpan",8),_.Db(6),_.rc("nzShowSearch",!0)("ngModel",i.appointmentPurpose),_.Db(1),_.rc("ngForOf",i.appointmentPurposeList),_.Db(1),_.rc("ngIf",i.appointmentPurposeLoading)}}function Ae(e,t){if(1&e&&(_.Xb(0,"nz-option",25),_.Xb(1,"strong",50),_.Xc(2),_.Wb(),_.Wb()),2&e){var n=t.$implicit;_.rc("nzLabel",null==n?null:n.title)("nzValue",n),_.Db(2),_.Yc(null==n?null:n.title)}}function Te(e,t){1&e&&(_.Xb(0,"nz-option",31),_.Sb(1,"app-icons",32),_.Xc(2," Loading Data... "),_.Wb())}function Ie(e,t){if(1&e){var n=_.Yb();_.Vb(0),_.Sb(1,"br"),_.Sb(2,"br"),_.Xb(3,"div",14),_.Xb(4,"div",3),_.Xb(5,"h3"),_.Xc(6,"Assessments"),_.Wb(),_.Wb(),_.Wb(),_.Xb(7,"div",14),_.Xb(8,"div",3),_.Xb(9,"div",17),_.Xb(10,"nz-select",46),_.ec("ngModelChange",function(e){return _.Lc(n),_.ic().selectedFormBlueprints=e}),_.Vc(11,Ae,3,3,"nz-option",47),_.Vc(12,Te,3,0,"nz-option",6),_.Wb(),_.Xb(13,"div",48),_.Sb(14,"app-icons",49),_.Wb(),_.Wb(),_.Wb(),_.Wb(),_.Ub()}if(2&e){var i=_.ic();_.Db(4),_.rc("nzSpan",8),_.Db(4),_.rc("nzSpan",12),_.Db(2),_.rc("ngModel",i.selectedFormBlueprints),_.Db(1),_.rc("ngForOf",i.formBlueprints),_.Db(1),_.rc("ngIf",i.formBlueprintsLoading)}}var ye,De=((ye=function(e){o(i,e);var t=c(i);function i(e,a,o,r,c,s,l,p,d,u,b,m,g){var f;return n(this,i),(f=t.call(this))._location=e,f._usersService=a,f._appointmentsService=o,f._notificationsService=r,f._datePipe=c,f._dataSharingService=s,f._videoCallService=l,f._appointmentsEventLogger=p,f._activatedRoute=d,f._episodesEventLogger=u,f._formService=b,f._actionItemsService=m,f._noteTemplatesService=g,f.patients=[],f.patientsLoading=!1,f.appointmentPurposeLoading=!1,f.audioAppointmentEnabled=!1,f.primaryStaff=new Set,f.note=new X.a,f.severity="NORMAL",f.fromEpisode=!1,f.episodeType=null,f.config=P.b,f}return a(i,[{key:"ngOnInit",value:function(){var e=this;this.appointment=new S.b,this.appointment.schedule=new z.a,this.appointment.serviceIds=new Array,this._activatedRoute.params.forEach(function(t){e.patientId=t.id,e.patientId&&(e.disablePatientSelection=!0)}),this.episodeId=this._activatedRoute.snapshot.queryParams.episodeId,this.episodeId&&(this.disableEpisodeSelection=!0),this.fromEpisode=this._activatedRoute.snapshot.queryParams.fromEpisode,this.episodeType=this._activatedRoute.snapshot.queryParams.episodeType,this.patientId&&this.getPatientForAppointment(),"CARE_TAKER"===localStorage.getItem("loggedInUserAccountType")&&(this.isLoggedInUserCaretaker=!0),this.getTenantConfig(),this.fetchFormBlueprints()}},{key:"fetchFormBlueprints",value:function(){var e=this;this.formBlueprintsLoading=!0,this._formService.getFormsWithBody({phq9:!0,gad7:!0},0,9999999,"").subscribe(function(t){var n,i,a;(null===(n=null==t?void 0:t.data)||void 0===n?void 0:n.forms)&&(e.formBlueprints=null===(a=null===(i=null==t?void 0:t.data)||void 0===i?void 0:i.forms)||void 0===a?void 0:a.obj),e.formBlueprintsLoading=!1})}},{key:"getTenantConfig",value:function(){var e=this;this._dataSharingService.tenantSettings.pipe(Object(f.a)(this.unsubscribed)).subscribe(function(t){t&&(t.videoCallConfig&&t.videoCallConfig.enabled&&t.appointmentConfig.videoCallAppointment&&(e.videoAppointmentEnabled=!0,e.appointment.type=S.c.VIDEO_CALL),t.audioCallConfig&&t.audioCallConfig.enabled&&t.appointmentConfig.audioCallAppointment&&(e.audioAppointmentEnabled=!0,e.appointment.type=S.c.AUDIO_CALL))})}},{key:"getPatientForAppointment",value:function(){var e=this;this.patientsLoading=!0,this._appointmentsService.fetchPatientForAppointment(this.patientId).pipe(Object(f.a)(this.unsubscribed)).subscribe(function(t){e.patients=[t],e.setPatientId(t),e.patientsLoading=!1,e.episodeIdUpdated()})}},{key:"setPatientId",value:function(e){var t=this;e&&(this.selectedPatient=e,this.patientId=e.id,this.appointment.attendeeId=e.id,e.monitoringStaffs.primaryStaff.forEach(function(e){return t.primaryStaff.add(e)}),e.physicianStaffs.primaryStaff.forEach(function(e){return t.primaryStaff.add(e)}),this.searchCaretakers(),this.getNoteTemplates(e.tenantId))}},{key:"getUsersByQuery",value:function(e){var t=this;this.patientsLoading=!0,this._usersService.searchUsersByType(e,"PATIENT",10,0,null,[C.a.ACTIVE,C.a.REGISTERED]).subscribe(function(e){t.patients=e.body,t.patientsLoading=!1})}},{key:"onAppointmentScheduleChange",value:function(e){var t,n,i,a;this.caretakers$=void 0,this.selectedCaretaker=void 0,e.valid?(this.appointment.schedule.startsOn=null==e?void 0:e.startTime,this.appointment.schedule.startDate=null===(t=null==e?void 0:e.startTime)||void 0===t?void 0:t.getTime(),this.appointment.schedule.endDate=null===(n=null==e?void 0:e.endTime)||void 0===n?void 0:n.getTime(),this.appointment.dateParam=this._datePipe.transform(e.startTime,"yyyy-MM-dd"),function(e){return Object(O.a)(1,arguments),Object(E.a)(Date.now(),e)}(null===(a=null===(i=this.appointment)||void 0===i?void 0:i.schedule)||void 0===a?void 0:a.startDate)||(this.episodeId=void 0,this.appointmentPurpose=void 0),this.searchCaretakers()):(this.appointment.schedule.startsOn=void 0,this.appointment.schedule.startDate=void 0,this.appointment.schedule.endDate=void 0)}},{key:"validateCreateAppointmentForm",value:function(){return this.appointment.attendeeId&&this.appointment.schedule.startDate?!(!this.episodeId||this.appointmentPurpose||(this._notificationsService.error("Appointment","Please Select Appointment Type!"),0)):(this._notificationsService.error("Appointment","Please Fill All Fields Before Proceeding!"),!0)}},{key:"searchCaretakers",value:function(e){var t,n,i,a,o=null===(n=null===(t=this.appointment)||void 0===t?void 0:t.schedule)||void 0===n?void 0:n.startDate,r=null===(a=null===(i=this.appointment)||void 0===i?void 0:i.schedule)||void 0===a?void 0:a.endDate;this.caretakers$=this._appointmentsService.fetchAvailableCaretakers(o,r,0,10,e,this.patientId)}},{key:"save",value:function(){if(!this.validateCreateAppointmentForm())return this.isLoggedInUserCaretaker?(this.appointment.attenderId=localStorage.getItem("loggedInUser"),void this.create()):void(this.selectedCaretaker?(this.appointment.attenderId=this.selectedCaretaker.id,this.create()):this._notificationsService.error("Appointment","Please select a clinician before proceeding!"))}},{key:"createNoteForAppointment",value:function(e){return this._appointmentsService.createNewNoteForAppointment(e)}},{key:"create",value:function(){switch(this.appointment.episodeId=this.episodeId,this.appointment.appointmentPurpose=this.appointmentPurpose,this.appointment.tenantId=localStorage.getItem("loggedInTenant"),this.isLoggedInUserCaretaker&&(this.appointment.ownerType=S.a.CARE_TAKER),this.appointment.type){case S.c.VIDEO_CALL:this.createVideoAppointment();break;case S.c.HOME_VISIT:case S.c.AUDIO_CALL:case S.c.HOSPITAL_VISIT:default:this.createAppointment()}}},{key:"createAppointment",value:function(){var e=this;this._appointmentsEventLogger.appointmentCreateEvent(this.appointment.type,this.appointment),this._appointmentsService.createNewAppointment(this.appointment).subscribe(function(t){e._notificationsService.success("Appointment","Appointment Created Successfully!"),e.assignAssessments(t),e.addNoteToAppointment(t)})}},{key:"createVideoAppointment",value:function(){var e=this,t=new y.a,n=localStorage.getItem("loggedInUser");t.createdById=n,t.tenantId=localStorage.getItem("loggedInTenant"),t.participantIds=[this.appointment.attendeeId,n],t.env="prod",t.scheduled=!0,this._videoCallService.createVideoCallSessions(t).subscribe(function(t){e.appointment.videoCallSessionId=t.id,e._appointmentsEventLogger.appointmentCreateEvent(e.appointment.type,e.appointment),e._appointmentsService.createNewAppointment(e.appointment).subscribe(function(t){e._notificationsService.success("Appointment","Appointment Created Successfully!"),e.cancel(null==t?void 0:t.id)})})}},{key:"addNoteToAppointment",value:function(e){var t=this;this.note.content.length>0?(this.note.type="APPOINTMENT",this.note.userId=this.appointment.attendeeId,this.note.caretakerIds=new Array,this.note.caretakerIds.push(this.appointment.attenderId),this.note.priority={level:this.severity},this.note.contextId=e.id,this.createNoteForAppointment(this.note).subscribe(function(n){e.noteId=n.id,t._appointmentsService.updateAppointment(e).subscribe(function(){return t.cancel(e.id)})})):this.cancel(e.id)}},{key:"cancel",value:function(e){this.fromEpisode&&this._episodesEventLogger.episodeAppointmentsEvent(this.episodeId,this.patientId,e,"episode_add_appointment"),this._location.back()}},{key:"episodeIdUpdated",value:function(){var e,t,n,i,a=this;if(this.appointmentPurpose=void 0,null!=this.episodeId){var o=null===(i=null===(n=null===(t=null===(e=this.selectedPatient)||void 0===e?void 0:e.patientState)||void 0===t?void 0:t.episodeState)||void 0===n?void 0:n.activeEpisodes)||void 0===i?void 0:i.find(function(e){return e.id===a.episodeId});this.appointmentPurposeLoading=!0,this._appointmentsService.fetchAppointmentPurpose(o.episodeType).subscribe(function(e){a.appointmentPurposeList=e,a.appointmentPurposeLoading=!1})}}},{key:"setTemplate",value:function(e){this.note.content=e}},{key:"getNoteTemplates",value:function(e){this.noteTemplates$=this._noteTemplatesService.fetchNoteTemplates(0,100,null,e)}},{key:"selectLevel",value:function(e){this.severity=e}},{key:"assignAssessments",value:function(e){var t,n=this;(null===(t=this.selectedFormBlueprints)||void 0===t?void 0:t.length)&&(null==e?void 0:e.id)&&this.selectedFormBlueprints.forEach(function(t){n._formService.assignOnDemandForm(null==t?void 0:t._id,n.patientId,e.id).subscribe(function(e){var t;n._actionItemsService.archiveActionItem(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.id).subscribe()})})}}]),i}(h.a)).\u0275fac=function(e){return new(e||ye)(_.Rb(l.l),_.Rb(v.a),_.Rb(A.a),_.Rb(W.b),_.Rb(l.e),_.Rb(T.a),_.Rb(I.a),_.Rb(D.a),_.Rb(u.a),_.Rb(N.a),_.Rb(M.a),_.Rb(k.a),_.Rb(L.a))},ye.\u0275cmp=_.Lb({type:ye,selectors:[["app-create"]],features:[_.Cb([l.e]),_.Ab],decls:67,vars:50,consts:[[1,"appointments-card"],["nz-typography",""],["nz-row","",3,"nzGutter"],["nz-col","",3,"nzSpan"],["nzSize","large",1,"full-width",3,"nzShowSearch","ngModel","nzPlaceHolder","nzServerSearch","nzDisabled","nzCustomTemplate","ngModelChange","nzOnSearch"],[4,"ngFor","ngForOf"],["nzDisabled","","nzCustomContent","",4,"ngIf"],["defaultTemplate",""],[3,"appointmentScheduleChange"],["nz-row","",3,"nzGutter",4,"ngIf"],["nz-col","",3,"nzSpan",4,"ngIf"],[4,"ngIf"],[3,"ngModel","config","ngModelChange"],["noteEditor",""],["nz-row",""],["nz-col","","nzSpan","8"],[3,"note","onTemplateSelected"],[1,"heading-info-icon"],[1,"info-icon"],["name","infoCircle","nzTooltipTitle","Making your note important will make it highlighted and easily accessible, ensuring that you never miss an important point again.","nzTooltipPlacement","rightBottom","nz-tooltip","",1,"infoCirle"],[3,"ngModel","ngModelChange"],["nz-radio","","nzValue","IMPORTANT"],["nz-radio","","nzValue","NORMAL"],[1,"align-right"],["nzSize","large","nz-button","","nzType","primary",3,"click"],["nzCustomContent","",3,"nzLabel","nzValue"],[2,"display","flex"],[2,"width","70%"],[4,"isAccessAcrossTenantEnabled"],[2,"width","30%"],["nz-typography","","nzType","secondary",2,"color","var(--primary-color)"],["nzDisabled","","nzCustomContent",""],["name","loading","size","12px"],["nzSize","large",1,"full-width",3,"nzShowSearch","nzDisabled","ngModel","nzServerSearch","nzPlaceHolder","ngModelChange","nzOnSearch"],[4,"ngIf","ngIfElse"],["staffLoading",""],["style","width: 30%; text-align: right; color: var(--primary-color);",4,"ngIf"],[2,"width","30%","text-align","right","color","var(--primary-color)"],["nz-icon","","nzType","crown","nzTheme","outline",2,"font-size","14px"],["nz-radio-button","","nzValue","HOME_VISIT",3,"nzDisabled"],["nz-radio-button","","nzValue","VIDEO_CALL",3,"nzDisabled"],["nz-radio-button","","nzValue","AUDIO_CALL",3,"nzDisabled"],["nzSize","large",3,"ngModel","nzDisabled","ngModelChange"],["nz-radio","",3,"nzValue"],["nzSize","large","nzPlaceHolder","Select Type","nzAllowClear","",1,"full-width",3,"nzShowSearch","ngModel","ngModelChange"],[3,"nzLabel","nzValue"],["nzMode","multiple","nzPlaceHolder","Select an assessment form","nzAllowClear","","nzSize","large",3,"ngModel","ngModelChange"],["nzCustomContent","",3,"nzLabel","nzValue",4,"ngFor","ngForOf"],[1,"info-icon",2,"margin-top","10px"],["name","infoCircle","nzTooltipTitle","If you would like to complete one or more assessments during the appointment on behalf of the patient, select them from the options below.","nzTooltipPlacement","rightBottom","nz-tooltip","",1,"infoCirle"],["nz-typography","","nzType","secondary"]],template:function(e,t){if(1&e&&(_.Xb(0,"nz-card",0),_.Xb(1,"h2",1),_.Xc(2),_.jc(3,"translate"),_.Wb(),_.Sb(4,"nz-divider"),_.Sb(5,"br"),_.Xb(6,"div",2),_.Xb(7,"div",3),_.Xb(8,"strong"),_.Xc(9),_.jc(10,"translate"),_.jc(11,"translate"),_.Wb(),_.Wb(),_.Xb(12,"div",3),_.Xb(13,"strong"),_.Xc(14),_.jc(15,"translate"),_.Wb(),_.Wb(),_.Wb(),_.Xb(16,"div",2),_.Xb(17,"div",3),_.Xb(18,"nz-select",4),_.ec("ngModelChange",function(e){return t.selectedPatient=e})("ngModelChange",function(e){return t.setPatientId(e)})("nzOnSearch",function(e){return t.getUsersByQuery(e)}),_.jc(19,"translate"),_.Vc(20,oe,8,13,"ng-container",5),_.Vc(21,re,3,0,"nz-option",6),_.Wb(),_.Vc(22,se,2,1,"ng-template",null,7,_.Wc),_.Wb(),_.Xb(24,"div",3),_.Xb(25,"app-appointment-datetimepicker",8),_.ec("appointmentScheduleChange",function(e){return t.onAppointmentScheduleChange(e)}),_.Wb(),_.Wb(),_.Wb(),_.Sb(26,"br"),_.Sb(27,"br"),_.Sb(28,"br"),_.Vc(29,le,7,11,"div",9),_.Xb(30,"div",2),_.Vc(31,me,7,12,"div",10),_.Vc(32,ge,11,14,"div",10),_.Wb(),_.Vc(33,he,12,10,"div",9),_.Vc(34,ze,10,6,"div",9),_.jc(35,"dateCompare"),_.Vc(36,Ie,15,5,"ng-container",11),_.Sb(37,"br"),_.Sb(38,"br"),_.Xb(39,"div",2),_.Xb(40,"div",3),_.Xb(41,"strong"),_.Xc(42,"Notes"),_.Wb(),_.Xb(43,"angular-editor",12,13),_.ec("ngModelChange",function(e){return t.note.content=e}),_.Wb(),_.Wb(),_.Wb(),_.Sb(45,"br"),_.Xb(46,"div",14),_.Xb(47,"div",15),_.Xb(48,"app-note-template-picker",16),_.ec("onTemplateSelected",function(e){return t.setTemplate(e)}),_.Wb(),_.Wb(),_.Wb(),_.Sb(49,"br"),_.Xb(50,"div",17),_.Xc(51),_.jc(52,"translate"),_.Xb(53,"div",18),_.Sb(54,"app-icons",19),_.Wb(),_.Wb(),_.Xb(55,"nz-radio-group",20),_.ec("ngModelChange",function(e){return t.severity=e})("ngModelChange",function(e){return t.selectLevel(e)}),_.Xb(56,"label",21),_.Xc(57,"Yes"),_.Wb(),_.Xb(58,"label",22),_.Xc(59,"No"),_.Wb(),_.Wb(),_.Sb(60,"br"),_.Sb(61,"br"),_.Xb(62,"div"),_.Xb(63,"div",23),_.Xb(64,"button",24),_.ec("click",function(){return t.save()}),_.Xc(65),_.jc(66,"translate"),_.Wb(),_.Wb(),_.Wb(),_.Wb()),2&e){var n=_.Ic(23);_.Db(2),_.Yc(_.kc(3,33,"COMMON.APPOINTMENTDETAILS")),_.Db(4),_.rc("nzGutter",24),_.Db(1),_.rc("nzSpan",8),_.Db(2),_.ad("",_.kc(10,35,"PATIENT.NAME")," - ",_.kc(11,37,"TABLEHEADER.DOB"),""),_.Db(3),_.rc("nzSpan",8),_.Db(2),_.Yc(_.kc(15,39,"COMMON.DATE_TIME")),_.Db(2),_.rc("nzGutter",24),_.Db(1),_.rc("nzSpan",8),_.Db(1),_.sc("nzPlaceHolder",_.kc(19,41,"PATIENT.SEARCH")),_.rc("nzShowSearch",!0)("ngModel",t.selectedPatient)("nzServerSearch",!0)("nzDisabled",t.disablePatientSelection)("nzCustomTemplate",n),_.Db(2),_.rc("ngForOf",t.patients),_.Db(1),_.rc("ngIf",t.patientsLoading),_.Db(3),_.rc("nzSpan",8),_.Db(5),_.rc("ngIf",!t.isLoggedInUserCaretaker),_.Db(1),_.rc("nzGutter",24),_.Db(1),_.rc("ngIf",!t.isLoggedInUserCaretaker),_.Db(1),_.rc("ngIf",!1),_.Db(1),_.rc("ngIf",!(null==t.selectedPatient||null==t.selectedPatient.patientState||null==t.selectedPatient.patientState.episodeState||null==t.selectedPatient.patientState.episodeState.activeEpisodes||!t.selectedPatient.patientState.episodeState.activeEpisodes.length)),_.Db(1),_.rc("ngIf",_.lc(35,43,t.episodeId&&(null==t.appointment||null==t.appointment.schedule?null:t.appointment.schedule.startDate),"MONTH")),_.Db(2),_.rc("ngIf",t.episodeId&&"BHI"==t.episodeType||"GENERAL"==t.episodeType||"CCM"==t.episodeType),_.Db(3),_.rc("nzGutter",16),_.Db(1),_.rc("nzSpan",24),_.Db(3),_.rc("ngModel",t.note.content)("config",t.config),_.Db(5),_.rc("note",t.note.content),_.Db(3),_.Zc(" ",_.kc(52,46,"MAKE_IMPORTANT_NOTES")," "),_.Db(4),_.rc("ngModel",t.severity),_.Db(10),_.Zc(" ",t.isLoggedInUserCaretaker?"Create":_.kc(66,48,"APPOINTMENT.APPROVE")," ")}},directives:[R.a,w.a,V.a,F.c,F.a,x.d,b.u,b.x,l.p,l.q,j.a,U.a,H.a,B.a,Y.d,$.c,$.b,q.a,Q.a,Z.a,x.a,K.a,G.a,$.a],pipes:[J.a,ee.a,l.e,te.a,l.b,ne.a,ie.a],styles:["[_nghost-%COMP%]     .ant-picker-large .ant-picker-input>input, [_nghost-%COMP%]     .ant-select, [_nghost-%COMP%]     .ant-select-selection-placeholder{font-size:14px!important}.full-width[_ngcontent-%COMP%], [_nghost-%COMP%]     .ant-calendar-picker{width:100%!important}.appointments-card[_ngcontent-%COMP%]{margin:2%;padding:2%}.align-right[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;text-align:right;margin-top:1vw}.heading-info-icon[_ngcontent-%COMP%]{display:flex}.info-icon[_ngcontent-%COMP%]{margin-left:10px}"]}),ye),Ce=r("DfQf"),Ee=r("Gskk"),Oe=r("M34a"),Xe=r("piIK"),Pe=r("9ig3"),Ne=r("jKzE"),Me=r("pLZG"),ke=r("ix5O");function Le(e,t){if(1&e&&_.Sb(0,"nz-option",11),2&e){var n=t.$implicit;_.uc("nzLabel","",null==n?null:n.firstName," ",null==n?null:n.lastName,""),_.rc("nzValue",n)}}function _e(e,t){if(1&e&&(_.Vb(0),_.Vc(1,Le,1,3,"nz-option",10),_.Ub()),2&e){var n=_.ic();_.Db(1),_.rc("ngForOf",n.caretakers)}}function We(e,t){1&e&&(_.Xb(0,"nz-option",12),_.Sb(1,"app-icons",13),_.Xc(2," Loading Data... "),_.Wb())}var Re,we,Ve,Fe=((Re=function(){function e(t){n(this,e),this._appointmentsService=t}return a(e,[{key:"disabledStartHours",value:function(){var e=this;return Array.from(Array(24).keys()).filter(function(t){var n;return t<(null===(n=new Date(e.dateTime))||void 0===n?void 0:n.getHours())})}},{key:"disabledEndHours",value:function(){var e=this;return Array.from(Array(24).keys()).filter(function(t){var n;return t<(null===(n=e.startTime)||void 0===n?void 0:n.getHours())})}},{key:"disabledStartMins",value:function(){var e=this;return Array.from(Array(60).keys()).filter(function(t){var n;return t<(null===(n=new Date(e.dateTime))||void 0===n?void 0:n.getMinutes())})}},{key:"disabledEndMins",value:function(){var e=this;return Array.from(Array(60).keys()).filter(function(t){var n;return t<(null===(n=e.startTime)||void 0===n?void 0:n.getMinutes())})}},{key:"ngOnInit",value:function(){this.startTime=this.dateTime,this.endTime=this.dateTime}},{key:"onTimeChange",value:function(){this.selectedCaretaker=null,this.searchCaretakers("")}},{key:"searchCaretakers",value:function(e){var t,n,i=this;this.loading=!0,this._appointmentsService.fetchAvailableCaretakers(null===(t=this.startTime)||void 0===t?void 0:t.getTime(),null===(n=this.endTime)||void 0===n?void 0:n.getTime(),0,10,e).subscribe(function(e){i.caretakers=e,i.loading=!1})}}]),e}()).\u0275fac=function(e){return new(e||Re)(_.Rb(A.a))},Re.\u0275cmp=_.Lb({type:Re,selectors:[["app-confirmation"]],inputs:{dateTime:"dateTime"},decls:14,vars:15,consts:[["nz-row","","nzGutter","16"],["nz-col","","nzSpan","6"],["nzFormat","HH:mm","nzMinuteStep","5","nzPlaceHolder","Start Time",1,"actions",3,"ngModel","nzDisabledHours","nzDisabledMinutes","ngModelChange"],["nzFormat","HH:mm","nzMinuteStep","5","nzPlaceHolder","End Time",1,"actions",3,"ngModel","nzDisabledHours","nzDisabledMinutes","ngModelChange"],["nz-col","","nzSpan","12"],[1,"actions",3,"nzShowSearch","nzPlaceHolder","ngModel","nzServerSearch","nzDisabled","ngModelChange","nzOnSearch"],[4,"ngIf"],["nzDisabled","","nzCustomContent","",4,"ngIf"],["nz-typography","","nzType","secondary"],["name","infoCircle","size","12px"],[3,"nzLabel","nzValue",4,"ngFor","ngForOf"],[3,"nzLabel","nzValue"],["nzDisabled","","nzCustomContent",""],["name","loading","size","12px"]],template:function(e,t){1&e&&(_.Xb(0,"div",0),_.Xb(1,"div",1),_.Xb(2,"nz-time-picker",2),_.ec("ngModelChange",function(e){return t.startTime=e})("ngModelChange",function(){return t.onTimeChange()}),_.Wb(),_.Wb(),_.Xb(3,"div",1),_.Xb(4,"nz-time-picker",3),_.ec("ngModelChange",function(e){return t.endTime=e})("ngModelChange",function(){return t.onTimeChange()}),_.Wb(),_.Wb(),_.Xb(5,"div",4),_.Xb(6,"nz-select",5),_.ec("ngModelChange",function(e){return t.selectedCaretaker=e})("nzOnSearch",function(e){return t.searchCaretakers(e)}),_.jc(7,"translate"),_.Vc(8,_e,2,1,"ng-container",6),_.Vc(9,We,3,0,"nz-option",7),_.Wb(),_.Wb(),_.Wb(),_.Sb(10,"br"),_.Xb(11,"em",8),_.Sb(12,"app-icons",9),_.Xc(13," Please choose a suitable start time and end time for the appointment to get the list of available staff members\n"),_.Wb()),2&e&&(_.Db(2),_.rc("ngModel",t.startTime)("nzDisabledHours",t.disabledStartHours)("nzDisabledMinutes",t.disabledStartMins),_.Db(2),_.rc("ngModel",t.endTime)("nzDisabledHours",t.disabledEndHours)("nzDisabledMinutes",t.disabledEndMins),_.Db(2),_.sc("nzPlaceHolder",_.kc(7,13,"COMMON.AVAILABLE_CLINICIANS")),_.rc("nzShowSearch",!0)("ngModel",t.selectedCaretaker)("nzServerSearch",!0)("nzDisabled",!t.endTime),_.Db(2),_.rc("ngIf",!t.loading),_.Db(1),_.rc("ngIf",t.loading))},directives:[F.c,F.a,ke.a,b.u,b.x,x.d,l.q,w.a,B.a,l.p,x.a],pipes:[J.a],styles:[".actions[_ngcontent-%COMP%]{width:100%}"]}),Re),xe=r("dEAy"),je=r("PTRe"),Ue=function(){return{minRows:6}},He=((we=function(){function e(t){n(this,e),this._modalRef=t}return a(e,[{key:"addReason",value:function(){this._modalRef.close(this.reason)}}]),e}()).\u0275fac=function(e){return new(e||we)(_.Rb(xe.e))},we.\u0275cmp=_.Lb({type:we,selectors:[["app-add-reason"]],inputs:{reason:"reason"},decls:11,vars:12,consts:[["nz-typography",""],["nz-input","",3,"placeholder","ngModel","nzAutosize","ngModelChange"],["nz-button","","nzType","primary",1,"add-reason-button",3,"click"]],template:function(e,t){1&e&&(_.Xb(0,"h2",0),_.Xc(1),_.jc(2,"translate"),_.Wb(),_.Sb(3,"nz-divider"),_.Xb(4,"textarea",1),_.ec("ngModelChange",function(e){return t.reason=e}),_.jc(5,"translate"),_.Wb(),_.Sb(6,"br"),_.Sb(7,"br"),_.Xb(8,"button",2),_.ec("click",function(){return t.addReason()}),_.Xc(9),_.jc(10,"translate"),_.Wb()),2&e&&(_.Db(1),_.Yc(_.kc(2,5,"COMMON.ADDREASON")),_.Db(3),_.sc("placeholder",_.kc(5,7,"APPOINTMENT.ADDREASON")),_.rc("ngModel",t.reason)("nzAutosize",_.xc(11,Ue)),_.Db(5),_.Yc(_.kc(10,9,"COMMON.ADD")))},directives:[w.a,V.a,je.b,b.d,je.a,b.u,b.x,q.a,Q.a,Z.a],pipes:[J.a],styles:[".add-reason-button[_ngcontent-%COMP%]{margin-left:90%;width:10%}"]}),we),Be=function e(){n(this,e)},Ye=function(e){return e.PENDING="PENDING",e.REJECTED="REJECTED",e.APPROVED="APPROVED",e.DELETED="DELETED",e.FINISHED="FINISHED",e.ALL="ALL",e.ON_HOLD="ON_HOLD",e}({}),$e=r("FWPb"),qe=r("QBjw"),Qe=r("FVa/"),Ze=r("xnfs"),Ke=((Ve=function(e){o(i,e);var t=c(i);function i(e,a,o){var r;return n(this,i),(r=t.call(this))._smsService=e,r._notificationsService=a,r._modalRef=o,r}return a(i,[{key:"validateMessage",value:function(){return this.message||this._notificationsService.error("SMS","Message cannot be empty!"),!!this.message}},{key:"sendSMS",value:function(){var e=this;if(this.validateMessage){var t=new Ze.a;t.message=this.message,t.toUsers=[this.patientId],t.fromUser=localStorage.getItem("loggedInUser"),this._smsService.sendSms(t).subscribe(function(){e._notificationsService.success("SMS","SMS sent successfully!"),e._modalRef.close(!0)})}}}]),i}(h.a)).\u0275fac=function(e){return new(e||Ve)(_.Rb(Qe.a),_.Rb(W.b),_.Rb(xe.e))},Ve.\u0275cmp=_.Lb({type:Ve,selectors:[["app-sms-sender"]],inputs:{patientId:"patientId",message:"message"},features:[_.Ab],decls:9,vars:4,consts:[["nz-row",""],["nz-col","","nzSpan","24"],["rows","4","nz-input","",3,"ngModel","ngModelChange"],["nz-col","","nzSpan","7","nzOffset","19"],["nz-button","","nzType","primary",3,"click"]],template:function(e,t){1&e&&(_.Xb(0,"div",0),_.Xb(1,"div",1),_.Xb(2,"textarea",2),_.ec("ngModelChange",function(e){return t.message=e}),_.Wb(),_.Wb(),_.Wb(),_.Sb(3,"br"),_.Xb(4,"div",0),_.Xb(5,"div",3),_.Xb(6,"button",4),_.ec("click",function(){return t.sendSMS()}),_.Xc(7),_.jc(8,"translate"),_.Wb(),_.Wb(),_.Wb()),2&e&&(_.Db(2),_.rc("ngModel",t.message),_.Db(5),_.Zc(" ",_.kc(8,2,"SMS.SEND_SMS")," "))},directives:[F.c,F.a,je.b,b.d,b.u,b.x,q.a,Q.a,Z.a],pipes:[J.a],styles:["textarea[_ngcontent-%COMP%]{resize:none}"]}),Ve),Ge=r("WoUL"),Je=function(){var e=function e(){n(this,e)};return e.APPOINTMENT_CREATE_STRINGS=new Array("APPOINTMENT.CONFIRM_APPOINTMENT","VIDEO_CALL","EPISODE.HOMEVISIT","AUDIO_CALL","FORM.APPOINTMENT","APPOINTMENT.NO_CLINICIAN_SELECTED","APPOINTMENT.CLINICIAN_ADDED_APPOINTMENT_APPROVED","APPOINTMENT.REJECT_APPOINTMENT","APPOINTMENT.REJECT_APPOINTMENT_POPUP","APPOINTMENT.MARKED_REJECTED","APPOINTMENT.DELETE_APPOINTMENT","APPOINTMENT.REMOVE_APPOINTMENT","APPOINTMENT.APPOINTMENT_DELETE","APPOINTMENT.REASON_ADDED_SUCCESSFULLY","VIDEOCALL.ERROR.APPOINTMENT_FUTURE_SCHEDULE","VIDEOCALL.ERROR.ALREADY_IN_CALL","VIDEOCALL.ERROR.ALREADY_ANOTHER_CALL","VIDEOCALL.ERROR.POPUP_BLOCKED","VIDEOCALL.ERROR.POPUP_BLOCKER_MESSAGE","COMMON.INVALID_SESSION","COMMON.SESSION_EXPIRED"),e}(),et=r("gssi"),tt=r("HZ0a"),nt=r("7t9/"),it=r("2lmJ"),at=r("nLCl"),ot=r("KC2T"),rt=r("4RGM");function ct(e,t){if(1&e&&(_.Xb(0,"span"),_.Xc(1),_.Wb()),2&e){var n=_.ic();_.Db(1),_.ad(" between ",n.dateRange[0].toISOString().slice(0,10)," and ",n.dateRange[1].toISOString().slice(0,10)," ")}}var st,lt=((st=function(){function e(t,i,a){n(this,e),this._modalRef=t,this._appointmentsService=i,this._notificationsService=a,this.dateRange=null,this.loadingDelete=!1}return a(e,[{key:"ngOnInit",value:function(){}},{key:"cancel",value:function(){this._modalRef.destroy(!1)}},{key:"deleteAppointments",value:function(){var e,t,n,i,a,o,r=this;this.loadingDelete=!0,this.activeRoleName=localStorage.getItem("loggedInUserRoleName"),this.dateRange&&this.dateRange[0]&&(a=this.datePreset?null===(e=this.dateRange[0])||void 0===e?void 0:e.getTime():null===(t=Object(Oe.a)(this.dateRange[0]))||void 0===t?void 0:t.getTime()),this.dateRange&&this.dateRange[1]&&(o=this.datePreset?null===(n=this.dateRange[1])||void 0===n?void 0:n.getTime():null===(i=Object(Xe.a)(this.dateRange[1]))||void 0===i?void 0:i.getTime()),this._appointmentsService.deleteAppointments(0,1e3,null,null,a,o,null,null,this.requestTenantIds).subscribe(function(){r.loadingDelete=!1,r._modalRef.destroy(!0),r._notificationsService.success("Clear Appointments","Appointments deleted successfully!")},function(e){r._notificationsService.error("Clear Appointments","Error while deleting appointments."),r._modalRef.destroy(!1)})}}]),e}()).\u0275fac=function(e){return new(e||st)(_.Rb(xe.e),_.Rb(A.a),_.Rb(W.b))},st.\u0275cmp=_.Lb({type:st,selectors:[["app-delete-appointments"]],inputs:{dateRange:"dateRange",datePreset:"datePreset",requestTenantIds:"requestTenantIds"},decls:12,vars:2,consts:[[4,"ngIf"],[1,"btn-container"],["nz-button","","nzType","primary",3,"nzLoading","click"],["nz-button","","nzType","default",2,"margin-left","10px",3,"click"]],template:function(e,t){1&e&&(_.Vb(0),_.Xb(1,"h3"),_.Xc(2," Clear Appointments"),_.Wb(),_.Xb(3,"p"),_.Xc(4,"Are you sure you want to clear all un-attended appointments"),_.Vc(5,ct,2,2,"span",0),_.Xc(6,"? This action cannot be reversed. "),_.Wb(),_.Xb(7,"div",1),_.Xb(8,"button",2),_.ec("click",function(){return t.deleteAppointments()}),_.Xc(9," Yes "),_.Wb(),_.Xb(10,"button",3),_.ec("click",function(){return t.cancel()}),_.Xc(11," No "),_.Wb(),_.Wb(),_.Ub()),2&e&&(_.Db(5),_.rc("ngIf",t.dateRange[0]&&t.dateRange[1]),_.Db(3),_.rc("nzLoading",t.loadingDelete))},directives:[l.q,q.a,Q.a,Z.a],styles:[".btn-container[_ngcontent-%COMP%]{margin-top:30px;display:flex;justify-content:flex-end}"]}),st),pt=r("BoNt"),dt=r("oyxB"),ut=r("0lU3"),bt=r("rMZv"),mt=r("ZKr6"),gt=r("ALyH"),ft=r("wjar"),ht=r("0zwC"),vt=r("Ujc4"),St=r("QlLE");function zt(e,t){if(1&e&&_.Sb(0,"app-staff-sub-tenants",38),2&e){var n=_.ic(3);_.rc("staffName",n.selectedStaffDetail.fullName)("assignedTenantIds",n.selectedStaffDetail.assignedTenantIds)}}function At(e,t){if(1&e&&(_.Vb(0),_.Vc(1,zt,1,2,"app-staff-sub-tenants",37),_.Ub()),2&e){var n=_.ic(2);_.Db(1),_.rc("ngIf",n.selectedStaffDetail)}}function Tt(e,t){1&e&&(_.Vb(0),_.Vc(1,At,2,1,"ng-container",16),_.Ub())}function It(e,t){if(1&e&&_.Sb(0,"nz-option",40),2&e){var n=t.$implicit;_.rc("nzValue",null==n?null:n.id)("nzLabel",null==n?null:n.name)}}function yt(e,t){if(1&e&&(_.Vb(0),_.Vc(1,It,1,2,"nz-option",39),_.Ub()),2&e){var n=_.ic();_.Db(1),_.rc("ngForOf",n.siteList)}}function Dt(e,t){1&e&&(_.Xb(0,"nz-option",41),_.Sb(1,"span",42),_.Xc(2," Loading Data... "),_.Wb())}function Ct(e,t){if(1&e&&_.Sb(0,"nz-option",40),2&e){var n=t.$implicit;_.rc("nzValue",null==n?null:n.id)("nzLabel",null==n?null:n.fullName)}}function Et(e,t){if(1&e&&(_.Vb(0),_.Vc(1,Ct,1,2,"nz-option",39),_.Ub()),2&e){var n=_.ic();_.Db(1),_.rc("ngForOf",n.staffList)}}function Ot(e,t){1&e&&(_.Xb(0,"nz-option",41),_.Sb(1,"span",42),_.Xc(2," Loading Data... "),_.Wb())}function Xt(e,t){1&e&&(_.Xb(0,"th"),_.Xc(1," Sub Tenant "),_.Wb())}function Pt(e,t){if(1&e&&_.Sb(0,"app-icons",58),2&e){var n=_.ic(3);_.rc("nzTooltipTitle",n.timerRunning?"End Appointment Timer":"Start Appointment Timer")}}function Nt(e,t){if(1&e){var n=_.Yb();_.Xb(0,"span"),_.Xb(1,"a",56),_.ec("click",function(){_.Lc(n);var e=_.ic().$implicit;return _.ic().startTimer(e)}),_.Vc(2,Pt,1,1,"app-icons",57),_.Wb(),_.Wb()}if(2&e){var i=_.ic().$implicit,a=_.ic();_.Db(1),_.rc("disabled",!(null!=i&&i.enabled)),_.Db(1),_.rc("ngIf",!(a.timerRunning||null!=a.timedAppointment&&a.timedAppointment.attendeeId))}}function Mt(e,t){1&e&&_.Sb(0,"app-icons",62)}function kt(e,t){if(1&e&&(_.Xb(0,"span",59),_.Xb(1,"a",60),_.Vc(2,Mt,1,0,"app-icons",61),_.Wb(),_.Wb()),2&e){var n=_.ic(2);_.rc("nzTooltipTitle","Timer will be enabled on the day of the appointment"),_.Db(1),_.rc("disabled",!0),_.Db(1),_.rc("ngIf",!(n.timerRunning||null!=n.timedAppointment&&n.timedAppointment.attendeeId))}}function Lt(e,t){if(1&e){var n=_.Yb();_.Vb(0),_.Xb(1,"app-audio-call-widget",63),_.ec("click",function(){_.Lc(n);var e=_.ic().$implicit;return _.ic().logAction("audio_call",null==e?null:e.attendeeId)}),_.Wb(),_.Ub()}if(2&e){var i=_.ic().$implicit;_.Db(1),_.rc("userId",null==i?null:i.attendeeId)("phoneNumbers",null==i?null:i.phoneNumbers)("disabled",!1)("renderVital",!1)("appointmentId",null==i?null:i.id)}}function _t(e,t){if(1&e&&(_.Xb(0,"td"),_.Xc(1),_.jc(2,"tenantName"),_.Wb()),2&e){var n=_.ic().$implicit;_.Db(1),_.Zc(" ",_.kc(2,1,n.tenantId)," ")}}function Wt(e,t){if(1&e){var n=_.Yb();_.Xb(0,"app-icons",65),_.ec("click",function(){_.Lc(n);var e=_.ic(2).$implicit;return _.ic().initiateVideoCall(null==e?null:e.attendeeId,e)}),_.Wb()}}var Rt=function(){return["VIDEO_CALL"]};function wt(e,t){1&e&&(_.Vb(0),_.Vc(1,Wt,1,0,"app-icons",64),_.Sb(2,"nz-divider",50),_.Ub()),2&e&&(_.Db(1),_.rc("isFeaturePermitted",_.xc(1,Rt)))}function Vt(e,t){if(1&e){var n=_.Yb();_.Xb(0,"app-icons",66),_.ec("click",function(){_.Lc(n);var e=_.ic().$implicit;return _.ic().viewAppointmentDetails(null==e?null:e.id)}),_.Wb()}}function Ft(e,t){if(1&e){var n=_.Yb();_.Xb(0,"app-icons",67),_.ec("click",function(){_.Lc(n);var e=_.ic().$implicit;return _.ic().rescheduleAppointment(e)}),_.Wb()}}function xt(e,t){if(1&e){var n=_.Yb();_.Xb(0,"app-icons",68),_.ec("click",function(){_.Lc(n);var e=_.ic().$implicit;return _.ic().deleteAppointment(null==e?null:e.id)}),_.Wb()}}var jt=function(){return["VIEW_APPOINTMENT"]},Ut=function(){return["RESCHEDULE_APPOINTMENT"]},Ht=function(){return["DELETE_APPOINTMENT"]};function Bt(e,t){if(1&e){var n=_.Yb();_.Xb(0,"tr"),_.Xb(1,"td"),_.Vb(2),_.Vc(3,Nt,3,2,"span",5),_.jc(4,"dateCompare"),_.Vc(5,kt,3,3,"span",43),_.jc(6,"dateCompare"),_.Ub(),_.Wb(),_.Xb(7,"td"),_.Xc(8),_.Wb(),_.Xb(9,"td",44),_.Xb(10,"span",45),_.Xc(11),_.Wb(),_.Wb(),_.Xb(12,"td"),_.Sb(13,"app-patient-status-tag",46),_.Wb(),_.Xb(14,"td"),_.Vc(15,Lt,2,5,"ng-container",5),_.Xb(16,"app-icons",47),_.ec("click",function(){_.Lc(n);var e=t.$implicit;return _.ic().sendSMS(null==e?null:e.attendeeId,null==e?null:e.attenderName,null==e||null==e.schedule?null:e.schedule.startDate,null==e?null:e.type,null==e?null:e.id)}),_.Wb(),_.Wb(),_.Vc(17,_t,3,3,"td",16),_.Xb(18,"td",48),_.Xb(19,"span",45),_.Xc(20),_.Wb(),_.Wb(),_.Xb(21,"td"),_.Xc(22),_.jc(23,"date"),_.Wb(),_.Xb(24,"td"),_.Xb(25,"span",45),_.jc(26,"purposeLabel"),_.Xc(27),_.jc(28,"purposeLabel"),_.Wb(),_.Wb(),_.Xb(29,"td"),_.Xc(30),_.Wb(),_.Xb(31,"td",19),_.Vb(32),_.Xb(33,"app-icons",49),_.ec("click",function(){_.Lc(n);var e=t.$implicit;return _.ic().showHistory("NON_COMPLEX_TMS",e)}),_.Wb(),_.Sb(34,"nz-divider",50),_.Ub(),_.Vc(35,wt,3,2,"ng-container",5),_.Vc(36,Vt,1,0,"app-icons",51),_.Sb(37,"nz-divider",50),_.Vc(38,Ft,1,0,"app-icons",52),_.Sb(39,"nz-divider",50),_.Vc(40,xt,1,0,"app-icons",53),_.Sb(41,"nz-divider",50),_.Xb(42,"app-icons",54),_.ec("click",function(){_.Lc(n);var e=t.$implicit;return _.ic().showNotesHistory(e)}),_.Wb(),_.Sb(43,"nz-divider",50),_.Xb(44,"app-icons",55),_.ec("click",function(){_.Lc(n);var e=t.$implicit;return _.ic().gotoManageEpisodes(null==e?null:e.episodeId,null==e?null:e.attendeeId)}),_.Wb(),_.Wb(),_.Wb()}if(2&e){var i=t.$implicit,a=_.ic();_.Db(3),_.rc("ngIf",_.lc(4,18,null==i||null==i.schedule?null:i.schedule.startDate,"TODAY")),_.Db(2),_.rc("ngIf",!_.lc(6,21,null==i||null==i.schedule?null:i.schedule.startDate,"TODAY")),_.Db(3),_.Yc((null==i?null:i.episodeType)||"N/A"),_.Db(1),_.tc("routerLink","/patient/view/",null==i?null:i.attendeeId,""),_.Db(1),_.sc("nzTooltipTitle",(null==i?null:i.attendeeName)||"N/A"),_.Db(1),_.Zc(" ",(null==i?null:i.attendeeName)||"N/A"," "),_.Db(2),_.rc("patientStatus",null==i?null:i.patientStatus),_.Db(2),_.rc("ngIf","AUDIO_CALL"===(null==i?null:i.type)&&a.isCallButtonEnabled),_.Db(4),_.sc("nzTooltipTitle",(null==i?null:i.attenderName)||"N/A"),_.Db(1),_.Zc(" ",(null==i?null:i.attenderName)||"N/A"," "),_.Db(2),_.Yc(_.lc(23,24,null==i||null==i.schedule?null:i.schedule.startDate,"MMM dd, hh:mm a")),_.Db(3),_.sc("nzTooltipTitle",_.kc(26,27,null==i?null:i.appointmentPurpose)),_.Db(2),_.Zc(" ",_.kc(28,29,null==i?null:i.appointmentPurpose)," "),_.Db(3),_.Yc(null==i?null:i.attemptCount),_.Db(5),_.rc("ngIf","VIDEO_CALL"===(null==i?null:i.type)&&a.isCallButtonEnabled),_.Db(1),_.rc("isFeaturePermitted",_.xc(31,jt)),_.Db(2),_.rc("isFeaturePermitted",_.xc(32,Ut)),_.Db(2),_.rc("isFeaturePermitted",_.xc(33,Ht))}}function Yt(e,t){1&e&&(_.Xb(0,"th"),_.Xc(1," Sub Tenant "),_.Wb())}function $t(e,t){if(1&e&&(_.Xb(0,"td"),_.Xc(1),_.jc(2,"tenantName"),_.Wb()),2&e){var n=_.ic().$implicit;_.Db(1),_.Zc(" ",_.kc(2,1,n.tenantId)," ")}}function qt(e,t){if(1&e){var n=_.Yb();_.Xb(0,"app-icons",70),_.ec("click",function(){_.Lc(n);var e=_.ic().$implicit;return _.ic().viewAppointmentDetails(null==e?null:e.id)}),_.Wb()}}function Qt(e,t){if(1&e&&(_.Xb(0,"tr"),_.Xb(1,"td"),_.Xc(2),_.Wb(),_.Xb(3,"td"),_.Xc(4),_.Wb(),_.Xb(5,"td"),_.Sb(6,"app-patient-status-tag",46),_.Wb(),_.Vc(7,$t,3,3,"td",16),_.Xb(8,"td",48),_.Xc(9),_.Wb(),_.Xb(10,"td"),_.Xc(11),_.jc(12,"date"),_.Wb(),_.Xb(13,"td"),_.Xc(14),_.jc(15,"purposeLabel"),_.Wb(),_.Xb(16,"td"),_.Xc(17),_.Wb(),_.Xb(18,"td",19),_.Vc(19,qt,1,0,"app-icons",69),_.Wb(),_.Wb()),2&e){var n=t.$implicit;_.Db(2),_.Yc(null==n?null:n.episodeType),_.Db(2),_.Yc((null==n?null:n.attendeeName)||"N/A"),_.Db(2),_.rc("patientStatus",null==n?null:n.patientStatus),_.Db(3),_.Yc((null==n?null:n.attenderName)||"N/A"),_.Db(2),_.Yc(_.lc(12,8,null==n||null==n.schedule?null:n.schedule.startDate,"MMM dd yyyy, hh:mm a")),_.Db(3),_.Yc(_.kc(15,11,null==n?null:n.appointmentPurpose)),_.Db(3),_.Yc(null==n?null:n.attemptCount),_.Db(2),_.rc("isFeaturePermitted",_.xc(13,jt))}}function Zt(e,t){if(1&e){var n=_.Yb();_.Xb(0,"div",71),_.Xb(1,"button",72),_.ec("click",function(){return _.Lc(n),_.ic().clearUnattendedAppointments()}),_.Xc(2," Clear Appointments "),_.Wb(),_.Wb()}if(2&e){var i=_.ic();_.Db(1),_.rc("disabled",0===i.unattendedAppointments.result.length)}}function Kt(e,t){1&e&&(_.Xb(0,"th"),_.Xc(1," Sub Tenant "),_.Wb())}function Gt(e,t){if(1&e&&(_.Xb(0,"td"),_.Xc(1),_.jc(2,"tenantName"),_.Wb()),2&e){var n=_.ic().$implicit;_.Db(1),_.Zc(" ",_.kc(2,1,n.tenantId)," ")}}function Jt(e,t){if(1&e){var n=_.Yb();_.Xb(0,"app-icons",70),_.ec("click",function(){_.Lc(n);var e=_.ic().$implicit;return _.ic().viewAppointmentDetails(null==e?null:e.id)}),_.Wb()}}function en(e,t){if(1&e){var n=_.Yb();_.Xb(0,"app-icons",74),_.ec("click",function(){_.Lc(n);var e=_.ic().$implicit;return _.ic().editReasonForUnattendedAppointment(e)}),_.Wb()}}function tn(e,t){if(1&e){var n=_.Yb();_.Xb(0,"app-icons",67),_.ec("click",function(){_.Lc(n);var e=_.ic(2).$implicit;return _.ic().rescheduleAppointment(e)}),_.Wb()}}function nn(e,t){1&e&&(_.Vb(0),_.Sb(1,"nz-divider",50),_.Vc(2,tn,1,0,"app-icons",52),_.Ub()),2&e&&(_.Db(2),_.rc("isFeaturePermitted",_.xc(1,Ut)))}var an=function(){return["EDIT_APPOINTMENT"]};function on(e,t){if(1&e&&(_.Xb(0,"tr"),_.Xb(1,"td"),_.Xc(2),_.Wb(),_.Xb(3,"td"),_.Xc(4),_.Wb(),_.Xb(5,"td"),_.Sb(6,"app-patient-status-tag",46),_.Wb(),_.Vc(7,Gt,3,3,"td",16),_.Xb(8,"td",48),_.Xc(9),_.Wb(),_.Xb(10,"td"),_.Xc(11),_.jc(12,"date"),_.Wb(),_.Xb(13,"td"),_.Xc(14),_.jc(15,"purposeLabel"),_.Wb(),_.Xb(16,"td"),_.Xc(17),_.Wb(),_.Xb(18,"td"),_.Xc(19),_.Wb(),_.Xb(20,"td",19),_.Vc(21,Jt,1,0,"app-icons",69),_.Sb(22,"nz-divider",50),_.Vc(23,en,1,0,"app-icons",73),_.Vc(24,nn,3,2,"ng-container",5),_.jc(25,"dateCompare"),_.Wb(),_.Wb()),2&e){var n=t.$implicit;_.Db(2),_.Yc(null==n?null:n.episodeType),_.Db(2),_.Yc((null==n?null:n.attendeeName)||"N/A"),_.Db(2),_.rc("patientStatus",null==n?null:n.patientStatus),_.Db(3),_.Yc((null==n?null:n.attenderName)||"N/A"),_.Db(2),_.Yc(_.lc(12,11,null==n||null==n.schedule?null:n.schedule.startDate,"MMM dd yyyy, hh:mm a")),_.Db(3),_.Yc(_.kc(15,14,null==n?null:n.appointmentPurpose)),_.Db(3),_.Yc(null==n?null:n.attemptCount),_.Db(2),_.Yc((null==n?null:n.reason)||"N/A"),_.Db(2),_.rc("isFeaturePermitted",_.xc(19,jt)),_.Db(2),_.rc("isFeaturePermitted",_.xc(20,an)),_.Db(1),_.rc("ngIf",_.lc(25,16,null==n||null==n.schedule?null:n.schedule.startDate,"MONTH_OR_FUTURE"))}}function rn(e,t){if(1&e&&_.Sb(0,"nz-option",40),2&e){var n=t.$implicit;_.rc("nzValue",null==n?null:n.id)("nzLabel",null==n?null:n.fullName)}}function cn(e,t){if(1&e&&(_.Vb(0),_.Vc(1,rn,1,2,"nz-option",39),_.Ub()),2&e){var n=_.ic(2);_.Db(1),_.rc("ngForOf",n.staffList)}}function sn(e,t){1&e&&(_.Xb(0,"nz-option",41),_.Sb(1,"span",42),_.Xc(2," Loading Data... "),_.Wb())}function ln(e,t){if(1&e){var n=_.Yb();_.Xb(0,"div",6),_.Xb(1,"nz-select",10),_.ec("ngModelChange",function(e){return _.Lc(n),_.ic().selectedStaff=e})("ngModelChange",function(){return _.Lc(n),_.ic().getPatientsWithoutAppointments()}),_.Vc(2,cn,2,1,"ng-container",8),_.Vc(3,sn,3,0,"ng-template",null,11,_.Wc),_.Wb(),_.Wb()}if(2&e){var i=_.Ic(4),a=_.ic();_.Db(1),_.rc("ngModel",a.selectedStaff),_.Db(1),_.rc("ngIf",null==a.staffList?null:a.staffList.length)("ngIfElse",i)}}function pn(e,t){1&e&&(_.Xb(0,"th"),_.Xc(1," Sub Tenant "),_.Wb())}function dn(e,t){if(1&e&&(_.Xb(0,"td"),_.Xc(1),_.jc(2,"tenantName"),_.Wb()),2&e){var n=_.ic().$implicit;_.Db(1),_.Zc(" ",_.kc(2,1,n.tenantId)," ")}}var un=function(e){return{episodeId:e}};function bn(e,t){if(1&e&&(_.Xb(0,"tr"),_.Xb(1,"td"),_.Xc(2),_.Wb(),_.Xb(3,"td",44),_.Xc(4),_.Wb(),_.Xb(5,"td"),_.Xc(6),_.Wb(),_.Xb(7,"td"),_.Vb(8),_.Xb(9,"div",75),_.Xb(10,"span",59),_.jc(11,"userLocations"),_.Xc(12),_.jc(13,"titlecase"),_.jc(14,"userLocations"),_.Wb(),_.Wb(),_.Ub(),_.Wb(),_.Vc(15,dn,3,3,"td",16),_.Xb(16,"td",76),_.Xb(17,"a",77),_.Xc(18,"Create Appointment"),_.Wb(),_.Wb(),_.Wb()),2&e){var n=t.$implicit,i=_.ic();_.Db(2),_.Yc((null==n||null==n.patientState||null==n.patientState.episodeState||null==n.patientState.episodeState.activeEpisodes[0]?null:n.patientState.episodeState.activeEpisodes[0].episodeType)||"N/A"),_.Db(1),_.tc("routerLink","/patient/view/",null==n?null:n.id,""),_.Db(1),_.bd(" ",null==n?null:n.firstName," ",null==n?null:n.middleName," ",null==n?null:n.lastName," "),_.Db(2),_.Zc(" ",(null==n||null==n.patientState||null==n.patientState.lastServiceDates?null:n.patientState.lastServiceDates.COMPLEX_CCM)||(null==n||null==n.patientState||null==n.patientState.lastServiceDates?null:n.patientState.lastServiceDates.CCM)||"N/A"," "),_.Db(4),_.rc("nzTooltipTitle",_.kc(11,11,null==n?null:n.locations)||"-"),_.Db(2),_.Zc(" ",_.kc(13,13,_.kc(14,15,null==n?null:n.locations))," "),_.Db(4),_.tc("routerLink","/appointments/create/",null==n?null:n.id,""),_.rc("queryParams",_.yc(17,un,(null==n||null==n.patientState||null==n.patientState.episodeState||null==n.patientState.episodeState.activeEpisodes[0]?null:n.patientState.episodeState.activeEpisodes[0].id)||"")),_.Db(1),_.rc("nzSize",i.size)}}function mn(e,t){1&e&&(_.Xb(0,"span"),_.Xc(1),_.jc(2,"translate"),_.Wb()),2&e&&(_.Db(1),_.Zc(" ",_.kc(2,1,"COMMON.NODATA")," "))}function gn(e,t){if(1&e&&(_.Xb(0,"nz-empty",78),_.Vc(1,mn,3,3,"ng-template",null,79,_.Wc),_.Wb()),2&e){var n=_.Ic(2);_.rc("nzNotFoundImage","https://gw.alipayobjects.com/mdn/miniapp_social/afts/img/A*pevERLJC9v0AAAAAAAAAAABjAQAAAQ/original")("nzNotFoundContent",n)}}var fn,hn,vn=function(){return[10,50,100,150,200]},Sn=function(){return["ascend","descend"]},zn=function(){return["CLEAR_UNATTENDED_APPOINTMENT"]},An=function(){return[5,50,100,150,200]},Tn=((fn=function(t){o(r,t);var i=c(r);function r(e,t,a,o,c,s,l,p,d,u,b,m,g,h,v){var S;n(this,r),(S=i.call(this))._appointmentsService=e,S._appointmentModalService=t,S._router=a,S._episodeService=o,S._activatedRoute=c,S._notificationsService=s,S._modalService=l,S._videoCallService=p,S._dataSharingService=d,S._staffService=u,S.translationService=b,S._datePipe=m,S._appointmentsEventLogger=g,S._patientsEventLogger=h,S._siteService=v,S.appointmentsRequests=new Be,S.upcomingAppointments=new qe.a,S.completedAppointments=new qe.a,S.unattendedAppointments=new qe.a,S.rejectedAppointments=new Be,S.noAppointmentPatients=[],S.filteredNoAppointmentPatients=[],S.isCallButtonEnabled=!0,S.pageSize=10,S.pageIndex=1,S.dateRange=[],S.appointmentLoading={},S.appointmentFetchQuery={startTime:null,endTime:null,staffId:null,searchTerm:null,tab:"upcoming"},S.selectedTabIndex=0,S.tabIndex=new Map([[0,"upcoming"],[1,"completed"],[2,"unattended"],[3,"no-appointment"],[4,"rejected"]]),S.filterAttempt=[],S.MAX_ATTEMPT_COUNT=10,S.notesMap=new Map,S.expandSet=new Set,S.editCache={},S.queryParamInitialised=!1,S.staffIdMap=new Map,S.onSelectedTabIndexChange=function(e){S.pageIndex=1,S.clearSearch(),S.changeTab(e)},S.appointmentsRequests.result=[],S.upcomingAppointments.result=[],S.completedAppointments.result=[],S.unattendedAppointments.result=[],S.rejectedAppointments.result=[];for(var z=0;z<=S.MAX_ATTEMPT_COUNT;z++){var A={text:z.toString(),value:z.toString()};S.filterAttempt.push(A)}return S._routeHelperService.isPrimaryActionTriggered().pipe(Object(Me.a)(function(e){return!!e}),Object(f.a)(S.unsubscribed)).subscribe(function(){return S.gotoAddAppointments()}),S._routeHelperService.getMultiActionTriggered().pipe(Object(Me.a)(function(e){return!!e}),Object(f.a)(S.unsubscribed)).subscribe(function(e){"BULK_UPLOAD"===e?S.gotoBulkUploadAppointments():"BULK_REASSIGN"===e&&S.gotoBulkReassignAppointments()}),S._routeHelperService.getSearch().pipe(Object(Me.a)(function(e){return null!==e}),Object(f.a)(S.unsubscribed)).subscribe(function(e){S.searchKey!=e&&(S.searchKey=e,S.fetchAppointmentsData())}),S._dataSharingService.getTimer().pipe(Object(f.a)(S.unsubscribed)).subscribe(function(e){e&&("COMPLETED"===(null==e?void 0:e.state)||"END"===(null==e?void 0:e.state)?(S.timerRunning=!1,S.timedAppointment=void 0,S.queryParamInitialised&&S.getUpcomingAppointments()):S.timerRunning=!0)}),S}return a(r,[{key:"ngOnInit",value:function(){var e=this;this.activeRoleType=localStorage.getItem("loggedInUserRole"),this.getStaff(null,!0),this._activatedRoute.queryParams.subscribe(function(t){var n,i;if(t.requestTenantIds&&(e.selectedTenantIds=t.requestTenantIds.split(","),localStorage.setItem(rt.a.REQUEST_TENANT_IDS,t.requestTenantIds)),(null==t?void 0:t.startTime)||(null==t?void 0:t.endTime)||(null==t?void 0:t.tab))(null==t?void 0:t.startTime)&&(null==t?void 0:t.endTime)&&(e.dateRange=[],e.dateRange[0]=new Date(Number(null==t?void 0:t.startTime)),e.dateRange[1]=new Date(Number(null==t?void 0:t.endTime)),e.datePreset=!0,e.appointmentFetchQuery.startTime=null==t?void 0:t.startTime,e.appointmentFetchQuery.endTime=null==t?void 0:t.endTime),(null==t?void 0:t.tab)&&(e.appointmentFetchQuery.tab=null==t?void 0:t.tab),localStorage.setItem("appointmentFetchQuery",JSON.stringify(e.appointmentFetchQuery));else{var a=localStorage.getItem("appointmentFetchQuery");null!=a&&(e.appointmentFetchQuery=JSON.parse(a),e.dateRange[0]=new Date(Number(null===(n=e.appointmentFetchQuery)||void 0===n?void 0:n.startTime)),e.dateRange[1]=new Date(Number(null===(i=e.appointmentFetchQuery)||void 0===i?void 0:i.endTime)),e.datePreset=!0,e.searchKey=e.appointmentFetchQuery.searchTerm)}e.queryParamInitialised=!0,e.changeTab(Array.from(e.tabIndex.values()).findIndex(function(t){var n;return t===(null===(n=e.appointmentFetchQuery)||void 0===n?void 0:n.tab)}))}),this._dataSharingService.onSubTenantChange().pipe(Object(f.a)(this.unsubscribed)).subscribe(function(t){e.onSubTenantChange(t)}),this.getSites()}},{key:"onSubTenantChange",value:function(e){"object"!=typeof e||0==e.length||""==e||null==e||null==e?(this.requestTenantIds=void 0,this.fetchAppointmentsData(1)):(this.requestTenantIds=e.join(),this.selectedTenantIds=e,this.fetchAppointmentsData(1)),this.staffList=[],this.siteList=[],this.getStaff(),this.getSites()}},{key:"clearSearch",value:function(){this.searchKey="",this._routeHelperService.setSearch("")}},{key:"changeTab",value:function(e){var t=this;this.selectedTabIndex=e,this._router.navigate([],{queryParams:{tab:this.tabIndex.get(e)},queryParamsHandling:"merge",relativeTo:this._activatedRoute,replaceUrl:!0}).then(function(){return t.fetchAppointmentsData()})}},{key:"ngAfterViewInit",value:function(){var t,n=this;(t=this.translationService).getMultiple.apply(t,e(Je.APPOINTMENT_CREATE_STRINGS)).subscribe(function(e){n.translatedStrings=e,n.appointmentTypes=new Map([["VIDEO_CALL",n.translatedStrings.get("VIDEO_CALL")],["HOME_VISIT",n.translatedStrings.get("EPISODE.HOMEVISIT")],["AUDIO_CALL",n.translatedStrings.get("AUDIO_CALL")]])}),this.getTenantConfig(),"CARE_TAKER"===localStorage.getItem("loggedInUserAccountType")&&(this.isCaretakerLogin=!0,this.selectedStaff=localStorage.getItem("loggedInUser"))}},{key:"onExpandChange",value:function(e,t){t?this.expandSet.add(e):this.expandSet.delete(e)}},{key:"getSites",value:function(){var e=this;this.loadingSites=!0,this._siteService.getAllSites().subscribe(function(t){e.siteList=t.result,e.loadingSites=!1})}},{key:"getStaff",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._staffService.fetchStaffMembers(at.a.MONITORING_STAFF,this.getOffset(this.pageIndex),10,null,null,"ALL",!1,t,!0).subscribe(function(t){var i;e.staffList=null===(i=null==t?void 0:t.result)||void 0===i?void 0:i.map(function(t){var n;return e.staffIdMap.set(null===(n=null==t?void 0:t.user)||void 0===n?void 0:n.id,null==t?void 0:t.user),null==t?void 0:t.user}),console.log("Staff : ",e.staffList),n&&"CARE_TAKER"===localStorage.getItem("loggedInUserAccountType")&&(e.isCaretakerLogin=!0,e.selectedStaff=localStorage.getItem("loggedInUser"))})}},{key:"logAction",value:function(e,t){this._patientsEventLogger.patientActionEvent(t,e)}},{key:"getTenantConfig",value:function(){var e=this;this._dataSharingService.tenantSettings.pipe(Object(f.a)(this.unsubscribed)).subscribe(function(t){t&&(e.isCallButtonEnabled=!!(t.videoCallConfig&&t.appointmentConfig.videoCallAppointment&&t.appointmentConfig.videoCallAppointment))})}},{key:"clear",value:function(){this.searchKey=null,this.fetchAppointmentsData()}},{key:"onSiteSelect",value:function(e){this.staffList=[],this.selectedSite=e,this.getStaff(e),this.fetchAppointmentsData(1,null,null,e)}},{key:"fetchAppointmentsData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;switch(this._activatedRoute.snapshot.queryParamMap.get("tab")||"upcoming"){case"request":this.getAppointmentRequests(e,t);break;case"upcoming":this.getUpcomingAppointments(e,t,n);break;case"completed":this.getCompletedAppointments(e,t,n);break;case"unattended":this.getUnattendedAppointments(e,t,n);break;case"rejected":this.getRejectedAppointments(e,t);break;case"on-hold":this.getOnHoldAppointments(e,t);break;case"no-appointment":this.getPatientsWithoutAppointments()}}},{key:"changePageSize",value:function(e){this.pageSize=e,1==this.pageIndex&&this.fetchAppointmentsData()}},{key:"onQueryParamsChange",value:function(e){var t=e.pageSize,n=e.pageIndex,i=e.sort,a=e.filter,o=i.find(function(e){return null!==e.value}),r="ascend"==(o&&o.value||"ascend")?"ASC":"DESC";this.pageSize=t,this.fetchAppointmentsData(n,r,a)}},{key:"getOffset",value:function(e){return Math.max(0,(e-1)*this.pageSize)}},{key:"getAppointmentRequests",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.appointmentLoading.appointmentsRequests=!0,this._appointmentsEventLogger.tabEvent("Requests","appointments"),this._appointmentsService.fetchAppointmentsRequests(this.getOffset(t),this.pageSize,this.searchKey,this.requestTenantIds).subscribe(function(t){e.appointmentsRequests=t,e.appointmentLoading.appointmentsRequests=!1})}},{key:"getUpcomingAppointments",value:function(){var e,t,n,i,a,o,r=this,c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.selectedStaffDetail=this.selectedStaff?this.staffIdMap.get(this.selectedStaff):void 0,this.appointmentLoading.upcomingAppointments||(this._appointmentsEventLogger.tabEvent("Upcoming","appointments"),this.appointmentLoading.upcomingAppointments=!0,this.dateRange&&this.dateRange[0]&&(a=this.datePreset?null===(e=this.dateRange[0])||void 0===e?void 0:e.getTime():null===(t=Object(Oe.a)(this.dateRange[0]))||void 0===t?void 0:t.getTime()),this.dateRange&&this.dateRange[1]&&(o=this.datePreset?null===(n=this.dateRange[1])||void 0===n?void 0:n.getTime():null===(i=Object(Xe.a)(this.dateRange[1]))||void 0===i?void 0:i.getTime()),console.log("Selected Staff ",this.selectedStaff),this._appointmentsService.fetchUpcomingAppointments(this.getOffset(c),a,o,void 0,this.selectedStaff,this.searchKey,null,this.pageSize,s,l,null,this.requestTenantIds,this.selectedSite).subscribe(function(e){r.upcomingAppointments=e,r.updateEnabled(),r.updateEpisodeType(r.upcomingAppointments,function(){r.appointmentLoading.upcomingAppointments=!1})}))}},{key:"updateEpisodeType",value:function(e,t){var n=e.result.map(function(e){return e.episodeId}).filter(function(e){return null!=e}).filter(function(e,t,n){return n.indexOf(e)==t});0!=n.length?this._episodeService.getEpisodeByIds(n).subscribe(function(n){e.result.forEach(function(e){return e.episodeType=n[e.episodeId]}),t()}):t()}},{key:"updateEnabled",value:function(){this.upcomingAppointments.result.forEach(function(e){e.enabled=e.schedule.startDate>=Object(Pe.a)(new Date).getTime()&&e.schedule.endDate<=Object(Ne.a)(new Date).getTime()})}},{key:"getCompletedAppointments",value:function(){var e,t,n,i,a,o,r=this,c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.appointmentLoading.completedAppointments||(this.appointmentLoading.completedAppointments=!0,this.dateRange&&this.dateRange[0]&&(a=this.datePreset?null===(e=this.dateRange[0])||void 0===e?void 0:e.getTime():null===(t=Object(Oe.a)(this.dateRange[0]))||void 0===t?void 0:t.getTime()),this.dateRange&&this.dateRange[1]&&(o=this.datePreset?null===(n=this.dateRange[1])||void 0===n?void 0:n.getTime():null===(i=Object(Xe.a)(this.dateRange[1]))||void 0===i?void 0:i.getTime()),this._appointmentsEventLogger.tabEvent("Completed","appointments"),this._appointmentsService.fetchCompletedAppointments(this.getOffset(c),this.pageSize,null,this.searchKey,s,a,o,l,this.requestTenantIds).subscribe(function(e){r.completedAppointments=e,r.updateEpisodeType(r.completedAppointments,function(){r.appointmentLoading.completedAppointments=!1})}))}},{key:"getUnattendedAppointments",value:function(){var e,t,n,i,a,o,r=this,c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.activeRoleName=localStorage.getItem("loggedInUserRoleName"),this.appointmentLoading.unattendedAppointments||(this.appointmentLoading.unattendedAppointments=!0,this.dateRange&&this.dateRange[0]&&(a=this.datePreset?null===(e=this.dateRange[0])||void 0===e?void 0:e.getTime():null===(t=Object(Oe.a)(this.dateRange[0]))||void 0===t?void 0:t.getTime()),this.dateRange&&this.dateRange[1]&&(o=this.datePreset?null===(n=this.dateRange[1])||void 0===n?void 0:n.getTime():null===(i=Object(Xe.a)(this.dateRange[1]))||void 0===i?void 0:i.getTime()),this._appointmentsEventLogger.tabEvent("Unattended","appointments"),this._appointmentsService.fetchUnattendedAppointments(this.getOffset(c),this.pageSize,null,this.searchKey,a,o,s,l,this.requestTenantIds).subscribe(function(e){r.unattendedAppointments=e,r.updateEpisodeType(r.unattendedAppointments,function(){r.appointmentLoading.unattendedAppointments=!1})}))}},{key:"getRejectedAppointments",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.appointmentLoading.rejectedAppointments=!0,this._appointmentsEventLogger.tabEvent("Rejected","appointments"),this._appointmentsService.fetchRejectedAppointments(this.getOffset(t),this.pageSize,this.searchKey).subscribe(function(t){e.rejectedAppointments=t,e.appointmentLoading.rejectedAppointments=!1})}},{key:"getOnHoldAppointments",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.appointmentLoading.rejectedAppointments=!0,this._appointmentsEventLogger.tabEvent("On-Hold","appointments"),this._appointmentsService.fetchOnHoldAppointments(this.getOffset(t),this.pageSize,this.searchKey).subscribe(function(t){e.rejectedAppointments=t,e.appointmentLoading.rejectedAppointments=!1})}},{key:"getPatientsWithoutAppointments",value:function(){var e=this;this.appointmentLoading.noAppointmentPatients||(this._appointmentsEventLogger.tabEvent("No-Appointments","appointments"),this.appointmentLoading.noAppointmentPatients=!0,this._appointmentsService.fetchPatientWihoutAppointment(this.selectedStaff,this.searchKey).subscribe(function(t){e.noAppointmentPatients=t,e.filteredNoAppointmentPatients=JSON.parse(JSON.stringify(t)),e.appointmentLoading.noAppointmentPatients=!1}))}},{key:"clearUnattendedAppointments",value:function(){var e=this;this._modalService.create({nzContent:lt,nzComponentParams:{dateRange:this.dateRange,datePreset:this.datePreset,requestTenantIds:this.requestTenantIds},nzClosable:!0,nzMaskClosable:!1,nzFooter:null}).afterClose.subscribe(function(t){t&&(e.dateRange=[],e.getUnattendedAppointments())})}},{key:"filterByLastServiceDate",value:function(){if(this.noAppointmentPatients=JSON.parse(JSON.stringify(this.filteredNoAppointmentPatients)),this.dateRange[0]&&this.dateRange[1]){var e=JSON.parse(JSON.stringify(this.dateRange)),t=new Date(e[0]).setHours(0,0,0,0),n=new Date(e[1]).setHours(23,59,59,999);this.noAppointmentPatients=this.noAppointmentPatients.filter(function(e){var i,a,o=null===(i=null==e?void 0:e.patientState)||void 0===i?void 0:i.lastServiceDates.COMPLEX_CCM,r=null===(a=null==e?void 0:e.patientState)||void 0===a?void 0:a.lastServiceDates.CCM;return o&&t<new Date(o).getTime()&&n>new Date(o).getTime()||r&&t<new Date(r).getTime()&&n>new Date(r).getTime()?e:void 0})}}},{key:"viewAppointmentDetails",value:function(e){this._appointmentsEventLogger.appointmentActionEvent(e,et.a.ACTION_VIEW),this._router.navigate(["appointments/details/",e])}},{key:"confirmAppointment",value:function(e){var t=this,n=new Date(e.startTime),i=this._modalService.create({nzTitle:this.translatedStrings.get("APPOINTMENT.CONFIRM_APPOINTMENT"),nzContent:Fe,nzComponentParams:{dateTime:n},nzOnOk:function(){var n,a,o=i.getContentComponent().selectedCaretaker,r=null===(n=i.getContentComponent().startTime)||void 0===n?void 0:n.getTime(),c=null===(a=i.getContentComponent().endTime)||void 0===a?void 0:a.getTime();o?t.approveAppointment(e.id,o.id,r,c):t._notificationsService.error(t.translatedStrings.get("FORM.APPOINTMENT"),t.translatedStrings.get("APPOINTMENT.NO_CLINICIAN_SELECTED"))}})}},{key:"approveAppointment",value:function(e,t,n,i){var a=this;this._appointmentsService.setAppointmentAsApproved(e,t,n,i).subscribe(function(){a._notificationsService.success(a.translatedStrings.get("FORM.APPOINTMENT"),a.translatedStrings.get("APPOINTMENT.CLINICIAN_ADDED_APPOINTMENT_APPROVED")),a.getAppointmentRequests()})}},{key:"rejectAppointment",value:function(e){var t=this;this._modalService.create({nzTitle:this.translatedStrings.get("APPOINTMENT.REJECT_APPOINTMENT"),nzContent:this.translatedStrings.get("APPOINTMENT.REJECT_APPOINTMENT_POPUP"),nzClosable:!0,nzOnCancel:function(){},nzOnOk:function(){e.status=Ye.REJECTED,t._appointmentsService.setAppointmentAsRejected(e).subscribe(function(){t._appointmentsEventLogger.appointmentActionEvent(e.id,et.a.ACTION_REJECT),t._notificationsService.success(t.translatedStrings.get("FORM.APPOINTMENT"),t.translatedStrings.get("APPOINTMENT.MARKED_REJECTED")),t.getAppointmentRequests()})}})}},{key:"deleteAppointment",value:function(e){var t=this;this._modalService.create({nzTitle:this.translatedStrings.get("APPOINTMENT.DELETE_APPOINTMENT"),nzContent:this.translatedStrings.get("APPOINTMENT.REMOVE_APPOINTMENT"),nzClosable:!0,nzOnCancel:function(){},nzOnOk:function(){t._appointmentsService.setAppointmentAsDeleted(e).subscribe(function(){t._appointmentsEventLogger.appointmentActionEvent(e,et.a.ACTION_DELETE),t._notificationsService.success(t.translatedStrings.get("FORM.APPOINTMENT"),t.translatedStrings.get("APPOINTMENT.APPOINTMENT_DELETE")),t.getUpcomingAppointments()})}})}},{key:"editReasonForUnattendedAppointment",value:function(e){var t=this;this._modalService.create({nzContent:He,nzComponentParams:{reason:e.reason},nzWidth:"850px",nzFooter:null}).afterClose.subscribe(function(n){n&&(e.reason=n,t._appointmentsEventLogger.appointmentUnattendedReason(n,e.id),t._appointmentsService.updateAppointment(e).subscribe(function(){t._notificationsService.success(t.translatedStrings.get("FORM.APPOINTMENT"),t.translatedStrings.get("APPOINTMENT.REASON_ADDED_SUCCESSFULLY"))}))})}},{key:"rescheduleAppointment",value:function(e){var t=this;e.schedule||(e.schedule=new z.a,e.schedule.startDate=(new Date).getTime()),this._appointmentsEventLogger.appointmentActionEvent(e.id,et.a.ACTION_RESCHEDULE),this._modalService.create({nzContent:$e.a,nzComponentParams:{appointment:e},nzWidth:850,nzFooter:null}).afterClose.subscribe(function(){t.getUpcomingAppointments(),t.getUnattendedAppointments()})}},{key:"gotoAddAppointments",value:function(){this._router.navigate(["appointments/create"])}},{key:"gotoManageEpisodes",value:function(e,t){var n=this;e?this._episodeService.getEpisodeById(e).subscribe(function(e){n._router.navigate(["episodes/details/".concat(null==e?void 0:e.patientId,"/").concat(null==e?void 0:e.id)],{queryParams:{blueprintId:null==e?void 0:e.blueprintId}})}):this._router.navigate(["patient/view/".concat(t)],{queryParams:{tab:"episodes"}})}},{key:"gotoCalendarView",value:function(){this._router.navigate(["appointments/calendar"])}},{key:"showHistory",value:function(e,t){this._modalService.create({nzContent:nt.a,nzComponentParams:{patientId:null==t?void 0:t.attendeeId,patientName:null==t?void 0:t.attendeeName},nzWidth:800,nzStyle:{top:"50px"},nzBodyStyle:{height:"700px",overflowY:"scroll"},nzFooter:null})}},{key:"initiateVideoCall",value:function(e,t){var n=this;if(t.schedule.startDate-Date.now()>6e5)this._notificationsService.warning(this.translatedStrings.get("FORM.APPOINTMENT"),this.translatedStrings.get("VIDEOCALL.ERROR.APPOINTMENT_FUTURE_SCHEDULE"));else{this.isCallButtonEnabled=!1;var i=localStorage.getItem("loggedInUser");this._videoCallService.videocallSessionCheck(i).subscribe(function(i){n._videoCallService.videocallSessionCheck(e).subscribe(function(){n._appointmentsEventLogger.appointmentActionEvent(t.id,et.a.ACTION_VIDEOCALL),n.openCallWindow(e,t.id,t.videoCallSessionId)},function(e){n.callError(e,n.translatedStrings.get("VIDEOCALL.ERROR.ALREADY_IN_CALL"))})},function(e){n.callError(e,n.translatedStrings.get("VIDEOCALL.ERROR.ALREADY_ANOTHER_CALL"))})}}},{key:"openCallWindow",value:function(e,t,n){var i=this._router.serializeUrl(this._router.createUrlTree(["/video-call/"+e],{queryParams:{env:"prod",appointmentId:t,appointmentSessionId:n}}));this.isCallButtonEnabled=!0,null==window.open(i,"_blank")&&this._notificationsService.create("error",this.translatedStrings.get("VIDEOCALL.ERROR.POPUP_BLOCKED"),this.translatedStrings.get("VIDEOCALL.ERROR.POPUP_BLOCKER_MESSAGE"))}},{key:"callError",value:function(e,t){403==e.status?this._notificationsService.create("error",this.translatedStrings.get("VIDEOCALL.VIDEOCALL"),t):401==e.status&&(this._notificationsService.create("error",this.translatedStrings.get("COMMON.INVALID_SESSION"),this.translatedStrings.get("COMMON.SESSION_EXPIRED")),this._router.navigate(["logout"])),this.isCallButtonEnabled=!0}},{key:"sendSMS",value:function(e,t,n,i,a){this._appointmentsEventLogger.appointmentActionEvent(a,et.a.ACTION_SMS),this._modalService.create({nzContent:Ke,nzTitle:this.translatedStrings.get("FORM.APPOINTMENT"),nzComponentParams:{patientId:e,message:"An appointment has been created for you with ".concat(t," on ").concat(this._datePipe.transform(n,"medium")," via ").concat(this.appointmentTypes.get(i))},nzFooter:null})}},{key:"startTimer",value:function(e){this.timerRunning=!0,this.timedAppointment=e,this._dataSharingService.setTimer({state:"START",data:e,showStickyNote:!0})}},{key:"updateNotesMap",value:function(t){var n=this;t.result.forEach(function(t){var i=[];t.notesHistory&&i.push.apply(i,e(t.notesHistory.filter(function(e){return null!=e}))),i.push(t.noteId),n.fetchAppointmentNotes(i,t)})}},{key:"fetchAppointmentNotes",value:function(e,t){var n=this;null!=e&&0!=e.length?this._appointmentsService.fetchNotesByIds(e).subscribe(function(e){e.forEach(function(e){return n.notesMap.set(e.id,e)}),t.notes=e}):t.notes=[]}},{key:"showNotesHistory",value:function(e){var t=this;this._appointmentModalService.showNotesHistory(e,e.attendeeId).afterClose.subscribe(function(n){n&&(e.noteId&&(e.notesHistory||(e.notesHistory=[]),e.notesHistory.push(e.noteId)),e.noteId=n.id,t._appointmentsService.updateAppointment(e).subscribe(function(e){return t.fetchAppointmentsData()}))})}},{key:"gotoBulkUploadAppointments",value:function(){this._router.navigate(["appointments/bulk-upload"])}},{key:"gotoBulkReassignAppointments",value:function(){this._router.navigate(["appointments/bulk-reassign"])}}]),r}(h.a)).\u0275fac=function(e){return new(e||fn)(_.Rb(A.a),_.Rb(ot.a),_.Rb(u.g),_.Rb(Ee.a),_.Rb(u.a),_.Rb(W.b),_.Rb(xe.f),_.Rb(I.a),_.Rb(T.a),_.Rb(it.a),_.Rb(Ge.a),_.Rb(l.e),_.Rb(D.a),_.Rb(tt.a),_.Rb(pt.a))},fn.\u0275cmp=_.Lb({type:fn,selectors:[["app-appointments"]],features:[_.Cb([l.e]),_.Ab],decls:148,vars:133,consts:[[3,"nzSelectedIndex","nzSelectedIndexChange"],[3,"nzTitle"],[1,"appointments-card"],["nz-row","","nzGutter","16","nzJustify","end"],["nz-col","","nzSpan","10",2,"padding-left","10px !important"],[4,"ngIf"],["nz-col","","nzSpan","4"],["nzPlaceHolder","Filter by sites","nzAllowClear","",3,"ngModel","ngModelChange"],[4,"ngIf","ngIfElse"],["siteLoading",""],["nzPlaceHolder","Filter by staff","nzAllowClear","",3,"ngModel","ngModelChange"],["staffLoading",""],["nz-col","","nzSpan","6"],[3,"ngModel","ngModelChange"],[3,"nzData","nzFrontPagination","nzNoResult","nzShowPagination","nzShowSizeChanger","nzPageSizeOptions","nzLoading","nzTotal","nzPageIndex","nzPageSize","nzQueryParams"],["upcoming",""],[4,"isAccessAcrossTenantEnabled"],["nzColumnKey","date",3,"nzSortFn","nzSortDirections","nzSortOrder"],["nzColumnKey","attempt","nzWidth","100px",3,"nzFilters","nzFilterFn"],["id","actions-container"],["ngFor","",3,"ngForOf"],["nz-col","","nzSpan","8"],[3,"nzData","nzFrontPagination","nzNoResult","nzShowPagination","nzShowSizeChanger","nzPageSizeOptions","nzLoading","nzTotal","nzQueryParams"],["completed",""],[4,"ngFor","ngForOf"],["nz-row",""],["nz-col","","nzFlex","3",4,"isFeaturePermitted"],["nz-col","","nzFlex","5"],[3,"nzData","nzFrontPagination","nzNoResult","nzShowPagination","nzShowSizeChanger","nzPageSizeOptions","nzPageIndex","nzPageSize","nzLoading","nzTotal","nzQueryParams"],["unattended",""],["nzTitle","Patients Without Appointment"],["nz-col","","nzSpan","4",4,"ngIf"],[3,"nzData","nzNoResult","nzShowPagination","nzShowSizeChanger","nzPageSizeOptions","nzLoading","nzPageSize"],["noAppointment",""],["nzWidth","200px"],["nzWidth","200px","id","actions-container"],["noData",""],[3,"staffName","assignedTenantIds",4,"ngIf"],[3,"staffName","assignedTenantIds"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],[3,"nzValue","nzLabel"],["nzDisabled","","nzCustomContent",""],["nz-icon","","nzType","loading",1,"loading-icon"],["nz-tooltip","",3,"nzTooltipTitle",4,"ngIf"],["actionable","",3,"routerLink"],["nz-typography","","nzEllipsis","","nz-tooltip","",3,"nzTooltipTitle"],["isToolTipEnabled","true",3,"patientStatus"],["name","sms",3,"click"],[1,"char-bound-field"],["nz-tooltip","","nzTooltipTitle","Communication History","name","history",3,"click"],["nzType","vertical"],["nz-tooltip","","nzTooltipTitle","Appointment Details","name","view",3,"click",4,"isFeaturePermitted"],["nz-tooltip","","nzTooltipTitle","Reschedule Appointment","name","reschedule",3,"click",4,"isFeaturePermitted"],["nz-tooltip","","nzTooltipTitle","Delete Appointment","name","delete",3,"click",4,"isFeaturePermitted"],["nz-tooltip","","nzTooltipTitle","Show Notes","name","file",3,"click"],["nz-tooltip","","nzTooltipTitle","Manage Episode","name","edit",3,"click"],["nz-button","","nzType","text",3,"disabled","click"],["nz-tooltip","","name","play",3,"nzTooltipTitle",4,"ngIf"],["nz-tooltip","","name","play",3,"nzTooltipTitle"],["nz-tooltip","",3,"nzTooltipTitle"],["nz-button","","nzType","text",3,"disabled"],["color","lightgray","name","play",4,"ngIf"],["color","lightgray","name","play"],[3,"userId","phoneNumbers","disabled","renderVital","appointmentId","click"],["name","videoCall",3,"click",4,"isFeaturePermitted"],["name","videoCall",3,"click"],["nz-tooltip","","nzTooltipTitle","Appointment Details","name","view",3,"click"],["nz-tooltip","","nzTooltipTitle","Reschedule Appointment","name","reschedule",3,"click"],["nz-tooltip","","nzTooltipTitle","Delete Appointment","name","delete",3,"click"],["name","view",3,"click",4,"isFeaturePermitted"],["name","view",3,"click"],["nz-col","","nzFlex","3"],["nz-button","","nzType","primary",3,"disabled","click"],["name","edit",3,"click",4,"isFeaturePermitted"],["name","edit",3,"click"],[1,"ellipsis-text"],["actionable","",2,"text-align","center !important",3,"routerLink","queryParams"],["nz-button","","nzType","link",1,"create-link",3,"nzSize"],[2,"flex","1","overflow","auto",3,"nzNotFoundImage","nzNotFoundContent"],["contentTpl",""]],template:function(e,t){if(1&e&&(_.Xb(0,"nz-tabset",0),_.ec("nzSelectedIndexChange",function(e){return t.onSelectedTabIndexChange(e)}),_.Xb(1,"nz-tab",1),_.jc(2,"translate"),_.Xb(3,"div",2),_.Xb(4,"div",3),_.Xb(5,"div",4),_.Vc(6,Tt,2,0,"ng-container",5),_.Wb(),_.Xb(7,"div",6),_.Xb(8,"nz-select",7),_.ec("ngModelChange",function(e){return t.selectedSite=e})("ngModelChange",function(e){return t.onSiteSelect(e)}),_.Vc(9,yt,2,1,"ng-container",8),_.Vc(10,Dt,3,0,"ng-template",null,9,_.Wc),_.Wb(),_.Wb(),_.Xb(12,"div",6),_.Xb(13,"nz-select",10),_.ec("ngModelChange",function(e){return t.selectedStaff=e})("ngModelChange",function(){return t.getUpcomingAppointments()}),_.Vc(14,Et,2,1,"ng-container",8),_.Vc(15,Ot,3,0,"ng-template",null,11,_.Wc),_.Wb(),_.Wb(),_.Xb(17,"div",12),_.Xb(18,"nz-range-picker",13),_.ec("ngModelChange",function(e){return t.dateRange=e})("ngModelChange",function(){return t.getUpcomingAppointments()}),_.Wb(),_.Wb(),_.Wb(),_.Xb(19,"nz-table",14,15),_.ec("nzQueryParams",function(e){return t.onQueryParamsChange(e)}),_.Xb(21,"thead"),_.Xb(22,"tr"),_.Sb(23,"th"),_.Xb(24,"th"),_.Xc(25,"Episode"),_.Wb(),_.Xb(26,"th"),_.Xc(27),_.jc(28,"translate"),_.Wb(),_.Sb(29,"th"),_.Sb(30,"th"),_.Vc(31,Xt,2,0,"th",16),_.Xb(32,"th"),_.Xc(33),_.jc(34,"translate"),_.Wb(),_.Xb(35,"th",17),_.Xc(36),_.jc(37,"translate"),_.Wb(),_.Xb(38,"th"),_.Xc(39,"Type"),_.Wb(),_.Xb(40,"th",18),_.Xc(41," Attempt "),_.Wb(),_.Xb(42,"th",19),_.Xc(43),_.jc(44,"translate"),_.Wb(),_.Wb(),_.Wb(),_.Xb(45,"tbody"),_.Vc(46,Bt,45,34,"ng-template",20),_.Wb(),_.Wb(),_.Wb(),_.Wb(),_.Xb(47,"nz-tab",1),_.jc(48,"translate"),_.Xb(49,"div",2),_.Xb(50,"div",3),_.Sb(51,"div",21),_.Xb(52,"div",12),_.Xb(53,"nz-range-picker",13),_.ec("ngModelChange",function(e){return t.dateRange=e})("ngModelChange",function(){return t.getCompletedAppointments()}),_.Wb(),_.Wb(),_.Wb(),_.Xb(54,"nz-table",22,23),_.ec("nzQueryParams",function(e){return t.onQueryParamsChange(e)}),_.Xb(56,"thead"),_.Xb(57,"tr"),_.Xb(58,"th"),_.Xc(59,"Episode"),_.Wb(),_.Xb(60,"th"),_.Xc(61),_.jc(62,"translate"),_.Wb(),_.Sb(63,"th"),_.Vc(64,Yt,2,0,"th",16),_.Xb(65,"th"),_.Xc(66),_.jc(67,"translate"),_.Wb(),_.Xb(68,"th",17),_.Xc(69),_.jc(70,"translate"),_.Wb(),_.Xb(71,"th"),_.Xc(72,"Type"),_.Wb(),_.Xb(73,"th",18),_.Xc(74," Attempt "),_.Wb(),_.Xb(75,"th",19),_.Xc(76),_.jc(77,"translate"),_.Wb(),_.Wb(),_.Wb(),_.Xb(78,"tbody"),_.Vc(79,Qt,20,14,"tr",24),_.Wb(),_.Wb(),_.Wb(),_.Wb(),_.Xb(80,"nz-tab",1),_.jc(81,"translate"),_.Xb(82,"div",2),_.Xb(83,"div",3),_.Sb(84,"div",21),_.Xb(85,"div",21),_.Xb(86,"div",25),_.Vc(87,Zt,3,1,"div",26),_.Xb(88,"div",27),_.Xb(89,"nz-range-picker",13),_.ec("ngModelChange",function(e){return t.dateRange=e})("ngModelChange",function(){return t.getUnattendedAppointments()}),_.Wb(),_.Wb(),_.Wb(),_.Wb(),_.Wb(),_.Xb(90,"nz-table",28,29),_.ec("nzQueryParams",function(e){return t.onQueryParamsChange(e)}),_.Xb(92,"thead"),_.Xb(93,"tr"),_.Xb(94,"th"),_.Xc(95,"Episode"),_.Wb(),_.Xb(96,"th"),_.Xc(97),_.jc(98,"translate"),_.Wb(),_.Sb(99,"th"),_.Vc(100,Kt,2,0,"th",16),_.Xb(101,"th"),_.Xc(102),_.jc(103,"translate"),_.Wb(),_.Xb(104,"th",17),_.Xc(105),_.jc(106,"translate"),_.Wb(),_.Xb(107,"th"),_.Xc(108,"Type"),_.Wb(),_.Xb(109,"th",18),_.Xc(110," Attempt "),_.Wb(),_.Xb(111,"th"),_.Xc(112),_.jc(113,"translate"),_.Wb(),_.Xb(114,"th",19),_.Xc(115),_.jc(116,"translate"),_.Wb(),_.Wb(),_.Wb(),_.Xb(117,"tbody"),_.Vc(118,on,26,21,"tr",24),_.Wb(),_.Wb(),_.Wb(),_.Wb(),_.Xb(119,"nz-tab",30),_.Xb(120,"div",2),_.Xb(121,"div",3),_.Sb(122,"div",21),_.Xb(123,"div",12),_.Xb(124,"nz-range-picker",13),_.ec("ngModelChange",function(e){return t.dateRange=e})("ngModelChange",function(){return t.filterByLastServiceDate()}),_.Wb(),_.Wb(),_.Vc(125,ln,5,3,"div",31),_.Wb(),_.Xb(126,"nz-table",32,33),_.Xb(128,"thead"),_.Xb(129,"tr"),_.Xb(130,"th",34),_.Xc(131,"Episode"),_.Wb(),_.Xb(132,"th"),_.Xc(133),_.jc(134,"translate"),_.Wb(),_.Xb(135,"th"),_.Xc(136,"Last Service Date"),_.Wb(),_.Xb(137,"th"),_.Xc(138),_.jc(139,"translate"),_.Wb(),_.Vc(140,pn,2,0,"th",16),_.Xb(141,"th",35),_.Xc(142),_.jc(143,"translate"),_.Wb(),_.Wb(),_.Wb(),_.Xb(144,"tbody"),_.Vc(145,bn,19,19,"ng-template",20),_.Wb(),_.Wb(),_.Wb(),_.Wb(),_.Wb(),_.Vc(146,gn,3,2,"ng-template",null,36,_.Wc)),2&e){var n=_.Ic(11),i=_.Ic(16),a=_.Ic(20),o=_.Ic(55),r=_.Ic(91),c=_.Ic(127),s=_.Ic(147);_.rc("nzSelectedIndex",t.selectedTabIndex),_.Db(1),_.sc("nzTitle",_.kc(2,87,"APPOINTMENTS.UPCOMING")),_.Db(5),_.rc("ngIf",!t.appointmentLoading.upcomingAppointments),_.Db(2),_.rc("ngModel",t.selectedSite),_.Db(1),_.rc("ngIf",null==t.siteList?null:t.siteList.length)("ngIfElse",n),_.Db(4),_.rc("ngModel",t.selectedStaff),_.Db(1),_.rc("ngIf",null==t.staffList?null:t.staffList.length)("ngIfElse",i),_.Db(4),_.rc("ngModel",t.dateRange),_.Db(1),_.rc("nzData",t.upcomingAppointments.result)("nzFrontPagination",!1)("nzNoResult",s)("nzShowPagination",!0)("nzShowSizeChanger",!0)("nzPageSizeOptions",_.xc(125,vn))("nzLoading",t.appointmentLoading.upcomingAppointments)("nzTotal",t.upcomingAppointments.totalCount)("nzPageIndex",t.pageIndex)("nzPageSize",t.pageSize),_.Db(8),_.Yc(_.kc(28,89,"HEADER.PATIENTS")),_.Db(6),_.Yc(_.kc(34,91,"TABLEHEADER.ASSIGNEDTO")),_.Db(2),_.rc("nzSortFn",!0)("nzSortDirections",_.xc(126,Sn))("nzSortOrder","ascend"),_.Db(1),_.Zc(" ",_.kc(37,93,"COMMON.DATE_TIME")," "),_.Db(4),_.rc("nzFilters",t.filterAttempt)("nzFilterFn",!0),_.Db(3),_.Yc(_.kc(44,95,"TABLEHEADER.ACTIONS")),_.Db(3),_.rc("ngForOf",a.data),_.Db(1),_.sc("nzTitle",_.kc(48,97,"APPOINTMENTS.COMPLETED")),_.Db(6),_.rc("ngModel",t.dateRange),_.Db(1),_.rc("nzData",t.completedAppointments.result)("nzFrontPagination",!1)("nzNoResult",s)("nzShowPagination",!0)("nzShowSizeChanger",!0)("nzPageSizeOptions",_.xc(127,vn))("nzLoading",t.appointmentLoading.completedAppointments)("nzTotal",t.completedAppointments.totalCount),_.Db(7),_.Yc(_.kc(62,99,"HEADER.PATIENTS")),_.Db(5),_.Yc(_.kc(67,101,"TABLEHEADER.ASSIGNEDTO")),_.Db(2),_.rc("nzSortFn",!0)("nzSortDirections",_.xc(128,Sn))("nzSortOrder","descend"),_.Db(1),_.Zc(" ",_.kc(70,103,"COMMON.DATE_TIME")," "),_.Db(4),_.rc("nzFilters",t.filterAttempt)("nzFilterFn",!0),_.Db(3),_.Yc(_.kc(77,105,"TABLEHEADER.ACTIONS")),_.Db(3),_.rc("ngForOf",o.data),_.Db(1),_.sc("nzTitle",_.kc(81,107,"APPOINTMENTS.UNATTENDED")),_.Db(7),_.rc("isFeaturePermitted",_.xc(129,zn)),_.Db(2),_.rc("ngModel",t.dateRange),_.Db(1),_.rc("nzData",t.unattendedAppointments.result)("nzFrontPagination",!1)("nzNoResult",s)("nzShowPagination",!0)("nzShowSizeChanger",!0)("nzPageSizeOptions",_.xc(130,vn))("nzPageIndex",t.pageIndex)("nzPageSize",t.pageSize)("nzLoading",t.appointmentLoading.unattendedAppointments)("nzTotal",t.unattendedAppointments.totalCount),_.Db(7),_.Yc(_.kc(98,109,"HEADER.PATIENTS")),_.Db(5),_.Yc(_.kc(103,111,"TABLEHEADER.ASSIGNEDTO")),_.Db(2),_.rc("nzSortFn",!0)("nzSortDirections",_.xc(131,Sn))("nzSortOrder","descend"),_.Db(1),_.Zc(" ",_.kc(106,113,"COMMON.DATE_TIME")," "),_.Db(4),_.rc("nzFilters",t.filterAttempt)("nzFilterFn",!0),_.Db(3),_.Yc(_.kc(113,115,"COMMON.REASON")),_.Db(3),_.Yc(_.kc(116,117,"TABLEHEADER.ACTIONS")),_.Db(3),_.rc("ngForOf",r.data),_.Db(6),_.rc("ngModel",t.dateRange),_.Db(1),_.rc("ngIf",!t.isCaretakerLogin),_.Db(1),_.rc("nzData",t.noAppointmentPatients)("nzNoResult",s)("nzShowPagination",!0)("nzShowSizeChanger",!0)("nzPageSizeOptions",_.xc(132,An))("nzLoading",t.appointmentLoading.noAppointmentPatients)("nzPageSize",t.pageSize),_.Db(7),_.Yc(_.kc(134,119,"COMMON.NAME")),_.Db(5),_.Yc(_.kc(139,121,"SITE")),_.Db(4),_.Yc(_.kc(143,123,"TABLEHEADER.ACTIONS")),_.Db(3),_.rc("ngForOf",c.data)}},directives:[dt.d,dt.a,F.c,F.a,l.q,x.d,b.u,b.x,ut.a,ut.c,bt.f,bt.n,bt.o,bt.e,bt.l,K.a,bt.k,bt.i,l.p,mt.a,gt.a,x.a,Z.a,G.a,ft.a,u.h,w.a,Y.d,ht.a,B.a,V.a,q.a,vt.a,Q.a,St.b],pipes:[J.a,ee.a,l.e,ie.a,te.a,ne.a,l.A],styles:["[_nghost-%COMP%]     .ant-tabs-tab{padding:12px}.appointments-card[_ngcontent-%COMP%]{margin:0 2%}.actions[_ngcontent-%COMP%]{font-size:20px;cursor:pointer}tr[_ngcontent-%COMP%]{cursor:default!important}.search-box[_ngcontent-%COMP%]{width:15%;margin-left:85%;margin-bottom:1%}.search-input[_ngcontent-%COMP%]{border-radius:5px!important}#actions-container[_ngcontent-%COMP%]{text-align:center!important}[_nghost-%COMP%]     .ant-pagination{float:right;margin-bottom:20px}.char-bound-field[_ngcontent-%COMP%]{max-width:18ch;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}label[_ngcontent-%COMP%]{display:inline-flex;padding:12px 0 0 5px}strong[_ngcontent-%COMP%]{font-weight:800}nz-tag[_ngcontent-%COMP%]{margin:5px 0 0 5px}a[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:not(.create-link){color:#0f2015d9}.inner-table[_ngcontent-%COMP%]   .ant-table-small[_ngcontent-%COMP%]   .ant-table-thead[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > th[_ngcontent-%COMP%],   .inner-table .ant-table-thead>tr>th{background:var(--grey)}[_nghost-%COMP%]     .ant-table-tbody>tr>td>.ant-table-wrapper:only-child .ant-table{margin:-36px 0}[_nghost-%COMP%]     .ant-table-column-sorter-down, [_nghost-%COMP%]     .ant-table-column-sorter-up{color:var(--grey)}[_nghost-%COMP%]     .ant-table-column-sorter-down.active, [_nghost-%COMP%]     .ant-table-column-sorter-up.active{color:var(--black)!important}[_nghost-%COMP%]     .ant-table-filter-trigger .anticon{color:var(--black)!important}.row-align[_ngcontent-%COMP%]{display:flex;align-items:flex-end}"]}),fn),In=r("bA1+"),yn=r("OS4Q"),Dn=r("tk/3"),Cn=r("AytR"),En=r("Ifg2"),On=((hn=function(){function e(){n(this,e),this.headersMap=new Map([["ID","id"],["FIRST NAME","firstName"],["LAST NAME","lastName"],["MRN#","mrn"],["DATE OF BIRTH","dateOfBirth"],["DATE","dateOfAppointment"],["START TIME","startTime"],["END TIME","endTime"],["TIMEZONE","timeZone"],["CLINICIAN NAME","staffName"]])}return a(e,[{key:"validateHeaders",value:function(e){var t=this;return e.forEach(function(e,n){Object.keys(e).forEach(function(n){Object.defineProperty(e,t.headersMap.get(n),Object.getOwnPropertyDescriptor(e,n)),delete e[n]}),e.rowId=n}),e}}]),e}()).\u0275fac=function(e){return new(e||hn)},hn.\u0275prov=_.Nb({token:hn,factory:hn.\u0275fac}),hn),Xn=r("D9mS");function Pn(e,t){if(1&e){var n=_.Yb();_.Xb(0,"h5"),_.Xb(1,"span",6),_.Sb(2,"i",7),_.Xc(3),_.Wb(),_.Xc(4," \xa0 "),_.Xb(5,"span",8),_.ec("click",function(e){return _.Lc(n),_.ic().removeFile(e)}),_.Sb(6,"i",9),_.Xc(7," Delete"),_.Wb(),_.Wb()}if(2&e){var i=_.ic();_.Db(3),_.Zc(" File Seleted: ",i.uploadedFileName,"")}}function Nn(e,t){if(1&e&&(_.Xb(0,"li"),_.Xc(1),_.Wb()),2&e){var n=t.$implicit;_.Db(1),_.Zc(" ",n," ")}}function Mn(e,t){if(1&e&&(_.Xb(0,"div"),_.Xb(1,"nz-card",13),_.Xb(2,"ul"),_.Vc(3,Nn,2,1,"li",12),_.Wb(),_.Wb(),_.Wb()),2&e){var n=t.$implicit,i=_.ic(2);_.Db(1),_.sc("nzTitle",n.key),_.rc("nzExtra",i.extraTemplate),_.Db(2),_.rc("ngForOf",n.value)}}function kn(e,t){if(1&e&&(_.Xb(0,"div",10),_.Xb(1,"nz-card",11),_.Vc(2,Mn,4,3,"div",12),_.jc(3,"keyvalue"),_.Wb(),_.Wb()),2&e){var n=_.ic(),i=_.Ic(13);_.Db(1),_.rc("nzTitle",i),_.Db(1),_.rc("ngForOf",_.kc(3,2,n.errors))}}function Ln(e,t){1&e&&(_.Xb(0,"span",14),_.Xb(1,"strong"),_.Xc(2,"Validation Errors"),_.Wb(),_.Wb())}var _n,Wn=((_n=function(e){o(i,e);var t=c(i);function i(e,a,o,r,c,s,l){var p;return n(this,i),(p=t.call(this))._router=e,p._http=a,p._appointmentsService=o,p._notificationsService=r,p._xlsxParserService=c,p._appointmentXlsxValidator=s,p._datePipe=l,p.mrnAndDobList=[],p.handleUpload=function(e){p.item=e,p.loading=!0,p.loadingText="Reading File...";var t=new FileReader;new Dn.g({bypass:"yes"}),t.onload=function(){var n=p._xlsxParserService.parse(t);try{p.data=p._appointmentXlsxValidator.validateHeaders(n[Object.keys(n)[0]]),p.mrnAndDobList=[];var i=p.data.map(function(e){return p.xlsxDataToAppointment(e)}),a=[];p.errors=new Map,i.forEach(function(t,n){var i,o,r,c;null==t&&[].push("Invalid Appointment Data"),p.isAppointment(t)?a.push(t):p.errors.set("Row : "+n,t),p.loading=!1,p.appointments=a,p.uploadedFileName=e.file.name,0===(null===(i=p.errors)||void 0===i?void 0:i.size)&&0===(null===(o=p.appointments)||void 0===o?void 0:o.length)&&(null===(r=p.errors)||void 0===r||r.set("Invalid File",["Invalid File - no appointment data found"])),(null===(c=p.errors)||void 0===c?void 0:c.size)||(p.errors=null,p._routeHelperService.setPrimaryEnableAction(!1))})}catch(o){return p.loading=!1,void p._notificationsService.error("Bulk Upload","Error while reading file headers!")}},t.readAsBinaryString(e.file)},p.uploadURL=Cn.g.url+"/v2/media/upload/"+Math.random().toString(10).substring(7)+".xlsx",p}return a(i,[{key:"ngOnInit",value:function(){var e=this;this._routeHelperService.isPrimaryActionTriggered().pipe(Object(Me.a)(function(e){return!!e}),Object(f.a)(this.unsubscribed)).subscribe(function(){return e.validateAndSave()}),this._routeHelperService.isSecondaryActionTriggered().pipe(Object(Me.a)(function(e){return!!e}),Object(f.a)(this.unsubscribed)).subscribe(function(){return e.downloadTemplate()}),this._routeHelperService.setPrimaryEnableAction(!0)}},{key:"xlsxDataToAppointment",value:function(e){var t;(null===(t=null==e?void 0:e.dateOfBirth)||void 0===t?void 0:t.length)&&(e.dateOfBirth=this._datePipe.transform(null==e?void 0:e.dateOfBirth,"yyyy-MM-dd"));var n=[],i=/^\d{4}-\d{2}-\d{2}$/,a=/^\d{2}:\d{2}:\d{2}$/;if(null!=e.firstName&&""!==e.firstName||n.push("Firstname of patient is missing"),null!=e.lastName&&""!=e.lastName||n.push("Lastname of patient is missing"),null==e.dateOfAppointment||""===e.dateOfAppointment?n.push("Appointment date is missing"):i.test(e.dateOfAppointment.trim())||n.push('Appointment date format is incorrect - use "yyyy-mm-dd" '),null!=e.staffName&&""!==e.staffName||n.push("Staff name is missing"),null!=e.mrn&&""!==e.mrn||n.push("MRN(Patient ID) is missing"),null==e.dateOfBirth||""===e.dateOfBirth?n.push("Date of Birth is missing"):i.test(e.dateOfBirth.trim())||n.push('Date of Birth format is incorrect - use "yyyy-mm-dd" '),null==e.startTime||""===e.startTime?n.push("Start Time is Missing"):a.test(e.startTime.trim())||n.push('Appointment start time format is incorrect - use "HH:MM:SS" '),null==e.endTime||""===e.endTime?n.push("Appointment end time is missing"):a.test(e.endTime.trim())||n.push('Appointment end time format is incorrect - use "HH:MM:SS" '),n.length>0)return n;function o(e,t){var n=new Date("1970-01-01T".concat(e));return{hour:n.getHours(),minute:n.getMinutes(),second:n.getSeconds()}}var r=new Date(e.dateOfAppointment.trim()),c=new Date(e.dateOfAppointment.trim()),s=o(e.startTime.trim()),l=o(e.endTime.trim());r.setHours(s.hour),r.setMinutes(s.minute),c.setHours(l.hour),c.setMinutes(l.minute);var p=new Intl.DateTimeFormat("en-US",{timeZone:e.timeZone,year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"}),d=p.format(r),u=p.format(c),b={startDate:Date.parse(d),endDate:Date.parse(u)};return this.mrn=e.mrn.trim(),this.dateOfBirth=e.dateOfBirth.trim(),this.mrnAndDobList.push({mrn:this.mrn,dateOfBirth:this.dateOfBirth}),{id:e.id,attendeeName:e.firstName.trim()+" "+e.lastName.trim(),attenderName:e.staffName.trim(),title:"",description:"",overallStatus:"APPROVED",attenderId:"",attendeeId:"",noteId:"",notesHistory:[],requestedBy:"",lastUpdatedBy:"",schedules:{},schedule:b,scheduleHistory:[],serviceIds:[],completionFormUrl:"",reason:"",episodeId:"",tenantId:"",dateParam:"",type:e.type,appointmentPurpose:"PATIENT_FOLLOW_UP",ownerType:S.a.USER,videoCallSessionId:""}}},{key:"isAppointment",value:function(e){return e.hasOwnProperty("id")}},{key:"removeFile",value:function(e){return this.uploadedFileName=null,this.appointments=null,this._routeHelperService.setPrimaryEnableAction(!1),e.stopPropagation(),!1}},{key:"downloadTemplate",value:function(){window.open("https://api.cooeyhealth.com/v1/assets/download/?filename=bulk-upload-appointments-template.xlsx","_blank")}},{key:"validateAndSave",value:function(){var e=this,t=new Dn.g({bypass:"yes"});this.errors=null,this.loading=!0,this.loadingText="Uploading file to server ...",this._appointmentsService.validateUploadAppointments(this.appointments,this.mrnAndDobList).subscribe(function(n){e.errors=n,Object.keys(e.errors).length?e.loading=!1:e._http.post(e.uploadURL,e.item.file,{headers:t,observe:"response",responseType:"text"}).subscribe(function(t){200==t.status?e._appointmentsService.bulkUploadAppointments(t.body).subscribe(function(){e._notificationsService.success("Appointments","Appointments uploaded successfully!"),e._router.navigate(["appointments"],{queryParams:{tab:"upcoming"}})}):e._notificationsService.error("Bulk Upload","Something went wrong, please try again!")})},function(t){var n;e.loading=!1,(null===(n=null==t?void 0:t.error)||void 0===n?void 0:n.message)&&e._notificationsService.error("Validation Bulk Upload","Error in validating document!")})}}]),i}(h.a)).\u0275fac=function(e){return new(e||_n)(_.Rb(u.g),_.Rb(Dn.c),_.Rb(A.a),_.Rb(W.b),_.Rb(En.a),_.Rb(On),_.Rb(l.e))},_n.\u0275cmp=_.Lb({type:_n,selectors:[["app-bulk-upload"]],features:[_.Cb([On,En.a]),_.Ab],decls:14,vars:10,consts:[[1,"container"],["nzType","drag","nzAccept",".xlsx",3,"nzCustomRequest","nzShowButton","nzShowUploadList","nzDisabled"],[4,"ngIf"],["nz-button","","nzType","primary","nzSize","large",3,"disabled"],["style","margin-top:10px",4,"ngIf"],["errorTitle",""],[2,"color","#8BC34A"],["nz-icon","","nzType","paper-clip","nzTheme","outline"],[2,"color","#FF0000","cursor","pointer",3,"click"],["nz-icon","","nzType","delete","nzTheme","outline"],[2,"margin-top","10px"],[3,"nzTitle"],[4,"ngFor","ngForOf"],["nzType","inner",2,"margin-top","16px",3,"nzTitle","nzExtra"],["nz-typography","","nzType","danger"]],template:function(e,t){1&e&&(_.Xb(0,"div",0),_.Xb(1,"nz-card"),_.Xb(2,"nz-upload",1),_.Vc(3,Pn,8,1,"h5",2),_.Xb(4,"button",3),_.Xc(5," BROWSE / DRAG "),_.Wb(),_.Xb(6,"p"),_.Sb(7,"br"),_.Xc(8),_.jc(9,"translate"),_.Wb(),_.Wb(),_.Sb(10,"br"),_.Wb(),_.Vc(11,kn,4,4,"div",4),_.Vc(12,Ln,3,0,"ng-template",null,5,_.Wc),_.Wb()),2&e&&(_.Db(2),_.rc("nzCustomRequest",t.handleUpload)("nzShowButton",!0)("nzShowUploadList",!1)("nzDisabled",t.uploadedFileName),_.Db(1),_.rc("ngIf",t.uploadedFileName),_.Db(1),_.rc("disabled",t.uploadedFileName),_.Db(4),_.Zc(" ",_.kc(9,8,"COMMON.DRAG_AND_UPLOAD")," "),_.Db(3),_.rc("ngIf",t.errors))},directives:[R.a,Xn.a,l.q,q.a,Q.a,Z.a,G.a,l.p,w.a],pipes:[J.a,l.j],styles:[""]}),_n),Rn=r("Kj3r"),wn=r("eIep"),Vn=r("XNiG"),Fn=r("LRne"),xn=r("ZyQt"),jn=r("ZO2R"),Un=r("UpsY");function Hn(e,t){if(1&e&&(_.Vb(0),_.Xb(1,"span",17),_.Xb(2,"span",18),_.Xc(3),_.jc(4,"tenantName"),_.Wb(),_.Wb(),_.Ub()),2&e){var n=_.ic().$implicit;_.Db(3),_.Yc(_.kc(4,1,null==n?null:n.tenantId))}}function Bn(e,t){if(1&e&&(_.Vb(0),_.Xb(1,"nz-option",13),_.jc(2,"userLocation"),_.Xb(3,"span",14),_.Xb(4,"span",15),_.Xc(5),_.Wb(),_.Vc(6,Hn,5,3,"ng-container",16),_.Wb(),_.Wb(),_.Ub()),2&e){var n=t.$implicit;_.Db(1),_.rc("nzLabel",_.kc(2,3,null==n?null:n.id))("nzValue",null==n?null:n.id),_.Db(4),_.Zc(" ",null==n?null:n.name," ")}}function Yn(e,t){if(1&e&&(_.Vb(0),_.Vc(1,Bn,7,5,"ng-container",12),_.Ub()),2&e){var n=_.ic();_.Db(1),_.rc("ngForOf",n.siteList)}}function $n(e,t){1&e&&(_.Xb(0,"div",19),_.Xb(1,"span"),_.Xc(2,"Select Staff : "),_.Wb(),_.Wb())}function qn(e,t){if(1&e&&_.Sb(0,"nz-option",22),2&e){var n=t.$implicit;_.rc("nzValue",null==n?null:n.id)("nzLabel",null==n?null:n.fullName)}}function Qn(e,t){if(1&e&&(_.Vb(0),_.Vc(1,qn,1,2,"nz-option",21),_.Ub()),2&e){var n=_.ic(2);_.Db(1),_.rc("ngForOf",n.staffList)}}function Zn(e,t){if(1&e){var n=_.Yb();_.Xb(0,"div",4),_.Xb(1,"nz-select",20),_.ec("ngModelChange",function(e){return _.Lc(n),_.ic().selectedStaff=e})("ngModelChange",function(){return _.Lc(n),_.ic().staffChanged()}),_.Vc(2,Qn,2,1,"ng-container",6),_.Wb(),_.Wb()}if(2&e){var i=_.ic(),a=_.Ic(27);_.Db(1),_.rc("ngModel",i.selectedStaff),_.Db(1),_.rc("ngIf",null==i.staffList?null:i.staffList.length)("ngIfElse",a)}}function Kn(e,t){1&e&&(_.Xb(0,"div",19),_.Xb(1,"span"),_.Xc(2,"Select Date : "),_.Wb(),_.Wb())}function Gn(e,t){if(1&e){var n=_.Yb();_.Xb(0,"div",4),_.Xb(1,"nz-date-picker",23),_.ec("ngModelChange",function(e){return _.Lc(n),_.ic().date=e})("ngModelChange",function(){return _.Lc(n),_.ic().getUpcomingAppointments()}),_.Wb(),_.Wb()}if(2&e){var i=_.ic();_.Db(1),_.rc("ngModel",i.date)}}function Jn(e,t){if(1&e){var n=_.Yb();_.Vb(0),_.Xb(1,"app-audio-call-widget",37),_.ec("click",function(){_.Lc(n);var e=_.ic().$implicit;return _.ic(2).logAction("audio_call",null==e?null:e.attendeeId)}),_.Wb(),_.Ub()}if(2&e){var i=_.ic().$implicit;_.Db(1),_.rc("userId",null==i?null:i.attendeeId)("phoneNumbers",null==i?null:i.phoneNumbers)("disabled",!1)("renderVital",!1)("appointmentId",null==i?null:i.id)}}function ei(e,t){if(1&e){var n=_.Yb();_.Xb(0,"tr"),_.Xb(1,"td",31),_.ec("nzCheckedChange",function(e){_.Lc(n);var i=t.$implicit;return _.ic(2).onItemChecked(i.id,e)}),_.Wb(),_.Xb(2,"td"),_.Xc(3),_.Wb(),_.Xb(4,"td",32),_.Xb(5,"span",33),_.Xc(6),_.Wb(),_.Wb(),_.Xb(7,"td"),_.Sb(8,"app-patient-status-tag",34),_.Wb(),_.Xb(9,"td"),_.Vc(10,Jn,2,5,"ng-container",10),_.Xb(11,"app-icons",35),_.ec("click",function(){_.Lc(n);var e=t.$implicit;return _.ic(2).sendSMS(null==e?null:e.attendeeId,null==e?null:e.attenderName,null==e||null==e.schedule?null:e.schedule.startDate,null==e?null:e.type,null==e?null:e.id)}),_.Wb(),_.Wb(),_.Xb(12,"td",36),_.Xb(13,"span",33),_.Xc(14),_.Wb(),_.Wb(),_.Xb(15,"td"),_.Xc(16),_.jc(17,"date"),_.Wb(),_.Xb(18,"td"),_.Xb(19,"span",33),_.jc(20,"purposeLabel"),_.Xc(21),_.jc(22,"purposeLabel"),_.Wb(),_.Wb(),_.Xb(23,"td"),_.Xc(24),_.Wb(),_.Wb()}if(2&e){var i=t.$implicit,a=_.ic(2);_.Db(1),_.rc("nzChecked",a.setOfCheckedId.has(i.id)),_.Db(2),_.Yc((null==i?null:i.episodeType)||"N/A"),_.Db(1),_.tc("routerLink","/patient/view/",null==i?null:i.attendeeId,""),_.Db(1),_.sc("nzTooltipTitle",(null==i?null:i.attendeeName)||"N/A"),_.Db(1),_.Zc(" ",(null==i?null:i.attendeeName)||"N/A"," "),_.Db(2),_.rc("patientStatus",null==i?null:i.patientStatus),_.Db(2),_.rc("ngIf","AUDIO_CALL"===(null==i?null:i.type)&&a.isCallButtonEnabled),_.Db(3),_.sc("nzTooltipTitle",(null==i?null:i.attenderName)||"N/A"),_.Db(1),_.Zc(" ",(null==i?null:i.attenderName)||"N/A"," "),_.Db(2),_.Yc(_.lc(17,13,null==i||null==i.schedule?null:i.schedule.startDate,"MMM dd, hh:mm a")),_.Db(3),_.sc("nzTooltipTitle",_.kc(20,16,null==i?null:i.appointmentPurpose)),_.Db(2),_.Zc(" ",_.kc(22,18,null==i?null:i.appointmentPurpose)," "),_.Db(3),_.Yc(null==i?null:i.attemptCount)}}function ti(e,t){1&e&&(_.Xb(0,"nz-tag",41),_.Sb(1,"i",42),_.Xb(2,"span"),_.Xc(3,"Please select a staff to continue"),_.Wb(),_.Wb())}function ni(e,t){if(1&e&&(_.Xb(0,"span"),_.Xc(1),_.jc(2,"translate"),_.Wb(),_.Xb(3,"p"),_.Xb(4,"span"),_.Vc(5,ti,4,0,"nz-tag",40),_.Wb(),_.Wb()),2&e){var n=_.ic(3);_.Db(1),_.Zc(" ",_.kc(2,2,"COMMON.NODATA")," "),_.Db(4),_.rc("ngIf",!n.selectedStaff)}}function ii(e,t){if(1&e&&(_.Xb(0,"nz-empty",38),_.Vc(1,ni,6,4,"ng-template",null,39,_.Wc),_.Wb()),2&e){var n=_.Ic(2);_.rc("nzNotFoundImage","https://gw.alipayobjects.com/mdn/miniapp_social/afts/img/A*pevERLJC9v0AAAAAAAAAAABjAQAAAQ/original")("nzNotFoundContent",n)}}var ai=function(){return[10,50,100,150,200]},oi=function(){return["ascend","descend"]};function ri(e,t){if(1&e){var n=_.Yb();_.Xb(0,"nz-table",24,25),_.ec("nzQueryParams",function(e){return _.Lc(n),_.ic().onQueryParamsChange(e)}),_.Xb(2,"thead"),_.Xb(3,"tr"),_.Xb(4,"th",26),_.ec("nzCheckedChange",function(e){return _.Lc(n),_.ic().checked=e})("nzCheckedChange",function(e){return _.Lc(n),_.ic().onAllChecked(e)}),_.Wb(),_.Xb(5,"th"),_.Xc(6,"Episode"),_.Wb(),_.Xb(7,"th"),_.Xc(8),_.jc(9,"translate"),_.Wb(),_.Sb(10,"th"),_.Sb(11,"th"),_.Xb(12,"th"),_.Xc(13),_.jc(14,"translate"),_.Wb(),_.Xb(15,"th",27),_.Xc(16),_.jc(17,"translate"),_.Wb(),_.Xb(18,"th"),_.Xc(19,"Type"),_.Wb(),_.Xb(20,"th",28),_.Xc(21,"Attempt"),_.Wb(),_.Wb(),_.Wb(),_.Xb(22,"tbody"),_.Vc(23,ei,25,20,"ng-template",29),_.Wb(),_.Vc(24,ii,3,2,"ng-template",null,30,_.Wc),_.Wb()}if(2&e){var i=_.Ic(1),a=_.Ic(25),o=_.ic();_.rc("nzData",o.upcomingAppointments.result)("nzFrontPagination",!1)("nzNoResult",a)("nzShowPagination",!0)("nzShowSizeChanger",!0)("nzPageSizeOptions",_.xc(28,ai))("nzLoading",o.upcomingAppointmentsLoading)("nzTotal",o.upcomingAppointments.totalCount)("nzPageIndex",o.pageIndex)("nzPageSize",o.pageSize),_.Db(4),_.rc("nzSelections",o.listOfSelection)("nzChecked",o.checked)("nzIndeterminate",o.indeterminate),_.Db(4),_.Yc(_.kc(9,22,"HEADER.PATIENTS")),_.Db(5),_.Yc(_.kc(14,24,"TABLEHEADER.ASSIGNEDTO")),_.Db(2),_.rc("nzSortFn",!0)("nzSortDirections",_.xc(29,oi))("nzSortOrder","ascend"),_.Db(1),_.Zc(" ",_.kc(17,26,"COMMON.DATE_TIME"),""),_.Db(4),_.rc("nzFilters",o.filterAttempt)("nzFilterFn",!0),_.Db(3),_.rc("ngForOf",i.data)}}function ci(e,t){if(1&e){var n=_.Yb();_.Vb(0),_.Xb(1,"selected-patient-action",43),_.ec("onPrimaryActionButtonClicked",function(){return _.Lc(n),_.ic().primaryButtonClick()})("onSecondaryActionButtonClicked",function(){return _.Lc(n),_.ic().reset()}),_.Wb(),_.Ub()}if(2&e){var i=_.ic();_.Db(1),_.rc("primaryActionText",i.primaryActionText)("primaryButtonLoading",i.primaryButttonloading)("secondaryActionText",i.secondaryActionText)("totalPatientsSelected",i.setOfCheckedId.size)("totalCount",i.upcomingAppointments.totalCount)}}function si(e,t){1&e&&(_.Xb(0,"nz-option",44),_.Sb(1,"span",45),_.Xc(2," Loading Data... "),_.Wb())}var li,pi,di,ui=[{path:"",component:Tn,pathMatch:"full",data:yn.a.Listing,canActivate:[g.a,In.a]},{path:"details/:id",component:Ce.a,data:yn.a.Detail,canActivate:[g.a,In.a]},{path:"create",component:De,data:yn.a.Form,canActivate:[g.a,In.a]},{path:"create/:id",component:De,data:yn.a.Form,canActivate:[g.a,In.a]},{path:"bulk-upload",component:Wn,data:yn.a.BulkUpload,canActivate:[g.a,In.a]},{path:"bulk-reassign",component:(li=function(e){o(i,e);var t=c(i);function i(e,a,o,r,c){var s;return n(this,i),(s=t.call(this))._appointmentsService=e,s._staffService=a,s._episodeService=o,s._dataSharingService=r,s._appointmentModalService=c,s.dateRange=[],s.upcomingAppointments=new qe.a,s.upcomingAppointmentsLoading=!1,s.pageSize=10,s.pageIndex=1,s.showTable=!1,s.checked=!1,s.indeterminate=!1,s.setOfCheckedId=new Set,s.primaryActionText="Reassign",s.secondaryActionText="Cancel",s.primaryButttonloading=!1,s.ignoreTableQueryChange=!1,s.fetchAppointments$=new Vn.a,s.upcomingAppointments.result=[],s}return a(i,[{key:"ngOnInit",value:function(){var e=this;this.initializeFetchAppointment(),this.getSite(),this._dataSharingService.onSubTenantChange().pipe(Object(f.a)(this.unsubscribed)).subscribe(function(t){e.initializeFetchAppointment(),e.getSite()})}},{key:"ngAfterViewInit",value:function(){"CARE_TAKER"===localStorage.getItem("loggedInUserAccountType")&&(this.isCaretakerLogin=!0,this.selectedStaff=localStorage.getItem("loggedInUser"))}},{key:"getSite",value:function(){var e=this;this._staffService.fetchSitesForStaff().subscribe(function(t){e.siteList=t})}},{key:"getStaff",value:function(){var e=this;this.date=null,this.selectedStaff=null,this.showTable=!1,this.ignoreTableQueryChange=!0,this.selectedSite?this._staffService.fetchStaffList(at.a.MONITORING_STAFF,null,null,this.selectedSite).subscribe(function(t){e.staffList=t||[]}):this.staffList=[]}},{key:"initializeFetchAppointment",value:function(){var e=this;this.fetchAppointments$.pipe(Object(Rn.a)(500)).pipe(Object(wn.a)(function(){return e.getUpcomingAppointmentsObservable()})).pipe(Object(f.a)(this.unsubscribed)).subscribe(function(t){e.upcomingAppointments=t,e.updateEpisodeType(e.upcomingAppointments,function(){e.upcomingAppointmentsLoading=!1})})}},{key:"staffChanged",value:function(){this.date&&this.getUpcomingAppointments()}},{key:"getUpcomingAppointments",value:function(){this.fetchAppointments$.next()}},{key:"getUpcomingAppointmentsObservable",value:function(){var e,t;if(this.showTable=!0,!this.selectedSite||!this.selectedStaff||!this.date)return Object(Fn.a)(new qe.a);this.upcomingAppointmentsLoading=!0,this.upcomingAppointments=new qe.a;var n=null===(e=Object(Oe.a)(this.date))||void 0===e?void 0:e.getTime(),i=null===(t=Object(Xe.a)(this.date))||void 0===t?void 0:t.getTime();return this._appointmentsService.fetchUpcomingAppointments(this.getOffset(this.pageIndex),n,i,null,this.selectedStaff,null,null,this.pageSize,null,null,!0)}},{key:"onQueryParamsChange",value:function(e){var t=e.pageSize,n=e.pageIndex;this.pageSize=t,this.pageIndex=n,this.ignoreTableQueryChange?this.ignoreTableQueryChange=!1:this.getUpcomingAppointments()}},{key:"getOffset",value:function(e){return Math.max(0,(e-1)*this.pageSize)}},{key:"updateEpisodeType",value:function(e,t){var n,i=null===(n=e.result)||void 0===n?void 0:n.map(function(e){return e.episodeId}).filter(function(e){return null!=e}).filter(function(e,t,n){return n.indexOf(e)==t});i&&0!=i.length?this._episodeService.getEpisodeByIds(i).subscribe(function(n){e.result.forEach(function(e){return e.episodeType=n[e.episodeId]}),t()}):t()}},{key:"updateCheckedSet",value:function(e,t){t?this.setOfCheckedId.add(e):this.setOfCheckedId.delete(e)}},{key:"onItemChecked",value:function(e,t){this.updateCheckedSet(e,t),this.refreshCheckedStatus()}},{key:"onAllChecked",value:function(e){var t,n=this;null===(t=this.upcomingAppointments)||void 0===t||t.result.forEach(function(t){return n.updateCheckedSet(t.id,e)}),this.refreshCheckedStatus()}},{key:"refreshCheckedStatus",value:function(){var e,t,n=this;this.checked=null===(e=this.upcomingAppointments)||void 0===e?void 0:e.result.every(function(e){return n.setOfCheckedId.has(e.id)}),this.indeterminate=(null===(t=this.upcomingAppointments)||void 0===t?void 0:t.result.some(function(e){return n.setOfCheckedId.has(e.id)}))&&!this.checked}},{key:"primaryButtonClick",value:function(){var e=this,t=this.staffList.filter(function(t){return t.id!=e.selectedStaff});this._appointmentModalService.showReassignModal(Array.from(this.setOfCheckedId),t).afterClose.subscribe(function(){e.reset(null),e.getUpcomingAppointments()})}},{key:"reset",value:function(e){this.onAllChecked(!1)}}]),i}(h.a),li.\u0275fac=function(e){return new(e||li)(_.Rb(A.a),_.Rb(it.a),_.Rb(Ee.a),_.Rb(T.a),_.Rb(ot.a))},li.\u0275cmp=_.Lb({type:li,selectors:[["app-appointment-bulk-reschedule"]],features:[_.Ab],decls:28,vars:9,consts:[[1,"container"],["nz-row","","nzGutter","16"],["nz-col",""],["nz-col","",1,"select-label"],["nz-col","","nzSpan","4"],["nzPlaceHolder","Select a site","nzAllowClear","","nzShowSearch","",3,"ngModel","ngModelChange"],[4,"ngIf","ngIfElse"],["nz-col","","class","select-label","nzOffset","1",4,"ngIf"],["nz-col","","nzSpan","4",4,"ngIf"],[3,"nzData","nzFrontPagination","nzNoResult","nzShowPagination","nzShowSizeChanger","nzPageSizeOptions","nzLoading","nzTotal","nzPageIndex","nzPageSize","nzQueryParams",4,"ngIf"],[4,"ngIf"],["staffLoading",""],[4,"ngFor","ngForOf"],["nzCustomContent","",3,"nzLabel","nzValue"],[2,"display","flex"],[2,"width","70%"],[4,"isAccessAcrossTenantEnabled"],[2,"width","30%"],["nz-typography","","nzType","secondary",2,"color","var(--primary-color)"],["nz-col","","nzOffset","1",1,"select-label"],["nzPlaceHolder","Select a staff","nzAllowClear","","nzShowSearch","",3,"ngModel","ngModelChange"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],[3,"nzValue","nzLabel"],[3,"ngModel","ngModelChange"],[3,"nzData","nzFrontPagination","nzNoResult","nzShowPagination","nzShowSizeChanger","nzPageSizeOptions","nzLoading","nzTotal","nzPageIndex","nzPageSize","nzQueryParams"],["upcoming",""],[3,"nzSelections","nzChecked","nzIndeterminate","nzCheckedChange"],["nzColumnKey","date",3,"nzSortFn","nzSortDirections","nzSortOrder"],["nzColumnKey","attempt","nzWidth","100px",3,"nzFilters","nzFilterFn"],["ngFor","",3,"ngForOf"],["noData",""],[3,"nzChecked","nzCheckedChange"],["actionable","",3,"routerLink"],["nz-typography","","nzEllipsis","","nz-tooltip","",3,"nzTooltipTitle"],["isToolTipEnabled","true",3,"patientStatus"],["name","sms",3,"click"],[1,"char-bound-field"],[3,"userId","phoneNumbers","disabled","renderVital","appointmentId","click"],[2,"flex","1","overflow","auto",3,"nzNotFoundImage","nzNotFoundContent"],["contentTpl",""],["nzColor","processing",4,"ngIf"],["nzColor","processing"],["nz-icon","","nzType","exclamation-circle"],["userType","APPOINTMENT",3,"primaryActionText","primaryButtonLoading","secondaryActionText","totalPatientsSelected","totalCount","onPrimaryActionButtonClicked","onSecondaryActionButtonClicked"],["nzDisabled","","nzCustomContent",""],["nz-icon","","nzType","loading",1,"loading-icon"]],template:function(e,t){if(1&e&&(_.Xb(0,"div",0),_.Xb(1,"div",1),_.Xb(2,"div",2),_.Xb(3,"h3"),_.Xc(4,"Reassign Appointments Guide"),_.Wb(),_.Xb(5,"ul"),_.Xb(6,"li"),_.Xc(7,"Use these filters to re-assign one or multiple appointments any staff member has on a specific day. You can start by choosing a site, any staff member on that site, and a date."),_.Wb(),_.Xb(8,"li"),_.Xc(9,"Appointments can be re-assigned only to other staff members in the same site."),_.Wb(),_.Xb(10,"li"),_.Xc(11,"If all appointments aren't re-assigned at once, try re-assigning them individually. If there are no staff available, please try rescheduling the appointment."),_.Wb(),_.Wb(),_.Wb(),_.Wb(),_.Sb(12,"br"),_.Xb(13,"div",1),_.Xb(14,"div",3),_.Xb(15,"span"),_.Xc(16,"Select Site : "),_.Wb(),_.Wb(),_.Xb(17,"div",4),_.Xb(18,"nz-select",5),_.ec("ngModelChange",function(e){return t.selectedSite=e})("ngModelChange",function(){return t.getStaff()}),_.Vc(19,Yn,2,1,"ng-container",6),_.Wb(),_.Wb(),_.Vc(20,$n,3,0,"div",7),_.Vc(21,Zn,3,3,"div",8),_.Vc(22,Kn,3,0,"div",7),_.Vc(23,Gn,2,1,"div",8),_.Wb(),_.Vc(24,ri,26,30,"nz-table",9),_.Vc(25,ci,2,5,"ng-container",10),_.Wb(),_.Vc(26,si,3,0,"ng-template",null,11,_.Wc)),2&e){var n=_.Ic(27);_.Db(18),_.rc("ngModel",t.selectedSite),_.Db(1),_.rc("ngIf",null==t.siteList?null:t.siteList.length)("ngIfElse",n),_.Db(1),_.rc("ngIf",t.selectedSite),_.Db(1),_.rc("ngIf",t.selectedSite),_.Db(1),_.rc("ngIf",t.selectedSite&&t.selectedStaff),_.Db(1),_.rc("ngIf",t.selectedSite&&t.selectedStaff),_.Db(1),_.rc("ngIf",t.showTable),_.Db(1),_.rc("ngIf",t.setOfCheckedId.size>0)}},directives:[F.c,F.a,x.d,b.u,b.x,l.q,l.p,x.a,K.a,w.a,ut.a,bt.f,bt.n,bt.o,bt.e,bt.l,bt.m,bt.k,bt.i,bt.j,ft.a,u.h,Y.d,ht.a,B.a,vt.a,St.b,xn.a,Z.a,G.a,jn.a],pipes:[Un.a,te.a,J.a,l.e,ie.a],styles:["[_nghost-%COMP%]     .ant-checkbox-wrapper{padding-left:16px;padding-right:8px;border-spacing:0!important}[_nghost-%COMP%]     .ant-checkbox-inner:after{border-color:var(--primary-color)}[_nghost-%COMP%]     .ant-checkbox-disabled .ant-checkbox-inner{background:gray 0 0 no-repeat padding-box;opacity:.5}[_nghost-%COMP%]     .ant-checkbox-disabled .ant-checkbox-inner:after{border-color:var(--neutral-color)!important}[_nghost-%COMP%]     .ant-checkbox-indeterminate .ant-checkbox-inner:after{border-color:var(--primary-color);background-color:var(--primary-color)}.select-label[_ngcontent-%COMP%]{margin-top:6px}"]}),li),data:yn.a.BulkReschedule,canActivate:[g.a,In.a]}],bi=((pi=function e(){n(this,e)}).\u0275mod=_.Pb({type:pi}),pi.\u0275inj=_.Ob({factory:function(e){return new(e||pi)},imports:[[u.k.forChild(ui)],u.k]}),pi),mi=r("bKRa"),gi=((di=function e(t){n(this,e),this.translationService=t,t.setLanguage()}).\u0275mod=_.Pb({type:di}),di.\u0275inj=_.Ob({factory:function(e){return new(e||di)(_.bc(Ge.a))},imports:[[bi,d.a,l.c,m.a,u.k,b.o,s.a,p.a.forRoot(),mi.a,U.b]]}),di)}}])}();