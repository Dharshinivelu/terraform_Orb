!function(){function e(e,t){var i;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(i=n(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,l=!0,r=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return l=e.done,e},e:function(e){r=!0,s=e},f:function(){try{l||null==i.return||i.return()}finally{if(r)throw s}}}}function t(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||n(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,i=r(e);if(t){var a=r(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return l(this,n)}}function l(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function r(e){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function u(e,t,n){return t&&d(e.prototype,t),n&&d(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{"1YrE":function(e,t,n){"use strict";n.d(t,"a",function(){return s});var i=n("AytR"),a=n("fXoL"),o=n("tk/3"),s=function(){var e=function(){function e(t){c(this,e),this._http=t,this.rootURL=i.g.url}return u(e,[{key:"savePlanOfCare",value:function(e){return this._http.post("".concat(this.rootURL,"/v3/plan-of-care"),JSON.stringify(e))}},{key:"savePlanOfCareEvent",value:function(e,t){return this._http.post("".concat(this.rootURL,"/v3/plan-of-care/").concat(e,"/event"),JSON.stringify(t))}},{key:"fetchPlanOfCare",value:function(e){return this._http.get("".concat(this.rootURL,"/v3/plan-of-care/").concat(e))}},{key:"fetchPlanOfCareById",value:function(e){return this._http.get("".concat(this.rootURL,"/v3/plan-of-care/details/").concat(e))}},{key:"archivePlanOfCare",value:function(e){return this._http.delete("".concat(this.rootURL,"/v3/plan-of-care/").concat(e))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(a.bc(o.c))},e.\u0275prov=a.Nb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},Edj7:function(e,t,n){"use strict";n.d(t,"a",function(){return g});var i=n("FH+g"),a=n("igu/"),o=n("WoUL"),s=n("fXoL"),l=n("tyNb"),r=n("bNXi"),d=n("ofXK"),b=n("ZKr6"),p=n("glKu");function f(e,t){if(1&e){var n=s.Yb();s.Xb(0,"app-icons",2),s.ec("click",function(){return s.Lc(n),s.ic(2).initiateVideoCall()}),s.Wb()}}var v=function(){return["VIDEO_CALL"]};function h(e,t){1&e&&(s.Vb(0),s.Vc(1,f,1,0,"app-icons",1),s.Ub()),2&e&&(s.Db(1),s.rc("isFeaturePermitted",s.xc(1,v)))}var g=function(){var e=function(){function e(t,n,i,a,o,s){c(this,e),this._router=t,this._activatedRoute=n,this._videoCallService=i,this._dataSharingService=a,this._translationService=o,this._notificationsService=s}return u(e,[{key:"ngOnInit",value:function(){var e=this;this.$tenantConfigObserver=this._dataSharingService.tenantSettings,this.env="prod",this.isCallButtonEnabled=!0,this.$translationSubscription=this._translationService.getMultiple("PATIENT_ALREADY_IN_ANOTHER_CALL","YOU_ARE_ALREADY_IN_CALL","VIDEOCALL.VIDEOCALL","COMMON.INVALID_SESSION","COMMON.SESSION_EXPIRED").subscribe(function(t){e.translatedStrings=t})}},{key:"ngOnDestroy",value:function(){var e,t;null===(e=this.$activatedRouteObserver)||void 0===e||e.unsubscribe(),null===(t=this.$translationSubscription)||void 0===t||t.unsubscribe()}},{key:"subscribeToActivatedRoute",value:function(){var e=this;this.$activatedRouteObserver=this._activatedRoute.queryParams.subscribe(function(t){"debug"==t.env&&(e.env=t.env)})}},{key:"initiateVideoCall",value:function(){var e=this;if(this.isCallButtonEnabled){this.isCallButtonEnabled=!1;var t=localStorage.getItem("loggedInUser");this._videoCallService.videocallSessionCheck(t).subscribe(function(t){e._videoCallService.videocallSessionCheck(e.userId).subscribe(function(){e.openCallWindow(e.userId)},function(t){e.callError(t,e.translatedStrings.get("PATIENT_ALREADY_IN_ANOTHER_CALL"))})},function(t){e.callError(t,e.translatedStrings.get("YOU_ARE_ALREADY_IN_CALL"))})}}},{key:"openCallWindow",value:function(e){var t=this._router.serializeUrl(this._router.createUrlTree(["/video-call/"+e],{queryParams:{env:this.env,appointmentSessionId:this.appointmentSessionId,appointmentId:this.appointmentId}}));this.isCallButtonEnabled=!0,window.open(t,"_blank")}},{key:"callError",value:function(e,t){403==e.status?this._notificationsService.create("error",this.translatedStrings.get("VIDEOCALL.VIDEOCALL"),t):401==e.status&&(this._notificationsService.create("error",this.translatedStrings.get("COMMON.INVALID_SESSION"),this.translatedStrings.get("COMMON.SESSION_EXPIRED")),this._router.navigate(["logout"])),this.isCallButtonEnabled=!0}}]),e}();return e.\u0275fac=function(t){return new(t||e)(s.Rb(l.g),s.Rb(l.a),s.Rb(i.a),s.Rb(a.a),s.Rb(o.a),s.Rb(r.b))},e.\u0275cmp=s.Lb({type:e,selectors:[["app-video-call-widget"]],inputs:{userId:"userId",appointmentId:"appointmentId",appointmentSessionId:"appointmentSessionId"},decls:2,vars:3,consts:[[4,"ngIf"],["name","videoCall","size","20px",3,"click",4,"isFeaturePermitted"],["name","videoCall","size","20px",3,"click"]],template:function(e,t){if(1&e&&(s.Vc(0,h,2,2,"ng-container",0),s.jc(1,"async")),2&e){var n;s.rc("ngIf",null==(n=s.kc(1,1,t.$tenantConfigObserver))||null==n.videoCallConfig?null:n.videoCallConfig.enabled)}},directives:[d.q,b.a,p.a],pipes:[d.b],styles:["app-icons[_ngcontent-%COMP%]{margin:0 10px}"]}),e}()},I2os:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var i=function e(){c(this,e)}},KZd8:function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return o});var i=function e(){c(this,e),this.isDurationEditable=!0,this.timeInDays=30},a=function e(){c(this,e),this.type="RPM",this.tmsSummaryAdherenceEnabled=!0,this.vitalAdherenceEnabled=!0,this.archived=!1,this.durationSettings=new i},o=function e(){c(this,e)}},Lrxu:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return a}),n("rqHP"),n("ua0i");var i=function(e){return e.OBTAINED="OBTAINED",e.IN_PROGRESS="IN_PROGRESS",e.DENIED="DENIED",e.TO_BE_PROCESSED="TO_BE_PROCESSED",e.ARCHIVED="ARCHIVED",e.REVOKED="REVOKED",e}({}),a=function(e){return e.VERBAL_CONSENT="VERBAL_CONSENT",e.APP_CONSENT="APP_CONSENT",e.SMS_CONSENT="SMS_CONSENT",e.MANUAL_CONSENT="MANUAL_CONSENT",e.DIGITAL_CONSENT="DIGITAL_CONSENT",e}({})},"OG+h":function(e,t,n){"use strict";n.d(t,"a",function(){return S});var i=n("M34a"),a=n("jKzE"),o=n("ofXK"),s=n("3pGX"),l=n("Dwgb"),r=n("AytR"),d=n("I2os"),b=n("fXoL"),p=n("dEAy"),f=n("bNXi"),v=n("tyNb"),h=n("rMZv"),g=n("wjar"),m=n("glKu"),C=n("dRHE");function D(e,t){if(1&e){var n=b.Yb();b.Xb(0,"tr"),b.Xb(1,"td",3),b.ec("click",function(){b.Lc(n);var e=t.$implicit;return b.ic().showCareplanTemplate(null==e?null:e.id)}),b.Xc(2),b.Wb(),b.Xb(3,"td",4),b.Xb(4,"app-icons",5),b.ec("click",function(){b.Lc(n);var e=t.$implicit;return b.ic().assignCareplan(null==e?null:e.id)}),b.Wb(),b.Wb(),b.Wb()}if(2&e){var i=t.$implicit;b.Db(2),b.Yc(i.name)}}var S=function(){var e=function(){function e(t,n,i,a,o,s){c(this,e),this._modalRef=t,this._partnerService=n,this._regimeService=i,this._notificationsService=a,this._router=o,this._datePipe=s,this.totalCount=0,this.pageSize=r.g.pageSize,this.courses=[],this.loading=!1}return u(e,[{key:"ngOnInit",value:function(){var e,t=this;this.careplanTypeMap=new Map,this.careplanTypeMap.set("GENERAL","DEFAULT"),this.careplanTypeMap.set("RPM","REMOTE_PATIENT_MONITORING"),this.careplanTypeMap.set("HEALTH_SCORE","HEALTH_SCORE"),this.careplanTypeMap.set("CCM","CHRONIC_CARE_MANAGEMENT"),this._regimeService.getCourse(this.pageSize,0,this.tenantId,this.careplanTypeMap.get(null===(e=this.episodeDetails)||void 0===e?void 0:e.type)||"DEFAULT").subscribe(function(e){t.courses=e.body,t.totalCount=t._partnerService.getTotalCount(e.headers)})}},{key:"getCpTemplatesOnPage",value:function(e){var t,n=this;this._regimeService.getCourse(this.pageSize,this.pageSize*e,this.tenantId,this.careplanTypeMap.get(null===(t=this.episodeDetails)||void 0===t?void 0:t.type)||"DEFAULT").subscribe(function(e){n.courses=e.body})}},{key:"getCpTemplates",value:function(e){this.getCpTemplatesOnPage(e-1)}},{key:"assignCareplan",value:function(e){this.loading?this._notificationsService.info("Care Plan","Please wait..."):(this.loading=!0,"auto-assign"===this.mode?this.autoAssignCareplan(e):this.gotoAssignCareplan(e))}},{key:"autoAssignCareplan",value:function(e){var t,n,o=this,s=new d.a;s.patientId=this.patientId,s.episodeId=this.episodeDetails.id,s.episodeName=this.episodeDetails.name,s.episodeBlueprintId=this.episodeDetails.blueprintId;var l=new Date,r=Object(i.a)(l),c=Object(a.a)(r);(null===(n=null===(t=this.episodeDetails)||void 0===t?void 0:t.deviceSetupTasks)||void 0===n?void 0:n.length)&&(r=Object(i.a)(new Date(this.episodeDetails.deviceSetupTasks[0].scheduledAt))),r<l&&(r=Object(i.a)(l)),s.assignedOn=Date.now(),s.startTime=r.getTime(),s.startDate=this._datePipe.transform(r,"yyyy-MM-dd"),s.endDate=this._datePipe.transform(c,"yyyy-MM-dd"),s.assignerId=localStorage.getItem("loggedInUser"),s.tenantId=localStorage.getItem("loggedInTenant"),this._regimeService.autoAssignCareplan(e,s).subscribe(function(e){o._notificationsService.success("Episode",e.message),o.closeDialog(!0)},function(e){o._notificationsService.error("Episode",e.error.message),o.closeDialog()})}},{key:"gotoAssignCareplan",value:function(e){this.closeDialog(),this.episodeDetails&&this.episodeDetails.id?this._router.navigate(["course/episode",e,this.patientId,this.episodeDetails.id,this.episodeDetails.tenantId],{queryParams:{episodeStartDate:this.episodeDetails.startDate,episodeEndDate:this.episodeDetails.endDate,episodeBlueprintId:this.episodeDetails.blueprintId,episodeName:this.episodeDetails.name}}):this._router.navigate(["course/assign",e,this.patientId])}},{key:"closeDialog",value:function(e){this._modalRef.close(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(b.Rb(p.e),b.Rb(l.a),b.Rb(s.a),b.Rb(f.b),b.Rb(v.g),b.Rb(o.e))},e.\u0275cmp=b.Lb({type:e,selectors:[["app-careplan-templates-dialog"]],inputs:{patientId:"patientId",tenantId:"tenantId",episodeDetails:"episodeDetails",mode:"mode"},features:[b.Cb([o.e])],decls:12,vars:11,consts:[[3,"nzData","nzShowPagination","nzFrontPagination","nzTotal","nzPageIndexChange"],["courseTable",""],[4,"ngFor","ngForOf"],[3,"click"],["actionable",""],["name","clone",3,"click"]],template:function(e,t){if(1&e&&(b.Xb(0,"nz-table",0,1),b.ec("nzPageIndexChange",function(e){return t.getCpTemplates(e)}),b.Xb(2,"thead"),b.Xb(3,"tr"),b.Xb(4,"th"),b.Xc(5),b.jc(6,"translate"),b.Wb(),b.Xb(7,"th"),b.Xc(8),b.jc(9,"translate"),b.Wb(),b.Wb(),b.Wb(),b.Xb(10,"tbody"),b.Vc(11,D,5,1,"tr",2),b.Wb(),b.Wb()),2&e){var n=b.Ic(1);b.rc("nzData",t.courses)("nzShowPagination",!0)("nzFrontPagination",!1)("nzTotal",t.totalCount),b.Db(5),b.Yc(b.kc(6,7,"COMMON.NAME")),b.Db(3),b.Yc(b.kc(9,9,"TABLEHEADER.ACTIONS")),b.Db(3),b.rc("ngForOf",null==n?null:n.data)}},directives:[h.f,h.n,h.o,h.e,h.l,h.i,o.p,g.a,m.a],pipes:[C.a],styles:[""]}),e}()},b1TM:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var i=n("AytR"),a=n("SxV6"),o=n("tk/3"),s=n("fXoL"),l=function(){var e=function(){function e(t){c(this,e),this._http=t,this.rootUrl=i.g.url}return u(e,[{key:"createConfigSetting",value:function(e){return this._http.post(this.rootUrl+"//",JSON.stringify(e)).pipe(Object(a.a)())}},{key:"updateConfigSetting",value:function(e){return e.tenantId=localStorage.getItem("loggedInTenant"),this._http.put(this.rootUrl+"/v2/tenants/settings/",JSON.stringify(e)).pipe(Object(a.a)())}},{key:"getConfigSetting",value:function(){return this._http.get(this.rootUrl+"/v2/tenants/settings/").pipe(Object(a.a)())}},{key:"updatePassword",value:function(e){return this._http.put(this.rootUrl+"/v2/users/changePassword/",JSON.stringify(e)).pipe(Object(a.a)())}},{key:"postPatchRequest",value:function(e,t){var n=new o.g({patch_json:"yes"});return e&&(n=n.append("tenant-id",e)),this._http.patch(this.rootUrl+"/ehealth/v3/tenant-configurations/"+e,t,{headers:n}).pipe(Object(a.a)())}},{key:"getTenantSettings",value:function(e,t){var n=new o.g;return t&&(n=n.append("tenant-id",t)),this._http.get(this.rootUrl+"/ehealth/v2/tenants/"+encodeURIComponent(e)+"/"+t+"/settings",{headers:n}).pipe(Object(a.a)())}}]),e}();return e.\u0275fac=function(t){return new(t||e)(s.bc(o.c))},e.\u0275prov=s.Nb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},cTUG:function(e,t,n){"use strict";n.d(t,"a",function(){return R});var i=n("s3hQ"),a=n("1YrE"),o=n("fXoL"),s=n("iD/K"),l=n("xn8p"),r=n("tyNb"),d=n("bNXi"),b=n("dEAy"),p=n("eHCX"),f=n("ofXK"),v=n("OzZK"),h=n("C2AL"),g=n("Nqz0"),m=n("glKu"),C=n("Q8cG"),D=n("KupA"),S=n("5vDB"),E=n("B+r4"),O=n("ZyQt"),I=n("fhRi");function _(e,t){1&e&&(o.Vb(0),o.Xb(1,"nz-tag",17),o.Xc(2,"Low"),o.Wb(),o.Ub())}function T(e,t){1&e&&(o.Vb(0),o.Xb(1,"nz-tag",18),o.Xc(2,"Medium"),o.Wb(),o.Ub())}function X(e,t){1&e&&(o.Vb(0),o.Xb(1,"nz-tag",19),o.Xc(2,"High"),o.Wb(),o.Ub())}function y(e,t){1&e&&(o.Vb(0),o.Xb(1,"nz-tag"),o.Xc(2,"New"),o.Wb(),o.Ub())}function N(e,t){1&e&&(o.Vb(0),o.Xb(1,"nz-tag",20),o.Xc(2,"Ongoing"),o.Wb(),o.Ub())}function z(e,t){1&e&&(o.Vb(0),o.Xb(1,"nz-tag",17),o.Xc(2,"Improved"),o.Wb(),o.Ub())}function M(e,t){1&e&&(o.Vb(0),o.Xb(1,"nz-tag",19),o.Xc(2,"Worsening"),o.Wb(),o.Ub())}function A(e,t){1&e&&(o.Vb(0),o.Xb(1,"nz-tag",17),o.Xc(2,"Resolved"),o.Wb(),o.Ub())}function P(e,t){if(1&e&&(o.Xb(0,"nz-tag"),o.Xc(1),o.Wb()),2&e){var n=t.$implicit;o.Db(1),o.Yc(n)}}var W=function(){return[16,24]},R=function(){var e=function(){function e(t,n,i,a,l){var r=this;c(this,e),this._activatedRoute=t,this._router=n,this._planOfCareService=i,this._notificationsService=a,this._modalService=l,this.refresh=new o.n,this.categoriesMap=new Map,s.a.forEach(function(e){return r.categoriesMap[null==e?void 0:e.type]=e.label})}return u(e,[{key:"edit",value:function(e){var t;this._router.navigate(["episodes/plan-of-care/edit/".concat(e,"/").concat(null===(t=this.planOfCare)||void 0===t?void 0:t.patientId,"/").concat(this._activatedRoute.snapshot.params.episodeId)])}},{key:"delete",value:function(e){var t=this;this._planOfCareService.archivePlanOfCare(e).subscribe(function(){t._notificationsService.success("Plan Of Care","Provider's plan of care removed successfully"),t.refresh.emit()})}},{key:"logEvent",value:function(e){var t=this;this._modalService.create({nzTitle:"Log Event",nzContent:i.a,nzComponentParams:{planOfCareId:e,planOfCare:this.planOfCare},nzBodyStyle:{paddingTop:"0"},nzStyle:{top:"20px"},nzWidth:"800px",nzFooter:null,nzMaskClosable:!1,nzKeyboard:!1}).afterClose.subscribe(function(e){e&&t.refresh.emit()})}},{key:"viewEventHistory",value:function(e){this._modalService.create({nzTitle:"Event History",nzContent:l.a,nzComponentParams:{events:null==e?void 0:e.events,staffMap:null==e?void 0:e.staffMap},nzBodyStyle:{paddingTop:"0"},nzStyle:{top:"20px"},nzWidth:"800px",nzFooter:null})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(o.Rb(r.a),o.Rb(r.g),o.Rb(a.a),o.Rb(d.b),o.Rb(b.f))},e.\u0275cmp=o.Lb({type:e,selectors:[["app-plan-of-care-details"]],inputs:{planOfCare:"planOfCare"},outputs:{refresh:"refresh"},decls:90,vars:47,consts:[["nz-typography",""],[3,"ngSwitch"],[4,"ngSwitchCase"],["nz-button","","nzType","text","nz-dropdown","","nzPlacement","right","id","more",3,"nzDropdownMenu"],["name","moreFilled","size","16px"],["menu","nzDropdownMenu"],["nz-menu",""],["nz-menu-item","",3,"click"],["nz-menu-item",""],["nz-popconfirm","","nzPopconfirmTitle","Are you sure you want to delete this plan of care?","nzPopconfirmPlacement","top",3,"nzOnConfirm"],["nz-typography","","nzType","secondary"],["nz-row","",3,"nzGutter"],["nz-col","","nzSpan","4"],["nz-col","","nzSpan","20"],[4,"ngFor","ngForOf"],["nz-col","","nzSpan","16"],[3,"innerHTML"],["nzColor","#a7c853"],["nzColor","gold"],["nzColor","#c81c1c"],["nzColor","gainsboro"]],template:function(e,t){if(1&e&&(o.Xb(0,"h4",0),o.Xc(1),o.Vb(2,1),o.Vc(3,_,3,0,"ng-container",2),o.Vc(4,T,3,0,"ng-container",2),o.Vc(5,X,3,0,"ng-container",2),o.Ub(),o.Xc(6," \xa0 "),o.Vb(7,1),o.Vc(8,y,3,0,"ng-container",2),o.Vc(9,N,3,0,"ng-container",2),o.Vc(10,z,3,0,"ng-container",2),o.Vc(11,M,3,0,"ng-container",2),o.Vc(12,A,3,0,"ng-container",2),o.Ub(),o.Xb(13,"button",3),o.Sb(14,"app-icons",4),o.Wb(),o.Xb(15,"nz-dropdown-menu",null,5),o.Xb(17,"ul",6),o.Xb(18,"li",7),o.ec("click",function(){return t.logEvent(null==t.planOfCare?null:t.planOfCare.id)}),o.Xc(19,"Log Event"),o.Wb(),o.Xb(20,"li",7),o.ec("click",function(){return t.viewEventHistory(t.planOfCare)}),o.Xc(21,"Event History"),o.Wb(),o.Xb(22,"li",7),o.ec("click",function(){return t.edit(null==t.planOfCare?null:t.planOfCare.id)}),o.Xc(23,"Edit"),o.Wb(),o.Xb(24,"li",8),o.Xb(25,"a",9),o.ec("nzOnConfirm",function(){return t.delete(null==t.planOfCare?null:t.planOfCare.id)}),o.Xc(26," Delete "),o.Wb(),o.Wb(),o.Wb(),o.Wb(),o.Wb(),o.Xb(27,"label",10),o.Xc(28," Created by "),o.Xb(29,"strong"),o.Xc(30),o.jc(31,"titlecase"),o.Wb(),o.Xc(32," at "),o.Xb(33,"strong"),o.Xc(34),o.jc(35,"utcToLocalTime"),o.Wb(),o.Wb(),o.Xb(36,"label",10),o.Xc(37," Last updated by "),o.Xb(38,"strong"),o.Xc(39),o.jc(40,"titlecase"),o.Wb(),o.Xc(41," at "),o.Xb(42,"strong"),o.Xc(43),o.jc(44,"utcToLocalTime"),o.Wb(),o.Wb(),o.Sb(45,"nz-divider"),o.Xb(46,"div",11),o.Xb(47,"div",12),o.Xb(48,"strong",0),o.Xc(49,"Category: "),o.Wb(),o.Wb(),o.Xb(50,"div",13),o.Xc(51),o.Wb(),o.Wb(),o.Xb(52,"div",11),o.Xb(53,"div",12),o.Xb(54,"strong",0),o.Xc(55,"Relative Problems: "),o.Wb(),o.Wb(),o.Xb(56,"div",13),o.Vc(57,P,2,1,"nz-tag",14),o.Wb(),o.Wb(),o.Xb(58,"div",11),o.Xb(59,"div",12),o.Xb(60,"strong",0),o.Xc(61,"Prescribed By: "),o.Wb(),o.Wb(),o.Xb(62,"div",13),o.Xc(63),o.jc(64,"titlecase"),o.Wb(),o.Wb(),o.Sb(65,"nz-divider"),o.Xb(66,"div",11),o.Xb(67,"div",12),o.Xb(68,"strong",0),o.Xc(69,"Provider Plan of Care: "),o.Wb(),o.Wb(),o.Xb(70,"div",15),o.Sb(71,"span",16),o.Wb(),o.Wb(),o.Xb(72,"div",11),o.Xb(73,"div",12),o.Xb(74,"strong",0),o.Xc(75,"Nursing Interventions: "),o.Wb(),o.Wb(),o.Xb(76,"div",15),o.Sb(77,"span",16),o.Wb(),o.Wb(),o.Xb(78,"div",11),o.Xb(79,"div",12),o.Xb(80,"strong",0),o.Xc(81,"Nursing Education: "),o.Wb(),o.Wb(),o.Xb(82,"div",15),o.Sb(83,"span",16),o.Wb(),o.Wb(),o.Xb(84,"div",11),o.Xb(85,"div",12),o.Xb(86,"strong",0),o.Xc(87,"Goals: "),o.Wb(),o.Wb(),o.Xb(88,"div",15),o.Sb(89,"span",16),o.Wb(),o.Wb()),2&e){var n=o.Ic(16);o.Db(1),o.Zc(" ",null==t.planOfCare?null:t.planOfCare.title," \xa0 "),o.Db(1),o.rc("ngSwitch",null==t.planOfCare||null==t.planOfCare.events[(null==t.planOfCare||null==t.planOfCare.events?null:t.planOfCare.events.length)-1]?null:t.planOfCare.events[(null==t.planOfCare||null==t.planOfCare.events?null:t.planOfCare.events.length)-1].priority),o.Db(1),o.rc("ngSwitchCase","LOW"),o.Db(1),o.rc("ngSwitchCase","MEDIUM"),o.Db(1),o.rc("ngSwitchCase","HIGH"),o.Db(2),o.rc("ngSwitch",null==t.planOfCare||null==t.planOfCare.events[(null==t.planOfCare||null==t.planOfCare.events?null:t.planOfCare.events.length)-1]?null:t.planOfCare.events[(null==t.planOfCare||null==t.planOfCare.events?null:t.planOfCare.events.length)-1].outcome),o.Db(1),o.rc("ngSwitchCase","NEW"),o.Db(1),o.rc("ngSwitchCase","ONGOING"),o.Db(1),o.rc("ngSwitchCase","IMPROVED"),o.Db(1),o.rc("ngSwitchCase","WORSENING"),o.Db(1),o.rc("ngSwitchCase","RESOLVED"),o.Db(1),o.rc("nzDropdownMenu",n),o.Db(17),o.Yc(o.kc(31,30,null==t.planOfCare?null:t.planOfCare.staffMap[null==t.planOfCare?null:t.planOfCare.createdBy])),o.Db(4),o.Yc(o.kc(35,32,null==t.planOfCare?null:t.planOfCare.createdAt)),o.Db(5),o.Yc(o.kc(40,34,null==t.planOfCare?null:t.planOfCare.staffMap[null==t.planOfCare?null:t.planOfCare.changedBy])),o.Db(4),o.Yc(o.kc(44,36,null==t.planOfCare?null:t.planOfCare.updatedAt)),o.Db(3),o.rc("nzGutter",o.xc(40,W)),o.Db(5),o.Zc(" ",t.categoriesMap[null==t.planOfCare?null:t.planOfCare.category]," "),o.Db(1),o.rc("nzGutter",o.xc(41,W)),o.Db(5),o.rc("ngForOf",null==t.planOfCare?null:t.planOfCare.icdCodes),o.Db(1),o.rc("nzGutter",o.xc(42,W)),o.Db(5),o.Zc(" ",o.kc(64,38,null==t.planOfCare?null:t.planOfCare.staffMap[null==t.planOfCare?null:t.planOfCare.provider])," "),o.Db(3),o.rc("nzGutter",o.xc(43,W)),o.Db(5),o.rc("innerHTML",null==t.planOfCare?null:t.planOfCare.providerPlanOfCare,o.Mc),o.Db(1),o.rc("nzGutter",o.xc(44,W)),o.Db(5),o.rc("innerHTML",null==t.planOfCare?null:t.planOfCare.nursingInterventions,o.Mc),o.Db(1),o.rc("nzGutter",o.xc(45,W)),o.Db(5),o.rc("innerHTML",null==t.planOfCare?null:t.planOfCare.nursingEducation,o.Mc),o.Db(1),o.rc("nzGutter",o.xc(46,W)),o.Db(5),o.rc("innerHTML",null==t.planOfCare?null:t.planOfCare.goals,o.Mc)}},directives:[p.a,f.s,f.t,v.a,h.a,g.d,g.b,m.a,g.e,C.c,C.e,D.a,S.a,E.c,E.a,f.p,O.a],pipes:[f.A,I.a],styles:["h4[_ngcontent-%COMP%]{margin-bottom:15px}label[_ngcontent-%COMP%], span[_ngcontent-%COMP%]{display:block}strong[_ngcontent-%COMP%]{font-weight:700}app-icons[_ngcontent-%COMP%]{vertical-align:sub}[_nghost-%COMP%]     *{text-align:justify}"]}),e}()},"d+1G":function(e,t,n){"use strict";n.d(t,"d",function(){return a}),n.d(t,"c",function(){return o}),n.d(t,"a",function(){return s}),n.d(t,"b",function(){return l});var i=n("ua0i"),a=[{id:"99453",name:"RPM - Device Setup",description:"Remote monitoring of physiologic parameter(s) (eg, weight, blood pressure, pulse oximetry, respiratory flow rate), initial; set-up and patient education on use of equipment",billRate:21,selected:!0,type:i.a.RPM},{id:"99454",name:"RPM - Vital Signs Monitoring",description:"Remote monitoring of physiologic parameter(s) (eg, weight, blood pressure, pulse oximetry, respiratory flow rate), initial; device(s) supply with daily recording(s) or programmed alert(s) transmission, each 30 days",billRate:69,selected:!0,type:i.a.RPM},{id:"99457",name:"RPM - TMS Time",description:"Remote physiologic monitoring treatment management services, 20 minutes or more of clinical staff/physician/other qualified healthcare professional time in a calendar month requiring interactive communication with the patient/caregiver during the month",billRate:54,selected:!0,type:i.a.RPM},{id:"99458",name:"RPM - Additional TMS - A Time",description:"Remote physiologic monitoring treatment management services, 20 minutes or more of clinical staff/physician/other qualified healthcare professional time in a calendar month requiring interactive communication with the patient/caregiver during the month",billRate:39,selected:!0,type:i.a.RPM},{id:"99458B",name:"RPM - Additional TMS - B Time",description:"Once TMS 40 is completed, there is an additional option to record up to 20 minutes more of clinical staff/physician/other qualified healthcare professional time in a calendar month requiring interactive communication with the patient/caregiver during the month.",billRate:40,selected:!0,type:i.a.RPM},{id:"99484",name:"BHI - Patient Interaction",description:"Systematic assessment and monitoring, using applicable validated clinical rating scales",billRate:50,selected:!0,type:i.a.BHI},{id:"99490",name:"CCM - Non-complex 20 min",description:"Non-complex CCM is a 20-minute timed service provided by clinical staff to coordinate care across providers and support patient accountability.",billRate:50,selected:!0,type:i.a.CCM},{id:"99491",name:"CCM - 30 mins",description:"CCM services provided personally by a physician or other qualified health care professional for at least 30 minutes.",billRate:50,selected:!0,type:i.a.CCM},{id:"99439",name:"CCM - Additional Non-complex A 20 mins",description:"Each additional 20 minutes of clinical staff time spent providing non-complex CCM directed by a physician or other qualified health care professional",billRate:50,selected:!0,type:i.a.CCM},{id:"99439B",name:"CCM - Additional Non-complex B 20 mins",description:"Each additional 20 minutes of clinical staff time spent providing non-complex CCM directed by a physician or other qualified health care professional",billRate:50,selected:!0,type:i.a.CCM},{id:"99487",name:"CCM - Complex 60 mins",description:"Complex CCM is a 60-minute timed service provided by clinical staff to substantially revise or establish comprehensive care plan that involves moderate- to high-complexity medical decision making.",billRate:50,selected:!0,type:i.a.CCM},{id:"99489",name:"CCM - Additional Complex 30 mins",description:"99489 is each additional 30 minutes of clinical staff time spent providing complex CCM directed by a physician or other qualified health care professional",billRate:50,selected:!0,type:i.a.CCM}],o=function(){return a.filter(function(e){return i.a.RPM===e.type})},s=function(){return a.filter(function(e){return i.a.BHI===e.type})},l=function(){return a.filter(function(e){return i.a.CCM===e.type})}},"gDH+":function(e,t,n){"use strict";n.d(t,"a",function(){return M});var i=n("N+jK"),a=n("WoUL"),o=n("oYoK"),s=n("fXoL"),l=n("dEAy"),r=n("bNXi"),d=n("zAKX"),b=n("3Pt+"),p=n("ofXK"),f=n("PTRe"),v=n("OzZK"),h=n("RwU8"),g=n("C2AL"),m=n("eHCX");function C(e,t){1&e&&(s.Xb(0,"h4"),s.Xc(1,"IMEI*"),s.Wb())}function D(e,t){1&e&&(s.Xb(0,"h4"),s.Xc(1,"Serial No*"),s.Wb())}function S(e,t){1&e&&(s.Xb(0,"h4"),s.Xc(1,"Device ID*"),s.Wb())}function E(e,t){1&e&&(s.Xb(0,"label",15),s.Xc(1,"Required"),s.Wb())}function O(e,t){1&e&&(s.Xb(0,"span"),s.Xc(1,"IMEI number should be 15 digits"),s.Wb())}function I(e,t){1&e&&(s.Xb(0,"span"),s.Xc(1,"Serial number should be 8 digits"),s.Wb())}function _(e,t){1&e&&(s.Xb(0,"span"),s.Xc(1,"Device ID should be 7 digits"),s.Wb())}function T(e,t){if(1&e&&(s.Xb(0,"label",15),s.Vc(1,O,2,0,"span",11),s.Vc(2,I,2,0,"span",11),s.Vc(3,_,2,0,"span",11),s.Wb()),2&e){var n=s.ic();s.Db(1),s.rc("ngIf","BGMD1"!==n.type&&"GM291V"!==n.type),s.Db(1),s.rc("ngIf","BGMD1"===n.type),s.Db(1),s.rc("ngIf","GM291V"===n.type)}}var X,y,N=function(e){return{border:e}},z=((y=function(){function e(t,n,i,a,o){c(this,e),this._devicesService=t,this._modalRef=n,this._translationService=i,this._notificationsService=a,this._devicesEventLogger=o,this.type="SM5000IB"}return u(e,[{key:"ngOnInit",value:function(){var e=this;this.$translationSubscription=this._translationService.getMultiple("DEVICE.DEVICE_ADDITION_TITLE","DEVICE.DEVICE_INVALID_IMEI","DEVICE.DEVICE_ADDITION_SUCCESS_TITLE","DEVICE.DEVICE_ADDITION_SUCCESS_MESSAGE","DEVICE.DEVICE_ADDITION_FAILED_TITLE","DEVICE.DEVICE_ADDITION_DUPLICATE_MESSAGE","DEVICE.DEVICE_ADDITION_DUPLICATE_MESSAGE_FOR_PATIENT").subscribe(function(t){e.translatedStrings=t})}},{key:"ngOnDestroy",value:function(){var e;null===(e=this.$translationSubscription)||void 0===e||e.unsubscribe()}},{key:"validateIMEI",value:function(){return this.onImeiChange(),!this.emptyInput&&!this.invalidImei}},{key:"save",value:function(){var e=this;this.validateIMEI()&&this._devicesService.assignDeviceToPatient(this.type,this.imei,this.userId).subscribe(function(t){e._notificationsService.success(e.translatedStrings.get("DEVICE.DEVICE_ADDITION_SUCCESS_TITLE"),e.translatedStrings.get("DEVICE.DEVICE_ADDITION_SUCCESS_MESSAGE")),e._devicesEventLogger.devicesActionEvent(e.userId,e.imei,"add_device_for_patient"),e._modalRef.close(t)},function(t){var n=t.error;if("DUPLICATE_DEVICE_IMEI"==n.type){var i=e.translatedStrings.get((null==n?void 0:n.parameters.PATIENT_NAME)?"DEVICE.DEVICE_ADDITION_DUPLICATE_MESSAGE_FOR_PATIENT":"DEVICE.DEVICE_ADDITION_DUPLICATE_MESSAGE");i=null==i?void 0:i.replace("{PATIENT_NAME}",null==n?void 0:n.parameters.PATIENT_NAME),e._notificationsService.error(e.translatedStrings.get("DEVICE.DEVICE_ADDITION_FAILED_TITLE"),i),e._modalRef.close()}})}},{key:"onImeiChange",value:function(){var e,t,n,i,a,o,s,l,r;this.emptyInput=!(null===(e=this.imei)||void 0===e?void 0:e.length),this.invalidImei="BGMD1"===this.type?8!==(null===(n=null===(t=this.imei.replace(/\s/g,""))||void 0===t?void 0:t.trim())||void 0===n?void 0:n.length):"GM291V"===this.type?7!==(null===(a=null===(i=this.imei.replace(/\s/g,""))||void 0===i?void 0:i.trim())||void 0===a?void 0:a.length):15!==(null===(s=null===(o=this.imei.replace(/\s/g,""))||void 0===o?void 0:o.trim())||void 0===s?void 0:s.length),this.imei=null===(r=null===(l=this.imei)||void 0===l?void 0:l.replace(/\s/g,""))||void 0===r?void 0:r.toUpperCase()}}]),e}()).\u0275fac=function(e){return new(e||y)(s.Rb(i.a),s.Rb(l.e),s.Rb(a.a),s.Rb(r.b),s.Rb(o.a))},y.\u0275cmp=s.Lb({type:y,selectors:[["app-bt105-create-form"]],inputs:{userId:"userId"},decls:26,vars:11,consts:[[1,"container"],[3,"ngModel","ngModelChange"],["nzValue","SM5000IB","nzLabel","SmartMeter Blood Pressure Monitor"],["nzValue","SMCLBS","nzLabel","SmartMeter Weighing Scale"],["nzValue","SMCOX","nzLabel","SmartMeter SPO2 Monitor"],["nzValue","GM291V","nzLabel","SmartMeter BG Monitor"],["nzValue","BT105","nzLabel","Body Trace Blood Pressure Monitor"],["nzValue","BT005","nzLabel","Body Trace Weighing Scale"],["nzValue","PY802LTE","nzLabel","Pylo Blood Pressure Monitor"],["nzValue","PY300LTE","nzLabel","Pylo Weighing Scale"],["nzValue","BGMD1","nzLabel","Biotel-Blood Glucose Monitor"],[4,"ngIf"],["nz-input","",3,"placeholder","ngModel","ngStyle","ngModelChange"],["nz-typography","","nzType","danger",4,"ngIf"],["id","save","nz-button","","nzType","primary","nzSize","large",3,"click"],["nz-typography","","nzType","danger"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"h3"),s.Xc(2,"Add a device"),s.Wb(),s.Xb(3,"h4"),s.Xc(4,"Choose Device"),s.Wb(),s.Xb(5,"nz-select",1),s.ec("ngModelChange",function(e){return t.type=e}),s.Sb(6,"nz-option",2),s.Sb(7,"nz-option",3),s.Sb(8,"nz-option",4),s.Sb(9,"nz-option",5),s.Sb(10,"nz-option",6),s.Sb(11,"nz-option",7),s.Sb(12,"nz-option",8),s.Sb(13,"nz-option",9),s.Sb(14,"nz-option",10),s.Wb(),s.Sb(15,"br"),s.Sb(16,"br"),s.Vb(17),s.Vc(18,C,2,0,"h4",11),s.Vc(19,D,2,0,"h4",11),s.Vc(20,S,2,0,"h4",11),s.Ub(),s.Xb(21,"input",12),s.ec("ngModelChange",function(e){return t.imei=e})("ngModelChange",function(){return t.onImeiChange()}),s.Wb(),s.Vc(22,E,2,0,"label",13),s.Vc(23,T,4,3,"label",13),s.Xb(24,"button",14),s.ec("click",function(){return t.save()}),s.Xc(25,"Save"),s.Wb(),s.Wb()),2&e&&(s.Db(5),s.rc("ngModel",t.type),s.Db(13),s.rc("ngIf","BGMD1"!==t.type&&"GM291V"!==t.type),s.Db(1),s.rc("ngIf","BGMD1"===t.type),s.Db(1),s.rc("ngIf","GM291V"===t.type),s.Db(1),s.rc("placeholder","BGMD1"===t.type?"Serial No.":"GM291V"===t.type?"Device ID":"IMEI")("ngModel",t.imei)("ngStyle",s.yc(9,N,t.emptyInput||t.invalidImei?"1px solid red":"")),s.Db(1),s.rc("ngIf",t.emptyInput),s.Db(1),s.rc("ngIf",t.invalidImei))},directives:[d.d,b.u,b.x,d.a,p.q,f.b,b.d,p.r,v.a,h.a,g.a,m.a],styles:["h3[_ngcontent-%COMP%]{font:normal normal 700 15px/23px Nunito;letter-spacing:-.38px;color:#2b2b2b}h4[_ngcontent-%COMP%]{font:normal normal normal 12px/16px Nunito;color:var(--tertiary-color)}[_nghost-%COMP%]     .ant-btn{width:75%;display:block;margin:auto}label[_ngcontent-%COMP%]{display:block;margin-top:10px}#save[_ngcontent-%COMP%]{margin-top:15px}"]}),y),M=((X=function(){function e(t){c(this,e),this.modalService=t}return u(e,[{key:"showModal",value:function(e){return this.modalService.create({nzContent:z,nzComponentParams:{userId:e},nzWidth:"350px",nzFooter:null})}}]),e}()).\u0275fac=function(e){return new(e||X)(s.bc(l.f))},X.\u0275prov=s.Nb({token:X,factory:X.\u0275fac,providedIn:"root"}),X)},"iD/K":function(e,t,n){"use strict";n.d(t,"a",function(){return i});var i=[{label:"Problem",type:"PROBLEM"},{label:"Coordination of Care",type:"CARE_COORDINATION"},{label:"Appointment Request",type:"APPOINTMENT_REQUEST"},{label:"Medication Management",type:"MEDICATION_MANAGEMENT"},{label:"Patient Support/Education",type:"PATIENT_SUPPORT"},{label:"Preventive Care",type:"PREVENTIVE_CARE"},{label:"Report of new signs and symptoms",type:"NEW_SYMPTOMS_REPORTING"}]},s3hQ:function(e,t,n){"use strict";n.d(t,"a",function(){return X});var i=n("3Pt+"),a=n("+gyu"),o=n("1YrE"),s=n("c36b"),l=n("fXoL"),r=n("dEAy"),d=n("bNXi"),b=n("5iDH"),p=n("ocnv"),f=n("B+r4"),v=n("eHCX"),h=n("bE2y"),g=n("Nqz0"),m=n("C2AL"),C=n("FwiY"),D=n("mUB+"),S=n("TaO5"),E=n("OzZK"),O=n("RwU8"),I=n("Q8cG"),_=n("ofXK");function T(e,t){if(1&e){var n=l.Yb();l.Xb(0,"li",20),l.ec("click",function(){l.Lc(n);var e=t.$implicit;return l.ic().setNoteTemplate(null==e?null:e.template)}),l.Xc(1),l.Wb()}if(2&e){var i=t.$implicit;l.Db(1),l.Zc(" ",null==i?null:i.title," ")}}var X=function(){var e=function(){function e(t,n,i,a,o){c(this,e),this.fb=t,this._modalRef=n,this._planOfCareService=i,this._noteTemplatesService=a,this._notificationsService=o,this.config=JSON.parse(JSON.stringify(s.b)),this.config.height="10rem"}return u(e,[{key:"ngOnInit",value:function(){this.initializeForm(),this.getNoteTemplates()}},{key:"getNoteTemplates",value:function(){var e=this;this._noteTemplatesService.fetchNoteTemplates(0,1e4).subscribe(function(t){return e.noteTemplates=null==t?void 0:t.content})}},{key:"initializeForm",value:function(){var e,t,n,a,o,s,l,r,c,d,u,b,p,f,v,h;this.form=this.fb.group({priority:(null===(a=null===(e=this.planOfCare)||void 0===e?void 0:e.events[(null===(n=null===(t=this.planOfCare)||void 0===t?void 0:t.events)||void 0===n?void 0:n.length)-1])||void 0===a?void 0:a.priority)?null===(r=null===(o=this.planOfCare)||void 0===o?void 0:o.events[(null===(l=null===(s=this.planOfCare)||void 0===s?void 0:s.events)||void 0===l?void 0:l.length)-1])||void 0===r?void 0:r.priority:["LOW",[i.D.required]],note:[null,[]],outcome:"NEW"!=(null===(b=null===(c=this.planOfCare)||void 0===c?void 0:c.events[(null===(u=null===(d=this.planOfCare)||void 0===d?void 0:d.events)||void 0===u?void 0:u.length)-1])||void 0===b?void 0:b.outcome)?null===(h=null===(p=this.planOfCare)||void 0===p?void 0:p.events[(null===(v=null===(f=this.planOfCare)||void 0===f?void 0:f.events)||void 0===v?void 0:v.length)-1])||void 0===h?void 0:h.outcome:["ONGOING",[i.D.required]],medicalSupport:[null,[]],erVisit:[null,[]],practiceVisit:[null,[]]})}},{key:"setNoteTemplate",value:function(e){var t,n;null===(n=null===(t=this.form)||void 0===t?void 0:t.controls.note)||void 0===n||n.setValue(e)}},{key:"validateForm",value:function(){for(var e in this.form.controls)this.form.controls[e].markAsDirty(),this.form.controls[e].updateValueAndValidity()}},{key:"submit",value:function(){var e,t,n,i,a,o,s,l,r,c=this,d={};null!==(null===(e=this.form)||void 0===e?void 0:e.value.medicalSupport)&&(d.MEDICAL_DECISION_SUPPORT=null===(t=this.form)||void 0===t?void 0:t.value.medicalSupport),null!==(null===(n=this.form)||void 0===n?void 0:n.value.erVisit)&&(d.ER_VISIT=null===(i=this.form)||void 0===i?void 0:i.value.erVisit),null!==(null===(a=this.form)||void 0===a?void 0:a.value.practiceVisit)&&(d.PRACTICE_VISIT=null===(o=this.form)||void 0===o?void 0:o.value.practiceVisit);var u={priority:null===(s=this.form)||void 0===s?void 0:s.value.priority,note:null===(l=this.form)||void 0===l?void 0:l.value.note,outcome:null===(r=this.form)||void 0===r?void 0:r.value.outcome,checklist:d};this._planOfCareService.savePlanOfCareEvent(this.planOfCareId,u).subscribe(function(){c._notificationsService.success("Plan Of Care Event","Event logged successfully!"),c._modalRef.close(!0)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(l.Rb(i.h),l.Rb(r.e),l.Rb(o.a),l.Rb(a.a),l.Rb(d.b))},e.\u0275cmp=l.Lb({type:e,selectors:[["app-event-form"]],inputs:{planOfCareId:"planOfCareId",planOfCare:"planOfCare"},decls:69,vars:16,consts:[[1,"container"],["appScrollToFirstInvalid","","nz-form","",3,"formGroup","ngSubmit"],["nzErrorTip","Please select a priority!"],[1,"priority"],["nz-typography","","nzType","danger"],["formControlName","priority"],["nz-radio","",3,"nzValue"],["nz-dropdown","",3,"nzDropdownMenu"],["nz-icon","","nzType","down"],["id","note","placeholder","Enter note here...","formControlName","note",3,"config"],["nz-checkbox","","formControlName","medicalSupport"],[1,"checklist"],["formControlName","erVisit"],["formControlName","practiceVisit"],["nzErrorTip","Please choose an outcome!"],["formControlName","outcome"],["nz-button","","nzType","primary",3,"disabled"],["templateMenu","nzDropdownMenu"],["nz-menu",""],["nz-menu-item","",3,"click",4,"ngFor","ngForOf"],["nz-menu-item","",3,"click"]],template:function(e,t){if(1&e&&(l.Xb(0,"div",0),l.Xb(1,"form",1),l.ec("ngSubmit",function(){return t.submit()}),l.Xb(2,"nz-form-item"),l.Xb(3,"nz-form-control",2),l.Xb(4,"strong",3),l.Xc(5,"Priority "),l.Xb(6,"span",4),l.Xc(7,"*"),l.Wb(),l.Wb(),l.Xb(8,"nz-radio-group",5),l.Xb(9,"label",6),l.Xc(10,"Low"),l.Wb(),l.Xb(11,"label",6),l.Xc(12,"Medium"),l.Wb(),l.Xb(13,"label",6),l.Xc(14,"High"),l.Wb(),l.Wb(),l.Wb(),l.Wb(),l.Xb(15,"nz-form-item"),l.Xb(16,"nz-form-control"),l.Xb(17,"strong"),l.Xc(18," Note (Optional) \xa0 "),l.Xb(19,"a",7),l.Xc(20," Template "),l.Sb(21,"em",8),l.Wb(),l.Wb(),l.Sb(22,"angular-editor",9),l.Wb(),l.Wb(),l.Xb(23,"nz-form-item"),l.Xb(24,"nz-form-control"),l.Xb(25,"label",10),l.Xb(26,"strong"),l.Xc(27,"Received Medical Decision Making Support (Optional)"),l.Wb(),l.Wb(),l.Wb(),l.Wb(),l.Xb(28,"nz-form-item"),l.Xb(29,"nz-form-control"),l.Xb(30,"strong",11),l.Xc(31,"ER or Hospital visit was (Optional)"),l.Wb(),l.Xb(32,"nz-radio-group",12),l.Xb(33,"label",6),l.Xc(34,"Prevented"),l.Wb(),l.Xb(35,"label",6),l.Xc(36,"Resulted"),l.Wb(),l.Wb(),l.Wb(),l.Wb(),l.Xb(37,"nz-form-item"),l.Xb(38,"nz-form-control"),l.Xb(39,"strong",11),l.Xc(40,"Practice visit was (Optional)"),l.Wb(),l.Xb(41,"nz-radio-group",13),l.Xb(42,"label",6),l.Xc(43,"Prevented"),l.Wb(),l.Xb(44,"label",6),l.Xc(45,"Resulted"),l.Wb(),l.Wb(),l.Wb(),l.Wb(),l.Xb(46,"nz-form-item"),l.Xb(47,"nz-form-control",14),l.Xb(48,"strong",11),l.Xc(49,"Outcome "),l.Xb(50,"span",4),l.Xc(51,"*"),l.Wb(),l.Wb(),l.Xb(52,"nz-radio-group",15),l.Xb(53,"label",6),l.Xc(54,"Ongoing"),l.Wb(),l.Xb(55,"label",6),l.Xc(56,"Improved"),l.Wb(),l.Xb(57,"label",6),l.Xc(58,"Worsening"),l.Wb(),l.Xb(59,"label",6),l.Xc(60,"Resolved"),l.Wb(),l.Wb(),l.Wb(),l.Wb(),l.Xb(61,"nz-form-item"),l.Xb(62,"nz-form-control"),l.Xb(63,"button",16),l.Xc(64,"Save"),l.Wb(),l.Wb(),l.Wb(),l.Wb(),l.Wb(),l.Xb(65,"nz-dropdown-menu",null,17),l.Xb(67,"ul",18),l.Vc(68,T,2,1,"li",19),l.Wb(),l.Wb()),2&e){var n=l.Ic(66);l.Db(1),l.rc("formGroup",t.form),l.Db(8),l.rc("nzValue","LOW"),l.Db(2),l.rc("nzValue","MEDIUM"),l.Db(2),l.rc("nzValue","HIGH"),l.Db(6),l.rc("nzDropdownMenu",n),l.Db(3),l.rc("config",t.config),l.Db(11),l.rc("nzValue",!1),l.Db(2),l.rc("nzValue",!0),l.Db(7),l.rc("nzValue",!1),l.Db(2),l.rc("nzValue",!0),l.Db(9),l.rc("nzValue","ONGOING"),l.Db(2),l.rc("nzValue","IMPROVED"),l.Db(2),l.rc("nzValue","WORSENING"),l.Db(2),l.rc("nzValue","RESOLVED"),l.Db(4),l.rc("disabled",!t.form.valid),l.Db(5),l.rc("ngForOf",t.noteTemplates)}},directives:[i.F,i.v,b.a,p.b,i.m,f.c,p.c,f.a,p.a,v.a,h.c,i.u,i.k,h.b,g.a,g.b,m.a,C.a,D.a,S.a,E.a,O.a,g.e,I.c,_.p,I.e],styles:[".priority[_ngcontent-%COMP%]{width:15%;display:inline-block}.checklist[_ngcontent-%COMP%]{width:40%;display:inline-block}a[_ngcontent-%COMP%]{font-weight:100}[_nghost-%COMP%]     .angular-editor-textarea{border-radius:5px}button[_ngcontent-%COMP%]{width:300px;display:block;margin:auto}"]}),e}()},ttvE:function(n,i,o){"use strict";o.r(i),o.d(i,"EpisodesModule",function(){return Kd});var l=o("bKRa"),r=o("ofXK"),d=o("1YrE"),b=o("+gyu"),p=o("2lmJ"),f=o("iD/K"),v=o("3Pt+"),h=o("nLCl"),g=o("c36b"),m=o("geco"),C=o("ighe"),D=o("qQcL"),S=o("pLZG"),E=o("1G5W"),O=o("4RGM"),I=o("fXoL"),_=o("tyNb"),T=o("bNXi"),X=o("Nqz0"),y=o("Q8cG"),N=o("B+r4"),z=o("JA5x"),M=o("5iDH"),A=o("ocnv"),P=o("eHCX"),W=o("PTRe"),R=o("zAKX"),k=o("bE2y"),w=o("5vDB"),L=o("C2AL"),x=o("FwiY"),V=o("mUB+");function U(e,t){if(1&e&&(I.Vb(0),I.Sb(1,"nz-option",34),I.Ub()),2&e){var n=t.$implicit;I.Db(1),I.rc("nzLabel",null==n?null:n.label)("nzValue",null==n?null:n.type)}}function F(e,t){if(1&e&&(I.Vb(0),I.Sb(1,"nz-option",34),I.Ub()),2&e){var n=t.$implicit;I.Db(1),I.rc("nzLabel",null==n?null:n.fullName)("nzValue",null==n?null:n.id)}}function j(e,t){if(1&e&&(I.Vb(0),I.Sb(1,"nz-option",34),I.Ub()),2&e){var n=t.$implicit;I.Db(1),I.rc("nzLabel",n)("nzValue",n)}}function Y(e,t){if(1&e){var n=I.Yb();I.Xb(0,"div",7),I.Xb(1,"div",8),I.Xb(2,"div",9),I.Xb(3,"nz-card",10),I.Xb(4,"form",11),I.ec("ngSubmit",function(){return I.Lc(n),I.ic().submit()}),I.Xb(5,"nz-form-item"),I.Xb(6,"nz-form-control",12),I.Xb(7,"strong"),I.Xc(8,"Title "),I.Xb(9,"span",13),I.Xc(10,"*"),I.Wb(),I.Wb(),I.Sb(11,"input",14),I.Wb(),I.Wb(),I.Xb(12,"div",15),I.Xb(13,"div",16),I.Xb(14,"nz-form-item"),I.Xb(15,"nz-form-control",17),I.Xb(16,"strong"),I.Xc(17,"Category "),I.Xb(18,"span",13),I.Xc(19,"*"),I.Wb(),I.Wb(),I.Xb(20,"nz-select",18),I.Vc(21,U,2,2,"ng-container",19),I.Wb(),I.Wb(),I.Wb(),I.Wb(),I.Xb(22,"div",16),I.Xb(23,"nz-form-item"),I.Xb(24,"nz-form-control",20),I.Xb(25,"strong"),I.Xc(26,"Provider "),I.Xb(27,"span",13),I.Xc(28,"*"),I.Wb(),I.Wb(),I.Xb(29,"nz-select",21),I.Vc(30,F,2,2,"ng-container",19),I.Wb(),I.Wb(),I.Wb(),I.Wb(),I.Wb(),I.Xb(31,"div",15),I.Xb(32,"div",22),I.Xb(33,"nz-form-item"),I.Xb(34,"nz-form-control"),I.Xb(35,"strong"),I.Xc(36,"Diagnosis (Optional)"),I.Wb(),I.Xb(37,"nz-select",23),I.Vc(38,j,2,2,"ng-container",19),I.Wb(),I.Wb(),I.Wb(),I.Wb(),I.Xb(39,"div",24),I.Xb(40,"nz-form-item"),I.Xb(41,"nz-form-control"),I.Xb(42,"strong"),I.Xc(43,"\xa0"),I.Wb(),I.Xb(44,"nz-radio-group",25),I.Xb(45,"label",26),I.Xc(46," Low "),I.Wb(),I.Xb(47,"label",26),I.Xc(48," Medium "),I.Wb(),I.Xb(49,"label",26),I.Xc(50," High "),I.Wb(),I.Wb(),I.Wb(),I.Wb(),I.Wb(),I.Wb(),I.Sb(51,"nz-divider"),I.Xb(52,"nz-form-item"),I.Xb(53,"nz-form-control",27),I.Xb(54,"strong"),I.Xc(55," Provider Plan Of Care From EMR "),I.Xb(56,"span",13),I.Xc(57,"*"),I.Wb(),I.Xc(58," \xa0 "),I.Xb(59,"a",28),I.Xc(60," Template "),I.Sb(61,"em",29),I.Wb(),I.Wb(),I.Sb(62,"angular-editor",30),I.Wb(),I.Wb(),I.Sb(63,"br"),I.Xb(64,"nz-form-item"),I.Xb(65,"nz-form-control"),I.Xb(66,"strong"),I.Xc(67," Nursing Interventions \xa0 "),I.Xb(68,"a",28),I.Xc(69," Template "),I.Sb(70,"em",29),I.Wb(),I.Wb(),I.Sb(71,"angular-editor",31),I.Wb(),I.Wb(),I.Sb(72,"br"),I.Xb(73,"nz-form-item"),I.Xb(74,"nz-form-control"),I.Xb(75,"strong"),I.Xc(76," Nursing Education \xa0 "),I.Xb(77,"a",28),I.Xc(78," Template "),I.Sb(79,"em",29),I.Wb(),I.Wb(),I.Sb(80,"angular-editor",32),I.Wb(),I.Wb(),I.Sb(81,"br"),I.Xb(82,"nz-form-item"),I.Xb(83,"nz-form-control"),I.Xb(84,"strong"),I.Xc(85," Goals \xa0 "),I.Xb(86,"a",28),I.Xc(87," Template "),I.Sb(88,"em",29),I.Wb(),I.Wb(),I.Sb(89,"angular-editor",33),I.Wb(),I.Wb(),I.Wb(),I.Wb(),I.Wb(),I.Wb(),I.Wb()}if(2&e){var i=I.ic(),a=I.Ic(2),o=I.Ic(6),s=I.Ic(10),l=I.Ic(14);I.Db(4),I.rc("formGroup",i.form),I.Db(17),I.rc("ngForOf",i.planOfCareCategories),I.Db(8),I.rc("nzDisabled",!0),I.Db(1),I.rc("ngForOf",i.providers),I.Db(8),I.rc("ngForOf",null==i.episodeDetails?null:i.episodeDetails.icdCodes),I.Db(7),I.rc("nzValue","LOW"),I.Db(2),I.rc("nzValue","MEDIUM"),I.Db(2),I.rc("nzValue","HIGH"),I.Db(10),I.rc("nzDropdownMenu",a),I.Db(3),I.rc("config",i.config),I.Db(6),I.rc("nzDropdownMenu",o),I.Db(3),I.rc("config",i.config),I.Db(6),I.rc("nzDropdownMenu",s),I.Db(3),I.rc("config",i.config),I.Db(6),I.rc("nzDropdownMenu",l),I.Db(3),I.rc("config",i.config)}}function G(e,t){if(1&e){var n=I.Yb();I.Xb(0,"li",35),I.ec("click",function(){I.Lc(n);var e=t.$implicit;return I.ic().setNoteTemplate("providerPlanOfCare",null==e?null:e.template)}),I.Xc(1),I.Wb()}if(2&e){var i=t.$implicit;I.Db(1),I.Yc(null==i?null:i.title)}}function B(e,t){if(1&e){var n=I.Yb();I.Xb(0,"li",35),I.ec("click",function(){I.Lc(n);var e=t.$implicit;return I.ic().setNoteTemplate("nursingInterventions",null==e?null:e.template)}),I.Xc(1),I.Wb()}if(2&e){var i=t.$implicit;I.Db(1),I.Yc(null==i?null:i.title)}}function H(e,t){if(1&e){var n=I.Yb();I.Xb(0,"li",35),I.ec("click",function(){I.Lc(n);var e=t.$implicit;return I.ic().setNoteTemplate("nursingEducation",null==e?null:e.template)}),I.Xc(1),I.Wb()}if(2&e){var i=t.$implicit;I.Db(1),I.Yc(null==i?null:i.title)}}function Z(e,t){if(1&e){var n=I.Yb();I.Xb(0,"li",35),I.ec("click",function(){I.Lc(n);var e=t.$implicit;return I.ic().setNoteTemplate("goals",null==e?null:e.template)}),I.Xc(1),I.Wb()}if(2&e){var i=t.$implicit;I.Db(1),I.Zc(" ",null==i?null:i.title," ")}}var q,$,K=((q=function(e){a(n,e);var t=s(n);function n(e,i,a,o,s,l,r,d,u){var b;return c(this,n),(b=t.call(this)).fb=e,b._location=i,b._staffService=a,b._activatedRoute=o,b._episodesService=s,b._patientsService=l,b._planOfCareService=r,b._noteTemplatesService=d,b._notificationsService=u,b.planOfCareCategories=f.a,b.config=g.b,b._routeHelperService.isPrimaryActionTriggered().pipe(Object(S.a)(function(e){return!!e}),Object(E.a)(b.unsubscribed)).subscribe(function(){var e;(null===(e=b.form)||void 0===e?void 0:e.valid)?b.submit():b.validateForm()}),b}return u(n,[{key:"ngAfterViewInit",value:function(){this._activatedRoute.snapshot.params.planOfCareId?(this.getPlanOfCareById(),this.mode="EDIT"):(this.initializeForm(),this.mode="ADD"),this.getUserDetails(),this.getEpisodeData()}},{key:"getPlanOfCareById",value:function(){var e=this;this._planOfCareService.fetchPlanOfCareById(this._activatedRoute.snapshot.params.planOfCareId).subscribe(function(t){e.planOfCare=t,e.initializeForm(e.planOfCare)})}},{key:"getUserDetails",value:function(){var e=this;this._patientsService.fetchPatientById(this._activatedRoute.snapshot.params.patientId).subscribe(function(t){e.patient=t,e.subTenantId=t.tenantId,e.getProviders(),e.getNoteTemplates(t.tenantId)})}},{key:"getEpisodeData",value:function(){var e=this;this._episodesService.fetchEpisodeDetails(this._activatedRoute.snapshot.params.episodeId).subscribe(function(t){e.episodeDetails=t})}},{key:"initializeForm",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.form=this.fb.group({title:[null==e?void 0:e.title,[v.D.required]],category:[(null==e?void 0:e.category)||"PROBLEM",[v.D.required]],priority:[(null==e?void 0:e.priority)||"LOW",[v.D.required]],icdCodes:[null==e?void 0:e.icdCodes,[]],provider:[null==e?void 0:e.provider,[v.D.required]],providerPlanOfCare:[null==e?void 0:e.providerPlanOfCare,[v.D.required]],nursingInterventions:[null==e?void 0:e.nursingInterventions,[]],nursingEducation:[null==e?void 0:e.nursingEducation,[]],goals:[null==e?void 0:e.goals,[]]})}},{key:"getProviders",value:function(){var e=this;this._staffService.fetchAssignableStaffMembersById(this._activatedRoute.snapshot.params.patientId,h.a.PHYSICIAN).subscribe(function(t){var n,i,a,o;e.providers=t;var s=null==t?void 0:t.filter(function(t){var n,i;return-1!==(null===(i=null===(n=e.patient)||void 0===n?void 0:n.assignedStaffIds)||void 0===i?void 0:i.findIndex(function(e){return e===(null==t?void 0:t.id)}))});null===(a=null===(i=null===(n=e.form)||void 0===n?void 0:n.controls)||void 0===i?void 0:i.provider)||void 0===a||a.setValue(null===(o=s[0])||void 0===o?void 0:o.id)})}},{key:"getNoteTemplates",value:function(e){var t=this;this._noteTemplatesService.fetchNoteTemplates(0,1e4,null,e).subscribe(function(e){return t.noteTemplates=null==e?void 0:e.content})}},{key:"setNoteTemplate",value:function(e,t){var n,i;null===(i=null===(n=this.form)||void 0===n?void 0:n.controls[e])||void 0===i||i.setValue(t)}},{key:"validateForm",value:function(){for(var e in this.form.controls)this.form.controls[e].markAsDirty(),this.form.controls[e].updateValueAndValidity();this.valid=!(null==this.subTenantId||null==this.subTenantId),this.showToggleError=!this.valid}},{key:"onSubTenantChange",value:function(e){"object"==typeof e&&""!=e&&null!=e&&null!=e?(localStorage.setItem(O.a.REQUEST_TENANT_IDS,e),this.subTenantId=e,this.showToggleError=!1):(this.subTenantId=null,this.showToggleError=!0)}},{key:"submit",value:function(){var e,t,n=this;this.validateForm(),this.valid&&((null===(e=this.planOfCare)||void 0===e?void 0:e.id)?t=this.updatePlanOfCareRequestObject(JSON.parse(JSON.stringify(this.form.value))):(t=this.createPlanOfCareRequestObject(JSON.parse(JSON.stringify(this.form.value)))).tenantId=this.subTenantId,this._planOfCareService.savePlanOfCare(t).subscribe(function(){n._notificationsService.success("Plan of Care","Provider's plan of care saved successfully!"),n._location.back()}))}},{key:"createPlanOfCareRequestObject",value:function(e){var t={priority:e.priority,note:"New plan of care added",outcome:"NEW",checklist:new Map,createdBy:localStorage.getItem("loggedInUser")};return e.episodeId=this._activatedRoute.snapshot.params.episodeId,e.patientId=this._activatedRoute.snapshot.params.patientId,e.createdBy=localStorage.getItem("loggedInUser"),e.events=[t],e}},{key:"updatePlanOfCareRequestObject",value:function(e){return this.planOfCare.title=null==e?void 0:e.title,this.planOfCare.category=null==e?void 0:e.category,this.planOfCare.provider=null==e?void 0:e.provider,this.planOfCare.icdCodes=null==e?void 0:e.icdCodes,this.planOfCare.priority=null==e?void 0:e.priority,this.planOfCare.providerPlanOfCare=null==e?void 0:e.providerPlanOfCare,this.planOfCare.nursingInterventions=null==e?void 0:e.nursingInterventions,this.planOfCare.nursingEducation=null==e?void 0:e.nursingEducation,this.planOfCare.goals=null==e?void 0:e.goals,this.planOfCare}}]),n}(D.a)).\u0275fac=function(e){return new(e||q)(I.Rb(v.h),I.Rb(r.l),I.Rb(p.a),I.Rb(_.a),I.Rb(C.a),I.Rb(m.a),I.Rb(d.a),I.Rb(b.a),I.Rb(T.b))},q.\u0275cmp=I.Lb({type:q,selectors:[["app-plan-of-care-form"]],features:[I.Ab],decls:17,vars:5,consts:[["class","container",4,"ngIf"],["templateMenu1","nzDropdownMenu"],["nz-menu",""],["nz-menu-item","",3,"click",4,"ngFor","ngForOf"],["templateMenu2","nzDropdownMenu"],["templateMenu3","nzDropdownMenu"],["templateMenu4","nzDropdownMenu"],[1,"container"],["nz-row",""],["nz-col","","nzSpan","18"],["nzBorderless",""],["appScrollToFirstInvalid","","nz-form","",3,"formGroup","ngSubmit"],["nzErrorTip","Please enter a title!"],["nz-typography","","nzType","danger"],["formControlName","title","nz-input","","placeholder","Enter plan of care title here..."],["nz-row","","nzGutter","16"],["nz-col","","nzSpan","12"],["nzErrorTip","Please select a category!"],["formControlName","category","nzPlaceHolder","Please select a category..."],[4,"ngFor","ngForOf"],["nzErrorTip","Please select a provider!"],["formControlName","provider","nzPlaceHolder","Please select a provider...",3,"nzDisabled"],["nz-col","","nzSpan","16"],["nzMode","multiple","formControlName","icdCodes","nzPlaceHolder","Select problems..."],["nz-col","","nzSpan","8"],["formControlName","priority"],["nz-radio-button","","nzButtonStyle","solid",3,"nzValue"],["nzErrorTip","Please enter a plan of care!"],["nz-dropdown","",3,"nzDropdownMenu"],["nz-icon","","nzType","down"],["id","pocEditor","placeholder","Enter plan of care here...","formControlName","providerPlanOfCare",3,"config"],["id","nursingInterventionsEditor","placeholder","Enter nursing interventions here...","formControlName","nursingInterventions",3,"config"],["id","nursingEducationEditor","placeholder","Enter nursing education here...","formControlName","nursingEducation",3,"config"],["id","goals","placeholder","Enter goals here...","formControlName","goals",3,"config"],[3,"nzLabel","nzValue"],["nz-menu-item","",3,"click"]],template:function(e,t){1&e&&(I.Vc(0,Y,90,16,"div",0),I.Xb(1,"nz-dropdown-menu",null,1),I.Xb(3,"ul",2),I.Vc(4,G,2,1,"li",3),I.Wb(),I.Wb(),I.Xb(5,"nz-dropdown-menu",null,4),I.Xb(7,"ul",2),I.Vc(8,B,2,1,"li",3),I.Wb(),I.Wb(),I.Xb(9,"nz-dropdown-menu",null,5),I.Xb(11,"ul",2),I.Vc(12,H,2,1,"li",3),I.Wb(),I.Wb(),I.Xb(13,"nz-dropdown-menu",null,6),I.Xb(15,"ul",2),I.Vc(16,Z,2,1,"li",3),I.Wb(),I.Wb()),2&e&&(I.rc("ngIf",!!t.form),I.Db(4),I.rc("ngForOf",t.noteTemplates),I.Db(4),I.rc("ngForOf",t.noteTemplates),I.Db(4),I.rc("ngForOf",t.noteTemplates),I.Db(4),I.rc("ngForOf",t.noteTemplates))},directives:[r.q,X.e,y.c,r.p,N.c,N.a,z.a,v.F,v.v,M.a,A.b,v.m,A.c,A.a,P.a,v.d,W.b,v.u,v.k,R.d,k.c,k.b,k.a,w.a,X.a,X.b,L.a,x.a,V.a,R.a,y.e],styles:[".container[_ngcontent-%COMP%]{background-color:var(--neutral-color)}strong[_ngcontent-%COMP%]{display:block}span[_ngcontent-%COMP%]{vertical-align:sub}[_nghost-%COMP%]     .ant-divider-horizontal{margin-top:14px}a[_ngcontent-%COMP%]{font-weight:100}[_nghost-%COMP%]     .angular-editor-textarea{border-radius:5px}"]}),q),Q=o("/XTn"),J=o("WoUL"),ee=(($=function(){function e(t){var n=this;c(this,e),this._translationsService=t,this.$translationObserver=this._translationsService.getMultiple("EPISODE","EPISODE.PRIMARY_INSURANCE_REQUIRED","EPISODE.ICD_CODE_REQUIRED","EPISODE.RPM_ICD_CODE_REQUIRED","EPISODE.CPT_CODE_REQUIRED").subscribe(function(e){n.translatedStrings=e})}return u(e,[{key:"ngOnDestroy",value:function(){this.$translationObserver.unsubscribe()}},{key:"validateGeneralEpisode",value:function(e,t){var n,i,a,o,s=[],l=null==t?void 0:t.insuranceInformation;return e&&!(null===(n=null==l?void 0:l.primaryInsuranceDetails)||void 0===n?void 0:n.carrierName)&&s.push("INVALID_PRIMARY_INSURANCE_CARRIER"),e&&!(null===(i=null==l?void 0:l.primaryInsuranceDetails)||void 0===i?void 0:i.insuranceId)&&s.push("INVALID_PRIMARY_INSURANCE_ID"),(null===(a=null==t?void 0:t.cptCodeList)||void 0===a?void 0:a.length)&&!(null===(o=null==t?void 0:t.icdCodeList)||void 0===o?void 0:o.length)&&s.push("INVALID_ICD_CODES"),s}},{key:"validateRPMEpisode",value:function(e){var t,n,i,a,o=[],s=null==e?void 0:e.insuranceInformation;return(null===(t=null==s?void 0:s.primaryInsuranceDetails)||void 0===t?void 0:t.carrierName)||o.push("INVALID_PRIMARY_INSURANCE_CARRIER"),(null===(n=null==s?void 0:s.primaryInsuranceDetails)||void 0===n?void 0:n.insuranceId)||o.push("INVALID_PRIMARY_INSURANCE_ID"),(null===(i=null==e?void 0:e.cptCodeList)||void 0===i?void 0:i.length)||o.push("INVALID_CPT_CODES"),(null===(a=null==e?void 0:e.icdCodeList)||void 0===a?void 0:a.length)||o.push("INVALID_ICD_CODES"),o}}]),e}()).\u0275fac=function(e){return new(e||$)(I.bc(J.a))},$.\u0275prov=I.Nb({token:$,factory:$.\u0275fac}),$),te=o("igu/"),ne=o("gXqy"),ie=o("jKzE"),ae=o("9ig3"),oe=(o("tkii"),o("0lU3")),se=o("dRHE");function le(e,t){if(1&e&&I.Sb(0,"nz-option",11),2&e){var n=t.$implicit;I.rc("nzValue",null==n?null:n.id)("nzLabel",null==n?null:n.name)}}function re(e,t){1&e&&(I.Xb(0,"label"),I.Xc(1),I.jc(2,"translate"),I.Wb()),2&e&&(I.Db(1),I.Yc(I.kc(2,1,"TITLE.DAYS")))}var ce=function(){return[16,16]};function de(e,t){1&e&&(I.Xb(0,"div",12),I.Xb(1,"div",3),I.Xb(2,"label",13),I.Xc(3,"Required"),I.Wb(),I.Wb(),I.Wb()),2&e&&I.rc("nzGutter",I.xc(1,ce))}var ue,be=function(e){return{danger:e}},pe=((ue=function(){function e(t,n){c(this,e),this._router=t,this._activatedRoute=n,this.disabledDates=function(e){return Object(ne.a)(new Date,e)>0||Object(ne.a)(Object(ie.a)(Date.now()),e)<0},this.duration=[new Date,Object(ie.a)(Date.now())]}return u(e,[{key:"tenantConfig",set:function(e){var t,n;if(e){this.tenantSettings=e;var i=null===(n=null===(t=this.tenantSettings)||void 0===t?void 0:t.episodeBlueprints)||void 0===n?void 0:n.filter(function(e){return!e.archived});this.tenantSettings.episodeBlueprints=i}}},{key:"ngOnInit",value:function(){var e,t=this;this._activatedRoute.queryParams.subscribe(function(e){t.selectedBlueprintId=e.blueprintId}),this.mode=null===(e=this._activatedRoute.snapshot.paramMap.get("mode"))||void 0===e?void 0:e.toUpperCase(),this.presetDateRange()}},{key:"presetDateRange",value:function(){var e,t,n=this;null===(t=null===(e=this.tenantSettings)||void 0===e?void 0:e.episodeBlueprints)||void 0===t||t.forEach(function(e){if(n.selectedBlueprintId&&n.selectedBlueprintId===e.id){var t=Object(ie.a)(Date.now()),i=new Date((new Date).setDate((new Date).getDate()+e.durationSettings.timeInDays));i<t&&(t=i),n.duration=[new Date,t]}}),this.setDaysRemaining(),this.setBlueprintIdToURL()}},{key:"setDuration",value:function(e,t){var n=Object(ae.a)(new Date),i=null==e?void 0:e.split("-");this.duration=[new Date(n.setDate(parseInt(i[2]))),this.duration[1]]}},{key:"setDaysRemaining",value:function(){var e;(null===(e=this.duration)||void 0===e?void 0:e.length)>1&&(this.durationInDays=Object(ne.a)(this.duration[1],this.duration[0]))}},{key:"setBlueprintIdToURL",value:function(){this._router.navigate([],{replaceUrl:!0,queryParams:{blueprintId:this.selectedBlueprintId},queryParamsHandling:"merge"})}}]),e}()).\u0275fac=function(e){return new(e||ue)(I.Rb(_.g),I.Rb(_.a))},ue.\u0275cmp=I.Lb({type:ue,selectors:[["app-duration"]],inputs:{tenantConfig:["tenantSettings","tenantConfig"],errors:"errors"},decls:25,vars:26,consts:[[1,"container"],["nz-typography",""],["nz-row","","nzGutter","16"],["nz-col","","nzXs","12","nzSm","8","nzMd","6"],[3,"ngModel","nzPlaceHolder","nzDisabled","ngClass","nzBorderless","ngModelChange"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],["nzFormat","MMM d, y",3,"nzAllowClear","nzDisabledDate","ngModel","nzDisabled","ngModelChange"],["id","durationDays"],["nz-typography","","nzType","success"],[4,"ngIf"],["nz-row","",3,"nzGutter",4,"ngIf"],[3,"nzValue","nzLabel"],["nz-row","",3,"nzGutter"],["nz-typography","","nzType","danger"]],template:function(e,t){1&e&&(I.Xb(0,"div",0),I.Xb(1,"h3",1),I.Xc(2),I.jc(3,"translate"),I.Wb(),I.Xb(4,"div",2),I.Xb(5,"div",3),I.Xb(6,"label"),I.Xc(7),I.jc(8,"translate"),I.Wb(),I.Xb(9,"nz-select",4),I.ec("ngModelChange",function(e){return t.selectedBlueprintId=e})("ngModelChange",function(){return t.presetDateRange()}),I.jc(10,"translate"),I.Vc(11,le,1,2,"nz-option",5),I.Wb(),I.Wb(),I.Xb(12,"div",3),I.Xb(13,"label"),I.Xc(14),I.jc(15,"translate"),I.Wb(),I.Xb(16,"nz-range-picker",6),I.ec("ngModelChange",function(e){return t.duration=e})("ngModelChange",function(){return t.setDaysRemaining()}),I.Wb(),I.Wb(),I.Xb(17,"div",3),I.Xb(18,"div",7),I.Xb(19,"h3",8),I.Xc(20),I.Wb(),I.Vc(21,re,3,3,"label",9),I.Wb(),I.Wb(),I.Wb(),I.Vc(22,de,4,2,"div",10),I.Sb(23,"br"),I.Sb(24,"nz-divider"),I.Wb()),2&e&&(I.Db(2),I.Yc(I.kc(3,16,"COMMON.EPISODE_DETAILS")),I.Db(5),I.Zc("",I.kc(8,18,"COMMON.EPISODE_NAME")," *"),I.Db(2),I.sc("nzPlaceHolder",I.kc(10,20,"EPISODE.CHOOSE_EPISODE_TYPE")),I.rc("ngModel",t.selectedBlueprintId)("nzDisabled","EDIT"===t.mode)("ngClass",I.yc(24,be,!t.selectedBlueprintId&&!(null==t.errors||!t.errors.includes("INVALID_BLUEPRINT"))))("nzBorderless",!t.selectedBlueprintId&&!(null==t.errors||!t.errors.includes("INVALID_BLUEPRINT"))),I.Db(2),I.rc("ngForOf",null==t.tenantSettings?null:t.tenantSettings.episodeBlueprints),I.Db(3),I.Zc("",I.kc(15,22,"COMMON.SELECT_START_END_DATE")," *"),I.Db(2),I.rc("nzAllowClear",!1)("nzDisabledDate",t.disabledDates)("ngModel",t.duration)("nzDisabled",!0),I.Db(4),I.Yc(t.durationInDays),I.Db(1),I.rc("ngIf",t.durationInDays),I.Db(1),I.rc("ngIf",!t.selectedBlueprintId&&!(null==t.errors||!t.errors.includes("INVALID_BLUEPRINT"))))},directives:[P.a,N.c,N.a,R.d,v.u,v.x,r.o,r.p,oe.a,oe.c,r.q,w.a,R.a],pipes:[se.a],styles:["nz-range-picker[_ngcontent-%COMP%]{width:100%}h3[_ngcontent-%COMP%]{margin-bottom:25px}h3[_ngcontent-%COMP%], label[_ngcontent-%COMP%]{margin-left:5px}label[_ngcontent-%COMP%]{font:normal normal normal 12px/16px Nunito;color:var(--tertiary-color);margin-bottom:5px;display:block}#durationDays[_ngcontent-%COMP%]{margin-top:15px}#durationDays[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:-5px}.danger[_ngcontent-%COMP%]{border:1px solid #c81c1c}[_nghost-%COMP%]     .ant-select-selector{background-color:var(--neutral-color)!important}"]}),ue),fe=o("qAZ0"),ve=o("glKu");function he(e,t){if(1&e&&I.Sb(0,"nz-option",10),2&e){var n=t.$implicit;I.uc("nzLabel","",n[0]||"",", ",n[1]||"",""),I.uc("nzValue","",n[0]||"",", ",n[1]||"","")}}function ge(e,t){if(1&e&&(I.Vb(0),I.Vc(1,he,1,4,"nz-option",9),I.Ub()),2&e){var n=I.ic();I.Db(1),I.rc("ngForOf",n.icdCodes)}}function me(e,t){1&e&&(I.Xb(0,"nz-option",11),I.Sb(1,"nz-spin",12),I.Xc(2),I.jc(3,"translate"),I.Wb()),2&e&&(I.Db(2),I.Zc(" ",I.kc(3,1,"COMMON.ICD_CODES_LOADING")," "))}function Ce(e,t){1&e&&(I.Xb(0,"nz-option",11),I.Xc(1),I.jc(2,"translate"),I.Wb()),2&e&&(I.Db(1),I.Zc(" ",I.kc(2,1,"COMMON.SEARCH_INPUT")," "))}function De(e,t){1&e&&I.Sb(0,"app-icons",13)}function Se(e,t){1&e&&(I.Xb(0,"div",2),I.Xb(1,"div",14),I.Xb(2,"label",15),I.Xc(3,"Required"),I.Wb(),I.Wb(),I.Wb())}var Ee,Oe=function(e){return{danger:e}},Ie=((Ee=function(){function e(t){c(this,e),this._episodesService=t,this.initialState=!0,this.selectedCodes=[],this.icdCodes=[]}return u(e,[{key:"getICDCodes",value:function(e){var t=this;e?(this.isLoading=!0,this.initialState=!1,this._episodesService.fetchICDCodes(e).subscribe(function(e){t.isLoading=!1,(null==e?void 0:e.length)&&(t.icdCodes=e[3])})):this.initialState=!0}},{key:"setAssignedICDCodes",value:function(e){var t=this;null==e||e.forEach(function(e){t.selectedCodes.push("".concat(e.id||"",", ").concat(e.description||"")),t.icdCodes.push([e.id,e.description])})}},{key:"getSelectedICDCodes",value:function(){var e;return null===(e=this.selectedCodes)||void 0===e?void 0:e.map(function(e){var t,n,i=e.split(",");return{id:i[0],description:null===(n=null===(t=null==i?void 0:i.slice(1))||void 0===t?void 0:t.join())||void 0===n?void 0:n.trim()}})}}]),e}()).\u0275fac=function(e){return new(e||Ee)(I.Rb(C.a))},Ee.\u0275cmp=I.Lb({type:Ee,selectors:[["app-icd-codes"]],inputs:{disabled:"disabled",errors:"errors"},decls:17,vars:16,consts:[[1,"container"],["nz-typography",""],["nz-row",""],[3,"nzSuffix","ngClass"],["nzMode","multiple","nzServerSearch","true",3,"ngModel","nzNotFoundContent","nzPlaceHolder","nzDisabled","ngModelChange","nzOnSearch"],[4,"ngIf"],["nzDisabled","","nzCustomContent","",4,"ngIf"],["suffixIconSearch",""],["nz-row","",4,"ngIf"],[3,"nzLabel","nzValue",4,"ngFor","ngForOf"],[3,"nzLabel","nzValue"],["nzDisabled","","nzCustomContent",""],["nzSimple","","nzSize","small"],["size","16px","name","search","color","white","strokeColor","black"],["nz-col","","nzSpan","6"],["nz-typography","","nzType","danger"]],template:function(e,t){if(1&e&&(I.Xb(0,"div",0),I.Xb(1,"h3",1),I.Xc(2,"ICD Codes *"),I.Wb(),I.Xb(3,"div",2),I.Xb(4,"nz-input-group",3),I.Xb(5,"nz-select",4),I.ec("ngModelChange",function(e){return t.selectedCodes=e})("nzOnSearch",function(e){return t.getICDCodes(e)}),I.jc(6,"translate"),I.jc(7,"translate"),I.Vc(8,ge,2,1,"ng-container",5),I.Vc(9,me,4,3,"nz-option",6),I.Vc(10,Ce,3,3,"nz-option",6),I.Wb(),I.Wb(),I.Vc(11,De,1,0,"ng-template",null,7,I.Wc),I.Wb(),I.Vc(13,Se,4,0,"div",8),I.Sb(14,"br"),I.Sb(15,"br"),I.Sb(16,"nz-divider"),I.Wb()),2&e){var n=I.Ic(12);I.Db(4),I.rc("nzSuffix",n)("ngClass",I.yc(14,Oe,!(null==t.errors||!t.errors.includes("INVALID_ICD_CODES")))),I.Db(1),I.sc("nzNotFoundContent",I.kc(6,10,"COMMON.ICD_CODES_NOT_FOUND")),I.sc("nzPlaceHolder",I.kc(7,12,"COMMON.SEARCH")),I.rc("ngModel",t.selectedCodes)("nzDisabled",t.disabled),I.Db(3),I.rc("ngIf",!t.isLoading),I.Db(1),I.rc("ngIf",t.isLoading),I.Db(1),I.rc("ngIf",t.initialState&&!(null!=t.icdCodes&&t.icdCodes.length)),I.Db(3),I.rc("ngIf",!(null==t.errors||!t.errors.includes("INVALID_ICD_CODES")))}},directives:[P.a,N.c,L.a,W.c,W.d,r.o,R.d,v.u,v.x,r.q,w.a,r.p,R.a,fe.a,ve.a,N.a],pipes:[se.a],styles:["h3[_ngcontent-%COMP%]{margin-bottom:25px;margin-left:5px}label[_ngcontent-%COMP%]{margin-top:5px;display:block}[_nghost-%COMP%]     .ant-input-affix-wrapper{border:1px solid #2f4f4f;padding:0 10px 0 0}[_nghost-%COMP%]     .ant-select:not(.ant-select-customize-input) .ant-select-selector{border:none}app-icons[_ngcontent-%COMP%]{margin-top:3px;pointer-events:none}.danger[_ngcontent-%COMP%]{border:1px solid #c81c1c}"]}),Ee),_e=o("GMnC"),Te=o("d+1G"),Xe=o("TaO5"),ye=o("ZyQt");function Ne(e,t){if(1&e){var n=I.Yb();I.Vb(0),I.Xb(1,"label",7),I.ec("ngModelChange",function(e){return I.Lc(n),I.ic(2).complexCCM=e})("ngModelChange",function(){return I.Lc(n),I.ic(2).toggleComplexCCM()}),I.Xc(2," Complex CCM Patient "),I.Wb(),I.Sb(3,"br"),I.Sb(4,"br"),I.Ub()}if(2&e){var i=I.ic(2);I.Db(1),I.rc("nzDisabled","EDIT"===i.mode)("ngModel",i.complexCCM)}}function ze(e,t){if(1&e&&(I.Xb(0,"nz-tag",8),I.Xc(1),I.Wb()),2&e){var n=t.$implicit;I.rc("nzColor","#E8E8E8"),I.Db(1),I.Yc(null==n?null:n.name)}}function Me(e,t){if(1&e&&(I.Xb(0,"div",1),I.Xb(1,"h3",2),I.Xc(2),I.jc(3,"translate"),I.Wb(),I.Vc(4,Ne,5,2,"ng-container",3),I.Xb(5,"div",4),I.Xb(6,"div",5),I.Xb(7,"label"),I.Xc(8),I.jc(9,"translate"),I.Wb(),I.Xc(10," \xa0\xa0 "),I.Vc(11,ze,2,2,"nz-tag",6),I.Wb(),I.Wb(),I.Sb(12,"br"),I.Sb(13,"nz-divider"),I.Wb()),2&e){var n=I.ic();I.Db(2),I.Yc(I.kc(3,4,"EPISODE.SERVICE_CODES")),I.Db(2),I.rc("ngIf","CCM"===(null==n.episodeBlueprint?null:n.episodeBlueprint.type)),I.Db(4),I.Zc("",I.kc(9,6,"COMMON.APPLIED"),":"),I.Db(3),I.rc("ngForOf",n.serviceCodes)}}var Ae,Pe=((Ae=function(){function e(t){c(this,e),this._activatedRoute=t,this.serviceCodes=[]}return u(e,[{key:"episodeData",set:function(e){e&&(this.episode=e,_e.a.CCM===(null==e?void 0:e.episodeType)&&this.toggleComplexCCM(null==e?void 0:e.cptCodeList))}},{key:"ngOnInit",value:function(){var e=this;this._activatedRoute.queryParams.subscribe(function(t){e.selectedBlueprintId=null==t?void 0:t.blueprintId,e.getEnabledServiceCodes()})}},{key:"getEnabledServiceCodes",value:function(){var e=this;this.tenantSettings&&this.tenantSettings.episodeBlueprints&&this.tenantSettings.episodeBlueprints.forEach(function(t){e.selectedBlueprintId&&e.selectedBlueprintId===t.id&&(e.episodeBlueprint=t,e.filterServiceCodes(t.enabledServiceCodes),"CCM"===t.type&&e.toggleComplexCCM())})}},{key:"filterServiceCodes",value:function(e){this.serviceCodes=(null==e?void 0:e.length)?Te.d.filter(function(t){return-1!==e.findIndex(function(e){return e===t.id})}):[]}},{key:"setServiceCodes",value:function(e){this.serviceCodes=e,this.getEnabledServiceCodes()}},{key:"toggleComplexCCM",value:function(e){var t=this,n=["99490","99439","99439B"],i=["99487","99489","99491"],a=[],o=[];(null==e?void 0:e.length)?(this.serviceCodes=e,a=e.filter(function(e){return-1!==i.findIndex(function(t){return t===e.id})}),o=e.filter(function(e){return-1!==n.findIndex(function(t){return t===e.id})})):(this.serviceCodes=Te.d.filter(function(e){return-1!==t.episodeBlueprint.enabledServiceCodes.findIndex(function(t){return t===e.id})}),a=this.serviceCodes.filter(function(e){return-1!==i.findIndex(function(t){return t===e.id})}),o=this.serviceCodes.filter(function(e){return-1!==n.findIndex(function(t){return t===e.id})}),this.complexCCM?o=[]:a=[]),(null==a?void 0:a.length)&&(this.serviceCodes=a,this.complexCCM=!0),(null==o?void 0:o.length)&&(this.serviceCodes=o)}}]),e}()).\u0275fac=function(e){return new(e||Ae)(I.Rb(_.a))},Ae.\u0275cmp=I.Lb({type:Ae,selectors:[["app-service-codes"]],inputs:{mode:"mode",tenantSettings:"tenantSettings",episodeData:["episode","episodeData"]},decls:1,vars:1,consts:[["class","container",4,"ngIf"],[1,"container"],["nz-typography",""],[4,"ngIf"],["nz-row",""],["nz-col","","nzSpan","24"],[3,"nzColor",4,"ngFor","ngForOf"],["nz-checkbox","",3,"nzDisabled","ngModel","ngModelChange"],[3,"nzColor"]],template:function(e,t){1&e&&I.Vc(0,Me,14,8,"div",0),2&e&&I.rc("ngIf",null==t.serviceCodes?null:t.serviceCodes.length)},directives:[r.q,P.a,N.c,N.a,r.p,w.a,Xe.a,v.u,v.x,ye.a],pipes:[se.a],styles:["h3[_ngcontent-%COMP%]{margin-bottom:25px}h3[_ngcontent-%COMP%], label[_ngcontent-%COMP%]{margin-left:5px}nz-tag[_ngcontent-%COMP%]{color:#888;border-radius:2px}"]}),Ae),We=o("rqHP"),Re=(o("cauy"),o("CLv8")),ke=o("EGpF");function we(e,t){if(1&e){var n=I.Yb();I.Xb(0,"nz-switch",15),I.ec("ngModelChange",function(e){return I.Lc(n),I.ic().insurance.secondaryInsured=e}),I.Wb()}if(2&e){var i=I.ic();I.rc("ngModel",i.insurance.secondaryInsured)}}function Le(e,t){1&e&&(I.Xb(0,"span",16),I.Xc(1,"Required"),I.Wb())}function xe(e,t){1&e&&(I.Xb(0,"span",16),I.Xc(1," Required "),I.Wb())}var Ve,Ue,Fe=function(e){return{danger:e}},je=((Ve=function(){function e(){c(this,e),this.insurance=new We.a}return u(e,[{key:"patientProfile",set:function(e){this.setInsuranceInfo(null==e?void 0:e.insuranceInformation)}},{key:"setInsuranceInfo",value:function(e){(null==e?void 0:e.primaryInsuranceDetails)||(e=new We.a),(null==e?void 0:e.secondaryInsuranceDetails)||(e.secondaryInsuranceDetails=new Re.a),this.insurance=e}}]),e}()).\u0275fac=function(e){return new(e||Ve)},Ve.\u0275cmp=I.Lb({type:Ve,selectors:[["app-insurance"]],inputs:{patientProfile:["patient","patientProfile"],errors:"errors"},decls:39,vars:28,consts:[[1,"container"],["nz-row","","nzGutter","16"],["nz-col","","nzSpan","12"],["nz-typography",""],["nz-col","","nzXs","10","nzSm","10","nzMd","6","id","top-left",1,"shaded"],["id","multiple"],["nz-col","","nzXs","2","nzSm","2","nzMd","6","id","top-right",1,"shaded"],["nzSize","small",3,"ngModel","ngModelChange",4,"ngIf"],["nz-col","","nzSpan","6"],["nz-typography","","nzEllipsis",""],["nz-input","","disabled","","readonly","","onfocus","this.removeAttribute('readonly')",3,"ngModel","ngClass","ngModelChange"],["nz-typography","","nzType","danger",4,"ngIf"],["nz-col","","nzSpan","6","id","bottom-left",1,"shaded"],["nz-input","","disabled","",3,"ngModel","ngModelChange"],["nz-col","","nzSpan","6","id","bottom-right",1,"shaded"],["nzSize","small",3,"ngModel","ngModelChange"],["nz-typography","","nzType","danger"]],template:function(e,t){1&e&&(I.Xb(0,"div",0),I.Xb(1,"div",1),I.Xb(2,"div",2),I.Xb(3,"h3",3),I.Xc(4),I.jc(5,"translate"),I.Wb(),I.Wb(),I.Vb(6),I.Xb(7,"div",4),I.Xb(8,"label",5),I.Xc(9,"Secondary Insurance"),I.Wb(),I.Wb(),I.Xb(10,"div",6),I.Vc(11,we,1,1,"nz-switch",7),I.Wb(),I.Ub(),I.Wb(),I.Xb(12,"div",1),I.Xb(13,"div",8),I.Xb(14,"label",9),I.Xc(15),I.jc(16,"translate"),I.Wb(),I.Xb(17,"input",10),I.ec("ngModelChange",function(e){return t.insurance.primaryInsuranceDetails.carrierName=e}),I.Wb(),I.Vc(18,Le,2,0,"span",11),I.Wb(),I.Xb(19,"div",8),I.Xb(20,"label",9),I.Xc(21),I.jc(22,"translate"),I.Wb(),I.Xb(23,"input",10),I.ec("ngModelChange",function(e){return t.insurance.primaryInsuranceDetails.insuranceId=e}),I.Wb(),I.Vc(24,xe,2,0,"span",11),I.Wb(),I.Xb(25,"div",12),I.Xb(26,"label",9),I.Xc(27),I.jc(28,"translate"),I.Wb(),I.Xb(29,"input",13),I.ec("ngModelChange",function(e){return t.insurance.secondaryInsuranceDetails.carrierName=e}),I.Wb(),I.Wb(),I.Xb(30,"div",14),I.Xb(31,"label",9),I.Xc(32),I.jc(33,"translate"),I.Wb(),I.Xb(34,"input",13),I.ec("ngModelChange",function(e){return t.insurance.secondaryInsuranceDetails.insuranceId=e}),I.Wb(),I.Sb(35,"br"),I.Sb(36,"br"),I.Wb(),I.Wb(),I.Sb(37,"br"),I.Sb(38,"nz-divider"),I.Wb()),2&e&&(I.Db(4),I.Yc(I.kc(5,14,"PATIENT.INSURANCE_INFORMATION")),I.Db(7),I.rc("ngIf",!1),I.Db(4),I.Zc("",I.kc(16,16,"INSURANCE.PRIMARY_INSURANCE_CARRIER_NAME")," *"),I.Db(2),I.rc("ngModel",t.insurance.primaryInsuranceDetails.carrierName)("ngClass",I.yc(24,Fe,!t.insurance.primaryInsuranceDetails.carrierName&&!(null==t.errors||!t.errors.includes("INVALID_PRIMARY_INSURANCE_CARRIER")))),I.Db(1),I.rc("ngIf",!t.insurance.primaryInsuranceDetails.carrierName&&!(null==t.errors||!t.errors.includes("INVALID_PRIMARY_INSURANCE_CARRIER"))),I.Db(3),I.Zc("",I.kc(22,18,"INSURANCE.INSURER_MEMBER_ID")," *"),I.Db(2),I.rc("ngModel",t.insurance.primaryInsuranceDetails.insuranceId)("ngClass",I.yc(26,Fe,!t.insurance.primaryInsuranceDetails.insuranceId&&!(null==t.errors||!t.errors.includes("INVALID_PRIMARY_INSURANCE_ID")))),I.Db(1),I.rc("ngIf",!t.insurance.primaryInsuranceDetails.insuranceId&&!(null==t.errors||!t.errors.includes("INVALID_PRIMARY_INSURANCE_ID"))),I.Db(3),I.Yc(I.kc(28,20,"INSURANCE.SECONDARY_INSURANCE_CARRIER_NAME")),I.Db(2),I.rc("ngModel",t.insurance.secondaryInsuranceDetails.carrierName),I.Db(3),I.Yc(I.kc(33,22,"INSURANCE.INSURER_MEMBER_ID")),I.Db(2),I.rc("ngModel",t.insurance.secondaryInsuranceDetails.insuranceId))},directives:[N.c,N.a,P.a,r.q,W.b,v.d,v.u,v.x,r.o,w.a,ke.a],pipes:[se.a],styles:["h3[_ngcontent-%COMP%]{margin-bottom:25px;margin-left:5px}input[_ngcontent-%COMP%]{background:#fbfbfb 0 0 no-repeat padding-box;border:1px solid var(--grey)}#multiple[_ngcontent-%COMP%]{font-weight:700}label[_ngcontent-%COMP%]{font:normal normal normal 12px/16px Nunito;color:var(--tertiary-color);margin-left:5px;margin-bottom:5px;display:block}.shaded[_ngcontent-%COMP%]{background:#dbdbdb 0 0 no-repeat padding-box}#top-left[_ngcontent-%COMP%]{padding-top:15px;padding-bottom:10px;border-top-left-radius:5px}#top-right[_ngcontent-%COMP%]{padding-top:15px;border-top-right-radius:5px}#bottom-left[_ngcontent-%COMP%]{border-bottom-left-radius:5px}#bottom-right[_ngcontent-%COMP%]{border-bottom-right-radius:5px}span[_ngcontent-%COMP%]{display:block;margin-left:5px;margin-top:5px}.danger[_ngcontent-%COMP%]{border-color:#c81c1c}"]}),Ve),Ye=o("Dm2S"),Ge=o("ua0i"),Be=o("HZ0a"),He=o("dEAy"),Ze=o("PScX"),qe=o("S5rh"),$e=((Ue=function(){function e(t,n,i,a,o){c(this,e),this._cdRef=t,this._templateRef=n,this._activatedRoute=i,this._viewContainerRef=a,this._dataSharingService=o}return u(e,[{key:"ngOnInit",value:function(){this.getDataFromURL()}},{key:"ngOnDestroy",value:function(){this.$route.unsubscribe(),this.$tenantSettings.unsubscribe()}},{key:"getDataFromURL",value:function(){var e=this;this.$route=this._activatedRoute.queryParams.subscribe(function(t){e.blueprintId=null==t?void 0:t.blueprintId,e.getTenantSettings(),e.disableFeature(),e.checkStatus()})}},{key:"getTenantSettings",value:function(){var e=this;this.$tenantSettings=this._dataSharingService.assignedTenantSettings.subscribe(function(t){var n;t.forEach(function(t,i){t.episodeBlueprints.findIndex(function(t){return t.id===e.blueprintId})>=0&&(n=t)}),n&&!e.tenantSettings&&(e.tenantSettings=n,e.checkStatus())})}},{key:"checkStatus",value:function(){switch(this.isComponentEnabled){case"PHYSICIAN_ORDER":this.isPhysicianOrderEnabled();break;case"CONSENT_FORM":this.isConsentFormEnabled();break;case"INSURANCE":this.isInsuranceEnabled();break;case"APPOINTMENT":this.isAppointmentEnabled();break;case"PATIENT_EDUCATION_APPOINTMENT":this.isPatientEducationTaskEnabled();break;case"PLAN_OF_CARE":this.isPlanOfCareEnabled();break;case"CARE_PLAN":this.isCareplanEnabled();break;case"CARE_MANAGEMENT_TIME":this.isCareManagementTimeEnabled();break;case"TREATMENT_MANAGEMENT_SERVICE":this.isTreatmentManagementServiceEnabled();break;case"ADDITIONAL_TREATMENT_MANAGEMENT_SERVICE":this.isAdditionalTreatmentManagementServiceEnabled();break;default:this.disableFeature()}}},{key:"enableFeature",value:function(){this._viewContainerRef.createEmbeddedView(this._templateRef),this._cdRef.detectChanges()}},{key:"disableFeature",value:function(){this._viewContainerRef.clear(),this._cdRef.detectChanges()}},{key:"getEpisodeBlueprint",value:function(){var e,t=this,n=null===(e=this.tenantSettings)||void 0===e?void 0:e.episodeBlueprints;return null==n?void 0:n.find(function(e){return t.blueprintId===e.id&&!e.archived})}},{key:"isPhysicianOrderEnabled",value:function(){var e,t=this.getEpisodeBlueprint();(null===(e=null==t?void 0:t.episodeComponent)||void 0===e?void 0:e.physicianOrderEnabled)?this.enableFeature():this.disableFeature()}},{key:"isConsentFormEnabled",value:function(){var e,t=this.getEpisodeBlueprint();(null===(e=null==t?void 0:t.episodeComponent)||void 0===e?void 0:e.enableConsentForm)?this.enableFeature():this.disableFeature()}},{key:"isInsuranceEnabled",value:function(){var e,t=this.getEpisodeBlueprint();(null===(e=null==t?void 0:t.episodeComponent)||void 0===e?void 0:e.enableInsuranceInfo)?this.enableFeature():this.disableFeature()}},{key:"isAppointmentEnabled",value:function(){var e,t,n=this.getEpisodeBlueprint();!(null===(e=null==n?void 0:n.enabledServiceCodes)||void 0===e?void 0:e.find(function(e){return"99453"===e}))&&(null===(t=null==n?void 0:n.episodeComponent)||void 0===t?void 0:t.enableAppointment)?this.enableFeature():this.disableFeature()}},{key:"isPatientEducationTaskEnabled",value:function(){var e,t=this.getEpisodeBlueprint();(null===(e=null==t?void 0:t.enabledServiceCodes)||void 0===e?void 0:e.find(function(e){return"99453"===e}))?this.enableFeature():this.disableFeature()}},{key:"isPlanOfCareEnabled",value:function(){var e,t=this.getEpisodeBlueprint();(null===(e=null==t?void 0:t.episodeComponent)||void 0===e?void 0:e.enablePlanOfCare)?this.enableFeature():this.disableFeature()}},{key:"isCareplanEnabled",value:function(){var e,t=this.getEpisodeBlueprint();"CCM"===(null==t?void 0:t.type)||(null===(e=null==t?void 0:t.episodeComponent)||void 0===e?void 0:e.enableCarePlan)?this.enableFeature():this.disableFeature()}},{key:"isCareManagementTimeEnabled",value:function(){var e=this.getEpisodeBlueprint(),t=null==e?void 0:e.enabledServiceCodes.findIndex(function(e){return"99484"===e});void 0!==t&&-1!==t?this.enableFeature():this.disableFeature()}},{key:"isTreatmentManagementServiceEnabled",value:function(){var e=this.getEpisodeBlueprint(),t=null==e?void 0:e.enabledServiceCodes.findIndex(function(e){return"99457"===e});void 0!==t&&-1!==t?this.enableFeature():this.disableFeature()}},{key:"isAdditionalTreatmentManagementServiceEnabled",value:function(){var e=this.getEpisodeBlueprint(),t=null==e?void 0:e.enabledServiceCodes.findIndex(function(e){return"99458"===e});void 0!==t&&-1!==t?this.enableFeature():this.disableFeature()}}]),e}()).\u0275fac=function(e){return new(e||Ue)(I.Rb(I.h),I.Rb(I.N),I.Rb(_.a),I.Rb(I.R),I.Rb(te.a))},Ue.\u0275dir=I.Mb({type:Ue,selectors:[["","isComponentEnabled",""]],inputs:{isComponentEnabled:"isComponentEnabled"}}),Ue),Ke=o("mLmo");function Qe(e,t){if(1&e&&I.Sb(0,"app-insurance",8),2&e){var n=I.ic(2);I.rc("patient",n.patient)("errors",n.errors)}}function Je(e,t){if(1&e&&(I.Xb(0,"div",3),I.Sb(1,"app-duration",4),I.Vc(2,Qe,1,2,"app-insurance",5),I.Sb(3,"app-icd-codes",6),I.Sb(4,"app-service-codes",7),I.Wb()),2&e){var n=I.ic();I.Db(1),I.rc("tenantSettings",n.tenantSettings)("errors",n.errors),I.Db(1),I.rc("isComponentEnabled","INSURANCE"),I.Db(1),I.rc("disabled",!0)("errors",n.errors),I.Db(1),I.rc("mode",n.mode)("tenantSettings",n.tenantSettings)("episode",n.episode)}}var et,tt=((et=function(e){a(i,e);var n=s(i);function i(e,t,a,o,s,l,r,d,u,b,p,f,v){var h;return c(this,i),(h=n.call(this))._dataSharingService=e,h._patientsService=t,h._episodesService=a,h._router=o,h._datePipe=s,h._modalService=l,h._notificationsService=r,h._episodeFormValidator=d,h._translationsService=u,h._patientsEventLogger=b,h._episodesEventLogger=p,h._activatedRoute=f,h._messageService=v,h._translationsService.getMultiple("EPISODE","EPISODE.CREATED","EPISODE.UPDATED","EPISODE.SUSPEND_POPUP_TITLE","EPISODE.SUSPEND_POPUP_CONTENT","EPISODE.SELECT_TEMPLATE","EPISODE.SUSPEND_REASON").pipe(Object(E.a)(h.unsubscribed)).subscribe(function(e){h.translatedStrings=e}),h}return u(i,[{key:"ngAfterViewInit",value:function(){this.checkComponentMode(),this.getTenantSettings()}},{key:"checkComponentMode",value:function(){var e=this;this._activatedRoute.params.pipe(Object(E.a)(this.unsubscribed)).subscribe(function(t){var n;e.mode=null===(n=t.mode)||void 0===n?void 0:n.toUpperCase(),e.patientId=t.patientId}),this._activatedRoute.queryParams.pipe(Object(E.a)(this.unsubscribed)).subscribe(function(t){e.blueprintId&&!(null==t?void 0:t.blueprintId)&&(e.errors||(e.errors=[]),e.errors.push("INVALID_BLUEPRINT")),e.episodeId=t.episodeId,e.blueprintId=t.blueprintId,e.context=e._activatedRoute.snapshot.queryParams.context,e.contextMode=e._activatedRoute.snapshot.queryParams.contextMode,e.tenantId=e._activatedRoute.snapshot.queryParams.tenantId,e.setSelectedBlueprint()})}},{key:"getTenantSettings",value:function(){var e=this;this._dataSharingService.assignedTenantSettings.pipe(Object(E.a)(this.unsubscribed)).subscribe(function(t){var n=t.get(e.tenantId);n&&(e.tenantSettings=n,e.setSelectedBlueprint(),e.initializeEpisodeData())})}},{key:"initializeEpisodeData",value:function(){var e=this;"ADD"===this.mode?this.getPatientData().subscribe(function(t){e.patient=t,localStorage.setItem(O.a.REQUEST_TENANT_TEMP_IDS,e.patient.tenantId),e.setICDCodesInfo()}):"EDIT"===this.mode&&(this.getPatientData().subscribe(function(t){e.patient=t,localStorage.setItem(O.a.REQUEST_TENANT_TEMP_IDS,e.patient.tenantId)}),this.getEpisodeData())}},{key:"setSelectedBlueprint",value:function(){var e,t,n=this;this.blueprintId||(this.selectedBlueprint=void 0),null===(t=null===(e=this.tenantSettings)||void 0===e?void 0:e.episodeBlueprints)||void 0===t||t.forEach(function(e){(null==e?void 0:e.id)===n.blueprintId&&(n.selectedBlueprint=e)})}},{key:"getEpisodeData",value:function(){var e=this;this._episodesService.fetchEpisode(this.episodeId).subscribe(function(t){e.episode=t,e.durationComponent.setDuration(t.startDate,t.endDate),e.insuranceComponent.setInsuranceInfo(t.insuranceInformation),e.icdCodesComponent.setAssignedICDCodes(t.icdCodeList),e.serviceCodesComponent.setServiceCodes(t.cptCodeList)})}},{key:"getPatientData",value:function(){return this._patientsService.getSpecificUser(this.patientId)}},{key:"setICDCodesInfo",value:function(){var e=this;this._episodesService.fetchEpisodePrefillData(this.patientId).subscribe(function(t){e.icdCodesComponent.setAssignedICDCodes(t.icdCodes),"AUTO_CREATION"===e.context&&e.blueprintId&&e.selectedBlueprint&&e.saveEpisode()})}},{key:"validateEpisode",value:function(e){var n,i,a,o,s,l=this;return this.errors=[],this.selectedBlueprint?(Ge.a.RPM===(null===(a=this.selectedBlueprint)||void 0===a?void 0:a.type)?(n=this.errors).push.apply(n,t(this._episodeFormValidator.validateRPMEpisode(e))):(i=this.errors).push.apply(i,t(this._episodeFormValidator.validateGeneralEpisode(!!this.insuranceComponent,e))),"AUTO_CREATION"===this.context&&(null===(o=this.errors)||void 0===o?void 0:o.length)&&this.errors.forEach(function(e){var t;switch(e){case"INVALID_PRIMARY_INSURANCE_CARRIER":t="Primary insurance carrier name cannot be blank";break;case"INVALID_PRIMARY_INSURANCE_ID":t="Primary insurance id cannot be blank";break;case"INVALID_CPT_CODES":t="At least 1 CPT code is needed";break;case"INVALID_ICD_CODES":t="Dx codes cannot be empty"}(null==t?void 0:t.length)&&l._messageService.error(t,{nzDuration:2e4})}),!(null===(s=this.errors)||void 0===s?void 0:s.length)):(this.errors.push("INVALID_BLUEPRINT"),!1)}},{key:"saveEpisode",value:function(){var e=this.getEpisodeRequestObject();this.validateEpisode(e)&&("ADD"===this.mode?this.createNewEpisode(e):"EDIT"===this.mode&&this.updateEpisode(e))}},{key:"createNewEpisode",value:function(e){var t=this;e.blueprintId=this.blueprintId;var n=this.selectedBlueprint.type;this._episodesService.fetchActiveEpisodes(this.patientId,1,0,this.selectedBlueprint.id,[Q.a.SCHEDULED,Q.a.IN_PROGRESS]).subscribe(function(i){var a,o;if(!(null==i?void 0:i.totalCount))return t._patientsEventLogger.patientActionEvent(t.patientId,"create_episode"),void t.createEpisode(e);var s=i.result.filter(function(e){return e.endTime>Date.now()});if(!(null==s?void 0:s.length))return t._patientsEventLogger.patientActionEvent(t.patientId,"create_episode"),void t.createEpisode(e);var l={assignerId:localStorage.getItem("loggedInUser"),archived:!1,reason:null===(a=t.translatedStrings.get("EPISODE.SUSPEND_REASON"))||void 0===a?void 0:a.replace("{EPISODE_NAME}",null===(o=t.selectedBlueprint)||void 0===o?void 0:o.name)};t._modalService.confirm({nzTitle:t.translatedStrings.get("EPISODE.SUSPEND_POPUP_TITLE"),nzContent:t.translatedStrings.get("EPISODE.SUSPEND_POPUP_CONTENT"),nzOkText:"Yes",nzCancelText:"No",nzOnOk:function(){t._episodesEventLogger.episodeActionEventAddAndSuspendEpisode(s[0].id,t.patientId,n,"suspend_episode"),t.createEpisode(e),t._episodesService.suspendEpisode(s[0].id,l).subscribe(function(e){})}})})}},{key:"createEpisode",value:function(e){var t=this;this._episodesService.saveEpisode(e).subscribe(function(n){t._episodesEventLogger.episodeActionEventAddAndSuspendEpisode(n.id,e.patientId,e.episodeType,"add_episode"),t._notificationsService.success(t.translatedStrings.get("EPISODE"),t.translatedStrings.get("EPISODE.CREATED")),"AUTO_CREATION"===t.context&&t.blueprintId&&t.selectedBlueprint&&"lead"===t.contextMode?t._router.navigate(["/leads"],{replaceUrl:!0,queryParams:{tab:"ACTIVE",status:"ACTIVE"}}):"AUTO_CREATION"===t.context&&t.blueprintId&&t.selectedBlueprint?t._router.navigate(["/patient/view/".concat(t.patientId),{replaceUrl:!0}]):t.viewEpisodeDetails(n.id)},function(){t._notificationsService.error(t.translatedStrings.get("EPISODE"),"Error creating episode!")})}},{key:"updateEpisode",value:function(e){var t=this;e.id=this.episodeId,this._episodesService.updateEpisode(e).subscribe(function(){t._episodesEventLogger.episodeActionEvent(e.id,e.patientId,"edit_episode"),t._notificationsService.success(t.translatedStrings.get("EPISODE"),t.translatedStrings.get("EPISODE.UPDATED")),t.viewEpisodeDetails(e.id)},function(){t._notificationsService.error(t.translatedStrings.get("EPISODE"),"Error saving episode!")})}},{key:"getEpisodeRequestObject",value:function(){var e,t,n,i,a,o,s,l,r,c=null===(t=null===(e=this.durationComponent)||void 0===e?void 0:e.duration[0])||void 0===t?void 0:t.getTime(),d=null===(i=null===(n=this.durationComponent)||void 0===n?void 0:n.duration[1])||void 0===i?void 0:i.setHours(23,59,59,59);return{patientId:this.patientId,startTime:c,endTime:d,startDate:this._datePipe.transform(this.durationComponent.duration[0],"yyyy-MM-dd"),endDate:this._datePipe.transform(this.durationComponent.duration[1],"yyyy-MM-dd"),episodeType:null===(a=this.selectedBlueprint)||void 0===a?void 0:a.type,icdCodeList:null===(o=this.icdCodesComponent)||void 0===o?void 0:o.getSelectedICDCodes(),cptCodeList:this.getCPTCodes(),insuranceInformation:(null===(s=this.insuranceComponent)||void 0===s?void 0:s.insurance)||{},consentFiles:null===(l=this.episode)||void 0===l?void 0:l.consentFiles,tenantId:null===(r=this.tenantSettings)||void 0===r?void 0:r.tenantId}}},{key:"getCPTCodes",value:function(){return this.serviceCodesComponent.serviceCodes.filter(function(e){return e.selected})}},{key:"viewEpisodeDetails",value:function(e){this._router.navigate(["episodes/details/".concat(this.patientId,"/").concat(e)],{replaceUrl:!0,queryParams:{blueprintId:this.selectedBlueprint.id}})}}]),i}(D.a)).\u0275fac=function(e){return new(e||et)(I.Rb(te.a),I.Rb(m.a),I.Rb(C.a),I.Rb(_.g),I.Rb(r.e),I.Rb(He.f),I.Rb(T.b),I.Rb(ee),I.Rb(J.a),I.Rb(Be.a),I.Rb(Ye.a),I.Rb(_.a),I.Rb(Ze.e))},et.\u0275cmp=I.Lb({type:et,selectors:[["app-episode-form"]],viewQuery:function(e,t){var n;1&e&&(I.ed(pe,1),I.ed(je,1),I.ed(Ie,1),I.ed(Pe,1)),2&e&&(I.Hc(n=I.fc())&&(t.durationComponent=n.first),I.Hc(n=I.fc())&&(t.insuranceComponent=n.first),I.Hc(n=I.fc())&&(t.icdCodesComponent=n.first),I.Hc(n=I.fc())&&(t.serviceCodesComponent=n.first))},features:[I.Cb([r.e,ee]),I.Ab],decls:6,vars:16,consts:[["title","episodeForm",3,"defaultTitle","isActionEnabled","actionTitle","isSearchEnabled","action"],["nzTip","Please wait while we generate an episode for the patient...",3,"nzSpinning"],["class","container",4,"ngIf"],[1,"container"],[3,"tenantSettings","errors"],[3,"patient","errors",4,"isComponentEnabled"],[3,"disabled","errors"],[3,"mode","tenantSettings","episode"],[3,"patient","errors"]],template:function(e,t){1&e&&(I.Xb(0,"app-header",0),I.ec("action",function(){return t.saveEpisode()}),I.jc(1,"episodeName"),I.jc(2,"episodeName"),I.jc(3,"translate"),I.Wb(),I.Xb(4,"nz-spin",1),I.Vc(5,Je,5,8,"div",2),I.Wb()),2&e&&(I.uc("defaultTitle","",null==t.patient?null:t.patient.fullName," | ","ADD"===t.mode?I.mc(1,7,(null==t.selectedBlueprint?null:t.selectedBlueprint.type)||"","Create","Episode"):I.lc(2,11,(null==t.selectedBlueprint?null:t.selectedBlueprint.type)||"","Edit"),""),I.sc("actionTitle",I.kc(3,14,"COMMON.SAVE_EPISODE")),I.rc("isActionEnabled","AUTO_CREATION"!==t.context)("isSearchEnabled",!1),I.Db(4),I.rc("nzSpinning","AUTO_CREATION"===t.context),I.Db(1),I.rc("ngIf",t.tenantSettings))},directives:[qe.a,fe.a,r.q,pe,$e,Ie,Pe,je],pipes:[Ke.a,se.a],styles:[".text-center[_ngcontent-%COMP%]{text-align:center}[_nghost-%COMP%]     .ant-spin-blur{opacity:0}[_nghost-%COMP%]     .ant-spin-text{font-size:16px}"]}),et),nt=o("wjar"),it=o("nJia"),at=o("Pp+U");function ot(e,t){1&e&&(I.Vb(0),I.Xc(1,",\xa0 "),I.Ub())}function st(e,t){if(1&e&&(I.Vb(0),I.Xc(1),I.Vc(2,ot,2,0,"ng-container",6),I.jc(3,"keyvalue"),I.Ub()),2&e){var n,i=t.$implicit,a=t.index,o=I.ic();I.Db(1),I.Zc(" ",null==i?null:i.value,""),I.Db(1),I.rc("ngIf",a<(null==(n=I.kc(3,2,null==o.episodeDetails?null:o.episodeDetails.monitoringStaff))?null:n.length)-1)}}function lt(e,t){if(1&e&&(I.Xb(0,"h4"),I.Xc(1),I.jc(2,"episodeStatusName"),I.Wb()),2&e){var n=I.ic();I.Db(1),I.Yc(I.kc(2,1,null==n.episodeDetails?null:n.episodeDetails.status))}}function rt(e,t){if(1&e&&(I.Vb(0),I.Xb(1,"h4"),I.Xc(2),I.jc(3,"date"),I.Wb(),I.Sb(4,"app-icons",7),I.Ub()),2&e){var n=I.ic();I.Db(2),I.Zc(" Suspended on ",I.lc(3,2,null==n.episodeDetails?null:n.episodeDetails.updatedOn,"d MMMM y")," "),I.Db(2),I.tc("nzTooltipTitle","Reason for suspension: ",(null==n.episodeDetails?null:n.episodeDetails.statusChangeReason)||"N/A","")}}var ct,dt=function(){return[32,32]},ut=function(e,t,n,i){return{"scheduled-status":e,"active-status":t,"suspended-status":n,"completed-status":i}},bt=((ct=function(){function e(){c(this,e)}return u(e,[{key:"episode",set:function(e){var t,n;this.episodeDetails=e,this.duration=Object(ne.a)(new Date(null===(t=this.episodeDetails)||void 0===t?void 0:t.endDate),new Date(null===(n=this.episodeDetails)||void 0===n?void 0:n.startDate))}}]),e}()).\u0275fac=function(e){return new(e||ct)},ct.\u0275cmp=I.Lb({type:ct,selectors:[["app-basic"]],inputs:{episode:["episodeDetails","episode"]},decls:40,vars:27,consts:[[1,"container"],["nz-row","",3,"nzGutter"],["nz-col","","nzXs","24","nzSm","12","nzMd","6"],[4,"ngFor","ngForOf"],["id","status","nz-col","","nzXs","24","nzSm","12","nzMd","6"],[3,"ngClass"],[4,"ngIf"],["actionable","","originalStyle","true","name","infoCircle","size","16px","nz-tooltip","","nzTooltipPlacement","bottomLeft",3,"nzTooltipTitle"]],template:function(e,t){1&e&&(I.Xb(0,"div",0),I.Xb(1,"div",1),I.Xb(2,"div",2),I.Xb(3,"label"),I.Xc(4,"Episode Name"),I.Wb(),I.Xb(5,"h4"),I.Xc(6),I.Wb(),I.Wb(),I.Xb(7,"div",2),I.Xb(8,"label"),I.Xc(9,"Monitoring Staff"),I.Wb(),I.Xb(10,"h4"),I.Vc(11,st,4,4,"ng-container",3),I.jc(12,"keyvalue"),I.Wb(),I.Wb(),I.Xb(13,"div",4),I.Xb(14,"div",5),I.Xb(15,"label"),I.Xc(16,"Status"),I.Wb(),I.Vc(17,lt,3,3,"h4",6),I.Vc(18,rt,5,5,"ng-container",6),I.Wb(),I.Wb(),I.Wb(),I.Xb(19,"div",1),I.Xb(20,"div",2),I.Xb(21,"label"),I.Xc(22,"Episode Duration"),I.Wb(),I.Xb(23,"h4"),I.Xc(24),I.jc(25,"date"),I.jc(26,"date"),I.Wb(),I.Xb(27,"h4"),I.Xc(28),I.Wb(),I.Wb(),I.Xb(29,"div",2),I.Xb(30,"label"),I.Xc(31,"Primary Insurance Carrier Name"),I.Wb(),I.Xb(32,"h4"),I.Xc(33),I.Wb(),I.Wb(),I.Xb(34,"div",2),I.Xb(35,"label"),I.Xc(36,"Primary Insurance ID"),I.Wb(),I.Xb(37,"h4"),I.Xc(38),I.Wb(),I.Wb(),I.Wb(),I.Sb(39,"nz-divider"),I.Wb()),2&e&&(I.Db(1),I.rc("nzGutter",I.xc(20,dt)),I.Db(5),I.Yc(null==t.episodeDetails?null:t.episodeDetails.name),I.Db(5),I.rc("ngForOf",I.kc(12,12,null==t.episodeDetails?null:t.episodeDetails.monitoringStaff)),I.Db(3),I.rc("ngClass",I.Bc(21,ut,"SCHEDULED"===(null==t.episodeDetails?null:t.episodeDetails.status),"IN_PROGRESS"===(null==t.episodeDetails?null:t.episodeDetails.status),"SUSPENDED"===(null==t.episodeDetails?null:t.episodeDetails.status),"COMPLETED"===(null==t.episodeDetails?null:t.episodeDetails.status))),I.Db(3),I.rc("ngIf","SUSPENDED"!==(null==t.episodeDetails?null:t.episodeDetails.status)),I.Db(1),I.rc("ngIf","SUSPENDED"===(null==t.episodeDetails?null:t.episodeDetails.status)),I.Db(1),I.rc("nzGutter",I.xc(26,dt)),I.Db(5),I.ad(" ",I.lc(25,14,null==t.episodeDetails?null:t.episodeDetails.startDate,"mediumDate")," - ",I.lc(26,17,null==t.episodeDetails?null:t.episodeDetails.endDate,"mediumDate")," "),I.Db(4),I.Zc("(",t.duration," Days)"),I.Db(5),I.Yc(null==t.episodeDetails||null==t.episodeDetails.insuranceInformation||null==t.episodeDetails.insuranceInformation.primaryInsuranceDetails?null:t.episodeDetails.insuranceInformation.primaryInsuranceDetails.carrierName),I.Db(5),I.Yc(null==t.episodeDetails||null==t.episodeDetails.insuranceInformation||null==t.episodeDetails.insuranceInformation.primaryInsuranceDetails?null:t.episodeDetails.insuranceInformation.primaryInsuranceDetails.insuranceId))},directives:[N.c,N.a,r.p,r.o,r.q,w.a,ve.a,nt.a,it.d],pipes:[r.j,r.e,at.a],styles:[".container[_ngcontent-%COMP%]{padding:30px 20px 10px!important}.ant-row[_ngcontent-%COMP%]{margin-bottom:20px!important}label[_ngcontent-%COMP%]{color:var(--tertiary-color);margin-bottom:5px;display:block}h4[_ngcontent-%COMP%], label[_ngcontent-%COMP%]{font:normal normal normal 13px/16px Nunito}h4[_ngcontent-%COMP%]{font-weight:700;margin-bottom:0}#status[_ngcontent-%COMP%]{padding:0!important}#status[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:90%;border-radius:5px;padding:16px 0 16px 16px}#status[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > h4[_ngcontent-%COMP%]{display:unset}.scheduled-status[_ngcontent-%COMP%]{background:#ffe58f 0 0 no-repeat padding-box}.active-status[_ngcontent-%COMP%]{background:var(--primary-color) 0 0 no-repeat padding-box}.suspended-status[_ngcontent-%COMP%]{background:#ffe07b 0 0 no-repeat padding-box}.completed-status[_ngcontent-%COMP%]{background:#dfdfdf 0 0 no-repeat padding-box}app-icons[_ngcontent-%COMP%]{float:right;margin-right:15px;line-height:2}"]}),ct);function pt(e,t){if(1&e&&(I.Vb(0),I.Xb(1,"nz-tag",6),I.Xc(2),I.Wb(),I.Ub()),2&e){var n=t.$implicit;I.Db(1),I.rc("nzColor","#EFFEE2"),I.Db(1),I.Yc(n)}}function ft(e,t){1&e&&(I.Vb(0),I.Xb(1,"h4"),I.Xc(2),I.jc(3,"translate"),I.Wb(),I.Ub()),2&e&&(I.Db(2),I.Yc(I.kc(3,1,"EPISODE.NO_ICD_CODES_ADDED")))}function vt(e,t){if(1&e&&(I.Xb(0,"div",2),I.Xb(1,"h4"),I.Xc(2),I.Wb(),I.Wb()),2&e){var n=t.$implicit;I.Db(2),I.Yc(n.value)}}function ht(e,t){if(1&e&&(I.Xb(0,"div",7),I.Vc(1,vt,3,1,"div",8),I.jc(2,"keyvalue"),I.Wb()),2&e){var n=I.ic();I.Db(1),I.rc("ngForOf",I.kc(2,1,null==n.episodeDetails?null:n.episodeDetails.serviceCodes))}}function gt(e,t){1&e&&(I.Vb(0),I.Xb(1,"h4"),I.Xc(2),I.jc(3,"translate"),I.Wb(),I.Ub()),2&e&&(I.Db(2),I.Yc(I.kc(3,1,"EPISODE.NO_SERVICE_CODES_ADDED")))}var mt,Ct=function(){return[32,32]},Dt=((mt=function e(){c(this,e)}).\u0275fac=function(e){return new(e||mt)},mt.\u0275cmp=I.Lb({type:mt,selectors:[["app-codes"]],inputs:{episodeDetails:"episodeDetails"},decls:14,vars:10,consts:[[1,"container"],["nz-row","",3,"nzGutter"],["nz-col","","nzSpan","12"],[4,"ngFor","ngForOf"],[4,"ngIf"],["nz-row","","nzGutter","16",4,"ngIf"],[3,"nzColor"],["nz-row","","nzGutter","16"],["nz-col","","nzSpan","12",4,"ngFor","ngForOf"]],template:function(e,t){var n,i;(1&e&&(I.Xb(0,"div",0),I.Xb(1,"div",1),I.Xb(2,"div",2),I.Xb(3,"label"),I.Xc(4,"ICD Codes - Diagnosis"),I.Wb(),I.Vc(5,pt,3,2,"ng-container",3),I.Vc(6,ft,4,3,"ng-container",4),I.Wb(),I.Xb(7,"div",2),I.Xb(8,"label"),I.Xc(9,"CPT Codes - Services"),I.Wb(),I.Vc(10,ht,3,3,"div",5),I.jc(11,"keyvalue"),I.Vc(12,gt,4,3,"ng-container",4),I.jc(13,"keyvalue"),I.Wb(),I.Wb(),I.Wb()),2&e)&&(I.Db(1),I.rc("nzGutter",I.xc(9,Ct)),I.Db(4),I.rc("ngForOf",null==t.episodeDetails?null:t.episodeDetails.icdCodes),I.Db(1),I.rc("ngIf",!(null!=t.episodeDetails&&null!=t.episodeDetails.icdCodes&&t.episodeDetails.icdCodes.length)),I.Db(4),I.rc("ngIf",null==(n=I.kc(11,5,null==t.episodeDetails?null:t.episodeDetails.serviceCodes))?null:n.length),I.Db(2),I.rc("ngIf",!(null!=(i=I.kc(13,7,null==t.episodeDetails?null:t.episodeDetails.serviceCodes))&&i.length)))},directives:[N.c,N.a,r.p,r.q,ye.a],pipes:[r.j,se.a],styles:[".ant-row[_ngcontent-%COMP%]{margin-bottom:20px!important}label[_ngcontent-%COMP%]{color:var(--tertiary-color);margin-bottom:10px;display:block}h4[_ngcontent-%COMP%], label[_ngcontent-%COMP%]{font:normal normal normal 13px/16px Nunito}h4[_ngcontent-%COMP%]{font-weight:700;margin-bottom:0}.ant-tag[_ngcontent-%COMP%]{background-color:#effee2;font:normal normal normal 12px/16px Nunito;font-weight:700;color:var(--light-black);padding:5px;max-width:100%;overflow:hidden;text-overflow:ellipsis}"]}),mt),St=o("wpKq"),Et=o("ZKr6");function Ot(e,t){1&e&&(I.Xb(0,"strong",13),I.Xb(1,"label",14),I.Xc(2,"Convert To Complex CCM"),I.Wb(),I.Wb())}function It(e,t){1&e&&(I.Xb(0,"strong",13),I.Xb(1,"label",14),I.Xc(2,"Convert To Non-Complex CCM"),I.Wb(),I.Wb())}function _t(e,t){if(1&e){var n=I.Yb();I.Xb(0,"div",10),I.ec("click",function(){return I.Lc(n),I.ic(2).convertCCMEpisode()}),I.Xb(1,"div",4),I.Sb(2,"app-icons",11),I.Wb(),I.Xc(3," \xa0 "),I.Vc(4,Ot,3,0,"strong",12),I.Vc(5,It,3,0,"strong",12),I.Xc(6," \xa0 "),I.Sb(7,"app-icons",8),I.Wb()}if(2&e){var i=I.ic(2);I.Db(2),I.rc("originalStyle",!0),I.Db(2),I.rc("ngIf",!(null==i.episodeDetails||!i.episodeDetails.serviceCodes[99490])),I.Db(1),I.rc("ngIf",!(null==i.episodeDetails||!i.episodeDetails.serviceCodes[99487]))}}var Tt=function(){return[32,32]},Xt=function(e){return{disabled:e}};function yt(e,t){if(1&e){var n=I.Yb();I.Xb(0,"div",1),I.Xb(1,"h4"),I.Xc(2,"Other actions"),I.Wb(),I.Xb(3,"div",2),I.Xb(4,"div",3),I.ec("click",function(){return I.Lc(n),I.ic().showEpisodeSuspender()}),I.Xb(5,"div",4),I.Sb(6,"app-icons",5),I.Wb(),I.Xc(7," \xa0 "),I.Xb(8,"strong",6),I.Xb(9,"label",7),I.Xc(10),I.jc(11,"translate"),I.Wb(),I.Wb(),I.Xc(12," \xa0 "),I.Sb(13,"app-icons",8),I.Wb(),I.Vc(14,_t,8,3,"div",9),I.Wb(),I.Wb()}if(2&e){var i=I.ic();I.Db(3),I.rc("nzGutter",I.xc(8,Tt)),I.Db(1),I.rc("ngClass",I.yc(9,Xt,"SUSPENDED"===(null==i.episodeDetails?null:i.episodeDetails.status)||"COMPLETED"===(null==i.episodeDetails?null:i.episodeDetails.status))),I.Db(2),I.rc("originalStyle",!0),I.Db(3),I.rc("ngClass",I.yc(11,Xt,"SUSPENDED"===(null==i.episodeDetails?null:i.episodeDetails.status)||"COMPLETED"===(null==i.episodeDetails?null:i.episodeDetails.status))),I.Db(1),I.Zc(" ",I.kc(11,6,"CONSENT.SUSPEND_EPISODE")," "),I.Db(4),I.rc("ngIf","CCM"===(null==i.episodeDetails?null:i.episodeDetails.type)&&"IN_PROGRESS"===(null==i.episodeDetails?null:i.episodeDetails.status))}}var Nt,zt,Mt=function(){return["SUSPEND_EPISODE"]},At=((Nt=function(){function e(t,n,i,a){c(this,e),this._episodeModalService=t,this._episodesService=n,this._activatedRoute=i,this._notificationsService=a,this.refreshEpisode=new I.n}return u(e,[{key:"showEpisodeSuspender",value:function(){var e=this,t=this._activatedRoute.snapshot.paramMap.get("episodeId");this._episodeModalService.createSuspendModal(t).afterClose.subscribe(function(t){t&&e.refreshEpisodeState()})}},{key:"convertCCMEpisode",value:function(){var e,t=this;this._episodesService.switchCCMEpisodeComplexity(null===(e=this.episodeDetails)||void 0===e?void 0:e.id).subscribe(function(){t._notificationsService.success("CCM Episode","CCM episode complexity switched!"),t.refreshEpisodeState()})}},{key:"refreshEpisodeState",value:function(){this.refreshEpisode.emit(!0)}}]),e}()).\u0275fac=function(e){return new(e||Nt)(I.Rb(St.a),I.Rb(C.a),I.Rb(_.a),I.Rb(T.b))},Nt.\u0275cmp=I.Lb({type:Nt,selectors:[["app-episode-quick-actions"]],inputs:{episodeDetails:"episodeDetails"},outputs:{refreshEpisode:"refreshEpisode"},decls:1,vars:2,consts:[["class","container",4,"isFeaturePermitted"],[1,"container"],["nz-row","",3,"nzGutter"],["nz-col","","nzXs","24","nzSm","12","nzMd","8",3,"ngClass","click"],[1,"profile-icon"],["name","profileDelete","size","23px",3,"originalStyle"],["nz-typography","","nzType","danger"],["actionable","","nz-typography","","nzType","danger",3,"ngClass"],["name","arrowRight"],["nz-col","","nzXs","24","nzSm","12","nzMd","8",3,"click",4,"ngIf"],["nz-col","","nzXs","24","nzSm","12","nzMd","8",3,"click"],["name","profileEdit","size","23px",3,"originalStyle"],["nz-typography","",4,"ngIf"],["nz-typography",""],["actionable","","nz-typography",""]],template:function(e,t){1&e&&I.Vc(0,yt,15,13,"div",0),2&e&&I.rc("isFeaturePermitted",I.xc(1,Mt))},directives:[Et.a,N.c,N.a,r.o,ve.a,P.a,nt.a,r.q],pipes:[se.a],styles:["*[_ngcontent-%COMP%]{font-size:12px}.container[_ngcontent-%COMP%]{width:100%;height:150px;background:var(--neutral-color) 0 0 no-repeat padding-box;border:1px solid var(--grey)}h4[_ngcontent-%COMP%]{padding:8px 8px 0;font-weight:700;margin-bottom:25px}[_nghost-%COMP%]     .ant-col-6{cursor:pointer}.profile-icon[_ngcontent-%COMP%]{padding:8px;background-color:#e9e9e9;border-radius:50%;height:40px;width:40px;text-align:center;display:inline-block}strong[_ngcontent-%COMP%]{line-height:32px}app-icons[_ngcontent-%COMP%], strong[_ngcontent-%COMP%]{vertical-align:text-bottom;display:inline-block;height:70%}app-icons[_ngcontent-%COMP%]{line-height:40px}.profile-icon[_ngcontent-%COMP%]   app-icons[_ngcontent-%COMP%]{vertical-align:unset}.disabled[_ngcontent-%COMP%]{color:grey;pointer-events:none}@media screen and (orientation:portrait){.container[_ngcontent-%COMP%]{height:-moz-fit-content;height:fit-content;height:-webkit-fit-content}}"]}),Nt),Pt=o("AytR"),Wt=function e(){c(this,e)},Rt=o("7Xlp"),kt=o("OzZK"),wt=o("RwU8"),Lt=o("jhN1"),xt=((zt=function(){function e(t){c(this,e),this._sanitizer=t}return u(e,[{key:"transform",value:function(e){return this._sanitizer.bypassSecurityTrustHtml(e)}}]),e}()).\u0275fac=function(e){return new(e||zt)(I.Rb(Lt.b))},zt.\u0275pipe=I.Qb({name:"sanitizeHtml",type:zt,pure:!0}),zt);function Vt(e,t){1&e&&(I.Vb(0),I.Xb(1,"div",1),I.Sb(2,"nz-spin",2),I.Wb(),I.Ub())}function Ut(e,t){if(1&e){var n=I.Yb();I.Xb(0,"button",9),I.ec("click",function(){return I.Lc(n),I.ic(2).consentSubmit("DENY")}),I.Xc(1),I.jc(2,"translate"),I.Wb()}2&e&&(I.Db(1),I.Zc(" ",I.kc(2,1,"CONSENT.DENY_CONSENT")," "))}function Ft(e,t){1&e&&(I.Vb(0),I.Xc(1),I.jc(2,"translate"),I.Ub()),2&e&&(I.Db(1),I.Zc(" ",I.kc(2,1,"CONSENT.ISSUE_ORDER")," "))}function jt(e,t){1&e&&(I.Vb(0),I.Xc(1),I.jc(2,"translate"),I.Ub()),2&e&&(I.Db(1),I.Zc(" ",I.kc(2,1,"CONSENT.SUBMIT_CONSENT")," "))}function Yt(e,t){if(1&e){var n=I.Yb();I.Vb(0),I.Sb(1,"div",3),I.jc(2,"sanitizeHtml"),I.Xb(3,"div",4),I.Xb(4,"div",5),I.Vc(5,Ut,3,3,"button",6),I.Wb(),I.Xb(6,"div",7),I.Xb(7,"button",8),I.ec("click",function(){return I.Lc(n),I.ic().consentSubmit("AGREE")}),I.Vc(8,Ft,3,3,"ng-container",0),I.Vc(9,jt,3,3,"ng-container",0),I.Wb(),I.Wb(),I.Wb(),I.Ub()}if(2&e){var i=I.ic();I.Db(1),I.rc("innerHTML",I.kc(2,4,i.consentForm),I.Mc),I.Db(4),I.rc("ngIf","DOCTORS_ORDER"!==i.consent),I.Db(3),I.rc("ngIf","DOCTORS_ORDER"===i.consent),I.Db(1),I.rc("ngIf","DOCTORS_ORDER"!==i.consent)}}var Gt,Bt,Ht=((Bt=function(){function e(t,n){c(this,e),this._episodesService=t,this._modalRef=n,this.rootURL=Pt.g.url}return u(e,[{key:"ngOnInit",value:function(){var e=this;this.loading=!0,"DOCTORS_ORDER"==this.consent?this._episodesService.getDigitalDoctorsOrder(this.patientId,this.episodeId,"DIGITAL_CONSENT").subscribe(function(t){e.loading=!1,e.consentForm=t},function(t){if(t.error){var n=JSON.parse(t.error);e.loading=!1,e._modalRef.close(n.type)}}):this._episodesService.getDigitalConsent(this.patientId,this.episodeType,"DIGITAL_CONSENT").subscribe(function(t){e.loading=!1,e.consentForm=t})}},{key:"consentSubmit",value:function(e){this._modalRef.close(e)}}]),e}()).\u0275fac=function(e){return new(e||Bt)(I.Rb(C.a),I.Rb(He.e))},Bt.\u0275cmp=I.Lb({type:Bt,selectors:[["app-consent-form-sign-popup"]],inputs:{patientId:"patientId",episodeType:"episodeType",episodeId:"episodeId",consent:"consent"},decls:2,vars:2,consts:[[4,"ngIf"],[1,"spin-container"],["nzSimple",""],[1,"table-responsive",3,"innerHTML"],["nz-row",""],["nz-col","","nzSpan","8"],["nz-button","","nzType","default","nzDanger","",3,"click",4,"ngIf"],["nz-col","","nzSpan","8","nzOffset","8",2,"text-align","right"],["nz-button","","nzType","primary",3,"click"],["nz-button","","nzType","default","nzDanger","",3,"click"]],template:function(e,t){1&e&&(I.Vc(0,Vt,3,0,"ng-container",0),I.Vc(1,Yt,10,6,"ng-container",0)),2&e&&(I.rc("ngIf",t.loading),I.Db(1),I.rc("ngIf",!t.loading))},directives:[r.q,fe.a,N.c,N.a,kt.a,wt.a,L.a],pipes:[xt,se.a],styles:[".spin-container[_ngcontent-%COMP%]{text-align:center;border-radius:4px;padding:30px 50px;margin:20px 0;height:400px}"]}),Bt),Zt=((Gt=function(){function e(t){c(this,e),this._notificationsService=t}return u(e,[{key:"handle",value:function(e,t){switch(e){case"CARETAKER_NOT_ASSIGNED":this._notificationsService.error(t.get("PHYSICIAN_ORDER"),t.get("DOCTORS_ORDER.NO_CLINICIANS_ASSIGNED"));break;case"DST_NOT_ASSIGNED":this._notificationsService.error(t.get("PHYSICIAN_ORDER"),t.get("DOCTORS_ORDER.DST_NOT_ASSIGNED_MESSAGE"));break;case"MR_NUMBER_NOT_ADDED":this._notificationsService.error(t.get("PHYSICIAN_ORDER"),t.get("DOCTORS_ORDER.MR_NUMBER_NOT_ASSIGNED_MESSAGE"));break;case"INVALID_ADDRESS_ADDED":this._notificationsService.error(t.get("PHYSICIAN_ORDER"),t.get("DOCTORS_ORDER.INVALID_ADDRESS_NOT_ASSIGNED_MESSAGE"));break;case"DST_NOT_COMPLETED":this._notificationsService.error(t.get("PHYSICIAN_ORDER"),t.get("DOCTORS_ORDER.DST_NOT_COMPLETED_MESSAGE"));break;case"INVALID_PATIENT_PHONE_NUMBER":this._notificationsService.error(t.get("PHYSICIAN_ORDER"),t.get("DOCTORS_ORDER.INVALID_PATIENT_PHONE_NUMBER_MESSAGE"))}}}]),e}()).\u0275fac=function(e){return new(e||Gt)(I.bc(T.b))},Gt.\u0275prov=I.Nb({token:Gt,factory:Gt.\u0275fac,providedIn:"root"}),Gt),qt=function(e){return e.MANUAL_ORDER="MANUAL_ORDER",e.DIGITAL_ORDER="DIGITAL_ORDER",e}({}),$t=o("D9mS");function Kt(e,t){if(1&e){var n=I.Yb();I.Xb(0,"div",6),I.Xb(1,"p"),I.Xc(2),I.jc(3,"translate"),I.Wb(),I.Xb(4,"button",7),I.ec("click",function(){return I.Lc(n),I.ic(2).getDigitalDoctorsOrder()}),I.Xc(5),I.jc(6,"translate"),I.Wb(),I.Wb()}if(2&e){var i=I.ic(2);I.Db(2),I.Zc(" ",I.kc(3,3,"CONSENT.DIGITAL_SIGNATURE_MESSAGE")," "),I.Db(2),I.rc("disabled","SCHEDULED"!==(null==i.episodeDetails?null:i.episodeDetails.status)&&"IN_PROGRESS"!==(null==i.episodeDetails?null:i.episodeDetails.status)),I.Db(1),I.Yc(I.kc(6,5,"COMMON.NEXT"))}}function Qt(e,t){if(1&e&&(I.Xb(0,"div",6),I.Xb(1,"p"),I.Xc(2),I.jc(3,"translate"),I.Wb(),I.Xb(4,"nz-upload",8),I.Xb(5,"button",9),I.Xc(6),I.jc(7,"translate"),I.Wb(),I.Wb(),I.Wb()),2&e){var n=I.ic(2);I.Db(2),I.Yc(I.kc(3,5,"CONSENT.PHYSICIAN_ORDER_MANUAL_UPLOAD_DESCRIPTION")),I.Db(2),I.rc("nzCustomRequest",n.handleUpload)("nzShowUploadList",!1),I.Db(1),I.rc("disabled","SCHEDULED"!==(null==n.episodeDetails?null:n.episodeDetails.status)&&"IN_PROGRESS"!==(null==n.episodeDetails?null:n.episodeDetails.status)),I.Db(1),I.Yc(I.kc(7,7,"COMMON.UPLOAD"))}}function Jt(e,t){if(1&e){var n=I.Yb();I.Vb(0),I.Xb(1,"p"),I.Xc(2),I.jc(3,"translate"),I.Wb(),I.Xb(4,"nz-radio-group",2),I.ec("ngModelChange",function(e){return I.Lc(n),I.ic().physicianOrderType=e}),I.Xb(5,"label",3),I.Xc(6),I.jc(7,"translate"),I.Wb(),I.Xb(8,"label",4),I.Xc(9),I.jc(10,"translate"),I.Wb(),I.Wb(),I.Vc(11,Kt,7,7,"div",5),I.Vc(12,Qt,8,9,"div",5),I.Ub()}if(2&e){var i=I.ic();I.Db(2),I.Zc(" ",I.kc(3,7,"CONSENT.PHYSICIAN_ORDER_DESCRIPTION")," "),I.Db(2),I.rc("ngModel",i.physicianOrderType)("nzDisabled",i.fileList&&(null==i.fileList?null:i.fileList.length)>0||"SCHEDULED"!==(null==i.episodeDetails?null:i.episodeDetails.status)&&"IN_PROGRESS"!==(null==i.episodeDetails?null:i.episodeDetails.status)),I.Db(2),I.Zc(" ",I.kc(7,9,"CONSENT.VIA_DIGITAL_SIGNATURE")," "),I.Db(3),I.Zc(" ",I.kc(10,11,"CONSENT.BY_UPLOADING_SIGNED_PHYSICIAN_ORDER")," "),I.Db(2),I.rc("ngIf","DIGITAL_ORDER"===i.physicianOrderType&&0===(null==i.fileList?null:i.fileList.length)),I.Db(1),I.rc("ngIf","MANUAL_ORDER"===i.physicianOrderType)}}function en(e,t){if(1&e){var n=I.Yb();I.Vb(0),I.Sb(1,"br"),I.Xb(2,"div",10),I.Xb(3,"div",11),I.Xb(4,"h4",12),I.Xc(5,"Physician order obtained"),I.Wb(),I.Xb(6,"label"),I.Xc(7),I.jc(8,"date"),I.Wb(),I.Wb(),I.Xb(9,"div",11),I.Xb(10,"div",13),I.Xb(11,"label"),I.Xc(12,"Physician order"),I.Wb(),I.Xb(13,"p",14),I.ec("click",function(){I.Lc(n);var e=I.ic();return e.view(null==e.episodeDetails||null==e.episodeDetails.physicianOrders[0]?null:e.episodeDetails.physicianOrders[0].orderURL)}),I.Sb(14,"app-icons",15),I.Xc(15),I.jc(16,"translate"),I.Wb(),I.Wb(),I.Wb(),I.Wb(),I.Ub()}if(2&e){var i=I.ic();I.Db(7),I.Zc("on ",I.lc(8,3,null==i.episodeDetails||null==i.episodeDetails.physicianOrders[0]?null:i.episodeDetails.physicianOrders[0].uploadedOn,"mediumDate"),""),I.Db(7),I.rc("altColorScheme",!0),I.Db(1),I.Zc(" ",I.kc(16,6,"CONSENT.VIEW")," ")}}var tn,nn,an,on,sn=((tn=function(){function n(e,t,i,a,o,s,l){var r=this;c(this,n),this._notificationsService=e,this._episodesService=t,this._modalService=i,this._episodesEventLogger=a,this._applicationInsightsService=o,this._translationService=s,this.consentFormErrorHandler=l,this.fileList=[],this.rootUrl=Pt.g.url,this.strings=["EPISODE","PHYSICIAN_ORDER","CONSENT.UNABLE_TO_UPLOAD_FILE","PHYSICIAN_ORDER.ADDED_TO_EPISODE","PHYSICIAN_ORDER.REMOVED_SUCCESSFULLY","PHYSICIAN_ORDER.DELETE_CONSENT_TITLE","SELECT_CLINICIAN_B4_PROCEEDING","DOCTORS_ORDER.DST_NOT_ASSIGNED_MESSAGE","DOCTORS_ORDER.INVALID_ADDRESS_NOT_ASSIGNED_MESSAGE","DOCTORS_ORDER.MR_NUMBER_NOT_ASSIGNED_MESSAGE","DOCTORS_ORDER.DST_NOT_COMPLETED_MESSAGE","DOCTORS_ORDER.INVALID_PATIENT_PHONE_NUMBER_MESSAGE"],this.consentChanged=new I.n,this.handleUpload=function(e){r.loading=!0,r._episodesEventLogger.pictureUploadEvent("upload_physician_order"),r._episodesService.uploadConsent(e.file.name,e.file,r.patientId,"PHYSICIAN_ORDER").subscribe(function(e){r.addPhysicianOrderFileToEpisode(e.filename)},function(){r._notificationsService.error(r.translatedStrings.get("EPISODE"),r.translatedStrings.get("CONSENT.UNABLE_TO_UPLOAD_FILE"))},function(){r.loading=!1})}}return u(n,[{key:"episode",set:function(e){this.episodeDetails=e,this.patientId=this.episodeDetails.patientId,this.episodeId=this.episodeDetails.id,this.episodeType=this.episodeDetails.type,this.episodeEndDate=this.episodeDetails.endDate,this.setPhysicianOrders(e.physicianOrders)}},{key:"ngOnInit",value:function(){var e,n=this;this.$translationSubscription=(e=this._translationService).getMultiple.apply(e,t(this.strings)).subscribe(function(e){return n.translatedStrings=e})}},{key:"setPhysicianOrders",value:function(e){var t,n=this;this.fileList=[],e&&(this.physicianOrderType=(null===(t=e.find(function(e){return qt.DIGITAL_ORDER==e.physicianOrderType}))||void 0===t?void 0:t.physicianOrderType)||qt.MANUAL_ORDER,e.forEach(function(e){var t=n.getPhysicianOrderObject(e);n.fileList.push(t)}))}},{key:"getPhysicianOrderObject",value:function(e){if(e){var t=e.orderURL,n=t.substring(t.lastIndexOf(":")+1,t.length);return t.startsWith("http")&&(n=t.split(":")[2]),{url:t,uid:"_"+Math.random().toString(36).substr(2,9),status:"done",name:n,dateOfSubmission:e.uploadedOn,episodeType:""}}}},{key:"view",value:function(e){var t;this._episodesEventLogger.episodeActionEvent(this.episodeId,this.patientId,"download_physicianOrder"),t=e.startsWith("http")?"filename=".concat(e.substring(e.lastIndexOf("/")+1,e.length)):"filename=".concat(e,"&asset-type=PHYSICIAN_ORDER");var n="".concat(this.rootUrl,"/v1/assets/view?").concat(t);this._applicationInsightsService.downloadSuccessReportEvent(this.patientId,n,"patients_consent","patients_consent"),window.open(n,"_blank")}},{key:"addPhysicianOrderFileToEpisode",value:function(t){var n=this,i=new Wt;i.orderURL=t,i.uploadedOn=Date.now(),this._episodesService.addPhysicianOrderToPatientAndEpisode(this.episodeId,i).subscribe(function(t){if(t){n.fileList=[];var i,a=e(t.physicianOrders);try{for(a.s();!(i=a.n()).done;){var o=i.value;n.fileList.push(n.getPhysicianOrderObject(o))}}catch(s){a.e(s)}finally{a.f()}n._notificationsService.success(n.translatedStrings.get("PHYSICIAN_ORDER"),n.translatedStrings.get("PHYSICIAN_ORDER.ADDED_TO_EPISODE")),n.consentChanged.emit()}})}},{key:"deleteConsentFileToEpisode",value:function(e){var t=this;this._modalService.confirm({nzTitle:this.translatedStrings.get("PHYSICIAN_ORDER.DELETE_CONSENT_TITLE"),nzOnOk:function(){var n={consentFile:e,assignerId:localStorage.getItem("loggedInUser")};t._episodesService.deleteEpisodeConsent(t.episodeId,n).subscribe(function(){t.fileList=t.fileList.filter(function(t){return t.url!==e}),t._notificationsService.success(t.translatedStrings.get("PHYSICIAN_ORDER"),t.translatedStrings.get("PHYSICIAN_ORDER.REMOVED_SUCCESSFULLY")),t.consentChanged.emit()})}})}},{key:"getDigitalDoctorsOrder",value:function(){var e=this;this._modalService.create({nzContent:Ht,nzComponentParams:{patientId:this.patientId,episodeType:this.episodeType,consent:"DOCTORS_ORDER",episodeId:this.episodeId},nzFooter:null,nzWidth:1e3,nzClosable:!0,nzMaskClosable:!1}).afterClose.subscribe(function(t){"AGREE"==t&&e.acceptConsent(),e.consentFormErrorHandler.handle(t,e.translatedStrings)})}},{key:"acceptConsent",value:function(){var e=this;this._episodesService.submitDoctorsOrder({consentType:"DIGITAL_CONSENT",episodeId:this.episodeId,patientId:this.patientId}).subscribe(function(t){e._episodesEventLogger.episodeConsentActionEvent(e.episodeId,e.patientId,"doctors_order_accepted","DIGITAL_CONSENT"),e.consentChanged.emit(),e._notificationsService.create("success",e.translatedStrings.get("PHYSICIAN_ORDER"),e.translatedStrings.get("PHYSICIAN_ORDER.ADDED_TO_EPISODE"))})}}]),n}()).\u0275fac=function(e){return new(e||tn)(I.Rb(T.b),I.Rb(C.a),I.Rb(He.f),I.Rb(Ye.a),I.Rb(Rt.a),I.Rb(J.a),I.Rb(Zt))},tn.\u0275cmp=I.Lb({type:tn,selectors:[["app-consent-forms"]],inputs:{episode:["episodeDetails","episode"]},outputs:{consentChanged:"consentChanged"},decls:7,vars:5,consts:[["nz-typography",""],[4,"ngIf"],[3,"ngModel","nzDisabled","ngModelChange"],["nz-radio","","nzValue","DIGITAL_ORDER"],["nz-radio","","nzValue","MANUAL_ORDER"],["class","order-actions-div",4,"ngIf"],[1,"order-actions-div"],["nz-button","","nzType","primary",1,"upload-btn",3,"disabled","click"],[3,"nzCustomRequest","nzShowUploadList"],["nz-button","","nzType","primary",1,"upload-btn",3,"disabled"],["nz-row","","nzGutter","32"],["nz-col","","nzXs","24","nzSm","12","nzMd","6"],["nz-typography","","nzType","success"],[1,"order-container"],["actionable","","nz-typography","","nzType","success",3,"click"],["size","14px","name","view",3,"altColorScheme"]],template:function(e,t){1&e&&(I.Xb(0,"nz-card"),I.Xb(1,"h3",0),I.Xc(2),I.jc(3,"translate"),I.Wb(),I.Vc(4,Jt,13,13,"ng-container",1),I.Vc(5,en,17,8,"ng-container",1),I.Wb(),I.Sb(6,"br")),2&e&&(I.Db(2),I.Yc(I.kc(3,3,"PHYSICIAN_ORDER")),I.Db(2),I.rc("ngIf",!(null!=t.episodeDetails&&null!=t.episodeDetails.physicianOrders&&t.episodeDetails.physicianOrders.length)),I.Db(1),I.rc("ngIf",null==t.episodeDetails||null==t.episodeDetails.physicianOrders?null:t.episodeDetails.physicianOrders.length))},directives:[z.a,P.a,r.q,k.c,v.u,v.x,k.b,kt.a,wt.a,L.a,$t.a,N.c,N.a,nt.a,ve.a],pipes:[se.a,r.e],styles:["nz-card[_ngcontent-%COMP%]{padding:10px;text-align:left}h3[_ngcontent-%COMP%]{margin-bottom:0}.text-center[_ngcontent-%COMP%]{text-align:center}.action-buttons[_ngcontent-%COMP%]{width:200px}.consent-action[_ngcontent-%COMP%]{color:#5bbd71;border-color:#5bbd71}[nz-radio][_ngcontent-%COMP%]{font-weight:700;margin-right:100px}button[_ngcontent-%COMP%]{min-width:160px;min-height:40px;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content}p[_ngcontent-%COMP%]:first-of-type{margin-top:20px;margin-bottom:20px}.upload-btn[_ngcontent-%COMP%]{display:block}.order-actions-div[_ngcontent-%COMP%]{margin:20px 0 10px}.order-container[_ngcontent-%COMP%]{width:100%;border-radius:10px;border:1px solid #dcdcdc;padding:30px 15px 15px!important}.order-container[_ngcontent-%COMP%]:hover{box-shadow:0 3px 6px #00000029;border:1px solid #8bc34a}.order-container[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600}.order-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 1em}app-icons[_ngcontent-%COMP%]{vertical-align:text-top}"]}),tn),ln=o("W4mZ"),rn=((an=function(){function e(t){c(this,e),this.scriptService=t}return u(e,[{key:"ngOnInit",value:function(){this.scriptService.setShowConsentScriptObservable(!0)}},{key:"ngOnDestroy",value:function(){this.scriptService.setShowConsentScriptObservable(!1)}}]),e}()).\u0275fac=function(e){return new(e||an)(I.Rb(ln.a))},an.\u0275cmp=I.Lb({type:an,selectors:[["app-consent-script"]],inputs:{htmlContent:"htmlContent"},decls:1,vars:1,consts:[[3,"innerHTML"]],template:function(e,t){1&e&&I.Sb(0,"div",0),2&e&&I.rc("innerHTML",t.htmlContent,I.Mc)},styles:[""]}),an),cn=((nn=function(){function e(t){c(this,e),this._modalRef=t,this.dontShowAgain=!1}return u(e,[{key:"initiateCall",value:function(){this.close({hidePopup:this.dontShowAgain,continueToCall:!0})}},{key:"close",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{hidePopup:!1,continueToCall:!1};this._modalRef.destroy(e)}}]),e}()).\u0275fac=function(e){return new(e||nn)(I.Rb(He.e))},nn.\u0275cmp=I.Lb({type:nn,selectors:[["app-audio-call-info-popup"]],decls:29,vars:22,consts:[["nz-typography",""],[2,"color","var(--primary-color)"],["xmlns","http://www.w3.org/2000/svg","height","10","viewBox","0 0 30.378 38.004"],["d","M-150.765,233.958h0a.3.3,0,0,0-.117-.234.057.057,0,0,0-.059-.059c-.059-.059-.117-.176-.176-.234h0l-8.606-8.255h0c-.059-.059-.117-.117-.176-.117h-.059a.352.352,0,0,0-.234-.059h-15.983a4.635,4.635,0,0,0-4.625,4.625v28.454a4.635,4.635,0,0,0,4.625,4.625h20.726a4.635,4.635,0,0,0,4.625-4.625v-23.77C-150.707,234.133-150.707,234.016-150.765,233.958Zm-8.548-5.621,5.035,4.8h-2.459a2.6,2.6,0,0,1-2.576-2.576Zm3.981,32.2h-20.726a2.6,2.6,0,0,1-2.576-2.576V229.508a2.6,2.6,0,0,1,2.576-2.576h14.7v3.688a4.635,4.635,0,0,0,4.625,4.625h3.981v22.775A2.588,2.588,0,0,1-155.332,260.538ZM-157.5,246.37a.987.987,0,0,1-1,1H-172.72a1.039,1.039,0,0,1-1.054-1,1,1,0,0,1,1.054-1h14.227A1.026,1.026,0,0,1-157.5,246.37Zm-16.393-6.323a.987.987,0,0,1,1-1h14.227a.987.987,0,0,1,1,1,1.026,1.026,0,0,1-1,1H-172.9A1.026,1.026,0,0,1-173.891,240.047Zm16.393,12.7a.987.987,0,0,1-1,1H-172.72a1.039,1.039,0,0,1-1.054-1,1,1,0,0,1,1.054-1h14.227A.987.987,0,0,1-157.5,252.751Z","transform","translate(180.95 -224.85)",1,"a"],["nz-checkbox","",3,"ngModel","ngModelChange"],["nz-button","","nzType","primary",3,"click"]],template:function(e,t){1&e&&(I.Xb(0,"h2",0),I.Xc(1,"Note"),I.Wb(),I.Xb(2,"p"),I.Xc(3),I.jc(4,"translate"),I.Wb(),I.Xb(5,"p"),I.Xc(6),I.jc(7,"translate"),I.Wb(),I.Xb(8,"p"),I.Xc(9),I.jc(10,"translate"),I.Wb(),I.Xb(11,"p"),I.Xc(12),I.jc(13,"translate"),I.Xb(14,"i",1),I.hc(),I.Xb(15,"svg",2),I.Xb(16,"style"),I.Xc(17," .a { fill: var(--primary-color); stroke: var(--primary-color); stroke-width: 0.3px; } "),I.Wb(),I.Sb(18,"defs"),I.Sb(19,"path",3),I.Wb(),I.Wb(),I.Xc(20),I.jc(21,"translate"),I.Wb(),I.gc(),I.Xb(22,"div"),I.Xb(23,"label",4),I.ec("ngModelChange",function(e){return t.dontShowAgain=e}),I.Xc(24),I.jc(25,"translate"),I.Wb(),I.Xb(26,"button",5),I.ec("click",function(){return t.initiateCall()}),I.Xc(27),I.jc(28,"translate"),I.Wb(),I.Wb()),2&e&&(I.Db(3),I.Yc(I.kc(4,8,"CONSENT.AUDIO_CALL_INFO_LINE1")),I.Db(3),I.Yc(I.kc(7,10,"CONSENT.AUDIO_CALL_INFO_LINE2")),I.Db(3),I.Yc(I.kc(10,12,"CONSENT.AUDIO_CALL_INFO_LINE3")),I.Db(3),I.Zc("",I.kc(13,14,"CONSENT.AUDIO_CALL_INFO_LINE4_PREICON")," "),I.Db(8),I.Zc(" ",I.kc(21,16,"CONSENT.AUDIO_CALL_INFO_LINE4_POSTICON"),"\n"),I.Db(3),I.rc("ngModel",t.dontShowAgain),I.Db(1),I.Yc(I.kc(25,18,"CONSENT.DONT_SHOW_AGAIN")),I.Db(3),I.Zc(" ",I.kc(28,20,"CONSENT.PROCEED_TO_CALL")," "))},directives:[P.a,Xe.a,v.u,v.x,kt.a,wt.a,L.a],pipes:[se.a],styles:["div[_ngcontent-%COMP%]{margin-top:50px;display:flex;flex-direction:row;justify-content:space-between}"]}),nn),dn=o("Lrxu"),un=((on=function(){function e(t){c(this,e),this._dialog=t}return u(e,[{key:"ngOnInit",value:function(){}},{key:"denied",value:function(){this._dialog.close(dn.b.DENIED)}},{key:"obtained",value:function(){this._dialog.close(dn.b.OBTAINED)}},{key:"other",value:function(){this._dialog.close(dn.b.IN_PROGRESS)}}]),e}()).\u0275fac=function(e){return new(e||on)(I.Rb(He.e))},on.\u0275cmp=I.Lb({type:on,selectors:[["app-consent-status-popup"]],inputs:{episodeType:"episodeType"},decls:14,vars:15,consts:[["nz-button","","nzSize","default","nzType","default","nzDanger","",3,"click"],["nz-button","","nzSize","default","nzType","primary",3,"click"],["id","other-button","nz-button","","nzSize","default","nzType","default",3,"click"]],template:function(e,t){1&e&&(I.Xb(0,"h3"),I.Xc(1),I.jc(2,"translate"),I.jc(3,"episodeName"),I.Wb(),I.Xb(4,"div"),I.Xb(5,"button",0),I.ec("click",function(){return t.denied()}),I.Xc(6),I.jc(7,"translate"),I.Wb(),I.Xb(8,"button",1),I.ec("click",function(){return t.obtained()}),I.Xc(9),I.jc(10,"translate"),I.Wb(),I.Xb(11,"button",2),I.ec("click",function(){return t.other()}),I.Xc(12),I.jc(13,"translate"),I.Wb(),I.Wb()),2&e&&(I.Db(1),I.ad("",I.kc(2,5,"CONSENT.DID_PATIENT_AGREE")," ",I.kc(3,7,t.episodeType)," episode? "),I.Db(5),I.Zc(" ",I.kc(7,9,"CONSENT.CONSENT_DENIED")," "),I.Db(3),I.Zc(" ",I.kc(10,11,"CONSENT.CONSENT_OBTAINED")," "),I.Db(3),I.Zc(" ",I.kc(13,13,"CONSENT.CONSENT_OTHER")," "))},directives:[kt.a,wt.a,L.a],pipes:[se.a,Ke.a],styles:["div[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,29%);grid-column-gap:4%;margin-top:15px}button[_ngcontent-%COMP%]{border-width:2px;border-radius:7px;border-style:solid;font-size:13px;font-weight:600;padding:2px}h3[_ngcontent-%COMP%]{font-weight:700}#other-button[_ngcontent-%COMP%]{color:var(--primary-color);border-color:var(--primary-color)}"]}),on),bn=o("Gskk"),pn=o("KZd8"),fn=o("BZRL"),vn=function e(){c(this,e)},hn=o("t6gT");function gn(e,t){if(1&e&&(I.Xb(0,"label",6),I.Xc(1),I.Wb()),2&e){var n=I.ic().$implicit;I.rc("ngModel",!0),I.Db(1),I.Yc(n)}}function mn(e,t){if(1&e&&(I.Vb(0),I.Vc(1,gn,2,2,"label",5),I.Ub()),2&e){var n=t.$implicit;I.Db(1),I.rc("ngIf",n)}}var Cn=function(){return{minRows:5,maxRows:5}};function Dn(e,t){if(1&e){var n=I.Yb();I.Vb(0),I.Vc(1,mn,2,1,"ng-container",3),I.Xb(2,"textarea",4),I.ec("ngModelChange",function(e){return I.Lc(n),I.ic().consentDeniedReasons.additionalReason=e}),I.Wb(),I.Ub()}if(2&e){var i=I.ic();I.Db(1),I.rc("ngForOf",i.consentDeniedReasons.checkboxReasons),I.Db(1),I.rc("disabled",!0)("nzAutosize",I.xc(4,Cn))("ngModel",i.consentDeniedReasons.additionalReason)}}var Sn,En=((Sn=function(){function e(t,n){c(this,e),this._patientsService=t,this._modalRef=n}return u(e,[{key:"ngOnInit",value:function(){var e=this;this._patientsService.fetchVitalNote(this.noteId).subscribe(function(t){e.populateConsentDeniedReasons(t.content)})}},{key:"populateConsentDeniedReasons",value:function(e){this.consentDeniedReasons={checkBoxReasons:[],additionalReason:""};var t=e.split(";");this.consentDeniedReasons.checkboxReasons=t[0].split(","),this.consentDeniedReasons.additionalReason=t[1]}},{key:"close",value:function(){this._modalRef.close()}}]),e}()).\u0275fac=function(e){return new(e||Sn)(I.Rb(m.a),I.Rb(He.e))},Sn.\u0275cmp=I.Lb({type:Sn,selectors:[["app-view-consent-denied-details"]],inputs:{noteId:"noteId"},decls:7,vars:7,consts:[["nz-typography",""],[4,"ngIf"],["nz-button","","nzType","primary","nzSize","large",3,"click"],[4,"ngFor","ngForOf"],["nz-input","",3,"disabled","nzAutosize","ngModel","ngModelChange"],["nz-checkbox","","nzDisabled","",3,"ngModel",4,"ngIf"],["nz-checkbox","","nzDisabled","",3,"ngModel"]],template:function(e,t){1&e&&(I.Xb(0,"h2",0),I.Xc(1),I.jc(2,"translate"),I.Wb(),I.Vc(3,Dn,3,5,"ng-container",1),I.Xb(4,"button",2),I.ec("click",function(){return t.close()}),I.Xc(5),I.jc(6,"translate"),I.Wb()),2&e&&(I.Db(1),I.Yc(I.kc(2,3,"CONSENT.CONSENT_DENIED_BECAUSE")),I.Db(2),I.rc("ngIf",t.consentDeniedReasons),I.Db(2),I.Zc(" ",I.kc(6,5,"COMMON.CLOSE")," "))},directives:[P.a,r.q,kt.a,wt.a,L.a,r.p,W.b,W.a,v.d,v.u,v.x,Xe.a],pipes:[se.a],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;justify-content:center;line-height:2;border-radius:20px;padding:20px;height:100%}label[_ngcontent-%COMP%] + label[_ngcontent-%COMP%]{margin-left:0}textarea[_ngcontent-%COMP%]{margin-top:20px;margin-bottom:30px;background-color:#f6f6f6}.ant-checkbox-wrapper-checked[_ngcontent-%COMP%]{font-weight:700}button[_ngcontent-%COMP%]{display:block;margin:4% auto 2%}[_ngcontent-%COMP%]::-webkit-input-placeholder{color:#949494;float:inline-start}"]}),Sn);function On(e,t){if(1&e&&(I.Xb(0,"h4"),I.Xc(1),I.Wb()),2&e){var n=I.ic().$implicit;I.Db(1),I.Yc(n)}}function In(e,t){if(1&e&&(I.Vb(0),I.Vc(1,On,2,1,"h4",4),I.Ub()),2&e){var n=t.$implicit;I.Db(1),I.rc("ngIf",n)}}function _n(e,t){if(1&e&&(I.Xb(0,"div"),I.Xc(1),I.jc(2,"date"),I.Vc(3,In,2,1,"ng-container",2),I.Xc(4),I.Sb(5,"br"),I.Wb()),2&e){var n=t.$implicit;I.Db(1),I.Zc(" ",I.lc(2,3,n.createdOn,"mediumDate")," "),I.Db(2),I.rc("ngForOf",n.checkboxReasons),I.Db(1),I.Zc(" ",n.additionalReason," ")}}var Tn,Xn,yn,Nn,zn,Mn=((Tn=function(){function t(e,n){c(this,t),this._patientsService=e,this._modalRef=n}return u(t,[{key:"ngOnInit",value:function(){var e=this;this._patientsService.fetchConsentNotesForPatient(this.patientId).subscribe(function(t){e.populateCallHistory(t)})}},{key:"populateCallHistory",value:function(t){this.callFailedReasonHistory=[];var n,i=e(t);try{for(i.s();!(n=i.n()).done;){var a=n.value,o={createdOn:a.createdOn,checkboxReasons:[],additionalReason:""},s=a.content.split(";");o.checkboxReasons=s[0].split(","),o.additionalReason=s[1],this.callFailedReasonHistory.push(o)}}catch(l){i.e(l)}finally{i.f()}}},{key:"close",value:function(){this._modalRef.close()}}]),t}()).\u0275fac=function(e){return new(e||Tn)(I.Rb(m.a),I.Rb(He.e))},Tn.\u0275cmp=I.Lb({type:Tn,selectors:[["app-view-consent-in-progress-details"]],inputs:{patientId:"patientId"},decls:8,vars:7,consts:[["nz-typography",""],[1,"call-history-container"],[4,"ngFor","ngForOf"],["nz-button","","nzType","primary","nzSize","large",3,"click"],[4,"ngIf"]],template:function(e,t){1&e&&(I.Xb(0,"h2",0),I.Xc(1),I.jc(2,"translate"),I.Wb(),I.Xb(3,"div",1),I.Vc(4,_n,6,6,"div",2),I.Wb(),I.Xb(5,"button",3),I.ec("click",function(){return t.close()}),I.Xc(6),I.jc(7,"translate"),I.Wb()),2&e&&(I.Db(1),I.Yc(I.kc(2,3,"CONSENT.CALL_HISTORY")),I.Db(3),I.rc("ngForOf",t.callFailedReasonHistory),I.Db(2),I.Zc(" ",I.kc(7,5,"COMMON.CLOSE"),"\n"))},directives:[P.a,r.p,kt.a,wt.a,L.a,r.q],pipes:[se.a,r.e],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;justify-content:center;line-height:2;border-radius:20px;padding:20px;height:100%}button[_ngcontent-%COMP%]{display:block;margin:4% auto 2%}.call-history-container[_ngcontent-%COMP%]{overflow-y:scroll;height:200px}.call-history-container[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{margin-bottom:5px}.call-history-container[_ngcontent-%COMP%] h4{margin-top:5px;line-height:1;font-weight:600}h4[_ngcontent-%COMP%]{margin-bottom:0}"]}),Tn),An=o("Z93s"),Pn=function(){return{minRows:5,maxRows:5}},Wn=((Xn=function(){function e(t,n,i){c(this,e),this._patientsService=t,this._modalRef=n,this.translationService=i,this.note=new An.a,this.strings=["CONSENT.PATIENT_WASNT_INTERESTED","CONSENT.PATIENT_SWITCHED_TO_ANOTHER_PROVIDER","CONSENT.CONSENT_OTHER"],this.otherReasons=""}return u(e,[{key:"ngOnInit",value:function(){this.initTranslationStrings()}},{key:"initTranslationStrings",value:function(){var e,n=this;this.$translationSubscription=(e=this.translationService).getMultiple.apply(e,t(this.strings)).subscribe(function(e){n.translatedStrings=e})}},{key:"saveNote",value:function(){this.note.type="CONSENT",this.note.userId=this.patientId,this.note.caretakerIds=new Array,this.note.content=(this.patientNotInterested?this.translatedStrings.get("CONSENT.PATIENT_WASNT_INTERESTED"):"")+(this.switchedProvider?","+this.translatedStrings.get("CONSENT.PATIENT_SWITCHED_TO_ANOTHER_PROVIDER"):"")+(this.othersCheckbox?","+this.translatedStrings.get("CONSENT.CONSENT_OTHER"):"")+";"+this.otherReasons,""!=this.note.content&&(null==localStorage.getItem("loggedInUser")?this.submitNoteWithId():this.submitNote())}},{key:"submitNote",value:function(){var e=this;this._patientsService.addNoteForPatient(this.note).subscribe(function(t){t.assignerId=localStorage.getItem("loggedInUser"),t.archived=!1,t.reason=e.note.content,e._modalRef.close(t)})}},{key:"submitNoteWithId",value:function(){var e=this;this._patientsService.addNoteForPatientWithId(this.patientId,this.note).subscribe(function(t){t.archived=!1,t.reason=e.note.content,e._modalRef.close(t)})}}]),e}()).\u0275fac=function(e){return new(e||Xn)(I.Rb(m.a),I.Rb(He.e),I.Rb(J.a))},Xn.\u0275cmp=I.Lb({type:Xn,selectors:[["app-add-consent-denied-details-feedback"]],inputs:{patientId:"patientId"},decls:17,vars:25,consts:[["nz-typography",""],["nz-checkbox","","nzValue","Patient wasn't interested",3,"ngModel","ngModelChange"],["nz-checkbox","","nzValue","The patient has switched to another provider",3,"ngModel","ngModelChange"],["nz-checkbox","","nzValue","Other",3,"ngModel","ngModelChange"],["nz-input","",3,"nzAutosize","placeholder","ngModel","ngModelChange"],["nz-button","","nzType","primary","nzSize","large",3,"disabled","click"]],template:function(e,t){1&e&&(I.Xb(0,"h2",0),I.Xc(1),I.jc(2,"translate"),I.Wb(),I.Xb(3,"label",1),I.ec("ngModelChange",function(e){return t.patientNotInterested=e}),I.Xc(4),I.jc(5,"translate"),I.Wb(),I.Xb(6,"label",2),I.ec("ngModelChange",function(e){return t.switchedProvider=e}),I.Xc(7),I.jc(8,"translate"),I.Wb(),I.Xb(9,"label",3),I.ec("ngModelChange",function(e){return t.othersCheckbox=e}),I.Xc(10),I.jc(11,"translate"),I.Wb(),I.Xb(12,"textarea",4),I.ec("ngModelChange",function(e){return t.otherReasons=e}),I.jc(13,"translate"),I.Wb(),I.Xb(14,"button",5),I.ec("click",function(){return t.saveNote()}),I.Xc(15),I.jc(16,"translate"),I.Wb()),2&e&&(I.Db(1),I.Zc("",I.kc(2,12,"CONSENT.CONSENT_NOT_OBTAINED_BECAUSE")," "),I.Db(2),I.rc("ngModel",t.patientNotInterested),I.Db(1),I.Yc(I.kc(5,14,"CONSENT.PATIENT_WASNT_INTERESTED")),I.Db(2),I.rc("ngModel",t.switchedProvider),I.Db(1),I.Yc(I.kc(8,16,"CONSENT.PATIENT_SWITCHED_TO_ANOTHER_PROVIDER")),I.Db(2),I.rc("ngModel",t.othersCheckbox),I.Db(1),I.Yc(I.kc(11,18,"CONSENT.CONSENT_OTHER")),I.Db(2),I.sc("placeholder",I.kc(13,20,"CONSENT.ADD_ADDITIONAL_NOTES")),I.rc("nzAutosize",I.xc(24,Pn))("ngModel",t.otherReasons),I.Db(2),I.rc("disabled",!(t.patientNotInterested||t.switchedProvider||t.othersCheckbox&&t.otherReasons)),I.Db(1),I.Yc(I.kc(16,22,"CONSENT.SUSPEND_EPISODE")))},directives:[P.a,Xe.a,v.u,v.x,W.b,W.a,v.d,kt.a,wt.a,L.a],pipes:[se.a],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;justify-content:center;line-height:2;border-radius:20px;padding:20px;height:100%}label[_ngcontent-%COMP%] + label[_ngcontent-%COMP%]{margin-left:0}textarea[_ngcontent-%COMP%]{margin-top:20px;margin-bottom:30px;background-color:#f6f6f6}.ant-checkbox-wrapper-checked[_ngcontent-%COMP%]{font-weight:700}button[_ngcontent-%COMP%]{display:block;margin:4% auto 2%}[_ngcontent-%COMP%]::-webkit-input-placeholder{color:#949494;float:inline-start}"]}),Xn),Rn=function(){return{minRows:5,maxRows:5}},kn=((yn=function(){function e(t,n,i){c(this,e),this._patientsService=t,this._modalRef=n,this.translationService=i,this.note=new An.a,this.otherReasons="",this.strings=["CONSENT.PATIENT_WAS_NOT_AVAILABLE","CONSENT.CALL_WENT_TO_VOICEMAIL","CONSENT.CALL_ANOTHER_DAY","CONSENT.PATIENT_WASNT_INTERESTED","CONSENT.PATIENT_SWITCHED_TO_ANOTHER_PROVIDER","CONSENT.CONSENT_OTHER"]}return u(e,[{key:"ngOnInit",value:function(){this.initTranslationStrings()}},{key:"initTranslationStrings",value:function(){var e,n=this;this.$translationSubscription=(e=this.translationService).getMultiple.apply(e,t(this.strings)).subscribe(function(e){n.translatedStrings=e})}},{key:"saveNote",value:function(){var e=this;this.note.type="CONSENT",this.note.userId=this.patientId,this.note.caretakerIds=new Array,this.note.content=(this.patientUnavailable?this.translatedStrings.get("CONSENT.PATIENT_WAS_NOT_AVAILABLE"):"")+(this.callToVoicemail?","+this.translatedStrings.get("CONSENT.CALL_WENT_TO_VOICEMAIL"):"")+(this.callAnotherDay?","+this.translatedStrings.get("CONSENT.CALL_ANOTHER_DAY"):"")+(this.othersCheckbox?","+this.translatedStrings.get("CONSENT.CONSENT_OTHER"):"")+";"+this.otherReasons,""!=this.note.content&&this._patientsService.addNoteForPatient(this.note).subscribe(function(t){t.assignerId=localStorage.getItem("loggedInUser"),t.archived=!1,t.reason=e.note.content,e._modalRef.close(t)})}}]),e}()).\u0275fac=function(e){return new(e||yn)(I.Rb(m.a),I.Rb(He.e),I.Rb(J.a))},yn.\u0275cmp=I.Lb({type:yn,selectors:[["app-add-in-progress-details-feedback"]],inputs:{patientId:"patientId"},decls:21,vars:29,consts:[["nz-typography",""],["nz-checkbox","","nzValue","Patient wasn't available",3,"ngModel","ngModelChange"],["nz-checkbox","","nzValue","Call went to voicemail",3,"ngModel","ngModelChange"],["nz-checkbox","","nzValue","Asked to call another day",3,"ngModel","ngModelChange"],["nz-checkbox","","nzValue","Other",3,"ngModel","ngModelChange"],["nz-input","",3,"nzAutosize","placeholder","ngModel","ngModelChange"],["nzType","primary","nz-button","",3,"disabled","click"]],template:function(e,t){1&e&&(I.Xb(0,"h2",0),I.Xc(1),I.jc(2,"translate"),I.Wb(),I.Xb(3,"label",1),I.ec("ngModelChange",function(e){return t.patientUnavailable=e}),I.Xc(4),I.jc(5,"translate"),I.Wb(),I.Xb(6,"label",2),I.ec("ngModelChange",function(e){return t.callToVoicemail=e}),I.Xc(7),I.jc(8,"translate"),I.Wb(),I.Xb(9,"label",3),I.ec("ngModelChange",function(e){return t.callAnotherDay=e}),I.Xc(10),I.jc(11,"translate"),I.Wb(),I.Xb(12,"label",4),I.ec("ngModelChange",function(e){return t.othersCheckbox=e}),I.Xc(13),I.jc(14,"translate"),I.Wb(),I.Xb(15,"textarea",5),I.ec("ngModelChange",function(e){return t.otherReasons=e}),I.jc(16,"translate"),I.Xc(17,"    "),I.Wb(),I.Xb(18,"button",6),I.ec("click",function(){return t.saveNote()}),I.Xc(19),I.jc(20,"translate"),I.Wb()),2&e&&(I.Db(1),I.Zc("",I.kc(2,14,"CONSENT.CONSENT_NOT_OBTAINED_BECAUSE")," "),I.Db(2),I.rc("ngModel",t.patientUnavailable),I.Db(1),I.Yc(I.kc(5,16,"CONSENT.PATIENT_WAS_NOT_AVAILABLE")),I.Db(2),I.rc("ngModel",t.callToVoicemail),I.Db(1),I.Yc(I.kc(8,18,"CONSENT.CALL_WENT_TO_VOICEMAIL")),I.Db(2),I.rc("ngModel",t.callAnotherDay),I.Db(1),I.Yc(I.kc(11,20,"CONSENT.CALL_ANOTHER_DAY")),I.Db(2),I.rc("ngModel",t.othersCheckbox),I.Db(1),I.Yc(I.kc(14,22,"CONSENT.CONSENT_OTHER")),I.Db(2),I.sc("placeholder",I.kc(16,24,"CONSENT.ADD_ADDITIONAL_NOTES")),I.rc("nzAutosize",I.xc(28,Rn))("ngModel",t.otherReasons),I.Db(3),I.rc("disabled",!(t.patientUnavailable||t.callToVoicemail||t.callAnotherDay||t.othersCheckbox&&t.otherReasons)),I.Db(1),I.Yc(I.kc(20,26,"CONSENT.SAVE_NOTE")))},directives:[P.a,Xe.a,v.u,v.x,W.b,W.a,v.d,kt.a,wt.a,L.a],pipes:[se.a],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;justify-content:center;line-height:2;border-radius:20px;padding:20px;height:100%}label[_ngcontent-%COMP%] + label[_ngcontent-%COMP%]{margin-left:0}textarea[_ngcontent-%COMP%]{margin-top:20px;margin-bottom:30px;background-color:#f6f6f6}.ant-checkbox-wrapper-checked[_ngcontent-%COMP%]{font-weight:700}button[_ngcontent-%COMP%]{display:block;margin:4% auto 2%}[_ngcontent-%COMP%]::-webkit-input-placeholder{color:#949494;float:inline-start}"]}),yn),wn=o("VGjC"),Ln=function e(){c(this,e),this.showInstructions=!0},xn=function(){return{minRows:5,maxRows:5}},Vn=((Nn=function(){function e(t,n){c(this,e),this._modalRef=t,this.translationService=n,this.strings=["CONSENT.PATIENT_DONT_HAVE_ACCESS","CONSENT.TECH_ISSUE","CONSENT.OTHER"]}return u(e,[{key:"ngOnInit",value:function(){this.initTranslationStrings()}},{key:"initTranslationStrings",value:function(){var e,n=this;this.$translationSubscription=(e=this.translationService).getMultiple.apply(e,t(this.strings)).subscribe(function(e){n.translatedStrings=e})}},{key:"submitReason",value:function(){var e=[];this.patientNotUsingApp&&e.push(this.translatedStrings.get("CONSENT.PATIENT_DONT_HAVE_ACCESS")),this.techIssue&&e.push(this.translatedStrings.get("CONSENT.TECH_ISSUE")),this.othersCheckbox&&e.push(this.translatedStrings.get("CONSENT.OTHER")),this.otherReasons&&e.push(this.otherReasons),0!==e.length&&this._modalRef.close(e)}}]),e}()).\u0275fac=function(e){return new(e||Nn)(I.Rb(He.e),I.Rb(J.a))},Nn.\u0275cmp=I.Lb({type:Nn,selectors:[["app-revoke-reason"]],decls:23,vars:37,consts:[["nz-typography",""],["nz-checkbox","",3,"nzValue","ngModel","ngModelChange"],["nz-input","",3,"nzAutosize","placeholder","ngModel","ngModelChange"],["nz-button","","nzType","primary","nzSize","large",3,"disabled","click"]],template:function(e,t){1&e&&(I.Xb(0,"h3",0),I.Xc(1),I.jc(2,"translate"),I.Wb(),I.Xb(3,"label",1),I.ec("ngModelChange",function(e){return t.patientNotUsingApp=e}),I.jc(4,"translate"),I.Xc(5),I.jc(6,"translate"),I.Wb(),I.Xb(7,"label",1),I.ec("ngModelChange",function(e){return t.techIssue=e}),I.jc(8,"translate"),I.Xc(9),I.jc(10,"translate"),I.Wb(),I.Xb(11,"label",1),I.ec("ngModelChange",function(e){return t.othersCheckbox=e}),I.jc(12,"translate"),I.Xc(13),I.jc(14,"translate"),I.Wb(),I.Xb(15,"textarea",2),I.ec("ngModelChange",function(e){return t.otherReasons=e}),I.jc(16,"translate"),I.Wb(),I.Xb(17,"p",0),I.Xc(18),I.jc(19,"translate"),I.Wb(),I.Xb(20,"button",3),I.ec("click",function(){return t.submitReason()}),I.Xc(21),I.jc(22,"translate"),I.Wb()),2&e&&(I.Db(1),I.Zc(" ",I.kc(2,16,"CONSENT.REVOKE_MODAL_TITLE"),"\n"),I.Db(2),I.sc("nzValue",I.kc(4,18,"CONSENT.PATIENT_DONT_HAVE_ACCESS")),I.rc("ngModel",t.patientNotUsingApp),I.Db(2),I.Yc(I.kc(6,20,"CONSENT.PATIENT_DONT_HAVE_ACCESS")),I.Db(2),I.sc("nzValue",I.kc(8,22,"CONSENT.TECH_ISSUE")),I.rc("ngModel",t.techIssue),I.Db(2),I.Yc(I.kc(10,24,"CONSENT.TECH_ISSUE")),I.Db(2),I.sc("nzValue",I.kc(12,26,"CONSENT.OTHER")),I.rc("ngModel",t.othersCheckbox),I.Db(2),I.Yc(I.kc(14,28,"CONSENT.OTHER")),I.Db(2),I.sc("placeholder",I.kc(16,30,"ADDITIONAL_NOTE")),I.rc("nzAutosize",I.xc(36,xn))("ngModel",t.otherReasons),I.Db(3),I.Zc(" ",I.kc(19,32,"CONSENT.REVOKE_MODAL_FOOTER_NOTE"),"\n"),I.Db(2),I.rc("disabled",!(t.patientNotUsingApp||t.techIssue||t.othersCheckbox&&t.otherReasons)),I.Db(1),I.Zc(" ",I.kc(22,34,"CONSENT.REVOKE_BUTTON")," "))},directives:[P.a,Xe.a,v.u,v.x,W.b,W.a,v.d,kt.a,wt.a,L.a],pipes:[se.a],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;justify-content:center;padding:24px}[nz-checkbox][_ngcontent-%COMP%]{margin:4px 0;height:20px}textarea[_ngcontent-%COMP%]{margin:10px auto;background-color:#f6f6f6}p[_ngcontent-%COMP%]{font-size:9px;margin-bottom:15px}button[_ngcontent-%COMP%]{margin:10px auto;width:200px}.ant-checkbox-wrapper-checked[_ngcontent-%COMP%]{font-weight:700}"]}),Nn),Un=o("azu5"),Fn=o("V1/G"),jn=o("IOC6"),Yn=function(e){return e.SMS="SMS",e.MMS="MMS",e}({}),Gn=function e(){c(this,e),this.messageType=Yn.SMS},Bn=o("0EQZ"),Hn=o("7RJT"),Zn=o("zB/H"),qn=function(e){a(i,e);var n=s(i);function i(e){var t;return c(this,i),(t=n.call(this)).http=e,t.length=10,t.pageSize=7,t.cachedData=Array.from({length:t.length}),t.fetchedPages=new Set,t.dataStream=new Hn.BehaviorSubject(t.cachedData),t.subscription=new Zn.Subscription,t.rootUrl=Pt.g.url,t}return u(i,[{key:"connect",value:function(e){var t=this;return this.subscription.add(e.viewChange.subscribe(function(e){for(var n=t.getPageForIndex(e.start),i=t.getPageForIndex(e.end-1),a=n;a<=i;a++)t.fetchPage(a)})),this.dataStream}},{key:"disconnect",value:function(){this.dataStream.unsubscribe(),this.subscription.unsubscribe()}},{key:"getPageForIndex",value:function(e){return Math.ceil(e/this.pageSize)}},{key:"fetchPage",value:function(e){var n=this;this.fetchedPages.has(e)||(this.fetchedPages.add(e),this.endPoint=this.rootUrl+"/v3/sms-template/?limit="+this.pageSize+"&offset="+e,this.http.get(this.endPoint).subscribe(function(i){var a;(a=n.cachedData).splice.apply(a,[e*n.pageSize,n.pageSize].concat(t(i.result))),n.cachedData=n.cachedData.filter(function(e){return null!=e}),n.length=i.totalCount,n.dataStream.next(n.cachedData)}))}}]),i}(Bn.b),$n=o("tk/3"),Kn=((zn=function(){function e(t){c(this,e),this._http=t,this.rootUrl=Pt.g.url}return u(e,[{key:"sendSms",value:function(e){return this.endPoint=this.rootUrl+"/v3/conversation/messages",this._http.post(this.endPoint,e)}},{key:"getConversations",value:function(e,t,n){return this._http.get(this.rootUrl+"/v3/conversation/messages/users/"+e+"?skip="+t+"&limit="+n)}},{key:"markAsRead",value:function(e){return this._http.post(this.rootUrl+"/v3/conversation/messages/read-state",e)}}]),e}()).\u0275fac=function(e){return new(e||zn)(I.bc($n.c))},zn.\u0275prov=I.Nb({token:zn,factory:zn.\u0275fac,providedIn:"root"}),zn),Qn=o("5+WD"),Jn=o("vxfF"),ei=o("Ff2k"),ti=o("Beax"),ni=o("OtHt");function ii(e,t){1&e&&(I.Xb(0,"p"),I.Xc(1),I.jc(2,"translate"),I.Wb()),2&e&&(I.Db(1),I.Zc(" ",I.kc(2,1,"NO_FILTERS_APPLIED")," "))}function ai(e,t){if(1&e&&(I.Xb(0,"div",3),I.Xb(1,"div",13),I.Xb(2,"nz-card",14),I.Xb(3,"div",13),I.Xb(4,"span",15),I.Sb(5,"app-icons",16),I.Wb(),I.Xb(6,"span",17),I.Xb(7,"strong"),I.Xc(8),I.jc(9,"translate"),I.Wb(),I.Wb(),I.Sb(10,"br"),I.Wb(),I.Xb(11,"div",18),I.Sb(12,"app-filter-desc",19),I.Vc(13,ii,3,3,"p",7),I.Wb(),I.Wb(),I.Wb(),I.Wb()),2&e){var n=I.ic();I.Db(8),I.Yc(I.kc(9,3,"SMS.APPLIED_FILTERS")),I.Db(4),I.rc("smsScreen",n.smsScreen),I.Db(1),I.rc("ngIf",0===n.noOfFiltersApplied)}}function oi(e,t){1&e&&(I.Xb(0,"div"),I.Xb(1,"div",20),I.Xc(2),I.jc(3,"translate"),I.Wb(),I.Wb()),2&e&&(I.Db(2),I.Zc("*",I.kc(3,1,"COMMON.REQUIRED"),""))}var si=function(){return{rows:1}};function li(e,t){1&e&&I.Sb(0,"nz-skeleton",23),2&e&&I.rc("nzParagraph",I.xc(1,si))}function ri(e,t){if(1&e){var n=I.Yb();I.Xb(0,"a",27),I.ec("click",function(){I.Lc(n);var e=I.ic(3).$implicit;return I.ic().selectTemplate(e.template)}),I.Xc(1),I.Wb()}if(2&e){var i=I.ic(3).$implicit;I.Db(1),I.Zc(" ",i.template," ")}}function ci(e,t){if(1&e){var n=I.Yb();I.Xb(0,"a",27),I.ec("click",function(){I.Lc(n);var e=I.ic(3).$implicit;return I.ic().selectTemplate(e.template)}),I.Xc(1),I.Wb()}if(2&e){var i=I.ic(3).$implicit;I.Db(1),I.Zc(" ",i.title," ")}}function di(e,t){if(1&e&&(I.Vc(0,ri,2,1,"a",26),I.Vc(1,ci,2,1,"a",26)),2&e){var n=I.ic(2).$implicit;I.rc("ngIf",null==n.title),I.Db(1),I.rc("ngIf",null!=n.title)}}function ui(e,t){if(1&e&&(I.Xb(0,"nz-list-item-meta",24),I.Vc(1,di,2,2,"ng-template",null,25,I.Wc),I.Wb()),2&e){var n=I.Ic(2);I.rc("nzTitle",n)}}function bi(e,t){if(1&e&&(I.Xb(0,"nz-list-item"),I.Vc(1,li,1,2,"nz-skeleton",21),I.Vc(2,ui,3,1,"nz-list-item-meta",22),I.Wb()),2&e){var n=t.$implicit;I.Db(1),I.rc("ngIf",!n),I.Db(1),I.rc("ngIf",n)}}var pi,fi,vi=function(e){return{border:e}},hi=((pi=function(){function e(n,i,a,o,s,l,r){var d,u=this;c(this,e),this.http=n,this.smsService=i,this.staffService=a,this._modalRef=o,this.smsTemplateService=s,this.notificationService=l,this.translationService=r,this.dateRange=[],this.smsLink="",this.patientId="",this.assignerName="",this.showFilter=!0,this.noOfFiltersApplied=0,this.usePrimaryNumber=!0,this.smsScreen=!0,this.message="",this.isValidMessage=!0,this.listOfOption=[],this.listOfSelectedValue=[],this.saveTemplateBtnLoading=!1,this.sendMessageBtnLoading=!1,this.allPatientIds=new Array,this.strings=["SMS.SMS_TEMPLATE","SMS.MESSAGE","SMS.MESSAGE_SENT","SMS.PLEASE_ENTER_TEXT","SMS.TEMPLATE_ALREADY_PRESENT","SMS.SMS_TEMPLATE_SAVED","SMS.MESSAGE_SENT_SUCCESSFULLY","TABLEHEADER.RESIDENT","SMS.PLEASE_ADD_RECEPIENT","SMS.MESSAGE_SENT_SUCCESSFULLY_TO_MULTIPLE"],this.$translationSubscription=(d=this.translationService).getMultiple.apply(d,t(this.strings)).subscribe(function(e){u.translatedStrings=e})}return u(e,[{key:"ngOnDestroy",value:function(){this.$translationSubscription.unsubscribe(),this.templates.disconnect(),this.close()}},{key:"ngOnInit",value:function(){this.radioValue="ALL",this.initTemplates(),this.initPatients(),this.initAllPatientsAsRecepients(),this.getPhysiciansForPatient()}},{key:"initAllPatientsAsRecepients",value:function(){this.listOfSelectedValue=this.allPatientIds}},{key:"initTemplates",value:function(){this.templates=new qn(this.http)}},{key:"initPatients",value:function(){var e=this,t=[];this.patientList.forEach(function(n){t.push({label:n.patientName,value:n.patientId}),e.allPatientIds.push(n.patientId)}),this.listOfOption=[].concat(t)}},{key:"selectTemplate",value:function(e){this.saveTemplateBtnLoading=!1,this.sendMessageBtnLoading=!1,null==this.physicianName&&(this.physicianName=this.assignerName),e=e.replace("PHYSICIAN_NAME",this.physicianName),this.message=e+"\n"+this.smsLink}},{key:"validateSms",value:function(){var e=!0;return 0===this.message.length&&(e=!1),0==this.listOfSelectedValue.length&&(e=!1),this.isValidMessage=e,e}},{key:"sendSms",value:function(){var e=this;if(this.sendMessageBtnLoading=!0,this.validateSms()){var t=new Gn;t.message=this.message,t.toUsers=this.listOfSelectedValue,t.fromUser=localStorage.getItem("loggedInUser"),t.usePrimaryNumber=this.usePrimaryNumber,this.smsService.sendSms(t).subscribe(function(t){var n;e.sendMessageBtnLoading=!1,n=1==e.listOfSelectedValue.length?e.translatedStrings.get("SMS.MESSAGE_SENT_SUCCESSFULLY"):e.translatedStrings.get("SMS.MESSAGE_SENT_SUCCESSFULLY_TO_MULTIPLE").replace("{COUNT}",e.listOfSelectedValue.length.toString()),e.notificationService.success(e.translatedStrings.get("SMS.MESSAGE_SENT"),n),e.message="SUCCESS",e.close()})}else this.sendMessageBtnLoading=!1}},{key:"getPhysiciansForPatient",value:function(){var e=this;this.staffService.fetchStaffMemberById(this.patientId).subscribe(function(t){e.physicians=null==t?void 0:t.assignedUsers.PHYSICIAN,e.physicians.length>0&&(e.physicianName=e.physicians[0].fullName)})}},{key:"saveTemplate",value:function(){var e=this;this.saveTemplateBtnLoading=!0;var t=new Fn.a;t.template=this.message,this.smsTemplateService.validateTemplate(t).subscribe(function(n){e.smsTemplateService.saveTemplate(t).subscribe(function(){e.initTemplates(),e.saveTemplateBtnLoading=!1,e.notificationService.success(e.translatedStrings.get("SMS.SMS_TEMPLATE"),e.translatedStrings.get("SMS.SMS_TEMPLATE_SAVED"))})},function(t){return e.notificationService.error(e.translatedStrings.get("SMS.SMS_TEMPLATE"),e.translatedStrings.get("SMS.TEMPLATE_ALREADY_PRESENT"))})}},{key:"onRadioChange",value:function(e){"ALL"==e?this.initAllPatientsAsRecepients():this.listOfSelectedValue=[]}},{key:"onChange",value:function(){this.saveTemplateBtnLoading=!1,this.sendMessageBtnLoading=!1}},{key:"close",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._modalRef.close(e)}}]),e}()).\u0275fac=function(e){return new(e||pi)(I.Rb($n.c),I.Rb(Kn),I.Rb(p.a),I.Rb(He.e),I.Rb(jn.a),I.Rb(T.b),I.Rb(J.a))},pi.\u0275cmp=I.Lb({type:pi,selectors:[["app-sms"]],inputs:{episodeType:"episodeType",dateRange:"dateRange",smsLink:"smsLink",patientId:"patientId",assignerName:"assignerName",patientList:"patientList",showFilter:"showFilter",noOfFiltersApplied:"noOfFiltersApplied",usePrimaryNumber:"usePrimaryNumber"},decls:36,vars:25,consts:[["cdkDrag","","cdkDragRootElement",".ant-modal-content","cdkDragHandle",""],["id","title"],["nz-row","","nzGutter","16",4,"ngIf"],["nz-row","","nzGutter","16"],["nz-col","","nzSpan","12"],[1,"header"],["rows","2","nz-input","","placeholder","Type here...",1,"message-textarea",3,"ngStyle","ngModel","ngModelChange"],[4,"ngIf"],[1,"message-count"],["itemSize","73",1,"demo-infinite-container"],[4,"cdkVirtualFor","cdkVirtualForOf"],["nz-col","","nzSpan","24",1,"centerize"],["nz-button","","nzType","primary",3,"nzSize","disabled","click"],["nz-col","","nzSpan","24"],[1,"filter-card"],[1,"info-icon-applied-filter"],["name","infoCircle"],[1,"filter-header"],["nz-col","","nzSpan","24",1,"filter-tag-div"],[3,"smsScreen"],[1,"required-text"],[3,"nzParagraph",4,"ngIf"],[3,"nzTitle",4,"ngIf"],[3,"nzParagraph"],[3,"nzTitle"],["nzTitle",""],["class","template",3,"click",4,"ngIf"],[1,"template",3,"click"]],template:function(e,t){1&e&&(I.Xb(0,"div",0),I.Xb(1,"strong",1),I.Xc(2),I.jc(3,"translate"),I.Wb(),I.Sb(4,"br"),I.Sb(5,"br"),I.Vc(6,ai,14,5,"div",2),I.Sb(7,"br"),I.Xb(8,"nz-card"),I.Xb(9,"div",3),I.Xb(10,"div",4),I.Xb(11,"strong",5),I.Xc(12),I.jc(13,"translate"),I.Wb(),I.Sb(14,"br"),I.Xb(15,"textarea",6),I.ec("ngModelChange",function(e){return t.message=e})("ngModelChange",function(){return t.onChange()}),I.Wb(),I.Vc(16,oi,4,3,"div",7),I.Xb(17,"label",8),I.Xb(18,"em"),I.Xc(19),I.jc(20,"translate"),I.Wb(),I.Wb(),I.Wb(),I.Xb(21,"div",4),I.Xb(22,"strong",5),I.Xc(23),I.jc(24,"translate"),I.Wb(),I.Sb(25,"br"),I.Sb(26,"br"),I.Xb(27,"cdk-virtual-scroll-viewport",9),I.Xb(28,"nz-list"),I.Vc(29,bi,3,2,"nz-list-item",10),I.Wb(),I.Wb(),I.Wb(),I.Wb(),I.Wb(),I.Sb(30,"br"),I.Xb(31,"div",3),I.Xb(32,"div",11),I.Xb(33,"button",12),I.ec("click",function(){return t.sendSms()}),I.Xc(34),I.jc(35,"translate"),I.Wb(),I.Wb(),I.Wb(),I.Wb()),2&e&&(I.Db(2),I.Zc(" ",I.kc(3,13,"SMS.SEND_SMS")," "),I.Db(4),I.rc("ngIf",t.showFilter),I.Db(6),I.Yc(I.kc(13,15,"COMMON.MESSAGE")),I.Db(3),I.rc("ngStyle",I.yc(23,vi,t.isValidMessage||0!==(null==t.message?null:t.message.length)?"":"1px solid red"))("ngModel",t.message),I.Db(1),I.rc("ngIf",!t.isValidMessage&&0==(null==t.message?null:t.message.length)),I.Db(3),I.ad("",t.message.length," ",I.kc(20,17,"SMS.CHARACTERS"),""),I.Db(4),I.Zc(" ",I.kc(24,19,"SMS.CHOOSE_FROM_TEMPLATE")," "),I.Db(6),I.rc("cdkVirtualForOf",t.templates),I.Db(4),I.rc("nzSize","medium")("disabled",0==(null==t.listOfSelectedValue?null:t.listOfSelectedValue.length)||t.sendMessageBtnLoading),I.Db(1),I.Zc(" ",I.kc(35,21,"SMS.SEND_SMS")," "))},directives:[Qn.a,Qn.b,r.q,z.a,N.c,N.a,W.b,v.d,r.r,v.u,v.x,Jn.d,Jn.a,ei.a,Jn.c,kt.a,wt.a,L.a,ve.a,ti.a,ei.e,ni.a,ei.f],pipes:[se.a],styles:["[_nghost-%COMP%]     .ant-modal-content{background-color:#eff2f0 0 0 no-repeat padding-box}#title[_ngcontent-%COMP%]{padding-left:1%;font-size:14px;font-weight:600;border-left:3px solid var(--primary-color)}.centerize[_ngcontent-%COMP%]{text-align:center}.info-icon-applied-filter[_ngcontent-%COMP%]{font-size:17px;color:var(--primary-color);margin-right:20px}.filter-card[_ngcontent-%COMP%]{margin:15px;border-radius:10px}.required-text[_ngcontent-%COMP%]{color:#ff2e2e;float:left;position:absolute}.ant-tag[_ngcontent-%COMP%]{font-size:10px}.filter-tag-div[_ngcontent-%COMP%]{margin-top:10px}.filter-header[_ngcontent-%COMP%]{text-align:left;font:normal normal normal 12px/21px Nunito;letter-spacing:0;color:var(--primary-color);opacity:1}.message-textarea[_ngcontent-%COMP%]{background:#fbfbfb 0 0 no-repeat padding-box;border:1px solid var(--grey);border-radius:5px;opacity:1;width:100%;min-height:132px;max-height:132px;padding:10px;resize:none}.demo-infinite-container[_ngcontent-%COMP%]{height:300px;border:1px solid var(--grey);border-radius:4px}nz-list[_ngcontent-%COMP%]{padding:14px 20px}.template[_ngcontent-%COMP%]{text-align:justify;font:normal normal normal 11px/15px Nunito;letter-spacing:0;color:var(--light-black);opacity:1}.message-count[_ngcontent-%COMP%]{float:right;margin-top:4px}.header[_ngcontent-%COMP%]{color:var(--primary-color);font:normal normal normal 12px/21px Nunito}#patient-select[_ngcontent-%COMP%]{width:100%;background:#fbfbfb 0 0 no-repeat padding-box;border:1px solid var(--grey);border-radius:5px;opacity:1}[_nghost-%COMP%]     .cdk-virtual-scroll-spacer{height:-webkit-fit-content!important;height:-moz-fit-content!important;height:fit-content!important}"]}),pi),gi=function(){return{minRows:5,maxRows:5}},mi=((fi=function(){function e(t,n){c(this,e),this._modalRef=t,this.translationService=n,this.strings=["CONSENT.TECH_ISSUE","CONSENT.OTHER"]}return u(e,[{key:"ngOnInit",value:function(){this.initTranslationStrings()}},{key:"initTranslationStrings",value:function(){var e,n=this;this.$translationSubscription=(e=this.translationService).getMultiple.apply(e,t(this.strings)).subscribe(function(e){n.translatedStrings=e})}},{key:"submitReason",value:function(){var e=[];this.techIssue&&e.push(this.translatedStrings.get("CONSENT.TECH_ISSUE")),this.othersCheckbox&&e.push(this.translatedStrings.get("CONSENT.OTHER")),this.otherReasons&&e.push(this.otherReasons),0!==e.length&&(console.log(e),this._modalRef.close(e))}}]),e}()).\u0275fac=function(e){return new(e||fi)(I.Rb(He.e),I.Rb(J.a))},fi.\u0275cmp=I.Lb({type:fi,selectors:[["app-revoke-reason-sms"]],decls:19,vars:30,consts:[["nz-typography",""],["nz-checkbox","",3,"nzValue","ngModel","ngModelChange"],["nz-input","",3,"nzAutosize","placeholder","ngModel","ngModelChange"],["nz-button","","nzType","primary","nzSize","large",3,"disabled","click"]],template:function(e,t){1&e&&(I.Xb(0,"h3",0),I.Xc(1),I.jc(2,"translate"),I.Wb(),I.Xb(3,"label",1),I.ec("ngModelChange",function(e){return t.techIssue=e}),I.jc(4,"translate"),I.Xc(5),I.jc(6,"translate"),I.Wb(),I.Xb(7,"label",1),I.ec("ngModelChange",function(e){return t.othersCheckbox=e}),I.jc(8,"translate"),I.Xc(9),I.jc(10,"translate"),I.Wb(),I.Xb(11,"textarea",2),I.ec("ngModelChange",function(e){return t.otherReasons=e}),I.jc(12,"translate"),I.Wb(),I.Xb(13,"p",0),I.Xc(14),I.jc(15,"translate"),I.Wb(),I.Xb(16,"button",3),I.ec("click",function(){return t.submitReason()}),I.Xc(17),I.jc(18,"translate"),I.Wb()),2&e&&(I.Db(1),I.Zc(" ",I.kc(2,13,"CONSENT.REVOKE_SMS_MODAL_TITLE"),"\n"),I.Db(2),I.sc("nzValue",I.kc(4,15,"CONSENT.TECH_ISSUE")),I.rc("ngModel",t.techIssue),I.Db(2),I.Yc(I.kc(6,17,"CONSENT.TECH_ISSUE")),I.Db(2),I.sc("nzValue",I.kc(8,19,"CONSENT.OTHER")),I.rc("ngModel",t.othersCheckbox),I.Db(2),I.Yc(I.kc(10,21,"CONSENT.OTHER")),I.Db(2),I.sc("placeholder",I.kc(12,23,"ADDITIONAL_NOTE")),I.rc("nzAutosize",I.xc(29,gi))("ngModel",t.otherReasons),I.Db(3),I.Zc(" ",I.kc(15,25,"CONSENT.REVOKE_SMS_MODAL_FOOTER_NOTE"),"\n"),I.Db(2),I.rc("disabled",!(t.patientNotUsingApp||t.techIssue||t.othersCheckbox&&t.otherReasons)),I.Db(1),I.Zc(" ",I.kc(18,27,"CONSENT.REVOKE_BUTTON")," "))},directives:[P.a,Xe.a,v.u,v.x,W.b,W.a,v.d,kt.a,wt.a,L.a],pipes:[se.a],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;justify-content:center;padding:24px}[nz-checkbox][_ngcontent-%COMP%]{margin:4px 0;height:20px}textarea[_ngcontent-%COMP%]{margin:10px auto;background-color:#f6f6f6}p[_ngcontent-%COMP%]{font-size:9px;margin-bottom:15px}button[_ngcontent-%COMP%]{margin:10px auto;width:200px}.ant-checkbox-wrapper-checked[_ngcontent-%COMP%]{font-weight:700}"]}),fi),Ci=o("F6ss"),Di=o("zM63");function Si(e,t){1&e&&I.Sb(0,"nz-spin",3)}function Ei(e,t){1&e&&(I.Vb(0),I.Xc(1," | Preferred"),I.Ub())}function Oi(e,t){if(1&e){var n=I.Yb();I.Xb(0,"li",19),I.ec("click",function(){I.Lc(n);var e=I.ic().$implicit;return I.ic(4).onVerbalCallInitiate(null==e?null:e.number)}),I.Xb(1,"label",20),I.Xc(2),I.jc(3,"titlecase"),I.Vc(4,Ei,2,0,"ng-container",2),I.Wb(),I.Sb(5,"br"),I.Xb(6,"span",21),I.Xc(7),I.Wb(),I.Xc(8,": "),I.Xb(9,"span",22),I.Xc(10),I.Wb(),I.Wb()}if(2&e){var i=I.ic().$implicit;I.Db(2),I.Zc(" ",I.kc(3,5,(null==i?null:i.label)||"Phone Number")," "),I.Db(2),I.rc("ngIf",null==i?null:i.preferred),I.Db(3),I.Zc(" ","MOBILE"===(null==i?null:i.type)?"M":"L"," "),I.Db(3),I.ad("",null==i?null:i.countryCode," ",null==i?null:i.number,"")}}function Ii(e,t){if(1&e&&(I.Vb(0),I.Vc(1,Oi,11,7,"li",18),I.Ub()),2&e){var n=t.$implicit;I.Db(1),I.rc("ngIf",!(null==n||null==n.number||!n.number.length)&&(null==n||null==n.notificationConfig.CALL?null:n.notificationConfig.CALL.enabled))}}function _i(e,t){if(1&e){var n=I.Yb();I.Xb(0,"div"),I.Xb(1,"button",11),I.Sb(2,"app-icons",12),I.Wb(),I.Xb(3,"nz-dropdown-menu",null,13),I.Xb(5,"ul",14),I.Vc(6,Ii,2,1,"ng-container",15),I.Wb(),I.Wb(),I.Xb(7,"button",16),I.ec("click",function(){return I.Lc(n),I.ic(3).showScript()}),I.jc(8,"translate"),I.Sb(9,"app-icons",17),I.Wb(),I.Wb()}if(2&e){var i=I.Ic(4),a=I.ic(3);I.Db(1),I.rc("disabled",!(null!=a.episodeDetails&&null!=a.episodeDetails.patientPhoneNumbers&&a.episodeDetails.patientPhoneNumbers.length))("nzDropdownMenu",i),I.Db(5),I.rc("ngForOf",null==a.episodeDetails?null:a.episodeDetails.patientPhoneNumbers),I.Db(1),I.sc("nzTooltipTitle",I.kc(8,4,"CONSENT.CONSENT_SCRIPT_TOOLTIP"))}}function Ti(e,t){if(1&e){var n=I.Yb();I.Xb(0,"div"),I.Xb(1,"div",23),I.Xb(2,"article",0),I.Xb(3,"p",0),I.Xc(4),I.Wb(),I.Wb(),I.Wb(),I.Xb(5,"button",16),I.ec("click",function(){return I.Lc(n),I.ic(3).getPatientConsentViaApp()}),I.jc(6,"translate"),I.Sb(7,"app-icons",24),I.Wb(),I.Wb()}if(2&e){var i=I.ic(3);I.Db(4),I.Zc(" ",i.viaAppDesc," "),I.Db(1),I.sc("nzTooltipTitle",I.kc(6,2,"CONSENT.SEND_CONSENT_TOOLTIP"))}}function Xi(e,t){1&e&&(I.Vb(0),I.Xc(1," | Preferred"),I.Ub())}function yi(e,t){if(1&e){var n=I.Yb();I.Xb(0,"li",19),I.ec("click",function(){I.Lc(n);var e=I.ic().$implicit;return I.ic(4).getPatientConsentViaSMS(null==e?null:e.preferred)}),I.Xb(1,"label",20),I.Xc(2),I.jc(3,"titlecase"),I.Vc(4,Xi,2,0,"ng-container",2),I.Wb(),I.Sb(5,"br"),I.Xb(6,"span",21),I.Xc(7),I.Wb(),I.Xc(8,": "),I.Xb(9,"span",22),I.Xc(10),I.Wb(),I.Wb()}if(2&e){var i=I.ic().$implicit;I.Db(2),I.Zc(" ",I.kc(3,5,(null==i?null:i.label)||"Phone Number")," "),I.Db(2),I.rc("ngIf",null==i?null:i.preferred),I.Db(3),I.Zc(" ","MOBILE"===(null==i?null:i.type)?"M":"L"," "),I.Db(3),I.ad("",null==i?null:i.countryCode," ",null==i?null:i.number,"")}}function Ni(e,t){if(1&e&&(I.Vb(0),I.Vc(1,yi,11,7,"li",18),I.Ub()),2&e){var n=t.$implicit;I.Db(1),I.rc("ngIf",!(null==n||null==n.number||!n.number.length)&&(null==n||null==n.notificationConfig.SMS?null:n.notificationConfig.SMS.enabled))}}function zi(e,t){if(1&e&&(I.Xb(0,"div"),I.Xb(1,"div",23),I.Xb(2,"article",0),I.Xb(3,"p",0),I.Xc(4),I.Wb(),I.Wb(),I.Wb(),I.Xb(5,"button",25),I.jc(6,"translate"),I.Sb(7,"app-icons",24),I.Wb(),I.Xb(8,"nz-dropdown-menu",null,26),I.Xb(10,"ul",14),I.Vc(11,Ni,2,1,"ng-container",15),I.Wb(),I.Wb(),I.Wb()),2&e){var n=I.Ic(9),i=I.ic(3);I.Db(4),I.Zc(" ",i.viaSMSDesc," "),I.Db(1),I.sc("nzTooltipTitle",I.kc(6,4,"CONSENT.SEND_CONSENT_TOOLTIP")),I.rc("nzDropdownMenu",n),I.Db(6),I.rc("ngForOf",null==i.episodeDetails?null:i.episodeDetails.patientPhoneNumbers)}}function Mi(e,t){if(1&e&&(I.Xb(0,"div"),I.Xb(1,"div",23),I.Xb(2,"article",0),I.Xb(3,"p",0),I.Xc(4),I.jc(5,"translate"),I.Wb(),I.Wb(),I.Wb(),I.Xb(6,"nz-upload",27),I.Xb(7,"button",28),I.Xc(8),I.jc(9,"translate"),I.Wb(),I.Wb(),I.Wb()),2&e){var n=I.ic(3);I.Db(4),I.Zc(" ",I.kc(5,6,"CONSENT.VIA_MANUAL_UPLOAD_DESCRIPTION")," "),I.Db(2),I.rc("nzShowButton",n.fileList.length<5)("nzCustomRequest",n.handleUpload)("nzShowUploadList",!1)("nzBeforeUpload",n.nzBeforeUpload),I.Db(2),I.Zc(" ",I.kc(9,8,"COMMON.UPLOAD")," ")}}function Ai(e,t){if(1&e){var n=I.Yb();I.Xb(0,"div",29),I.Xb(1,"button",30),I.ec("click",function(){I.Lc(n);var e=I.ic(3);return e.revokeConsent(e.lastConsentAvailable)}),I.jc(2,"translate"),I.Xc(3),I.jc(4,"translate"),I.Wb(),I.Xb(5,"h3"),I.Xc(6),I.jc(7,"translate"),I.Wb(),I.Xb(8,"p",31),I.Xc(9),I.jc(10,"translate"),I.Wb(),I.Wb()}2&e&&(I.Db(1),I.sc("nzTooltipTitle",I.kc(2,4,"CONSENT.REVOKE_TOOLTIP")),I.Db(2),I.Zc(" ",I.kc(4,6,"CONSENT.REVOKE_BUTTON")," "),I.Db(3),I.Zc("",I.kc(7,8,"CONSENT.CONSENT_FORM_SENT")," "),I.Db(3),I.Yc(I.kc(10,10,"CONSENT.AWAITING_RESPONSE")))}function Pi(e,t){if(1&e){var n=I.Yb();I.Xb(0,"div",29),I.Xb(1,"h3"),I.Xc(2),I.jc(3,"translate"),I.Wb(),I.Xb(4,"a",32),I.ec("click",function(){return I.Lc(n),I.ic(3).viewConsentInProgressDetails()}),I.Xc(5),I.jc(6,"translate"),I.Wb(),I.Sb(7,"span",33),I.Wb()}2&e&&(I.Db(2),I.Yc(I.kc(3,2,"CONSENT.CONSENT_PENDING")),I.Db(3),I.Zc(" ",I.kc(6,4,"CONSENT.VIEW_DETAILS")," "))}function Wi(e,t){if(1&e){var n=I.Yb();I.Vb(0),I.Xb(1,"label"),I.Xc(2),I.jc(3,"translate"),I.Wb(),I.Xb(4,"nz-radio-group",4),I.ec("ngModelChange",function(e){return I.Lc(n),I.ic(2).consentMedium=e}),I.Xb(5,"label",5),I.Xb(6,"b"),I.Xc(7),I.jc(8,"translate"),I.Wb(),I.Wb(),I.Xb(9,"label",6),I.Xb(10,"b"),I.Xc(11),I.jc(12,"translate"),I.Wb(),I.Wb(),I.Xb(13,"label",7),I.Xb(14,"b"),I.Xc(15),I.jc(16,"translate"),I.Wb(),I.Wb(),I.Xb(17,"label",8),I.Xb(18,"b"),I.Xc(19),I.jc(20,"translate"),I.Wb(),I.Wb(),I.Xb(21,"label",9),I.Xb(22,"b"),I.Xc(23),I.jc(24,"translate"),I.Wb(),I.Wb(),I.Wb(),I.Vc(25,_i,10,6,"div",2),I.Vc(26,Ti,8,4,"div",2),I.Vc(27,zi,12,6,"div",2),I.Vc(28,Mi,10,10,"div",2),I.Vc(29,Ai,11,12,"div",10),I.Vc(30,Pi,8,6,"div",10),I.Ub()}if(2&e){var i=I.ic(2);I.Db(2),I.Zc("",I.kc(3,18,"CONSENT.OBTAIN_CONSENT"),": "),I.Db(2),I.rc("ngModel",i.consentMedium),I.Db(1),I.rc("nzDisabled","IN_PROGRESS"!=(null==i.episodeDetails?null:i.episodeDetails.status)&&"SCHEDULED"!=(null==i.episodeDetails?null:i.episodeDetails.status)||"SMS_CONSENT"==(null==i.lastConsentAvailable?null:i.lastConsentAvailable.type)&&"IN_PROGRESS"==(null==i.lastConsentAvailable?null:i.lastConsentAvailable.consentStatus)||i.consentCallInProgress),I.Db(2),I.Yc(I.kc(8,20,"CONSENT.VIA_APP")),I.Db(2),I.rc("nzDisabled",!i.consentSMSEnabled||"IN_PROGRESS"!=(null==i.episodeDetails?null:i.episodeDetails.status)&&"SCHEDULED"!=(null==i.episodeDetails?null:i.episodeDetails.status)||"APP_CONSENT"==(null==i.lastConsentAvailable?null:i.lastConsentAvailable.type)&&"IN_PROGRESS"==(null==i.lastConsentAvailable?null:i.lastConsentAvailable.consentStatus)||i.consentCallInProgress),I.Db(2),I.Yc(I.kc(12,22,"CONSENT.VIA_SMS")),I.Db(2),I.rc("nzDisabled",!i.verbalConsentEnabled||"IN_PROGRESS"!=(null==i.episodeDetails?null:i.episodeDetails.status)&&"SCHEDULED"!=(null==i.episodeDetails?null:i.episodeDetails.status)||("APP_CONSENT"==(null==i.lastConsentAvailable?null:i.lastConsentAvailable.type)||"SMS_CONSENT"==(null==i.lastConsentAvailable?null:i.lastConsentAvailable.type))&&"IN_PROGRESS"==(null==i.lastConsentAvailable?null:i.lastConsentAvailable.consentStatus)),I.Db(2),I.Yc(I.kc(16,24,"CONSENT.VERBALLY_OVER_CALL")),I.Db(2),I.rc("nzDisabled","IN_PROGRESS"!=(null==i.episodeDetails?null:i.episodeDetails.status)&&"SCHEDULED"!=(null==i.episodeDetails?null:i.episodeDetails.status)||("APP_CONSENT"==(null==i.lastConsentAvailable?null:i.lastConsentAvailable.type)||"SMS_CONSENT"==(null==i.lastConsentAvailable?null:i.lastConsentAvailable.type))&&"IN_PROGRESS"==(null==i.lastConsentAvailable?null:i.lastConsentAvailable.consentStatus)),I.Db(2),I.Yc(I.kc(20,26,"CONSENT.MANUAL_UPLOAD")),I.Db(2),I.rc("nzDisabled","IN_PROGRESS"!=(null==i.episodeDetails?null:i.episodeDetails.status)&&"SCHEDULED"!=(null==i.episodeDetails?null:i.episodeDetails.status)||("APP_CONSENT"==(null==i.lastConsentAvailable?null:i.lastConsentAvailable.type)||"SMS_CONSENT"==(null==i.lastConsentAvailable?null:i.lastConsentAvailable.type))&&"IN_PROGRESS"==(null==i.lastConsentAvailable?null:i.lastConsentAvailable.consentStatus)),I.Db(2),I.Yc(I.kc(24,28,"CONSENT.DIGITAL_CONSENT")),I.Db(2),I.rc("ngIf","VERBAL_CONSENT"===i.consentMedium&&(null==i.lastConsentAvailable||"VERBAL_CONSENT"==(null==i.lastConsentAvailable?null:i.lastConsentAvailable.type)&&"IN_PROGRESS"==(null==i.lastConsentAvailable?null:i.lastConsentAvailable.consentStatus)&&!("APP_CONSENT"==(null==i.lastConsentAvailable?null:i.lastConsentAvailable.type)&&"IN_PROGRESS"==(null==i.lastConsentAvailable?null:i.lastConsentAvailable.consentStatus)))),I.Db(1),I.rc("ngIf","APP_CONSENT"===i.consentMedium&&(null==i.lastConsentAvailable||"VERBAL_CONSENT"==(null==i.lastConsentAvailable?null:i.lastConsentAvailable.type)&&"IN_PROGRESS"==(null==i.lastConsentAvailable?null:i.lastConsentAvailable.consentStatus))&&!("APP_CONSENT"==(null==i.lastConsentAvailable?null:i.lastConsentAvailable.type)&&"IN_PROGRESS"==(null==i.lastConsentAvailable?null:i.lastConsentAvailable.consentStatus))),I.Db(1),I.rc("ngIf","SMS_CONSENT"===i.consentMedium&&(null==i.lastConsentAvailable||"VERBAL_CONSENT"==(null==i.lastConsentAvailable?null:i.lastConsentAvailable.type)&&"IN_PROGRESS"==(null==i.lastConsentAvailable?null:i.lastConsentAvailable.consentStatus))&&!("APP_CONSENT"==(null==i.lastConsentAvailable?null:i.lastConsentAvailable.type)&&"IN_PROGRESS"==(null==i.lastConsentAvailable?null:i.lastConsentAvailable.consentStatus))),I.Db(1),I.rc("ngIf","MANUAL_CONSENT"===i.consentMedium&&(null==i.lastConsentAvailable||"VERBAL_CONSENT"==(null==i.lastConsentAvailable?null:i.lastConsentAvailable.type)&&"IN_PROGRESS"==(null==i.lastConsentAvailable?null:i.lastConsentAvailable.consentStatus))&&!("APP_CONSENT"==(null==i.lastConsentAvailable?null:i.lastConsentAvailable.type)&&"IN_PROGRESS"==(null==i.lastConsentAvailable?null:i.lastConsentAvailable.consentStatus))),I.Db(1),I.rc("ngIf",("APP_CONSENT"==(null==i.lastConsentAvailable?null:i.lastConsentAvailable.type)||"SMS_CONSENT"==(null==i.lastConsentAvailable?null:i.lastConsentAvailable.type))&&"IN_PROGRESS"==(null==i.lastConsentAvailable?null:i.lastConsentAvailable.consentStatus)),I.Db(1),I.rc("ngIf","VERBAL_CONSENT"==i.consentMedium&&"VERBAL_CONSENT"==(null==i.lastConsentAvailable?null:i.lastConsentAvailable.type)&&"IN_PROGRESS"==(null==i.lastConsentAvailable?null:i.lastConsentAvailable.consentStatus))}}function Ri(e,t){if(1&e){var n=I.Yb();I.Vb(0),I.Xb(1,"div",23),I.Xb(2,"article",0),I.Xb(3,"p",0),I.Xc(4),I.Wb(),I.Wb(),I.Wb(),I.Xb(5,"div",23),I.Xb(6,"button",34),I.ec("click",function(){return I.Lc(n),I.ic(2).getDigitalConsent()}),I.Xc(7),I.jc(8,"translate"),I.Wb(),I.Wb(),I.Ub()}if(2&e){var i=I.ic(2);I.Db(4),I.Zc(" ",i.viaDigitalConsentDesc," "),I.Db(3),I.Zc(" ",I.kc(8,2,"CONSENT.SUBMIT_CONSENT")," ")}}function ki(e,t){if(1&e&&(I.Vb(0),I.Xb(1,"h4",35),I.Xc(2),I.jc(3,"translate"),I.Wb(),I.Xb(4,"p",31),I.Xc(5),I.jc(6,"date"),I.Wb(),I.Ub()),2&e){var n=I.ic(2);I.Db(2),I.Yc(I.kc(3,2,"CONSENT.VERBAL_CONSENT_DENIED")),I.Db(3),I.Yc(I.lc(6,4,null==n.lastConsentAvailable?null:n.lastConsentAvailable.obtainedOn,"d MMMM, y"))}}function wi(e,t){if(1&e&&(I.Vb(0),I.Xb(1,"h4",35),I.Xc(2),I.jc(3,"translate"),I.Wb(),I.Xb(4,"p",31),I.Xc(5),I.jc(6,"date"),I.Wb(),I.Ub()),2&e){var n=I.ic(2);I.Db(2),I.Yc(I.kc(3,2,"CONSENT.VERBAL_CONSENT_DENIED")),I.Db(3),I.Yc(I.lc(6,4,null==n.lastConsentAvailable?null:n.lastConsentAvailable.obtainedOn,"d MMMM, y"))}}function Li(e,t){if(1&e){var n=I.Yb();I.Vb(0),I.Xb(1,"h4",35),I.Xc(2),I.jc(3,"translate"),I.Wb(),I.Xb(4,"p",31),I.Xc(5),I.jc(6,"date"),I.Wb(),I.Xb(7,"a",36),I.ec("click",function(){return I.Lc(n),I.ic(2).viewConsentDeniedDetails()}),I.Xc(8),I.jc(9,"translate"),I.Sb(10,"span",33),I.Wb(),I.Ub()}if(2&e){var i=I.ic(2);I.Db(2),I.Yc(I.kc(3,3,"CONSENT.VERBAL_CONSENT_DENIED")),I.Db(3),I.Yc(I.lc(6,5,null==i.lastConsentAvailable?null:i.lastConsentAvailable.obtainedOn,"d MMMM, y")),I.Db(3),I.Zc(" ",I.kc(9,8,"CONSENT.VIEW_DETAILS")," ")}}function xi(e,t){if(1&e&&(I.Xb(0,"span",49),I.Sb(1,"app-icons",50),I.Xc(2),I.jc(3,"translate"),I.Wb()),2&e){var n=I.ic(4);I.Db(1),I.rc("altColorScheme","VERBAL_CONSENT"===(null==n.lastConsentAvailable?null:n.lastConsentAvailable.type)),I.Db(1),I.Zc(" ",I.kc(3,2,"CONSENT.PLAY")," ")}}function Vi(e,t){if(1&e&&(I.Xb(0,"span",49),I.Sb(1,"app-icons",51),I.Xc(2),I.jc(3,"translate"),I.Wb()),2&e){var n=I.ic(4);I.Db(1),I.rc("altColorScheme","VERBAL_CONSENT"===(null==n.lastConsentAvailable?null:n.lastConsentAvailable.type)),I.Db(1),I.Zc(" ",I.kc(3,2,"CONSENT.PAUSE")," ")}}var Ui=function(e){return{"consent-disabled":e}};function Fi(e,t){if(1&e){var n=I.Yb();I.Xb(0,"div",38),I.Xb(1,"div",41),I.Xb(2,"label"),I.Xc(3),I.jc(4,"translate"),I.Wb(),I.Xb(5,"p",45),I.ec("click",function(){I.Lc(n);var e=I.ic(3);return e.paused?e.playVoiceRecording():e.pause()}),I.Vc(6,xi,4,4,"span",46),I.Vc(7,Vi,4,4,"span",46),I.Xc(8," \xa0\xa0 "),I.Xb(9,"span",47),I.ec("click",function(){I.Lc(n);var e=I.ic(3);return e.openConsentCertificate(e.lastConsentAvailable)}),I.Sb(10,"app-icons",48),I.Xc(11),I.jc(12,"translate"),I.Wb(),I.Wb(),I.Wb(),I.Wb()}if(2&e){var i=I.ic(3);I.Db(1),I.rc("ngClass",I.yc(11,Ui,"VERBAL_CONSENT"!==(null==i.lastConsentAvailable?null:i.lastConsentAvailable.type))),I.Db(2),I.Yc(I.kc(4,7,"CONSENT.AUDIO_CALL_RECORDING")),I.Db(2),I.rc("nzType","VERBAL_CONSENT"===(null==i.lastConsentAvailable?null:i.lastConsentAvailable.type)?"success":"-"),I.Db(1),I.rc("ngIf",i.paused),I.Db(1),I.rc("ngIf",!i.paused),I.Db(3),I.rc("altColorScheme","VERBAL_CONSENT"===(null==i.lastConsentAvailable?null:i.lastConsentAvailable.type)),I.Db(1),I.Zc(" ",I.kc(12,9,"CONSENT.VIEW")," ")}}function ji(e,t){if(1&e){var n=I.Yb();I.Vb(0),I.Sb(1,"br"),I.Xb(2,"div",37),I.Xb(3,"div",38),I.Xb(4,"h4",39),I.Xc(5),I.Wb(),I.Xb(6,"label"),I.Xc(7),I.jc(8,"date"),I.Wb(),I.Wb(),I.Vc(9,Fi,13,13,"div",40),I.Xb(10,"div",38),I.Xb(11,"div",41),I.Xb(12,"label"),I.Xc(13),I.jc(14,"translate"),I.Wb(),I.Xb(15,"p",42),I.ec("click",function(){I.Lc(n);var e=I.ic(2);return e.view(e.lastConsentAvailable.consent)}),I.Sb(16,"app-icons",43),I.Xc(17),I.jc(18,"translate"),I.Wb(),I.Wb(),I.Wb(),I.Wb(),I.Xb(19,"label",44),I.Xc(20),I.jc(21,"translate"),I.jc(22,"date"),I.Wb(),I.Ub()}if(2&e){var i=I.ic(2);I.Db(5),I.Zc("",i.consentType[null==i.lastConsentAvailable?null:i.lastConsentAvailable.type]," obtained"),I.Db(2),I.Zc("on ",I.lc(8,10,null==i.lastConsentAvailable?null:i.lastConsentAvailable.obtainedOn,"mediumDate"),""),I.Db(2),I.rc("ngIf","VERBAL_CONSENT"===(null==i.lastConsentAvailable?null:i.lastConsentAvailable.type)),I.Db(2),I.rc("ngClass",I.yc(22,Ui,"VERBAL_CONSENT"===(null==i.lastConsentAvailable?null:i.lastConsentAvailable.type))),I.Db(2),I.Yc(I.kc(14,13,"CONSENT.CONSENT_FORM_CERTIFICATE")),I.Db(2),I.rc("nzType","VERBAL_CONSENT"!==(null==i.lastConsentAvailable?null:i.lastConsentAvailable.type)?"success":"-"),I.Db(1),I.rc("altColorScheme","VERBAL_CONSENT"!==(null==i.lastConsentAvailable?null:i.lastConsentAvailable.type)),I.Db(1),I.Zc(" ",I.kc(18,15,"CONSENT.VIEW")," "),I.Db(3),I.ad(" ",I.kc(21,17,"CONSENT.VALID_TILL")," ",I.lc(22,19,null==i.lastConsentAvailable?null:i.lastConsentAvailable.validTill,"mediumDate")," ")}}function Yi(e,t){if(1&e&&(I.Vb(0),I.Vc(1,Wi,31,30,"ng-container",2),I.Vc(2,Ri,9,4,"ng-container",2),I.Vc(3,ki,7,7,"ng-container",2),I.Vc(4,wi,7,7,"ng-container",2),I.Vc(5,Li,11,10,"ng-container",2),I.Vc(6,ji,23,24,"ng-container",2),I.Ub()),2&e){var n=I.ic();I.Db(1),I.rc("ngIf",null==n.lastConsentAvailable||"IN_PROGRESS"==(null==n.lastConsentAvailable?null:n.lastConsentAvailable.consentStatus)||"REVOKED"==(null==n.lastConsentAvailable?null:n.lastConsentAvailable.consentStatus)),I.Db(1),I.rc("ngIf","DIGITAL_CONSENT"===n.consentMedium&&!("OBTAINED"==(null==n.lastConsentAvailable?null:n.lastConsentAvailable.consentStatus)||"DENIED"==(null==n.lastConsentAvailable?null:n.lastConsentAvailable.consentStatus))),I.Db(1),I.rc("ngIf","DIGITAL_CONSENT"===n.consentMedium&&"DENIED"==(null==n.lastConsentAvailable?null:n.lastConsentAvailable.consentStatus)),I.Db(1),I.rc("ngIf","SMS_CONSENT"===n.consentMedium&&"DENIED"==(null==n.lastConsentAvailable?null:n.lastConsentAvailable.consentStatus)),I.Db(1),I.rc("ngIf","VERBAL_CONSENT"==(null==n.lastConsentAvailable?null:n.lastConsentAvailable.type)&&"DENIED"==(null==n.lastConsentAvailable?null:n.lastConsentAvailable.consentStatus)),I.Db(1),I.rc("ngIf","OBTAINED"==(null==n.lastConsentAvailable?null:n.lastConsentAvailable.consentStatus))}}var Gi,Bi,Hi,Zi=((Gi=function(){function n(e,t,i,a,o,s,l,r,d,u,b,p,f,v){var h=this;c(this,n),this._drawerService=e,this._modalService=t,this.episodeService=i,this._patientsService=a,this._userService=o,this._dataSharingService=s,this.router=l,this._notificationsService=r,this._episodesService=d,this.translationService=u,this.consentService=b,this.consentScriptService=p,this._episodesEventLogger=f,this._ngProgress=v,this.episodeChange=new I.n,this.rootUrl=Pt.g.url,this.consentFormRequest=new vn,this.episodeBlueprint=new pn.b,this.paused=!0,this.fileList=[],this.viaAppDesc="",this.viaSMSDesc="",this.viaDigitalConsentDesc="",this.strings=["CONSENT.CONFIGURE_CONSENT_SCRIPT","CONSENT.DIGITAL_CONSENT","CONSENT.UNABLE_TO_UPLOAD_FILE","CONSENT.PATIENT_CONSENT_ADDED","CONSENT.PATIENT_CONSENT_REMOVED","CONSENT.ARE_YOU_SURE","CONSENT.RECORDING_NOT_FOUND","CONSENT.RECORDING_REQUIRED","CONSENT.REVOKE_SUCCESSFUL_TITLE","CONSENT.SAVE_SUCCESSFUL","CONSENT.UPDATE_FAILED","CONSENT.REVOKE_BUTTON","CONSENT.REVOKE_SUCCESSFUL_MESSAGE","CONSENT.DENY_SUCCESSFUL_MESSAGE","CONSENT.DENY_CONSENT","CONSENT.REVOKED_SUCCESS","CONSENT.VIA_DIGITAL_SIGNATURE_DESCRIPTION","CONSENT.VIA_APP_DESCRIPTION","CONSENT.VIA_SMS_DESCRIPTION","CONSENT.VIA_DIGITAL_SIGNATURE_DESCRIPTION","DOCTORS_ORDER.INVALID_ADDRESS_NOT_ASSIGNED_MESSAGE","DOCTORS_ORDER.MR_NUMBER_NOT_ASSIGNED_MESSAGE","CONSENT.ACCEPT_CONSENT","CONSENT.ACCEPT_SUCCESSFUL_MESSAGE","COMMON.PHYSICIAN"],this.availableConsentMap=new Map,this.consentType={VERBAL_CONSENT:"Verbal consent",APP_CONSENT:"App consent",SMS_CONSENT:"SMS Consent",MANUAL_CONSENT:"Manual consent",DIGITAL_CONSENT:"Digital consent"},this.nzBeforeUpload=function(e,t){h.file=e},this.handleUpload=function(e){h._episodesEventLogger.episodeConsentActionEvent(h.episodeId,h.patientId,"consent_upload_triggered","MANUAL_CONSENT"),h.loading=!0,h._episodesService.uploadConsent(e.file.name,e.file,h.patientId,"PATIENT_CONSENTS").subscribe(function(e){var t=e.filename;h._episodesEventLogger.episodeConsentActionEvent(h.episodeId,h.patientId,"consent_upload_success","MANUAL_CONSENT",t),h.saveManualConsent(t)},function(){h._notificationsService.error("Episode","Unable to upload file!"),h._episodesEventLogger.episodeConsentActionEvent(h.episodeId,h.patientId,"consent_upload_failure","MANUAL_CONSENT")},function(){h.loading=!1})}}return u(n,[{key:"episodeSetter",set:function(e){this.episodeDetails=e,this.patientId=this.episodeDetails.patientId,this.episodeId=this.episodeDetails.id,this.episodeType=this.episodeDetails.type,this.setConsentForms(this.episodeDetails.availableConsents),this.checkIfConsentEnabled()}},{key:"ngOnInit",value:function(){var e=this;this.initTranslationStrings(),this.getTenantConfig(),this.consentScriptSubscription$=this.consentScriptService.getShowConsentScriptObservable().subscribe(function(t){return t?e.showConsentScript():e.hideConsentScript()}),this._dataSharingService.getLoggedInUserName().subscribe(function(t){e.assignerName=t||e.translatedStrings.get("COMMON.PHYSICIAN")})}},{key:"ngOnDestroy",value:function(){this.audio&&(this.audio.pause(),this.audio=null),this.consentScriptSubscription$.unsubscribe()}},{key:"initTranslationStrings",value:function(){var e,n=this;this.$translationSubscription=(e=this.translationService).getMultiple.apply(e,t(this.strings)).subscribe(function(e){var t,i;n.translatedStrings=e,n.viaAppDesc=null===(t=n.translatedStrings.get("CONSENT.VIA_APP_DESCRIPTION"))||void 0===t?void 0:t.replace("{EPISODE_NAME}",n.episodeType),n.viaSMSDesc=null===(i=n.translatedStrings.get("CONSENT.VIA_SMS_DESCRIPTION"))||void 0===i?void 0:i.replace("{EPISODE_NAME}",n.episodeType),n.viaDigitalConsentDesc=n.translatedStrings.get("CONSENT.VIA_DIGITAL_SIGNATURE_DESCRIPTION").replace("{EPISODE_NAME}",n.episodeType)})}},{key:"play",value:function(){var e=this;this._episodesEventLogger.episodeConsentActionEvent(this.episodeId,this.patientId,"play_consent_audio"),null==this.audio?(this.audio=new Audio(this.consentSrc),this.audio.addEventListener("ended",function(t){e.paused=!0})):this.paused||(this.audio.src=this.consentSrc),this.paused=!1,this.audio.play()}},{key:"pause",value:function(){this.paused=!0,this.audio.pause()}},{key:"populateConsentFiles",value:function(){null!=this.episodeDetails.availableConsents&&this.episodeDetails.availableConsents.length>0&&this.setConsentForms(this.episodeDetails.availableConsents)}},{key:"getTenantConfig",value:function(){var t=this;this._dataSharingService.tenantSettings.subscribe(function(n){if(null!=n){var i,a=e(n.episodeBlueprints);try{for(a.s();!(i=a.n()).done;){var o=i.value;o.type===t.episodeDetails.type&&(t.episodeBlueprint=o)}}catch(s){a.e(s)}finally{a.f()}}})}},{key:"checkIfConsentEnabled",value:function(){var e,t,n=this;null===(t=null===(e=this.episodeDetails)||void 0===e?void 0:e.patientPhoneNumbers)||void 0===t||t.forEach(function(e){var t,i;(null==e?void 0:e.preferred)&&((null===(t=null==e?void 0:e.notificationConfig.SMS)||void 0===t?void 0:t.enabled)&&"MOBILE"===(null==e?void 0:e.type)&&(n.consentSMSEnabled=!0),(null===(i=null==e?void 0:e.notificationConfig.CALL)||void 0===i?void 0:i.enabled)&&(n.verbalConsentEnabled=!0))})}},{key:"showScript",value:function(){this.consentScriptService.setShowConsentScriptObservable(!0)}},{key:"setConsentForms",value:function(e){var t;if(null!=e){var n=e.filter(function(e){return e.consentStatus===dn.b.OBTAINED});this.lastConsentAvailable=(null==n||0==n.length?e:n).filter(function(e){return e.consentStatus!=dn.b.REVOKED}).reduce(function(e,t){return(null==e?void 0:e.createdOn)>t.createdOn?e:t},null)}if(this.consentMedium=null===(t=this.lastConsentAvailable)||void 0===t?void 0:t.type,this.consentMedium==dn.a.APP_CONSENT||this.consentMedium==dn.a.SMS_CONSENT||this.consentMedium==dn.a.MANUAL_CONSENT&&this.lastConsentAvailable.consentStatus===dn.b.OBTAINED&&this.lastConsentAvailable.consent){var i=this.lastConsentAvailable.consent;this.lastConsentAvailable.fileName=(null==i?void 0:i.startsWith("http"))?null==i?void 0:i.split(":")[2]:null==i?void 0:i.substring((null==i?void 0:i.lastIndexOf(":"))+1,null==i?void 0:i.length)}}},{key:"showConsentScript",value:function(){var e=this,t="";this.drawer||null!=this.episodeBlueprint&&(this._episodesEventLogger.episodeConsentActionEvent(this.episodeId,this.patientId,"show_consentScript"),this.episodeBlueprint.consentComponent&&this.episodeBlueprint.consentComponent.consentScriptHtml?t=this.episodeBlueprint.consentComponent.consentScriptHtml:(this.episodeBlueprint.consentComponent=new pn.a,t=this.translatedStrings.get("CONSENT.CONFIGURE_CONSENT_SCRIPT"),this.episodeBlueprint.consentComponent.consentScriptHtml=this.translatedStrings.get("CONSENT.CONFIGURE_CONSENT_SCRIPT")),this.drawer=this._drawerService.create({nzContent:rn,nzContentParams:{htmlContent:t},nzWidth:400,nzMask:!0,nzMaskClosable:!1,nzZIndex:1e3}),this.drawer.afterClose.subscribe(function(t){e.drawer=null}))}},{key:"hideConsentScript",value:function(){null!=this.drawer&&this.drawer.close()}},{key:"onVerbalCallInitiate",value:function(e){var t=this;this.drawer&&this.drawer.close(null),this._userService.getCallSettings(localStorage.getItem("loggedInUser")).subscribe(function(n){t._episodesEventLogger.episodeConsentActionEvent(t.episodeId,t.patientId,t.consentMedium.toLowerCase()),null==n||n.showInstructions?t.showAudioInfoAndProceedToCallPopupModal(e):t.launchVoiceCall(e)},function(n){t.showAudioInfoAndProceedToCallPopupModal(e)})}},{key:"showAudioInfoAndProceedToCallPopupModal",value:function(e){var t=this;this._modalService.create({nzTitle:null,nzContent:cn,nzFooter:null,nzBodyStyle:{height:"430px",padding:"50px"},nzWidth:630,nzZIndex:1e3}).afterClose.subscribe(function(n){(null==n?void 0:n.hidePopup)&&t.hideCallInformationForThisUser(),(null==n?void 0:n.continueToCall)&&t.launchVoiceCall(e)})}},{key:"hideCallInformationForThisUser",value:function(){var e=new Ln;e.showInstructions=!1,this._userService.updateCallSettings(localStorage.getItem("loggedInUser"),e).subscribe(function(){})}},{key:"launchVoiceCall",value:function(e){var t=this;this.consentCallInProgress=!0,this.consentService.createConsentCallSubject(),this._patientsService.getSpecificUser(this.patientId).subscribe(function(n){var i={patient:n,toNumber:e,enableRecording:!0,context:hn.a.PATIENT_CONSENT};t._episodesEventLogger.episodeConsentActionEvent(t.episodeId,t.patientId,"launch_voiceCall"),t._dataSharingService.setVoiceCallInitiated(i)}),this.consentService.onConsentCallDisconnect().subscribe(function(e){e&&(t.consentFormRequest.type=dn.a.VERBAL_CONSENT,t.consentFormRequest.sourceId=e.voicecallSessionId,t.consentFormRequest.consent=e.callRecordingUri,t._episodesEventLogger.episodeConsentActionEvent(t.episodeId,t.patientId,"disconnect_voiceCall"),t.onVoiceCallEnd())},function(e){return console.log("Error getting voice call details : ",e)})}},{key:"onVoiceCallEnd",value:function(){var e=this;this.consentService.unsubscribeFromConsentCallSubject(),this._dataSharingService.setVoiceCallInitiated(null),this._dataSharingService.setVoicecallDisconnectTrigger(!0),this.drawer&&this.drawer.close(null),this.consentCallInProgress=!1,this._modalService.create({nzContent:un,nzComponentParams:{episodeType:this.episodeDetails.type},nzBodyStyle:{height:"150px",padding:"50px"},nzStyle:{top:"40%"},nzFooter:null,nzWidth:600}).afterClose.subscribe(function(t){t&&(e.consentFormRequest.consentStatus=dn.b[t],e.consentFormRequest.consentStatus==dn.b.OBTAINED?(e._episodesEventLogger.episodeConsentActionEvent(e.episodeId,e.patientId,"consent_obtained"),e.saveVerbalConsent(null)):e.consentFormRequest.consentStatus==dn.b.DENIED?(e._episodesEventLogger.episodeConsentActionEvent(e.episodeId,e.patientId,"consent_denied"),e.addConsentDeniedDetails()):e.consentFormRequest.consentStatus==dn.b.IN_PROGRESS&&(e._episodesEventLogger.episodeConsentActionEvent(e.episodeId,e.patientId,"consent_in_progress"),e.addConsentInProgressDetails()))})}},{key:"addConsentDeniedDetails",value:function(){var e=this;this._modalService.create({nzContent:Wn,nzComponentParams:{patientId:this.patientId},nzBodyStyle:{height:"400px"},nzWidth:470,nzFooter:null,nzClosable:!1,nzMaskClosable:!1}).afterClose.subscribe(function(t){e.saveVerbalConsent(t)})}},{key:"addConsentInProgressDetails",value:function(){var e=this;this._modalService.create({nzContent:kn,nzComponentParams:{patientId:this.patientId},nzBodyStyle:{height:"400px"},nzWidth:470,nzFooter:null,nzClosable:!1,nzMaskClosable:!1}).afterClose.subscribe(function(t){e.saveVerbalConsent(t)})}},{key:"viewConsentDeniedDetails",value:function(){this._modalService.create({nzContent:En,nzComponentParams:{noteId:this.lastConsentAvailable.noteId},nzBodyStyle:{height:"400px"},nzWidth:470,nzFooter:null,nzClosable:!1,nzMaskClosable:!1})}},{key:"viewConsentInProgressDetails",value:function(){this._modalService.create({nzContent:Mn,nzComponentParams:{patientId:this.patientId},nzBodyStyle:{height:"400px"},nzWidth:470,nzFooter:null,nzClosable:!1,nzMaskClosable:!1})}},{key:"playVoiceRecording",value:function(){if(this.consentSrc)this.play();else{var e=this.lastConsentAvailable.consent;if(null==e||""===e)return void this._notificationsService.error("Patient Consent",this.translatedStrings.get("CONSENT.RECORDING_NOT_FOUND"));var t="https://api.twilio.com/"+e;t=t.replace(".json",".mp3"),this.consentSrc=t,this.play()}}},{key:"saveVerbalConsent",value:function(e){var t=this;this.consentFormRequest.consentStatus!==dn.b.OBTAINED||null!=this.consentFormRequest.consent?(this.consentFormRequest.episodeType=this.episodeDetails.type,this.consentFormRequest.consentee=this.episodeDetails.patientId,this.consentFormRequest.noteId=null==e?void 0:e.id,this.episodeService.saveConsentDetails(this.consentFormRequest).subscribe(function(n){t.consentFormRequest.consentStatus===dn.b.DENIED?t.episodeService.suspendEpisode(t.episodeId,{assignerId:e.assignerId,archived:e.archived,reason:e.reason}).subscribe(function(e){t.episodeChange.emit(!0)}):t.episodeChange.emit(!0),t._notificationsService.create("success",t.translatedStrings.get("CONSENT.SAVE_SUCCESSFUL"),null)},function(e){t._notificationsService.error(t.translatedStrings.get("CONSENT.UPDATE_FAILED"),e)})):this._notificationsService.error("Patient Consent",this.translatedStrings.get("CONSENT.RECORDING_REQUIRED"))}},{key:"saveManualConsent",value:function(e){var t=this;this.consentFormRequest.episodeType=this.episodeDetails.type,this.consentFormRequest.consentee=this.episodeDetails.patientId,this.consentFormRequest.type=dn.a.MANUAL_CONSENT,this.consentFormRequest.consent=e,this.episodeService.saveConsentDetails(this.consentFormRequest).subscribe(function(e){t.episodeChange.emit(!0),t._notificationsService.create("success",t.translatedStrings.get("CONSENT.SAVE_SUCCESSFUL"),null)},function(e){t._notificationsService.error(t.translatedStrings.get("CONSENT.UPDATE_FAILED"),e)})}},{key:"openConsentCertificate",value:function(e){this._episodesEventLogger.episodeConsentActionEvent(this.episodeId,this.patientId,"open_consent_certificate"),this.router.navigate(["episodes/consentCertificate/",this.episodeId],{queryParams:{consentId:e.id}})}},{key:"revokeType",value:function(e){return"SMS_CONSENT"==e.type?mi:Vn}},{key:"revokeConsent",value:function(e){var t=this;this._episodesEventLogger.episodeConsentActionEvent(this.episodeId,this.patientId,"consent_revoke_triggered",e.type),this._modalService.create({nzContent:this.revokeType(e),nzWidth:500,nzBodyStyle:{height:"462px",padding:"20px",borderRadius:"20px"},nzFooter:null,nzKeyboard:!1,nzClosable:!0,nzMaskClosable:!1}).afterClose.subscribe(function(n){var i={reason:n.toString()};t._episodesService.revokeConsent(e.id,i).subscribe(function(n){t._episodesEventLogger.episodeConsentActionEvent(t.episodeId,t.patientId,"consent_revoked",e.type),t.episodeChange.emit(!0),t.populateConsentFiles(),t._notificationsService.create("success",t.translatedStrings.get("CONSENT.REVOKE_SUCCESSFUL_TITLE"),t.translatedStrings.get("CONSENT.REVOKE_SUCCESSFUL_MESSAGE"))})})}},{key:"getConsentFormDateOfSubmission",value:function(e){var t;return this.patientConsents.forEach(function(n){n.url.includes(e)&&(t=n.dateOfSubmission)}),t}},{key:"view",value:function(e){var t;this._episodesEventLogger.episodeConsentActionEvent(this.episodeId,this.patientId,"download_consent"),t=e.startsWith("http")?"filename=".concat(e.substring(e.lastIndexOf("/")+1,e.length)):"filename=".concat(e,"&asset-type=PATIENT_CONSENTS");var n="".concat(this.rootUrl,"/v1/assets/view?").concat(t);this._episodesEventLogger.downloadSuccessReportEvent(this.patientId,e,"patients_consent","patients_consent"),window.open(n,"_blank")}},{key:"getPatientConsentViaApp",value:function(){var e=this;this._episodesService.assignConsentTaskViaApp(this.episodeId).subscribe(function(t){e._episodesEventLogger.episodeConsentActionEvent(e.episodeId,e.patientId,e.consentMedium.toLowerCase()),e._notificationsService.info("Patient Consent",t.message),e.episodeChange.emit(!0)},function(e){return console.log("Assigning Consent Via App failed : ",e)})}},{key:"getPatientConsentViaSMS",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._episodesService.assignConsentTaskViaSMS(this.episodeId).subscribe(function(n){e._patientsService.getSpecificUser(e.patientId).subscribe(function(i){e.sendSMS(n.message,e.patientId,i.fullName,t)})},function(e){return console.log("Assigning Consent Via SMS failed : ",e)})}},{key:"sendSMS",value:function(e,t,n){var i=this,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=this._modalService.create({nzContent:hi,nzComponentParams:{patientList:[this.convertUserToPatientModel(t,n)],smsLink:e,patientId:this.patientId,assignerName:this.assignerName,showFilter:!1,usePrimaryNumber:a},nzStyle:{width:"800px"},nzFooter:null,nzKeyboard:!1,nzClosable:!0,nzMaskClosable:!0});o.afterClose.subscribe(function(e){null!=e&&"SUCCESS"==o.componentInstance.message&&(i._episodesEventLogger.episodeConsentActionEvent(i.episodeId,i.patientId,i.consentMedium.toLowerCase()),i.episodeChange.emit(!0))})}},{key:"convertUserToPatientModel",value:function(e,t){var n=new Un.a;return n.patientId=e,n.patientName=t,n}},{key:"getDigitalConsent",value:function(){var e=this;this._modalService.create({nzContent:Ht,nzComponentParams:{patientId:this.patientId,episodeType:this.episodeType},nzFooter:null,nzWidth:1e3,nzClosable:!0,nzMaskClosable:!1}).afterClose.subscribe(function(t){"AGREE"==t&&e.acceptConsent(),"DENY"==t&&e.denyConsent()})}},{key:"acceptConsent",value:function(){var e=this;this._episodesService.submitConsent({consentType:"DIGITAL_CONSENT",episodeId:this.episodeId,patientId:this.patientId}).subscribe(function(t){e._episodesEventLogger.episodeConsentActionEvent(e.episodeId,e.patientId,"consent_accepted","DIGITAL_CONSENT"),e.episodeChange.emit(!0),e._dataSharingService.triggerAlertRefresh(),e.populateConsentFiles(),e._notificationsService.create("success",e.translatedStrings.get("CONSENT.DIGITAL_CONSENT"),e.translatedStrings.get("CONSENT.PATIENT_CONSENT_ADDED"))})}},{key:"denyConsent",value:function(){var e=this;this._modalService.create({nzContent:Wn,nzComponentParams:{patientId:this.patientId},nzWidth:470,nzFooter:null,nzClosable:!1,nzMaskClosable:!1}).afterClose.subscribe(function(t){var n,i,a={reason:t.reason,consentType:"DIGITAL_CONSENT",episodeId:e.episodeId,consentId:null};null===(i=null===(n=e._ngProgress)||void 0===n?void 0:n.ref())||void 0===i||i.start(),e._episodesService.denyConsent(a).subscribe(function(t){var n,i;e._episodesEventLogger.episodeConsentActionEvent(e.episodeId,e.patientId,"consent_denied","DIGITAL_CONSENT"),null===(i=null===(n=e._ngProgress)||void 0===n?void 0:n.ref())||void 0===i||i.complete(),e._dataSharingService.triggerAlertRefresh(),e._notificationsService.create("success",e.translatedStrings.get("CONSENT.DENY_CONSENT"),e.translatedStrings.get("CONSENT.DENY_SUCCESSFUL_MESSAGE")),e.router.navigate(["patient/view/"+e.patientId],{queryParams:{tab:"episodes"}})})})}}]),n}()).\u0275fac=function(e){return new(e||Gi)(I.Rb(Ci.d),I.Rb(He.f),I.Rb(bn.a),I.Rb(m.a),I.Rb(wn.a),I.Rb(te.a),I.Rb(_.g),I.Rb(T.b),I.Rb(C.a),I.Rb(J.a),I.Rb(fn.a),I.Rb(ln.a),I.Rb(Ye.a),I.Rb(Di.a))},Gi.\u0275cmp=I.Lb({type:Gi,selectors:[["app-patient-consent"]],inputs:{episodeSetter:["episodeDetails","episodeSetter"]},outputs:{episodeChange:"episodeChange"},decls:7,vars:5,consts:[["nz-typography",""],["nzSimple","",4,"ngIf"],[4,"ngIf"],["nzSimple",""],[3,"ngModel","ngModelChange"],["nz-radio","","nzValue","APP_CONSENT",3,"nzDisabled"],["nz-radio","","nzValue","SMS_CONSENT",3,"nzDisabled"],["nz-radio","","nzValue","VERBAL_CONSENT",3,"nzDisabled"],["nz-radio","","nzValue","MANUAL_CONSENT",3,"nzDisabled"],["nz-radio","","nzValue","DIGITAL_CONSENT",3,"nzDisabled"],["class","in-progress-box",4,"ngIf"],["nz-dropdown","","nzSize","large","nz-button","","nzShape","circle",1,"consent-round-btn",3,"disabled","nzDropdownMenu"],["size","23px","color","#A7C853","altColor","#a7c853","name","phone"],["menu","nzDropdownMenu"],["nz-menu","","nzSelectable",""],[4,"ngFor","ngForOf"],["nzSize","large","nz-button","","nzShape","circle","nz-tooltip","","nzTooltipPlacement","right",1,"consent-round-btn",3,"nzTooltipTitle","click"],["size","23px","color","#a7c853","altColor","#a7c853","name","formFilled"],["nz-menu-item","",3,"click",4,"ngIf"],["nz-menu-item","",3,"click"],["nz-typography","","nzType","secondary",1,"phone-label"],["nz-typography","","nzType","success",1,"phone-span"],[1,"phone-span"],[2,"margin-top","10px"],["size","23px","color","#a7c853","strokeColor","#a7c853","name","direct"],["nzSize","large","nz-button","","nzShape","circle","nz-tooltip","","nzTooltipPlacement","right","nz-dropdown","",1,"consent-round-btn",3,"nzTooltipTitle","nzDropdownMenu"],["menuSMS","nzDropdownMenu"],[3,"nzShowButton","nzCustomRequest","nzShowUploadList","nzBeforeUpload"],["nz-button","","nzType","primary",2,"min-width","160px","min-height","40px"],[1,"in-progress-box"],["nzSize","small","nzDanger","","nzType","default","nz-button","","nz-tooltip","","nzTooltipPlacement","top",1,"revoke-btn",3,"nzTooltipTitle","click"],[1,"greyed-text"],["nz-button","","nzType","link",3,"click"],[1,"dot"],["nz-button","","nzType","primary",3,"click"],["nz-typography","",1,"consent-status","denied-text"],[1,"view-details",3,"click"],["nz-row","","nzGutter","32"],["nz-col","","nzXs","24","nzSm","12","nzMd","6"],["nz-typography","","nzType","success"],["nz-col","","nzXs","24","nzSm","12","nzMd","6",4,"ngIf"],[1,"consent-container",3,"ngClass"],["actionable","","nz-typography","",3,"nzType","click"],["size","14px","color","#a7c853","strokeColor","#a7c853","name","view",3,"altColorScheme"],["id","validTill"],["nz-typography","",3,"nzType","click"],["actionable","",4,"ngIf"],["actionable","",3,"click"],["size","12px","color","#a7c853","strokeColor","#a7c853","name","view",3,"altColorScheme"],["actionable",""],["size","12px","color","#a7c853","strokeColor","#a7c853","name","play",3,"altColorScheme"],["size","12px","color","#a7c853","strokeColor","#a7c853","name","pauseCircle",3,"altColorScheme"]],template:function(e,t){1&e&&(I.Xb(0,"nz-card"),I.Xb(1,"h3",0),I.Xc(2),I.jc(3,"translate"),I.Wb(),I.Vc(4,Si,1,0,"nz-spin",1),I.Vc(5,Yi,7,6,"ng-container",2),I.Wb(),I.Sb(6,"br")),2&e&&(I.Db(2),I.Yc(I.kc(3,3,"CONSENT.PATIENT_CONSENT")),I.Db(2),I.rc("ngIf",t.loading),I.Db(1),I.rc("ngIf",!t.loading))},directives:[z.a,P.a,r.q,fe.a,k.c,v.u,v.x,k.b,kt.a,wt.a,X.b,L.a,X.d,ve.a,X.e,y.c,r.p,it.d,y.e,$t.a,N.c,N.a,r.o,nt.a],pipes:[se.a,r.A,r.e],styles:["nz-card[_ngcontent-%COMP%]{padding:10px;text-align:left}h3[_ngcontent-%COMP%]{margin-bottom:0}nz-spin[_ngcontent-%COMP%]{text-align:center}nz-radio-group[_ngcontent-%COMP%]{width:100%;margin-top:20px;display:flex;flex-direction:row;flex-wrap:wrap;align-content:space-between;row-gap:20px}nz-radio-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{width:30%}.consent-round-btn[_ngcontent-%COMP%]{margin:25px 25px 25px 0;text-align:center;width:50px;height:50px;padding:11px}.consent-round-btn[_ngcontent-%COMP%], button[_ngcontent-%COMP%]:hover{border:2px solid var(--primary-color)}td[_ngcontent-%COMP%] > app-icons[_ngcontent-%COMP%]{cursor:pointer}td[_ngcontent-%COMP%] > app-icons[_ngcontent-%COMP%] + app-icons[_ngcontent-%COMP%]{margin-left:20px}.ant-modal-content[_ngcontent-%COMP%]{border-radius:20px}.consent-status[_ngcontent-%COMP%]{margin-top:30px;margin-bottom:0;font-weight:400}.denied-text[_ngcontent-%COMP%]{color:#ff3939}.obtained-text[_ngcontent-%COMP%]{color:var(--primary-color)}.in-progress-box[_ngcontent-%COMP%]{border-radius:10px;background:#f6f6f6 0 0 no-repeat padding-box;height:70px;max-width:100%;margin-top:10px;padding:25px;text-align:left;line-height:1px}.in-progress-box[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#000;text-align:left;padding:0}.in-progress-box[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:20px}.dot[_ngcontent-%COMP%]{height:7px;width:7px;margin-left:3px;margin-bottom:2px}div[_ngcontent-%COMP%] > nz-card[_ngcontent-%COMP%]{display:inline-block;min-width:-webkit-fit-content;min-width:-moz-fit-content;min-width:fit-content;width:90%;height:110px;border:1px solid #dcdcdc;border-radius:10px;background-color:#f5f5f5;padding:4px;margin-left:5%}div[_ngcontent-%COMP%] > nz-card[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#8a8a8a}div[_ngcontent-%COMP%] > nz-card[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-weight:600}div[_ngcontent-%COMP%] > nz-card[_ngcontent-%COMP%] .ant-card-body{padding:10px}div[_ngcontent-%COMP%] > nz-card[_ngcontent-%COMP%]:hover{background:var(--neutral-color);border:1px solid var(--primary-color)}div[_ngcontent-%COMP%] > nz-card[_ngcontent-%COMP%]:hover   a[_ngcontent-%COMP%]{color:var(--primary-color)}div[_ngcontent-%COMP%] > nz-card[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{line-height:1.2}.consent-pending-text[_ngcontent-%COMP%]{text-align:left;font:normal normal normal 14px/20px Nunito;letter-spacing:0;color:#0f2015;opacity:1}.date[_ngcontent-%COMP%]{color:#888}.view-details[_ngcontent-%COMP%]{margin-top:20px;color:#0f2015}.dot[_ngcontent-%COMP%]{height:5px;width:5px;background-color:#0080ff;border-radius:50%;display:inline-block}.revoke-btn[_ngcontent-%COMP%]{float:right;position:relative;color:#ff3939;border-color:#ff3939}.revoke-btn[_ngcontent-%COMP%]:hover{color:#ff3939;border-color:#ff3939!important} .ant-drawer-right.ant-drawer-open.no-mask{width:0}.manual-consent-col[_ngcontent-%COMP%]{text-align:center!important}.revoke-btn[_ngcontent-%COMP%]{margin:0;height:auto;top:-12px;width:auto!important;height:42px!important}.consent-container[_ngcontent-%COMP%]{width:100%;border-radius:10px;border:1px solid #dcdcdc;padding:30px 15px 15px!important}.consent-container[_ngcontent-%COMP%]:hover{box-shadow:0 3px 6px #00000029;border:1px solid #8bc34a}.consent-container[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600}.consent-disabled[_ngcontent-%COMP%]{background:#f5f5f5 0 0 no-repeat padding-box;pointer-events:none}#validTill[_ngcontent-%COMP%]{display:block;margin-top:-25px}app-icons[_ngcontent-%COMP%]{vertical-align:text-top}.phone-label[_ngcontent-%COMP%]{font-size:11px}.phone-span[_ngcontent-%COMP%]{font-size:12px}"]}),Gi),qi=function(e){return e.INITIAL_SMS="INITIAL_SMS",e.CONTACT_ATTEMPT="CONTACT_ATTEMPT",e}({}),$i=function(){return{minRows:6,maxRows:10}},Ki=((Bi=function(){function e(t){c(this,e),this._modalRef=t}return u(e,[{key:"save",value:function(){this._modalRef.close({startDateTime:this.dateTime,message:this.message,type:qi.INITIAL_SMS,successful:!0})}}]),e}()).\u0275fac=function(e){return new(e||Bi)(I.Rb(He.e))},Bi.\u0275cmp=I.Lb({type:Bi,selectors:[["app-initial-sms-event"]],decls:24,vars:4,consts:[["id","heading"],["nz-row","","nzGutter","16"],["nz-col","","nzSpan","24"],["nz-col","","nzSpan","12"],["nzPlaceHolder","Select Date/Time","nzShowTime","",3,"ngModel","ngModelChange"],["nz-input","","placeholder","SMS content",3,"ngModel","nzAutosize","ngModelChange"],["nz-col","","nzOffset","21","nzSpan","3"],["nz-button","","nzType","primary",3,"click"]],template:function(e,t){1&e&&(I.Xb(0,"strong",0),I.Xc(1,"Log Initial SMS"),I.Wb(),I.Sb(2,"br"),I.Sb(3,"br"),I.Xb(4,"div",1),I.Xb(5,"div",2),I.Xb(6,"strong"),I.Xc(7,"Select SMS date/time:"),I.Wb(),I.Wb(),I.Wb(),I.Xb(8,"div",1),I.Xb(9,"div",3),I.Xb(10,"nz-date-picker",4),I.ec("ngModelChange",function(e){return t.dateTime=e}),I.Wb(),I.Wb(),I.Wb(),I.Sb(11,"br"),I.Xb(12,"div",1),I.Xb(13,"div",2),I.Xb(14,"strong"),I.Xc(15,"Enter message:"),I.Wb(),I.Wb(),I.Wb(),I.Xb(16,"div",1),I.Xb(17,"div",2),I.Xb(18,"textarea",5),I.ec("ngModelChange",function(e){return t.message=e}),I.Wb(),I.Wb(),I.Wb(),I.Sb(19,"br"),I.Xb(20,"div",1),I.Xb(21,"div",6),I.Xb(22,"button",7),I.ec("click",function(){return t.save()}),I.Xc(23,"Save"),I.Wb(),I.Wb(),I.Wb()),2&e&&(I.Db(10),I.rc("ngModel",t.dateTime),I.Db(8),I.rc("ngModel",t.message)("nzAutosize",I.xc(3,$i)))},directives:[N.c,N.a,oe.a,v.u,v.x,W.b,v.d,W.a,kt.a,wt.a,L.a],styles:["#heading[_ngcontent-%COMP%]{padding-left:1%;font-size:14px;font-weight:600;border-left:3px solid var(--primary-color)}button[_ngcontent-%COMP%]{width:100%}"]}),Bi),Qi=function(){return{minRows:6,maxRows:10}},Ji=((Hi=function(){function e(t){c(this,e),this._modalRef=t}return u(e,[{key:"save",value:function(){this._modalRef.close({startDateTime:this.dateTime,message:this.message,type:qi.CONTACT_ATTEMPT,successful:this.successful})}}]),e}()).\u0275fac=function(e){return new(e||Hi)(I.Rb(He.e))},Hi.\u0275cmp=I.Lb({type:Hi,selectors:[["app-contact-attempt-event"]],decls:30,vars:7,consts:[["id","heading"],["nz-row","","nzGutter","16"],["nz-col","","nzSpan","12"],["nzPlaceHolder","Select Date/Time","nzShowTime","",3,"ngModel","ngModelChange"],[3,"ngModel","ngModelChange"],["nz-radio-button","",3,"nzValue"],["nz-col","","nzSpan","24"],["nz-input","","placeholder","Contact attempt notes...",3,"ngModel","nzAutosize","ngModelChange"],["nz-col","","nzOffset","21","nzSpan","3"],["nz-button","","nzType","primary",3,"click"]],template:function(e,t){1&e&&(I.Xb(0,"strong",0),I.Xc(1,"Log Contact Attempt"),I.Wb(),I.Sb(2,"br"),I.Sb(3,"br"),I.Xb(4,"div",1),I.Xb(5,"div",2),I.Xb(6,"strong"),I.Xc(7,"Select Attempt date/time:"),I.Wb(),I.Wb(),I.Wb(),I.Xb(8,"div",1),I.Xb(9,"div",2),I.Xb(10,"nz-date-picker",3),I.ec("ngModelChange",function(e){return t.dateTime=e}),I.Wb(),I.Wb(),I.Xb(11,"div",2),I.Xb(12,"nz-radio-group",4),I.ec("ngModelChange",function(e){return t.successful=e}),I.Xb(13,"label",5),I.Xc(14,"Successful"),I.Wb(),I.Xb(15,"label",5),I.Xc(16,"Failed"),I.Wb(),I.Wb(),I.Wb(),I.Wb(),I.Sb(17,"br"),I.Xb(18,"div",1),I.Xb(19,"div",6),I.Xb(20,"strong"),I.Xc(21,"Enter message:"),I.Wb(),I.Wb(),I.Wb(),I.Xb(22,"div",1),I.Xb(23,"div",6),I.Xb(24,"textarea",7),I.ec("ngModelChange",function(e){return t.message=e}),I.Wb(),I.Wb(),I.Wb(),I.Sb(25,"br"),I.Xb(26,"div",1),I.Xb(27,"div",8),I.Xb(28,"button",9),I.ec("click",function(){return t.save()}),I.Xc(29,"Save"),I.Wb(),I.Wb(),I.Wb()),2&e&&(I.Db(10),I.rc("ngModel",t.dateTime),I.Db(2),I.rc("ngModel",t.successful),I.Db(1),I.rc("nzValue",!0),I.Db(2),I.rc("nzValue",!1),I.Db(9),I.rc("ngModel",t.message)("nzAutosize",I.xc(6,Qi)))},directives:[N.c,N.a,oe.a,v.u,v.x,k.c,k.b,k.a,W.b,v.d,W.a,kt.a,wt.a,L.a],styles:["#heading[_ngcontent-%COMP%]{padding-left:1%;font-size:14px;font-weight:600;border-left:3px solid var(--primary-color)}button[_ngcontent-%COMP%]{width:100%}"]}),Hi),ea=o("ncdi"),ta=o("fhRi");function na(e,t){1&e&&(I.Xb(0,"label"),I.Xc(1," No episode events have been logged yet "),I.Wb())}function ia(e,t){if(1&e&&(I.Vb(0),I.Sb(1,"br"),I.Xb(2,"p"),I.Xb(3,"strong"),I.Xc(4,"Message: "),I.Wb(),I.Xc(5),I.Wb(),I.Ub()),2&e){var n=I.ic(3);I.Db(5),I.Yc(null==n.attempt?null:n.attempt.message)}}function aa(e,t){if(1&e&&(I.Xb(0,"nz-timeline-item",13),I.Xc(1," Initial SMS was sent at "),I.Xb(2,"strong"),I.Xc(3),I.jc(4,"utcToLocalTime"),I.jc(5,"utcToLocalTime"),I.Wb(),I.Vc(6,ia,6,1,"ng-container",9),I.Wb()),2&e){var n=I.ic().$implicit,i=I.ic();I.Db(3),I.Zc(" ",I.kc(4,2,null==n||null==n.value[0]?null:n.value[0].startDateTime)||I.kc(5,4,null==n||null==n.value[0]?null:n.value[0].createdAt)," "),I.Db(3),I.rc("ngIf",null==i.attempt||null==i.attempt.message?null:i.attempt.message.length)}}function oa(e,t){if(1&e&&(I.Vb(0),I.Sb(1,"br"),I.Xb(2,"p"),I.Xb(3,"strong"),I.Xc(4,"Message: "),I.Wb(),I.Xc(5),I.Wb(),I.Ub()),2&e){var n=I.ic(2).$implicit;I.Db(5),I.Yc(null==n?null:n.message)}}function sa(e,t){if(1&e&&(I.Vb(0),I.Xc(1," Patient contacted successfully at "),I.Xb(2,"strong"),I.Xc(3),I.jc(4,"utcToLocalTime"),I.jc(5,"utcToLocalTime"),I.Wb(),I.Vc(6,oa,6,1,"ng-container",9),I.Ub()),2&e){var n=I.ic().$implicit;I.Db(3),I.Zc(" ",I.kc(4,2,null==n?null:n.startDateTime)||I.kc(5,4,null==n?null:n.createdAt)," "),I.Db(3),I.rc("ngIf",null==n||null==n.message?null:n.message.length)}}function la(e,t){if(1&e&&(I.Vb(0),I.Sb(1,"br"),I.Xb(2,"p"),I.Xb(3,"strong"),I.Xc(4,"Message: "),I.Wb(),I.Xc(5),I.Wb(),I.Ub()),2&e){var n=I.ic(2).$implicit;I.Db(5),I.Yc(null==n?null:n.message)}}function ra(e,t){if(1&e&&(I.Vb(0),I.Xc(1," Failed to contact patient at "),I.Xb(2,"strong"),I.Xc(3),I.jc(4,"utcToLocalTime"),I.jc(5,"utcToLocalTime"),I.Wb(),I.Vc(6,la,6,1,"ng-container",9),I.Ub()),2&e){var n=I.ic().$implicit;I.Db(3),I.Zc(" ",I.kc(4,2,null==n?null:n.startDateTime)||I.kc(5,4,null==n?null:n.createdAt)," "),I.Db(3),I.rc("ngIf",null==n||null==n.message?null:n.message.length)}}function ca(e,t){if(1&e&&(I.Xb(0,"nz-timeline-item",15),I.Vc(1,sa,7,6,"ng-container",9),I.Vc(2,ra,7,6,"ng-container",9),I.Wb()),2&e){var n=t.$implicit;I.rc("nzColor",n.successful?"blue":"red"),I.Db(1),I.rc("ngIf",n.successful),I.Db(1),I.rc("ngIf",!n.successful)}}function da(e,t){if(1&e&&(I.Vb(0),I.Vc(1,ca,3,3,"nz-timeline-item",14),I.Ub()),2&e){var n=I.ic().$implicit,i=null;I.Db(1),I.rc("ngForOf",null==n||null==n.value||null==(i=n.value.slice())?null:i.reverse())}}function ua(e,t){if(1&e&&(I.Vb(0),I.Vc(1,aa,7,6,"nz-timeline-item",12),I.Vc(2,da,2,1,"ng-container",9),I.Ub()),2&e){var n=t.$implicit;I.Db(1),I.rc("ngIf","INITIAL_SMS"===(null==n?null:n.key)),I.Db(1),I.rc("ngIf","CONTACT_ATTEMPT"===(null==n?null:n.key))}}var ba,pa=function(e){return{disabled:e}},fa=((ba=function(){function e(t,n,i){c(this,e),this._modalService=t,this._episodeService=n,this._notificationsService=i,this.objectKeys=Object.keys,this.refreshEpisode=new I.n,this.eventsMap=new Map}return u(e,[{key:"ngOnInit",value:function(){var e=this;this._episodeService.fetchEpisodeEvents(this.episodeDetails.id).subscribe(function(t){e.eventsMap=t})}},{key:"logInitialSMS",value:function(){var e=this;this._modalService.create({nzContent:Ki,nzWidth:"700px",nzFooter:null}).afterClose.subscribe(function(t){var n;t&&e._episodeService.postEpisodeEvent(e.episodeDetails.id,null===(n=e.episodeDetails)||void 0===n?void 0:n.patientId,t).subscribe(function(){e._notificationsService.success("Episode Event","SMS logged successfully!"),e.refreshEpisodeState()})})}},{key:"logContactAttempt",value:function(){var e=this;this._modalService.create({nzContent:Ji,nzComponentParams:{},nzWidth:"700px",nzFooter:null}).afterClose.subscribe(function(t){if(t){var n=e.eventsMap.CONTACT_ATTEMPT;2<=(null==n?void 0:n.length)&&!(null==t?void 0:t.successful)?e._modalService.confirm({nzTitle:"Confirm",nzContent:"A 'Trying to contact you' letter will be sent to the patient once this failed contact attempt is logged, Are you sure you want to continue?",nzOkText:"Ok",nzCancelText:"Cancel",nzOnOk:function(){return e.postContactAttempt(t)}}):e.postContactAttempt(t)}})}},{key:"postContactAttempt",value:function(e){var t,n=this;this._episodeService.postEpisodeEvent(this.episodeDetails.id,null===(t=this.episodeDetails)||void 0===t?void 0:t.patientId,e).subscribe(function(){n._notificationsService.success("Episode Event","Contact attempt logged successfully!"),n.refreshEpisodeState()})}},{key:"refreshEpisodeState",value:function(){this.refreshEpisode.emit(!0)}}]),e}()).\u0275fac=function(e){return new(e||ba)(I.Rb(He.f),I.Rb(C.a),I.Rb(T.b))},ba.\u0275cmp=I.Lb({type:ba,selectors:[["app-toc-events"]],inputs:{episodeDetails:"episodeDetails"},outputs:{refreshEpisode:"refreshEpisode"},decls:24,vars:13,consts:[["nz-row",""],["nz-col","","nzXs","24","nzSm","18","nzMd","18"],["nz-typography",""],["nz-col","","nzSpan","6","id","actions"],["nz-button","","nzType","primary","nz-dropdown","",3,"nzDropdownMenu","nzPlacement"],["menu","nzDropdownMenu"],["nz-menu",""],["nz-menu-item","",3,"ngClass","click"],["nz-col","","nzXs","24","nzSm","18","nzMd","21"],[4,"ngIf"],[3,"nzReverse"],[4,"ngFor","ngForOf"],["nzColor","green",4,"ngIf"],["nzColor","green"],[3,"nzColor",4,"ngFor","ngForOf"],[3,"nzColor"]],template:function(e,t){if(1&e&&(I.Xb(0,"nz-card"),I.Xb(1,"div",0),I.Xb(2,"div",1),I.Xb(3,"h3",2),I.Xc(4,"Episode events"),I.Wb(),I.Wb(),I.Xb(5,"div",3),I.Xb(6,"button",4),I.Xc(7," Log Event "),I.Wb(),I.Xb(8,"nz-dropdown-menu",null,5),I.Xb(10,"ul",6),I.Xb(11,"li",7),I.ec("click",function(){return t.logInitialSMS()}),I.Xc(12," Log Initial SMS "),I.Wb(),I.Xb(13,"li",7),I.ec("click",function(){return t.logContactAttempt()}),I.Xc(14," Log Contact Attempt "),I.Wb(),I.Wb(),I.Wb(),I.Wb(),I.Wb(),I.Vb(15),I.Sb(16,"br"),I.Xb(17,"div",0),I.Xb(18,"div",8),I.Vc(19,na,2,0,"label",9),I.Xb(20,"nz-timeline",10),I.Vc(21,ua,3,2,"ng-container",11),I.jc(22,"keyvalue"),I.Wb(),I.Wb(),I.Wb(),I.Ub(),I.Wb(),I.Sb(23,"br")),2&e){var n=I.Ic(9),i=null;I.Db(6),I.rc("nzDropdownMenu",n)("nzPlacement","bottomRight"),I.Db(5),I.rc("ngClass",I.yc(9,pa,!!t.eventsMap.INITIAL_SMS)),I.Db(2),I.rc("ngClass",I.yc(11,pa,!t.eventsMap.INITIAL_SMS||3<=(null==t.eventsMap.CONTACT_ATTEMPT?null:t.eventsMap.CONTACT_ATTEMPT.length))),I.Db(6),I.rc("ngIf",!t.eventsMap||!(null!=(i=t.objectKeys(t.eventsMap))&&i.length)),I.Db(1),I.rc("nzReverse",!0),I.Db(1),I.rc("ngForOf",I.kc(22,7,t.eventsMap))}},directives:[z.a,N.c,N.a,P.a,kt.a,wt.a,L.a,X.d,X.b,X.e,y.c,y.e,r.o,r.q,ea.a,r.p,ea.b],pipes:[r.j,ta.a],styles:[".ant-card[_ngcontent-%COMP%]{padding:10px}h3[_ngcontent-%COMP%]{margin-bottom:0}#actions[_ngcontent-%COMP%]{text-align:right}.disabled[_ngcontent-%COMP%]{color:gray;pointer-events:none}label[_ngcontent-%COMP%]{font:normal normal normal 13px/16px Nunito;color:var(--tertiary-color);margin-bottom:5px;display:block}"]}),ba),va=o("vDSh"),ha=o("OE57"),ga=o("SKKP"),ma=o("KupA"),Ca=o("Edj7"),Da=o("Ujc4");function Sa(e,t){1&e&&I.Sb(0,"nz-ribbon",11)}function Ea(e,t){if(1&e){var n=I.Yb();I.Xb(0,"a",13),I.ec("nzOnConfirm",function(){return I.Lc(n),I.ic(2).deleteAppointment()}),I.jc(1,"translate"),I.Sb(2,"app-icons",14),I.Wb()}2&e&&I.sc("nzPopconfirmTitle",I.kc(1,1,"APPOINTMENT.REMOVE_APPOINTMENT"))}function Oa(e,t){if(1&e&&I.Vc(0,Ea,3,3,"a",12),2&e){var n=I.ic();I.rc("ngIf","FINISHED"==!(null!=n.appointment&&n.appointment.overallStatus))}}function Ia(e,t){if(1&e&&I.Sb(0,"app-icons",15),2&e){var n=I.ic();I.tc("routerLink","/appointments/details/",null==n.appointment?null:n.appointment.id,"")}}function _a(e,t){if(1&e){var n=I.Yb();I.Vb(0),I.Xb(1,"app-video-call-widget",17),I.ec("click",function(){I.Lc(n);var e=I.ic(2);return e.logAction("video_call",e.patientId)}),I.Wb(),I.Ub()}if(2&e){var i=I.ic(2);I.Db(1),I.rc("userId",i.patientId)("appointmentId",null==i.appointment?null:i.appointment.id)}}function Ta(e,t){if(1&e){var n=I.Yb();I.Vb(0),I.Xb(1,"app-audio-call-widget",18),I.ec("click",function(){I.Lc(n);var e=I.ic(2);return e.logAction("audio_call",null==e.appointment?null:e.appointment.attendeeId)}),I.Wb(),I.Ub()}if(2&e){var i=I.ic(2);I.Db(1),I.rc("userId",i.patientId)("phoneNumbers",i.phoneNumbers)("disabled","FINISHED"==(null==i.appointment?null:i.appointment.overallStatus))("renderVital",!1)("appointmentId",null==i.appointment?null:i.appointment.id)("appointmentSessionId",null==i.appointment?null:i.appointment.videoCallSessionId)}}function Xa(e,t){if(1&e&&(I.Vc(0,_a,2,2,"ng-container",16),I.Vc(1,Ta,2,6,"ng-container",16)),2&e){var n=I.ic();I.rc("ngIf","VIDEO_CALL"==(null==n.appointment?null:n.appointment.appointmentType)),I.Db(1),I.rc("ngIf","AUDIO_CALL"==(null==n.appointment?null:n.appointment.appointmentType))}}var ya,Na,za=function(e,t){return[e,t]},Ma=((Na=function(){function e(t,n,i,a){c(this,e),this._appointmentsService=t,this._notificationsService=n,this._translationService=i,this._episodesEventLogger=a,this.bodyStyle={height:"82px"},this.deleteEvent=new I.n}return u(e,[{key:"deleteAppointment",value:function(){var e,t=this;this._appointmentsService.setAppointmentAsDeleted(null===(e=this.appointment)||void 0===e?void 0:e.id).subscribe(function(){t._episodesEventLogger.episodeAppointmentsEvent(t.episodeId,t.patientId,t.appointment.id,"episode_delete_appointment"),t._translationService.getMultiple("FORM.APPOINTMENT","APPOINTMENT.APPOINTMENT_DELETE").subscribe(function(e){t._notificationsService.success(e.get("FORM.APPOINTMENT"),e.get("APPOINTMENT.APPOINTMENT_DELETE"))}),t.emitDeleteSuccessfullEvent()})}},{key:"emitDeleteSuccessfullEvent",value:function(){this.deleteEvent.emit()}}]),e}()).\u0275fac=function(e){return new(e||Na)(I.Rb(ha.a),I.Rb(T.b),I.Rb(J.a),I.Rb(Ye.a))},Na.\u0275cmp=I.Lb({type:Na,selectors:[["app-upcoming-episode-appointment"]],inputs:{episodeId:"episodeId",patientId:"patientId",staffMap:"staffMap",appointment:"appointment",phoneNumbers:"phoneNumbers"},outputs:{deleteEvent:"deleteEvent"},decls:22,vars:17,consts:[["nzText","Completed","nzStandalone","",4,"ngIf"],[1,"appointment-container",3,"nzTitle","nzHoverable","nzActions","nzExtra","nzSize","nzBodyStyle"],["nz-row",""],["nz-col","","nzSpan","12"],["nz-typography","","nzType","secondary"],["nz-col","","nzSpan","12",2,"text-align","right"],[1,"time"],["nz-col","","nzSpan","24"],["delete",""],["view",""],["call",""],["nzText","Completed","nzStandalone",""],["nz-popconfirm","",3,"nzPopconfirmTitle","nzOnConfirm",4,"ngIf"],["nz-popconfirm","",3,"nzPopconfirmTitle","nzOnConfirm"],["size","16px","name","delete"],["size","16px","name","view",3,"routerLink"],[4,"ngIf"],[3,"userId","appointmentId","click"],[3,"userId","phoneNumbers","disabled","renderVital","appointmentId","appointmentSessionId","click"]],template:function(e,t){if(1&e&&(I.Vc(0,Sa,1,0,"nz-ribbon",0),I.Xb(1,"nz-card",1),I.jc(2,"date"),I.Xb(3,"div"),I.Xb(4,"div",2),I.Xb(5,"div",3),I.Xb(6,"label",4),I.Xc(7,"Clinician"),I.Wb(),I.Wb(),I.Xb(8,"div",5),I.Xb(9,"label",6),I.Xc(10),I.jc(11,"titlecase"),I.Wb(),I.Wb(),I.Wb(),I.Xb(12,"div",2),I.Xb(13,"div",7),I.Xb(14,"strong"),I.Xc(15),I.Wb(),I.Wb(),I.Wb(),I.Wb(),I.Vc(16,Oa,1,1,"ng-template",null,8,I.Wc),I.Vc(18,Ia,1,1,"ng-template",null,9,I.Wc),I.Vc(20,Xa,2,2,"ng-template",null,10,I.Wc),I.Wb()),2&e){var n=I.Ic(17),i=I.Ic(19),a=I.Ic(21);I.rc("ngIf","FINISHED"==(null==t.appointment?null:t.appointment.overallStatus)),I.Db(1),I.sc("nzTitle",I.lc(2,9,null==t.appointment?null:t.appointment.startsOn,"d MMM y")),I.rc("nzHoverable",!0)("nzActions",I.zc(14,za,i,a))("nzExtra",n)("nzSize","small")("nzBodyStyle",t.bodyStyle),I.Db(9),I.Yc(I.kc(11,12,null==t.appointment?null:t.appointment.timeSlot)),I.Db(5),I.Yc(t.staffMap[null==t.appointment?null:t.appointment.attenderId])}},directives:[r.q,z.a,N.c,N.a,P.a,ga.c,ma.a,ve.a,_.h,Ca.a,Da.a],pipes:[r.e,r.A,se.a],styles:[".appointment-container[_ngcontent-%COMP%]{border-radius:10px;border:1px solid #dcdcdc;padding:10px!important;margin:5px;height:182px}.date[_ngcontent-%COMP%]{font-weight:600;color:var(--primary-color)}.date[_ngcontent-%COMP%], .time[_ngcontent-%COMP%]{display:unset}.time[_ngcontent-%COMP%]{font-size:12.5px;border-radius:2px;padding:2px 10px;background:#f5f5f5 0 0 no-repeat padding-box}label[_ngcontent-%COMP%]{font:normal normal normal 13px/16px Nunito;color:var(--tertiary-color);margin-bottom:5px;display:block}[_nghost-%COMP%]     .ant-ribbon.ant-ribbon-placement-end{right:-3px;color:var(--neutral-color);z-index:100}[_nghost-%COMP%]     .ant-card-hoverable:hover{box-shadow:3px 5px 5px #00000036}"]}),Na),Aa=((ya=function(){function e(){c(this,e)}return u(e,[{key:"transform",value:function(e,t){var n,i,a=!1;return(null===(n=Object.keys(null==e?void 0:e.serviceCodes))||void 0===n?void 0:n.length)||(a=!0),null===(i=null==e?void 0:e.availableConsents)||void 0===i||i.forEach(function(n){dn.b.OBTAINED===(null==n?void 0:n.consentStatus)&&(null==n?void 0:n.episodeType)===(null==e?void 0:e.type)?a=!0:"DST"!==t||dn.b.IN_PROGRESS!==(null==n?void 0:n.consentStatus)||"APP_CONSENT"!==(null==n?void 0:n.type)&&"SMS_CONSENT"!==(null==n?void 0:n.type)||(a=!0)}),a}}]),e}()).\u0275fac=function(e){return new(e||ya)},ya.\u0275pipe=I.Qb({name:"validConsent",type:ya,pure:!0}),ya);function Pa(e,t){if(1&e){var n=I.Yb();I.Vb(0),I.Xb(1,"div",8),I.Xb(2,"button",9),I.ec("click",function(){return I.Lc(n),I.ic().addAppointment()}),I.jc(3,"validConsent"),I.Xc(4," Create Appointment "),I.Wb(),I.Wb(),I.Ub()}if(2&e){var i=I.ic();I.Db(2),I.rc("disabled","CCM"!==(null==i.episodeDetails?null:i.episodeDetails.type)&&!I.lc(3,1,i.episodeDetails,"DST"))}}function Wa(e,t){1&e&&(I.Xb(0,"label"),I.Xc(1),I.jc(2,"translate"),I.Wb()),2&e&&(I.Db(1),I.Yc(I.kc(2,1,"APPOINTMENTS.NOUPCOMING")))}function Ra(e,t){if(1&e){var n=I.Yb();I.Xb(0,"div",10),I.Xb(1,"app-upcoming-episode-appointment",11),I.ec("deleteEvent",function(){return I.Lc(n),I.ic().refreshEpisodeState()}),I.Wb(),I.Wb()}if(2&e){var i=t.$implicit,a=I.ic();I.Db(1),I.rc("appointment",i)("episodeId",null==a.episodeDetails?null:a.episodeDetails.id)("patientId",null==a.episodeDetails?null:a.episodeDetails.patientId)("staffMap",null==a.episodeDetails?null:a.episodeDetails.monitoringStaff)("phoneNumbers",null==a.user?null:a.user.phoneNumbers)}}var ka,wa=function(){return["ADD_APPOINTMENT"]},La=((ka=function(){function e(t,n,i){c(this,e),this._dateComparePipe=t,this._notificationsService=n,this._router=i,this.refreshEpisode=new I.n}return u(e,[{key:"ngOnInit",value:function(){var e=this;this.appointments=new Array,this.episodeDetails.appointments.forEach(function(t){"FINISHED"!=t.overallStatus&&e.appointments.push(t)}),this.episodeDetails.appointments.forEach(function(t){"FINISHED"==t.overallStatus&&e.appointments.push(t)})}},{key:"addAppointment",value:function(){var e,t,n;!this._dateComparePipe.transform(this.episodeDetails.endDate)||"IN_PROGRESS"!==this.episodeDetails.status&&"SCHEDULED"!==this.episodeDetails.status?this._notificationsService.error("Episode Suspended","This episode has been suspended and no further activities can be assigned."):this._router.navigate(["appointments/create",null===(e=this.episodeDetails)||void 0===e?void 0:e.patientId],{queryParams:{episodeId:(null===(t=this.episodeDetails)||void 0===t?void 0:t.id)||"",episodeType:(null===(n=this.episodeDetails)||void 0===n?void 0:n.type)||"",fromEpisode:!0}})}}]),e}()).\u0275fac=function(e){return new(e||ka)(I.Rb(va.a),I.Rb(T.b),I.Rb(_.g))},ka.\u0275cmp=I.Lb({type:ka,selectors:[["app-appointment"]],inputs:{episodeDetails:"episodeDetails",user:"user"},outputs:{refreshEpisode:"refreshEpisode"},features:[I.Cb([va.a])],decls:14,vars:7,consts:[["nz-row",""],["nz-col","","nzSpan","21"],["nz-typography",""],[4,"isFeaturePermitted"],["nz-col","","nzSpan","24"],[4,"ngIf"],["nz-row","","nzGutter","8"],["nz-col","","nzSpan","6",4,"ngFor","ngForOf"],["nz-col","","nzSpan","3","id","actions"],["nz-button","","nzType","primary","nzSize","large",3,"disabled","click"],["nz-col","","nzSpan","6"],[3,"appointment","episodeId","patientId","staffMap","phoneNumbers","deleteEvent"]],template:function(e,t){1&e&&(I.Xb(0,"nz-card"),I.Xb(1,"div",0),I.Xb(2,"div",1),I.Xb(3,"h3",2),I.Xc(4),I.jc(5,"translate"),I.Wb(),I.Wb(),I.Vc(6,Pa,5,4,"ng-container",3),I.Wb(),I.Xb(7,"div",0),I.Xb(8,"div",4),I.Sb(9,"br"),I.Vc(10,Wa,3,3,"label",5),I.Xb(11,"div",6),I.Vc(12,Ra,2,5,"div",7),I.Wb(),I.Wb(),I.Wb(),I.Wb(),I.Sb(13,"br")),2&e&&(I.Db(4),I.Yc(I.kc(5,4,"MENU.APPOINTMENT")),I.Db(2),I.rc("isFeaturePermitted",I.xc(6,wa)),I.Db(4),I.rc("ngIf",!(null!=t.episodeDetails&&null!=t.episodeDetails.appointments&&t.episodeDetails.appointments.length)),I.Db(2),I.rc("ngForOf",t.appointments))},directives:[z.a,N.c,N.a,P.a,Et.a,r.q,r.p,kt.a,wt.a,L.a,Ma],pipes:[se.a,Aa],styles:[".ant-card[_ngcontent-%COMP%]{padding:10px}h3[_ngcontent-%COMP%]{margin-bottom:0}label[_ngcontent-%COMP%]{font:normal normal normal 13px/16px Nunito;color:var(--tertiary-color);margin-bottom:5px;display:block}#actions[_ngcontent-%COMP%]{text-align:right}"]}),ka),xa=o("gDH+"),Va=o("rMZv");function Ua(e,t){1&e&&(I.Xb(0,"label"),I.Xc(1," No device has been setup yet "),I.Wb())}function Fa(e,t){if(1&e){var n=I.Yb();I.Vb(0),I.Xb(1,"button",7),I.ec("click",function(){return I.Lc(n),I.ic().showDeviceSetupModal()}),I.jc(2,"validConsent"),I.Xc(3),I.jc(4,"translate"),I.Wb(),I.Xc(5," \xa0 "),I.Ub()}if(2&e){var i=I.ic();I.Db(1),I.rc("disabled",!I.lc(2,2,i.episodeDetails,"DST")||"SCHEDULED"!==(null==i.episodeDetails?null:i.episodeDetails.status)&&"IN_PROGRESS"!==(null==i.episodeDetails?null:i.episodeDetails.status)),I.Db(2),I.Zc(" ",I.kc(4,5,"EPISODE.EDU_TASK")," ")}}function ja(e,t){if(1&e){var n=I.Yb();I.Vb(0),I.Xc(1," \xa0 "),I.Xb(2,"button",9),I.ec("click",function(){return I.Lc(n),I.ic(2).showDeviceSetupModal(!0)}),I.jc(3,"validConsent"),I.Xc(4),I.jc(5,"translate"),I.Wb(),I.Ub()}if(2&e){var i=I.ic(2);I.Db(2),I.rc("disabled",!I.lc(3,2,i.episodeDetails,"DST")||"SCHEDULED"!==(null==i.episodeDetails?null:i.episodeDetails.status)&&"IN_PROGRESS"!==(null==i.episodeDetails?null:i.episodeDetails.status)),I.Db(2),I.Zc(" ",I.kc(5,5,"APPOINTMENT.RESCHEDULE")," ")}}function Ya(e,t){if(1&e&&(I.Vb(0),I.Vc(1,ja,6,7,"ng-container",3),I.Xb(2,"button",8),I.Xc(3),I.jc(4,"translate"),I.Wb(),I.Ub()),2&e){var n=I.ic();I.Db(1),I.rc("ngIf",!1),I.Db(1),I.tc("routerLink","/appointments/details/",null==n.appointment?null:n.appointment.id,""),I.rc("disabled","SCHEDULED"!==(null==n.episodeDetails?null:n.episodeDetails.status)&&"IN_PROGRESS"!==(null==n.episodeDetails?null:n.episodeDetails.status)),I.Db(1),I.Zc(" ",I.kc(4,4,"APPOINTMENT.VIEW_APPOINTMENT")," ")}}var Ga=function(e){return{"shaded-row":e}};function Ba(e,t){if(1&e){var n=I.Yb();I.Xb(0,"tr",13),I.Xb(1,"td"),I.Xc(2),I.Wb(),I.Xb(3,"td"),I.Xc(4),I.Wb(),I.Xb(5,"td"),I.Xc(6),I.jc(7,"date"),I.Wb(),I.Xb(8,"td"),I.Xc(9),I.Wb(),I.Xb(10,"td"),I.Xc(11),I.jc(12,"date"),I.Wb(),I.Xb(13,"td"),I.Xb(14,"a",14),I.ec("nzOnConfirm",function(){I.Lc(n);var e=t.$implicit;return I.ic(2).completeDST(null==e?null:e.id)}),I.Xb(15,"button",15),I.jc(16,"validConsent"),I.Xc(17," Mark as complete "),I.Wb(),I.Wb(),I.Wb(),I.Wb()}if(2&e){var i=t.$implicit,a=t.index,o=I.ic(2);I.rc("ngClass",I.yc(15,Ga,a%2!=0)),I.Db(2),I.Yc(null==i?null:i.name),I.Db(2),I.Yc(null==o.episodeDetails?null:o.episodeDetails.monitoringStaff[null==o.appointment?null:o.appointment.attenderId]),I.Db(2),I.Yc(I.lc(7,7,null==i?null:i.scheduledAt,"mediumDate")),I.Db(3),I.Yc(null!=i&&i.completed?"Completed":"Pending"),I.Db(2),I.Yc(I.lc(12,10,null==i?null:i.completedAt,"mediumDate")||"N/A"),I.Db(4),I.rc("disabled",(null==i?null:i.completed)||!I.kc(16,13,o.episodeDetails))}}var Ha=function(){return{x:"1175px"}};function Za(e,t){if(1&e&&(I.Vb(0),I.Sb(1,"br"),I.Xb(2,"nz-table",10,11),I.Xb(4,"thead"),I.Xb(5,"tr"),I.Xb(6,"th"),I.Xc(7),I.jc(8,"translate"),I.Wb(),I.Xb(9,"th"),I.Xc(10,"Assigned to"),I.Wb(),I.Xb(11,"th"),I.Xc(12),I.jc(13,"translate"),I.Wb(),I.Xb(14,"th"),I.Xc(15),I.jc(16,"translate"),I.Wb(),I.Xb(17,"th"),I.Xc(18),I.jc(19,"translate"),I.Wb(),I.Sb(20,"th"),I.Wb(),I.Wb(),I.Xb(21,"tbody"),I.Vc(22,Ba,18,17,"tr",12),I.Wb(),I.Wb(),I.Ub()),2&e){var n=I.Ic(3),i=I.ic();I.Db(2),I.rc("nzData",null==i.episodeDetails?null:i.episodeDetails.deviceSetupTasks)("nzScroll",I.xc(15,Ha)),I.Db(5),I.Yc(I.kc(8,7,"COMMON.TITLE")),I.Db(5),I.Yc(I.kc(13,9,"PATIENT.SECHEDULED_ON")),I.Db(3),I.Yc(I.kc(16,11,"COMMON.STATUS")),I.Db(3),I.Yc(I.kc(19,13,"TABLEHEADER.COMPLETEDON")),I.Db(4),I.rc("ngForOf",n.data)}}var qa,$a=((qa=function(){function e(t,n,i,a,o,s,l){var r=this;c(this,e),this._episodesService=t,this._dataSharingService=n,this._translationsService=i,this._episodesEventLogger=a,this._notificationsService=o,this._bt105CreateModalService=s,this._episodesModalService=l,this.refreshEpisode=new I.n,this.cloudDevices=["BT105","PY802LTE","PY300LTE","BT005","BGMD1","SMCLBS","SM5000IB","SMCOX","GM291V"],this.translatedStrings=new Map,this.translations$=this._translationsService.getMultiple("EPISODE","EPISODE.DEVICE_SETUP_TASK","EPISODE.DST.NO_DEVICES_ENABLED","EPISODE.UNABLE_TO_ASSIGN_DST_NO_CLINICIAN").subscribe(function(e){return r.translatedStrings=e})}return u(e,[{key:"episode",set:function(e){this.episodeDetails=e,this.getAppointment()}},{key:"ngAfterViewInit",value:function(){this.getAppointment(),this.getDevices()}},{key:"ngOnDestroy",value:function(){var e,t;null===(e=this.tenantConfig$)||void 0===e||e.unsubscribe(),null===(t=this.translations$)||void 0===t||t.unsubscribe()}},{key:"getAppointment",value:function(){var e,t,n,i=null===(e=this.episodeDetails)||void 0===e?void 0:e.deviceSetupTasks[0];i&&(this.appointment=null===(n=null===(t=this.episodeDetails)||void 0===t?void 0:t.appointments)||void 0===n?void 0:n.find(function(e){return e.id===(null==i?void 0:i.appointmentId)}))}},{key:"getDevices",value:function(){var e=this;this._episodesService.fetchDeviceSpecifications().subscribe(function(t){e.tenantConfig$=e._dataSharingService.tenantSettings.subscribe(function(n){t&&n&&(e.tenantConfig=n,e.devices=t.filter(function(t){return-1!==n.deviceConfig.supportedDevices.findIndex(function(n){return n===t.model||-1!==e.cloudDevices.indexOf(t.model)})}))})})}},{key:"validate",value:function(){var e,t,n,i,a;return(null===(n=null===(t=null===(e=this.tenantConfig)||void 0===e?void 0:e.deviceConfig)||void 0===t?void 0:t.supportedDevices)||void 0===n?void 0:n.length)?!!(null===(a=Object.keys(null===(i=this.episodeDetails)||void 0===i?void 0:i.monitoringStaff))||void 0===a?void 0:a.length)||(this._notificationsService.warning(this.translatedStrings.get("EPISODE.DEVICE_SETUP_TASK"),this.translatedStrings.get("EPISODE.UNABLE_TO_ASSIGN_DST_NO_CLINICIAN")),!1):(this._notificationsService.error(this.translatedStrings.get("EPISODE.DEVICE_SETUP_TASK"),this.translatedStrings.get("EPISODE.DST.NO_DEVICES_ENABLED")),!1)}},{key:"showDeviceSetupModal",value:function(){var e,t,n=this,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.validate()){var a=localStorage.getItem("loggedInUserRole");if(h.a.MONITORING_STAFF===a){var o=localStorage.getItem("loggedInUser");Object.keys(null===(e=this.episodeDetails)||void 0===e?void 0:e.monitoringStaff).filter(function(e){return o!==e}).forEach(function(e){var t;return null===(t=n.episodeDetails)||void 0===t||delete t.monitoringStaff[e]})}this._episodesModalService.createDeviceSetupTaskModal(null===(t=this.episodeDetails)||void 0===t?void 0:t.monitoringStaff,this.devices,this.patient).afterClose.subscribe(function(e){e&&(i?n.rescheduleAppointment(e):n.assignDST(e))})}}},{key:"assignDST",value:function(e){var t=this;this._episodesService.assignDeviceSetupTask(this.episodeDetails.id,e).subscribe(function(e){var n,i;t.refreshEpisodeState(),t._episodesEventLogger.episodeAppointmentsEvent(t.episodeDetails.id,t.episodeDetails.patientId,null===(i=null===(n=t.episodeDetails)||void 0===n?void 0:n.appointments[t.episodeDetails.appointments.length-1])||void 0===i?void 0:i.id,"episode_add_appointment")})}},{key:"rescheduleAppointment",value:function(e){var t,n,i,a,o=this,s=null===(a=null===(t=this.episodeDetails)||void 0===t?void 0:t.appointments[(null===(i=null===(n=this.episodeDetails)||void 0===n?void 0:n.appointments)||void 0===i?void 0:i.length)-1])||void 0===a?void 0:a.id;this._episodesService.rescheduleAppointment(s,this.episodeDetails.id,e).subscribe(function(t){o._notificationsService.success(o.translatedStrings.get("EPISODE"),t.message),o.assignDST(e),o._episodesEventLogger.episodeAppointmentsEvent(o.episodeDetails.id,o.episodeDetails.patientId,s,"episode_reschedule_appointment")},function(e){o._notificationsService.error(o.translatedStrings.get("EPISODE"),e.json().message)})}},{key:"completeDST",value:function(e){var t=this;this._episodesService.fetchActionItemById(e).subscribe(function(e){e.completed=!0,e.completedOn=Date.now(),e.completedBy=localStorage.getItem("loggedInUser"),t._episodesService.updateActionItem(e).subscribe(function(){t._notificationsService.success("Device Setup Task","Task marked as completed successfully!"),t.refreshEpisodeState()})})}},{key:"assignDevice",value:function(){var e;this._bt105CreateModalService.showModal(null===(e=this.episodeDetails)||void 0===e?void 0:e.patientId)}},{key:"refreshEpisodeState",value:function(){this.refreshEpisode.emit(!0)}}]),e}()).\u0275fac=function(e){return new(e||qa)(I.Rb(C.a),I.Rb(te.a),I.Rb(J.a),I.Rb(Ye.a),I.Rb(T.b),I.Rb(xa.a),I.Rb(St.a))},qa.\u0275cmp=I.Lb({type:qa,selectors:[["app-device-setup-tasks"]],inputs:{patient:"patient",episode:["episodeDetails","episode"]},outputs:{refreshEpisode:"refreshEpisode"},decls:16,vars:14,consts:[["nz-row",""],["nz-col","","nzXs","24","nzSm","6","nzMd","14"],["nz-typography",""],[4,"ngIf"],["nz-col","","nzXs","24","nzSm","18","nzMd","10","id","actions"],["type","button",3,"userId","phoneNumbers","disabled"],["nz-button","","nzSize","large",3,"disabled","click"],["nz-button","","nzType","primary","nzSize","large",3,"disabled","click"],["nz-button","","nzType","primary","nzSize","large",3,"disabled","routerLink"],["nz-button","","nzType","default","nzSize","large",3,"disabled","click"],["nzShowPagination","false","nzSize","small","nzBordered","false",3,"nzData","nzScroll"],["dstTable",""],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],["nz-popconfirm","","nzPopconfirmTitle","Are you sure you want to mark this task as complete ?","nzPopconfirmPlacement","left",3,"nzOnConfirm"],["nz-button","","nzType","primary","nzSize","small",3,"disabled"]],template:function(e,t){1&e&&(I.Xb(0,"nz-card"),I.Xb(1,"div",0),I.Xb(2,"div",1),I.Xb(3,"h3",2),I.Xc(4),I.jc(5,"translate"),I.Wb(),I.Vc(6,Ua,2,0,"label",3),I.Wb(),I.Xb(7,"div",4),I.Vc(8,Fa,6,7,"ng-container",3),I.Sb(9,"app-audio-call-widget",5),I.Xb(10,"button",6),I.ec("click",function(){return t.assignDevice()}),I.Xc(11),I.jc(12,"translate"),I.Wb(),I.Vc(13,Ya,5,6,"ng-container",3),I.Wb(),I.Wb(),I.Vc(14,Za,23,16,"ng-container",3),I.Wb(),I.Sb(15,"br")),2&e&&(I.Db(4),I.Zc(" ",I.kc(5,10,"EPISODE.DEVICE_SETUP")," "),I.Db(2),I.rc("ngIf",!(null!=t.episodeDetails&&null!=t.episodeDetails.deviceSetupTasks&&t.episodeDetails.deviceSetupTasks.length)),I.Db(2),I.rc("ngIf",!(null!=t.episodeDetails&&null!=t.episodeDetails.deviceSetupTasks&&t.episodeDetails.deviceSetupTasks.length)),I.Db(1),I.rc("userId",null==t.episodeDetails?null:t.episodeDetails.patientId)("phoneNumbers",null==t.patient?null:t.patient.phoneNumbers)("disabled","SCHEDULED"!==(null==t.episodeDetails?null:t.episodeDetails.status)&&"IN_PROGRESS"!==(null==t.episodeDetails?null:t.episodeDetails.status)),I.Db(1),I.rc("disabled","SCHEDULED"!==(null==t.episodeDetails?null:t.episodeDetails.status)&&"IN_PROGRESS"!==(null==t.episodeDetails?null:t.episodeDetails.status)),I.Db(1),I.Zc(" ",I.kc(12,12,"DEVICES.ADD")," "),I.Db(2),I.rc("ngIf",null==t.episodeDetails||null==t.episodeDetails.deviceSetupTasks?null:t.episodeDetails.deviceSetupTasks.length),I.Db(1),I.rc("ngIf",null==t.episodeDetails||null==t.episodeDetails.deviceSetupTasks?null:t.episodeDetails.deviceSetupTasks.length))},directives:[z.a,N.c,N.a,P.a,r.q,Da.a,kt.a,wt.a,L.a,_.h,Va.f,Va.n,Va.o,Va.e,Va.l,Va.i,r.p,r.o,ma.a],pipes:[se.a,Aa,r.e],styles:[".ant-card[_ngcontent-%COMP%]{padding:10px}h3[_ngcontent-%COMP%]{margin-bottom:0}label[_ngcontent-%COMP%]{font:normal normal normal 13px/16px Nunito;color:var(--tertiary-color);margin-bottom:5px;display:block}#actions[_ngcontent-%COMP%]{text-align:right}#actions[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{margin-left:5px}[_nghost-%COMP%]     .ant-table-thead>tr>th{height:50px!important}[_nghost-%COMP%]     .ant-table-tbody>tr>td{border-bottom:none}.shaded-row[_ngcontent-%COMP%]{background-color:var(--light-grey)}"]}),qa),Ka=o("cTUG");function Qa(e,t){if(1&e){var n=I.Yb();I.Vb(0),I.Xb(1,"app-plan-of-care-details",8),I.ec("refresh",function(){return I.Lc(n),I.ic(2).getPlanOfCare()}),I.Wb(),I.Sb(2,"br"),I.Ub()}if(2&e){var i=t.$implicit;I.Db(1),I.rc("planOfCare",i)}}function Ja(e,t){1&e&&(I.Vb(0),I.Xb(1,"strong"),I.Xc(2,"Plan of Care has not been assigned yet!"),I.Wb(),I.Ub())}function eo(e,t){if(1&e){var n=I.Yb();I.Xb(0,"div"),I.Xb(1,"nz-card"),I.Xb(2,"div",1),I.Xb(3,"div",2),I.Xb(4,"h3",3),I.Xc(5,"Plan of Care"),I.Wb(),I.Wb(),I.Xb(6,"div",4),I.Xb(7,"button",5),I.ec("click",function(){return I.Lc(n),I.ic().viewHistory()}),I.Xc(8," History "),I.Wb(),I.Wb(),I.Xb(9,"div",4),I.Xb(10,"button",6),I.ec("click",function(){return I.Lc(n),I.ic().addPlanOfCare()}),I.Xc(11," Add New "),I.Wb(),I.Wb(),I.Wb(),I.Vc(12,Qa,3,1,"ng-container",7),I.Vc(13,Ja,3,0,"ng-container",0),I.Wb(),I.Sb(14,"br"),I.Wb()}if(2&e){var i=I.ic();I.Db(12),I.rc("ngForOf",i.planOfCare),I.Db(1),I.rc("ngIf",i.planOfCare&&!(null!=i.planOfCare&&i.planOfCare.length))}}var to,no,io=((to=function(){function e(t,n){c(this,e),this._router=t,this._planOfCareService=n}return u(e,[{key:"ngOnInit",value:function(){this.getPlanOfCare()}},{key:"getPlanOfCare",value:function(){var e,t=this;this._planOfCareService.fetchPlanOfCare(null===(e=this.patient)||void 0===e?void 0:e.id).subscribe(function(e){t.planOfCare=e})}},{key:"viewHistory",value:function(){var e,t,n;this._router.navigate(["episodes/plan-of-care/details/".concat(null===(e=this.patient)||void 0===e?void 0:e.id,"/").concat(null===(t=this.episodeDetails)||void 0===t?void 0:t.id)],{queryParams:{tab:"history",patientName:null===(n=this.patient)||void 0===n?void 0:n.fullName}})}},{key:"addPlanOfCare",value:function(){var e,t;this._router.navigate(["episodes/plan-of-care/".concat(null===(e=this.patient)||void 0===e?void 0:e.id,"/").concat(null===(t=this.episodeDetails)||void 0===t?void 0:t.id)])}}]),e}()).\u0275fac=function(e){return new(e||to)(I.Rb(_.g),I.Rb(d.a))},to.\u0275cmp=I.Lb({type:to,selectors:[["app-plan-of-care"]],inputs:{episodeDetails:"episodeDetails",patient:"patient"},outputs:{refresh:"refresh"},decls:1,vars:1,consts:[[4,"ngIf"],["nz-row","","nzGutter","16"],["nz-col","","nzXs","24","nzSm","20","nzMd","20"],["nz-typography",""],["nz-col","","nzXs","24","nzSm","24","nzMd","2"],["nz-button","","id","full-width-button","nzSize","large",3,"click"],["nz-button","","id","full-width-button","nzType","primary","nzSize","large",3,"click"],[4,"ngFor","ngForOf"],[3,"planOfCare","refresh"]],template:function(e,t){1&e&&I.Vc(0,eo,15,2,"div",0),2&e&&I.rc("ngIf",t.episodeDetails&&"CCM"!==t.episodeDetails.type)},directives:[r.q,z.a,N.c,N.a,P.a,kt.a,wt.a,L.a,r.p,Ka.a],styles:["[_nghost-%COMP%]     .ant-card{padding:10px}[_nghost-%COMP%]     .ant-card-body{max-height:165px;overflow:hidden}h3[_ngcontent-%COMP%]{margin-bottom:0}#full-width-button[_ngcontent-%COMP%]{width:100%}#actions[_ngcontent-%COMP%]{text-align:right}"]}),to),ao=o("OG+h"),oo=((no=function(){function e(t,n,i,a){c(this,e),this._cdRef=t,this._element=n,this._dateComparePipe=i,this._dataSharingService=a}return u(e,[{key:"ngOnInit",value:function(){this.getTenantSettings()}},{key:"ngOnChanges",value:function(e){this.checkStatus()}},{key:"ngOnDestroy",value:function(){this.$tenantSettings.unsubscribe()}},{key:"getTenantSettings",value:function(){var e=this;this.$tenantSettings=this._dataSharingService.assignedTenantSettings.subscribe(function(t){var n;t.forEach(function(t,i){t.episodeBlueprints.findIndex(function(t){return t.id===e.episodeDetails.blueprintId})>=0&&(n=t)}),n&&!e.tenantSettings&&(e.tenantSettings=n,e.checkStatus())})}},{key:"getEpisodeBlueprint",value:function(){var e,t=this,n=null===(e=this.tenantSettings)||void 0===e?void 0:e.episodeBlueprints;return null==n?void 0:n.find(function(e){return t.episodeDetails.blueprintId===e.id&&!e.archived})}},{key:"getActiveCarePlan",value:function(){var e,t,n,i,a;(null===(t=null===(e=this.episodeDetails)||void 0===e?void 0:e.activeCarePlans)||void 0===t?void 0:t.length)&&(this.careplan=null===(n=this.episodeDetails)||void 0===n?void 0:n.activeCarePlans[(null===(a=null===(i=this.episodeDetails)||void 0===i?void 0:i.activeCarePlans)||void 0===a?void 0:a.length)-1])}},{key:"checkStatus",value:function(){switch(this.getActiveCarePlan(),this.isCarePlanEntityEnabled){case"AUTO_ASSIGN_CARE_PLAN":this.isAutoAssignCarePlanEnabled();break;case"ASSIGN_CARE_PLAN":this.isAssignCarePlanEnabled();break;case"EDIT_CARE_PLAN":this.isEditCarePlanEnabled();break;case"VIEW_CARE_PLAN":this.isViewCarePlanEnabled();break;case"CARE_PLAN_AUTO_ASSIGNED":this.isCarePlanAutoAssigned();break;case"CARE_PLAN_SUSPENDED":this.isCarePlanSuspended();break;case"CARE_PLAN_COMPLETED":this.isCarePlanCompleted();break;default:this.disableFeature()}}},{key:"enableFeature",value:function(){this._element.nativeElement.style.display="unset",this._cdRef.detectChanges()}},{key:"disableFeature",value:function(){this._element.nativeElement.style.display="none",this._cdRef.detectChanges()}},{key:"isEpisodeExpired",value:function(){var e,t,n;return((new Date).getMonth()+1>new Date(null===(e=this.episodeDetails)||void 0===e?void 0:e.endDate).getMonth()+1||"IN_PROGRESS"!==(null===(t=this.episodeDetails)||void 0===t?void 0:t.status)&&"SCHEDULED"!==(null===(n=this.episodeDetails)||void 0===n?void 0:n.status))&&(this.disableFeature(),!0)}},{key:"isAutoAssignCarePlanEnabled",value:function(){var e,t,n,i,a,o,s,l,r,c;if(!this.isEpisodeExpired()){var d=this.getEpisodeBlueprint();return(null===(e=null==d?void 0:d.episodeComponent)||void 0===e?void 0:e.enableConsentForm)?_e.a.RPM===(null==d?void 0:d.type)&&this.isDeviceSetupComplete()||_e.a.RPM===(null==d?void 0:d.type)&&(null===(n=null===(t=this.episodeDetails)||void 0===t?void 0:t.availableConsents)||void 0===n?void 0:n.length)&&!this.consentObtained()&&this.isDeviceSetupComplete()||_e.a.GENERAL===(null==d?void 0:d.type)&&(null===(a=null===(i=this.episodeDetails)||void 0===i?void 0:i.availableConsents)||void 0===a?void 0:a.length)&&this.consentObtained()||_e.a.CCM===(null==d?void 0:d.type)&&(null===(s=null===(o=this.episodeDetails)||void 0===o?void 0:o.availableConsents)||void 0===s?void 0:s.length)&&this.consentObtained()||(null===(l=this.careplan)||void 0===l?void 0:l.id)||(null===(c=null===(r=this.episodeDetails)||void 0===r?void 0:r.inActiveCarePlans)||void 0===c?void 0:c.length)?this.disableFeature():void this.enableFeature():this.disableFeature()}}},{key:"isAssignCarePlanEnabled",value:function(){var e,t,n,i;if(!this.isEpisodeExpired()){var a=this.getEpisodeBlueprint();if(null===(t=null===(e=this.episodeDetails)||void 0===e?void 0:e.activeCarePlans)||void 0===t?void 0:t.length)return this.disableFeature();(null===(n=null==a?void 0:a.episodeComponent)||void 0===n?void 0:n.enableConsentForm)&&(this.consentObtained()&&this.isDeviceSetupComplete()&&!(null===(i=this.careplan)||void 0===i?void 0:i.id)||this.disableFeature())}}},{key:"isEditCarePlanEnabled",value:function(){var e,t,n,i,a;if(!this.isEpisodeExpired()){if(!(null===(t=null===(e=this.episodeDetails)||void 0===e?void 0:e.activeCarePlans)||void 0===t?void 0:t.length))return this.disableFeature();var o=null===(n=this.episodeDetails)||void 0===n?void 0:n.activeCarePlans[(null===(a=null===(i=this.episodeDetails)||void 0===i?void 0:i.activeCarePlans)||void 0===a?void 0:a.length)-1];if("SUSPENDED"===(null==o?void 0:o.status))return this.disableFeature();this._dateComparePipe.transform(null==o?void 0:o.endDate)&&"COMPLETED"!==(null==o?void 0:o.status)||this.disableFeature()}}},{key:"isViewCarePlanEnabled",value:function(){var e,t,n,i;if(!this.isEpisodeExpired()){var a=this.getEpisodeBlueprint();return"CCM"!==(null===(e=this.episodeDetails)||void 0===e?void 0:e.type)||(null===(t=null==a?void 0:a.episodeComponent)||void 0===t?void 0:t.enableCarePlan)?(null===(i=null===(n=this.episodeDetails)||void 0===n?void 0:n.activeCarePlans)||void 0===i?void 0:i.length)?void this.enableFeature():this.disableFeature():this.enableFeature()}}},{key:"isCarePlanAutoAssigned",value:function(){var e,t,n,i;if((null===(t=null===(e=this.episodeDetails)||void 0===e?void 0:e.activeCarePlans)||void 0===t?void 0:t.length)||!(null===(n=this.careplan)||void 0===n?void 0:n.id)||"IN_PROGRESS"!==(null===(i=this.episodeDetails)||void 0===i?void 0:i.status))return this.disableFeature()}},{key:"isCarePlanSuspended",value:function(){var e,t,n,i,a;if(!(null===(t=null===(e=this.episodeDetails)||void 0===e?void 0:e.activeCarePlans)||void 0===t?void 0:t.length))return this.disableFeature();var o=null===(n=this.episodeDetails)||void 0===n?void 0:n.activeCarePlans[(null===(a=null===(i=this.episodeDetails)||void 0===i?void 0:i.activeCarePlans)||void 0===a?void 0:a.length)-1];return"SUSPENDED"!==(null==o?void 0:o.status)?this.disableFeature():void 0}},{key:"isCarePlanCompleted",value:function(){var e,t,n,i,a;if(!(null===(t=null===(e=this.episodeDetails)||void 0===e?void 0:e.activeCarePlans)||void 0===t?void 0:t.length))return this.disableFeature();var o=null===(n=this.episodeDetails)||void 0===n?void 0:n.activeCarePlans[(null===(a=null===(i=this.episodeDetails)||void 0===i?void 0:i.activeCarePlans)||void 0===a?void 0:a.length)-1];return"SUSPENDED"===(null==o?void 0:o.status)||this._dateComparePipe.transform(null==o?void 0:o.endDate)||"COMPLETED"!==(null==o?void 0:o.status)?this.disableFeature():void 0}},{key:"consentObtained",value:function(){var e,t,n,i,a=this,o=!1;return(null===(t=Object.keys(null===(e=this.episodeDetails)||void 0===e?void 0:e.serviceCodes))||void 0===t?void 0:t.length)||(o=!0),null===(i=null===(n=this.episodeDetails)||void 0===n?void 0:n.availableConsents)||void 0===i||i.forEach(function(e){var t;dn.b.OBTAINED===(null==e?void 0:e.consentStatus)&&(null==e?void 0:e.episodeType)===(null===(t=a.episodeDetails)||void 0===t?void 0:t.type)&&(o=!0)}),o}},{key:"isDeviceSetupComplete",value:function(){var e,t,n,i,a,o=this.getEpisodeBlueprint(),s=null===(e=null==o?void 0:o.enabledServiceCodes)||void 0===e?void 0:e.find(function(e){return"99453"===e});if(!s)return!0;var l=null===(n=null===(t=this.episodeDetails)||void 0===t?void 0:t.deviceSetupTasks)||void 0===n?void 0:n.filter(function(e){return e.completed});return!(s&&!(null==l?void 0:l.length))&&l.length===(null===(a=null===(i=this.episodeDetails)||void 0===i?void 0:i.deviceSetupTasks)||void 0===a?void 0:a.length)}}]),e}()).\u0275fac=function(e){return new(e||no)(I.Rb(I.h),I.Rb(I.l),I.Rb(va.a),I.Rb(te.a))},no.\u0275dir=I.Mb({type:no,selectors:[["","isCarePlanEntityEnabled",""]],inputs:{isCarePlanEntityEnabled:"isCarePlanEntityEnabled",episodeDetails:"episodeDetails"},features:[I.Cb([va.a]),I.Bb]}),no);function so(e,t){if(1&e&&(I.Xb(0,"span",9),I.jc(1,"translate"),I.Xc(2),I.Wb()),2&e){var n=I.ic(2);I.uc("nzTooltipTitle","",null==n.careplan?null:n.careplan.name," ",I.kc(1,3,"CAREPLAN.ASSIGNED.INFO"),""),I.Db(2),I.Zc("\xa0 | \xa0 ",null==n.careplan?null:n.careplan.name," ")}}function lo(e,t){if(1&e&&(I.Xb(0,"strong"),I.Xc(1),I.Wb()),2&e){var n=I.ic(4);I.Db(1),I.Zc(" ",16-(null==n.episodeDetails?null:n.episodeDetails.patientComplianceCount[99454])," days ")}}function ro(e,t){1&e&&(I.Xb(0,"strong"),I.Xc(1," 0 days "),I.Wb())}function co(e,t){if(1&e&&(I.Vb(0),I.Xb(1,"label",10),I.Xc(2," As per RPM guidelines, a minimum of one vital needs to be measured for the next : "),I.Vc(3,lo,2,1,"strong",0),I.Vc(4,ro,2,0,"strong",0),I.Wb(),I.Ub()),2&e){var n=I.ic(3);I.Db(1),I.rc("isCarePlanEntityEnabled","VIEW_CARE_PLAN")("episodeDetails",n.episodeDetails),I.Db(2),I.rc("ngIf",(null==n.episodeDetails?null:n.episodeDetails.patientComplianceCount[99454])<16),I.Db(1),I.rc("ngIf",(null==n.episodeDetails?null:n.episodeDetails.patientComplianceCount[99454])>=16)}}function uo(e,t){1&e&&(I.Vb(0),I.Xc(1),I.jc(2,"translate"),I.Ub()),2&e&&(I.Db(1),I.Zc(" ",I.kc(2,1,"CAREPLAN.ASSIGNED.INFO")," "))}function bo(e,t){if(1&e&&(I.Xb(0,"label"),I.Xb(1,"strong"),I.Xc(2),I.Wb(),I.Xc(3),I.jc(4,"translate"),I.Wb()),2&e){var n=I.ic(3);I.Db(2),I.Yc(null==n.episodeDetails||null==n.episodeDetails.inActiveCarePlans[0]?null:n.episodeDetails.inActiveCarePlans[0].name),I.Db(1),I.Zc(" ",I.kc(4,2,"CAREPLAN.ASSIGNED")," ")}}function po(e,t){if(1&e&&(I.Xb(0,"label"),I.Xb(1,"strong"),I.Xc(2),I.Wb(),I.Xc(3),I.jc(4,"translate"),I.Wb()),2&e){var n=I.ic(3);I.Db(2),I.Yc(null==n.episodeDetails||null==n.episodeDetails.inActiveCarePlans[0]?null:n.episodeDetails.inActiveCarePlans[0].name),I.Db(1),I.Zc(" ",I.kc(4,2,"CAREPLAN.ASSIGNED_DST")," ")}}function fo(e,t){if(1&e&&(I.Vb(0),I.Xb(1,"label",10),I.Xc(2),I.jc(3,"translate"),I.Wb(),I.Xb(4,"label",10),I.Xc(5),I.jc(6,"translate"),I.Wb(),I.Vc(7,co,5,4,"ng-container",0),I.Vc(8,uo,3,3,"ng-container",0),I.Vc(9,bo,5,4,"label",0),I.Vc(10,po,5,4,"label",0),I.Ub()),2&e){var n=I.ic(2);I.Db(1),I.rc("isCarePlanEntityEnabled","AUTO_ASSIGN_CARE_PLAN")("episodeDetails",n.episodeDetails),I.Db(1),I.Zc(" ",I.kc(3,10,"CAREPLAN.ACTIVATION.INFO")," "),I.Db(2),I.rc("isCarePlanEntityEnabled","ASSIGN_CARE_PLAN")("episodeDetails",n.episodeDetails),I.Db(1),I.Zc(" ",I.kc(6,12,"CAREPLAN.ACTIVATION.INFO")," "),I.Db(2),I.rc("ngIf",n.isRPMEpisode),I.Db(1),I.rc("ngIf",!n.isRPMEpisode&&(null==n.episodeDetails||null==n.episodeDetails.activeCarePlans?null:n.episodeDetails.activeCarePlans.length)),I.Db(1),I.rc("ngIf",(null==n.episodeDetails||null==n.episodeDetails.inActiveCarePlans?null:n.episodeDetails.inActiveCarePlans.length)&&!n.isConsentAvailable),I.Db(1),I.rc("ngIf",n.isRPMEpisode&&(null==n.episodeDetails||null==n.episodeDetails.inActiveCarePlans?null:n.episodeDetails.inActiveCarePlans.length)&&(!(null!=n.episodeDetails&&null!=n.episodeDetails.deviceSetupTasks&&n.episodeDetails.deviceSetupTasks.length)||!n.isDSTComplete))}}function vo(e,t){1&e&&(I.Vb(0),I.Xc(1),I.jc(2,"translate"),I.Ub()),2&e&&(I.Db(1),I.Zc(" ",I.kc(2,1,"CAREPLAN.ASSIGNED.INFO")," "))}function ho(e,t){if(1&e){var n=I.Yb();I.Xb(0,"button",11),I.ec("click",function(){return I.Lc(n),I.ic(2).viewCareplanTemplates("auto-assign")}),I.Xc(1),I.jc(2,"translate"),I.Wb()}if(2&e){var i=I.ic(2);I.rc("isCarePlanEntityEnabled","AUTO_ASSIGN_CARE_PLAN")("episodeDetails",i.episodeDetails),I.Db(1),I.Zc(" ",I.kc(2,3,"CAREPLAN.AUTO_ASSIGN")," ")}}function go(e,t){if(1&e){var n=I.Yb();I.Xb(0,"button",11),I.ec("click",function(){return I.Lc(n),I.ic(2).viewCareplanTemplates("assign")}),I.Xc(1),I.jc(2,"translate"),I.Wb()}if(2&e){var i=I.ic(2);I.rc("isCarePlanEntityEnabled","ASSIGN_CARE_PLAN")("episodeDetails",i.episodeDetails),I.Db(1),I.Zc(" ",I.kc(2,3,"CAREPLAN.ASSIGN_CAREPLAN")," ")}}function mo(e,t){if(1&e){var n=I.Yb();I.Xb(0,"span",10),I.Xb(1,"button",12),I.Sb(2,"app-icons",13),I.Wb(),I.Xb(3,"nz-dropdown-menu",null,14),I.Xb(5,"ul",15),I.Xb(6,"li",16),I.ec("click",function(){return I.Lc(n),I.ic(2).editCarePlan()}),I.Xc(7),I.jc(8,"translate"),I.Wb(),I.Wb(),I.Wb(),I.Wb()}if(2&e){var i=I.Ic(4),a=I.ic(2);I.rc("isCarePlanEntityEnabled","EDIT_CARE_PLAN")("episodeDetails",a.episodeDetails),I.Db(1),I.rc("nzDropdownMenu",i),I.Db(6),I.Yc(I.kc(8,4,"COMMON.EDIT_CAREPLAN"))}}function Co(e,t){if(1&e){var n=I.Yb();I.Xb(0,"nz-card"),I.Xb(1,"div",1),I.Xb(2,"div",2),I.Xb(3,"h3",3),I.Xc(4),I.jc(5,"translate"),I.Vc(6,so,3,5,"span",4),I.Wb(),I.Vc(7,fo,11,14,"ng-container",0),I.Vc(8,vo,3,3,"ng-container",0),I.Wb(),I.Xb(9,"div",5),I.Xb(10,"button",6),I.ec("click",function(){return I.Lc(n),I.ic().viewCarePlan()}),I.Xc(11),I.jc(12,"translate"),I.Wb(),I.Vc(13,ho,3,5,"button",7),I.Vc(14,go,3,5,"button",7),I.Vc(15,mo,9,6,"span",8),I.Wb(),I.Wb(),I.Wb()}if(2&e){var i=I.ic();I.Db(4),I.Zc(" ",I.kc(5,10,"EPISODE.CAREPLAN")," "),I.Db(2),I.rc("ngIf",null==i.careplan?null:i.careplan.name),I.Db(1),I.rc("ngIf",!i.isCCMNonCareplanEpisode),I.Db(1),I.rc("ngIf",i.isCCMNonCareplanEpisode),I.Db(2),I.rc("isCarePlanEntityEnabled","VIEW_CARE_PLAN")("episodeDetails",i.episodeDetails),I.Db(1),I.Zc(" ",I.kc(12,12,"COMMON.VIEW_CAREPLAN")," "),I.Db(2),I.rc("ngIf",!i.isCCMNonCareplanEpisode),I.Db(1),I.rc("ngIf",!i.isCCMNonCareplanEpisode),I.Db(1),I.rc("ngIf",!i.isCCMNonCareplanEpisode)}}var Do,So=((Do=function(){function e(n,i,a,o,s,l){var r,d=this;c(this,e),this._router=n,this._modalService=i,this.translationService=a,this._notificationsService=o,this._episodesEventLogger=s,this._dataSharingService=l,this.strings=["CAREPLAN.CHOOSE_CAREPLAN_TEMPLATE","COMMON.CAREPLAN","CAREPLAN.ACTIVE_ON_CONSENT"],this.isRPMEpisode=!0,this.isCCMNonCareplanEpisode=!1,this.$translationSubscription=(r=this.translationService).getMultiple.apply(r,t(this.strings)).subscribe(function(e){d.translatedStrings=e}),this.refresh=new I.n}return u(e,[{key:"ngOnInit",value:function(){this.getTenantConfig(),this.getActiveCarePlan(),this.checkForConsent(),this.checkForDST()}},{key:"ngOnDestroy",value:function(){var e;null===(e=this.$translationSubscription)||void 0===e||e.unsubscribe()}},{key:"getTenantConfig",value:function(){var e=this;this._dataSharingService.assignedTenantSettings.subscribe(function(t){var n,i,a,o,s,l,r,c,d=t.get(null===(n=e.episodeDetails)||void 0===n?void 0:n.tenantId);e.isRPMEpisode=-1!==(null===(o=null===(a=null===(i=null==d?void 0:d.episodeBlueprints)||void 0===i?void 0:i.find(function(t){return e.episodeDetails.blueprintId===t.id&&!t.archived}))||void 0===a?void 0:a.enabledServiceCodes)||void 0===o?void 0:o.findIndex(function(e){return"99454"===e})),e.isCCMNonCareplanEpisode="CCM"==(null===(s=e.episodeDetails)||void 0===s?void 0:s.type)&&!1===(null===(c=null===(r=null===(l=null==d?void 0:d.episodeBlueprints)||void 0===l?void 0:l.find(function(t){return e.episodeDetails.blueprintId===t.id&&!t.archived}))||void 0===r?void 0:r.episodeComponent)||void 0===c?void 0:c.enableCarePlan)})}},{key:"checkForConsent",value:function(){this.isConsentAvailable=-1!==this.episodeDetails.availableConsents.findIndex(function(e){return"OBTAINED"===e.consentStatus})}},{key:"checkForDST",value:function(){this.isDSTComplete=this.episodeDetails.deviceSetupTasks.every(function(e){return e.completed})}},{key:"getActiveCarePlan",value:function(){var e,t,n,i,a;(null===(t=null===(e=this.episodeDetails)||void 0===e?void 0:e.activeCarePlans)||void 0===t?void 0:t.length)&&(this.careplan=null===(n=this.episodeDetails)||void 0===n?void 0:n.activeCarePlans[(null===(a=null===(i=this.episodeDetails)||void 0===i?void 0:i.activeCarePlans)||void 0===a?void 0:a.length)-1])}},{key:"viewCarePlan",value:function(){var e,t,n,i,a,o,s,l;this._episodesEventLogger.episodeCareplanActionEvent(null===(e=this.episodeDetails)||void 0===e?void 0:e.id,null===(t=this.episodeDetails)||void 0===t?void 0:t.patientId,"episode_view_careplan"),"CCM"==(null===(n=this.episodeDetails)||void 0===n?void 0:n.type)?this._router.navigate(["episodes/ccm/careplan/".concat(null===(i=this.episodeDetails)||void 0===i?void 0:i.patientId,"/").concat(null===(a=this.episodeDetails)||void 0===a?void 0:a.id,"/").concat(null===(o=this.episodeDetails)||void 0===o?void 0:o.blueprintId)]):this._router.navigate(["careplanassignments/patient/"+(null===(s=this.episodeDetails)||void 0===s?void 0:s.patientId)+"/actionitems"],{queryParams:{careplanId:null===(l=this.careplan)||void 0===l?void 0:l.id}})}},{key:"editCarePlan",value:function(){var e,t,n,i;this._episodesEventLogger.episodeCareplanActionEvent(null===(e=this.episodeDetails)||void 0===e?void 0:e.id,null===(t=this.episodeDetails)||void 0===t?void 0:t.patientId,"episode_edit_careplan"),this._router.navigate(["course/edit-assigned-careplan/"+(null===(n=this.careplan)||void 0===n?void 0:n.id)],{queryParams:{episodeStartDate:this.careplan.startDate,episodeEndDate:null===(i=this.episodeDetails)||void 0===i?void 0:i.endDate}})}},{key:"viewCareplanTemplates",value:function(e){var t,n,i,a,o=this;this._episodesEventLogger.episodeCareplanActionEvent(null===(t=this.episodeDetails)||void 0===t?void 0:t.id,null===(n=this.episodeDetails)||void 0===n?void 0:n.patientId,"episode_choose_careplan"),this._modalService.create({nzTitle:this.translatedStrings.get("CAREPLAN.CHOOSE_CAREPLAN_TEMPLATE"),nzContent:ao.a,nzComponentParams:{tenantId:null===(i=this.episodeDetails)||void 0===i?void 0:i.tenantId,patientId:null===(a=this.episodeDetails)||void 0===a?void 0:a.patientId,episodeDetails:this.episodeDetails,mode:e},nzFooter:null}).afterClose.subscribe(function(t){t&&"auto-assign"==e&&(o._notificationsService.info(o.translatedStrings.get("COMMON.CAREPLAN"),o.translatedStrings.get("CAREPLAN.ACTIVE_ON_CONSENT")),o.refreshEpisodeDetails())})}},{key:"refreshEpisodeDetails",value:function(){this.refresh.emit()}}]),e}()).\u0275fac=function(e){return new(e||Do)(I.Rb(_.g),I.Rb(He.f),I.Rb(J.a),I.Rb(T.b),I.Rb(Ye.a),I.Rb(te.a))},Do.\u0275cmp=I.Lb({type:Do,selectors:[["app-careplan"]],inputs:{episodeDetails:"episodeDetails"},outputs:{refresh:"refresh"},decls:2,vars:1,consts:[[4,"ngIf"],["nz-row",""],["nz-col","","nzXs","24","nzSm","20","nzMd","18"],["nz-typography",""],["nz-typography","","nz-tooltip","",3,"nzTooltipTitle",4,"ngIf"],["nz-col","","nzXs","24","nzSm","24","nzMd","6","id","actions"],["nz-button","","nzSize","large",3,"isCarePlanEntityEnabled","episodeDetails","click"],["nz-button","","nzType","primary","nzSize","large",3,"isCarePlanEntityEnabled","episodeDetails","click",4,"ngIf"],[3,"isCarePlanEntityEnabled","episodeDetails",4,"ngIf"],["nz-typography","","nz-tooltip","",3,"nzTooltipTitle"],[3,"isCarePlanEntityEnabled","episodeDetails"],["nz-button","","nzType","primary","nzSize","large",3,"isCarePlanEntityEnabled","episodeDetails","click"],["nz-button","","nzType","primary","nzSize","large","nz-dropdown","","nzPlacement","bottomRight","id","more",3,"nzDropdownMenu"],["color","white","name","moreFilled","size","16px"],["menu","nzDropdownMenu"],["nz-menu",""],["nz-menu-item","",3,"click"]],template:function(e,t){1&e&&(I.Vc(0,Co,16,14,"nz-card",0),I.Sb(1,"br")),2&e&&I.rc("ngIf",t.episodeDetails)},directives:[r.q,z.a,N.c,N.a,P.a,kt.a,wt.a,L.a,oo,it.d,X.d,X.b,ve.a,X.e,y.c,y.e],pipes:[se.a],styles:[".ant-card[_ngcontent-%COMP%]{padding:10px}h3[_ngcontent-%COMP%]{margin-bottom:0}button[_ngcontent-%COMP%]{margin-top:25px}label[_ngcontent-%COMP%]{font:normal normal normal 13px/16px Nunito;color:var(--tertiary-color);margin-bottom:5px;display:block}#actions[_ngcontent-%COMP%]{text-align:right}#more[_ngcontent-%COMP%]{font-size:14px;margin-left:10px}app-icons[_ngcontent-%COMP%]{vertical-align:sub}"]}),Do),Eo=o("OTIt"),Oo=o("c/Vb");function Io(e,t){1&e&&(I.Vb(0),I.Xc(1," 0 "),I.Ub())}function _o(e,t){if(1&e&&(I.Vb(0),I.Xc(1),I.Ub()),2&e){var n=I.ic();I.Db(1),I.Zc(" ",20-(null==n.episodeDetails?null:n.episodeDetails.patientComplianceCount[99484])," ")}}function To(e,t){1&e&&(I.Xb(0,"label"),I.Xc(1," No call activity yet "),I.Wb())}var Xo=function(e){return{"shaded-row":e}};function yo(e,t){if(1&e){var n=I.Yb();I.Xb(0,"tr",10),I.Xb(1,"td"),I.Xc(2),I.jc(3,"date"),I.Wb(),I.Xb(4,"td"),I.Xc(5),I.Wb(),I.Xb(6,"td"),I.Xc(7),I.Wb(),I.Xb(8,"td",11),I.Xc(9),I.Wb(),I.Xb(10,"td"),I.Xc(11),I.Wb(),I.Xb(12,"td"),I.Xb(13,"app-icons",12),I.ec("click",function(){I.Lc(n);var e=t.$implicit,i=I.ic(2);return i.showLogDetails(e,null==i.episodeDetails?null:i.episodeDetails.monitoringStaff[null==e?null:e.staffId])}),I.Wb(),I.Xc(14," \xa0 "),I.Xb(15,"app-icons",13),I.ec("click",function(){I.Lc(n);var e=t.$implicit;return I.ic(2).showCMTModal(e)}),I.Wb(),I.Xc(16," \xa0 "),I.Xb(17,"a",14),I.ec("nzOnConfirm",function(){I.Lc(n);var e=t.$implicit;return I.ic(2).delete(null==e?null:e.id)}),I.Sb(18,"app-icons",15),I.Wb(),I.Wb(),I.Wb()}if(2&e){var i=t.$implicit,a=t.index,o=I.ic(2);I.rc("ngClass",I.yc(10,Xo,a%2!=0)),I.Db(2),I.Yc(I.lc(3,7,null==i?null:i.startTime,"MMM dd yyyy hh:mm")),I.Db(3),I.Yc(((null==i?null:i.endTime)-(null==i?null:i.startTime))/6e4),I.Db(2),I.Yc(o.mode.get(null==i?null:i.mode)),I.Db(1),I.rc("nzTooltipTitle",null==i?null:i.notes),I.Db(1),I.Yc(null==i?null:i.activity),I.Db(2),I.Yc(null==o.episodeDetails?null:o.episodeDetails.monitoringStaff[null==i?null:i.staffId])}}var No=function(){return{x:"1175px"}};function zo(e,t){if(1&e&&(I.Vb(0),I.Sb(1,"br"),I.Xb(2,"nz-table",7,8),I.Xb(4,"thead"),I.Xb(5,"tr"),I.Xb(6,"th"),I.Xc(7),I.jc(8,"translate"),I.Wb(),I.Xb(9,"th"),I.Xc(10),I.jc(11,"translate"),I.Wb(),I.Xb(12,"th"),I.Xc(13),I.jc(14,"translate"),I.Wb(),I.Xb(15,"th"),I.Xc(16),I.jc(17,"translate"),I.Wb(),I.Xb(18,"th"),I.Xc(19),I.jc(20,"translate"),I.Wb(),I.Sb(21,"th"),I.Wb(),I.Wb(),I.Xb(22,"tbody"),I.Vc(23,yo,19,12,"tr",9),I.Wb(),I.Wb(),I.Ub()),2&e){var n=I.Ic(3),i=I.ic();I.Db(2),I.rc("nzData",null==i.episodeDetails?null:i.episodeDetails.patientCommunications[99484])("nzScroll",I.xc(18,No)),I.Db(5),I.Yc(I.kc(8,8,"COMMON.DATE_TIME")),I.Db(3),I.Zc("",I.kc(11,10,"COMMON.DURATION")," (mins)"),I.Db(3),I.Yc(I.kc(14,12,"TMS.COMMUNICATION_MODE")),I.Db(3),I.Yc(I.kc(17,14,"HEADER.ACTIVITY")),I.Db(3),I.Yc(I.kc(20,16,"PATIENT.MONITORING_STAFF")),I.Db(4),I.rc("ngForOf",n.data)}}var Mo,Ao=((Mo=function(){function e(t,n,i,a,o){c(this,e),this._dateComparePipe=t,this._notificationsService=n,this._patientCommunicationModalService=i,this._episodesEventLogger=a,this._episodesService=o,this.mode=new Map([["VIDEO_CALL","Video Call"],["CALL","Audio Call"],["HOME_VISIT","Home Visit"],["CLINIC_VISIT","In Clinic"],["OTHER","Other"]]),this.refreshEpisode=new I.n}return u(e,[{key:"validate",value:function(){var e,t;return!this._dateComparePipe.transform(this.episodeDetails.endDate)||"IN_PROGRESS"!==this.episodeDetails.status&&"SCHEDULED"!==this.episodeDetails.status?(this._notificationsService.error("Episode Suspended","This episode has been suspended and no further activities can be assigned."),!1):!!(null===(t=null===(e=this.episodeDetails)||void 0===e?void 0:e.availableConsents)||void 0===t?void 0:t.length)}},{key:"showCMTModal",value:function(e){var t,n,i=this;this.validate()&&(this._episodesEventLogger.episodeCMTActionEvent(this.episodeDetails.id,this.episodeDetails.patientId,"episode_add_cmt"),this._patientCommunicationModalService.createCMTModal("",null===(t=this.episodeDetails)||void 0===t?void 0:t.patientId,null===(n=this.episodeDetails)||void 0===n?void 0:n.id,Oo.a.CARE_MANAGEMENT_TIME,void 0,void 0,this.episodeDetails.endDate,void 0,void 0,e).afterClose.subscribe(function(e){e&&i.refreshEpisodeState()}))}},{key:"showLogDetails",value:function(e,t){this._patientCommunicationModalService.createLogDetailsModal(e,t)}},{key:"delete",value:function(e){var t=this;this.validate()&&this._episodesService.archivePatientCommunication(e).subscribe(function(){t._notificationsService.success("Patient Communication","Note deleted successfully!"),t.refreshEpisodeState()})}},{key:"refreshEpisodeState",value:function(){this.refreshEpisode.emit(!0)}}]),e}()).\u0275fac=function(e){return new(e||Mo)(I.Rb(va.a),I.Rb(T.b),I.Rb(Eo.a),I.Rb(Ye.a),I.Rb(bn.a))},Mo.\u0275cmp=I.Lb({type:Mo,selectors:[["app-care-management-time"]],inputs:{episodeDetails:"episodeDetails"},outputs:{refreshEpisode:"refreshEpisode"},features:[I.Cb([va.a])],decls:17,vars:14,consts:[["nz-row",""],["nz-col","","nzXs","24","nzSm","18","nzMd","21"],["nz-typography",""],["nz-typography","",3,"nzType"],[4,"ngIf"],["nz-col","","nzXs","24","nzSm","6","nzMd","3","id","actions"],["nz-button","","nzType","primary","nzSize","large",3,"disabled","click"],["nzShowPagination","false","nzSize","small","nzBordered","false",3,"nzData","nzScroll"],["cmtTable",""],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],["nz-tooltip","",3,"nzTooltipTitle"],["size","16px","name","view","nz-tooltip","","nzTooltipTitle","View",3,"click"],["size","16px","name","profileEdit","nz-tooltip","","nzTooltipTitle","Edit",3,"click"],["nz-popconfirm","","nzPopconfirmTitle","Are you sure you want to delete this record ?","nzPopconfirmPlacement","bottom",3,"nzOnConfirm"],["name","delete","size","16px","color","#c81c1c"]],template:function(e,t){1&e&&(I.Xb(0,"nz-card"),I.Xb(1,"div",0),I.Xb(2,"div",1),I.Xb(3,"h3",2),I.Xb(4,"span",3),I.Vc(5,Io,2,0,"ng-container",4),I.Vc(6,_o,2,1,"ng-container",4),I.Wb(),I.Xc(7),I.jc(8,"translate"),I.Wb(),I.Vc(9,To,2,0,"label",4),I.Wb(),I.Xb(10,"div",5),I.Xb(11,"button",6),I.ec("click",function(){return t.showCMTModal()}),I.jc(12,"validConsent"),I.Xc(13),I.jc(14,"translate"),I.Wb(),I.Wb(),I.Wb(),I.Vc(15,zo,24,19,"ng-container",4),I.Wb(),I.Sb(16,"br")),2&e&&(I.Db(4),I.rc("nzType",0===(null==t.episodeDetails?null:t.episodeDetails.patientComplianceCount[99484])?"-":"success"),I.Db(1),I.rc("ngIf",20<=(null==t.episodeDetails?null:t.episodeDetails.patientComplianceCount[99484])),I.Db(1),I.rc("ngIf",20>(null==t.episodeDetails?null:t.episodeDetails.patientComplianceCount[99484])),I.Db(1),I.Zc(" ",I.kc(8,8,"CMT.MINUTES_REMAINING")," "),I.Db(2),I.rc("ngIf",!(null!=t.episodeDetails&&t.episodeDetails.patientCommunications&&null!=t.episodeDetails&&null!=t.episodeDetails.patientCommunications[99484]&&t.episodeDetails.patientCommunications[99484].length)),I.Db(2),I.rc("disabled",!I.kc(12,10,t.episodeDetails)),I.Db(2),I.Zc(" ",I.kc(14,12,"CMT.ADD")," "),I.Db(2),I.rc("ngIf",(null==t.episodeDetails?null:t.episodeDetails.patientCommunications)&&(null==t.episodeDetails||null==t.episodeDetails.patientCommunications[99484]?null:t.episodeDetails.patientCommunications[99484].length)))},directives:[z.a,N.c,N.a,P.a,r.q,kt.a,wt.a,L.a,Va.f,Va.n,Va.o,Va.e,Va.l,Va.i,r.p,r.o,it.d,ve.a,ma.a],pipes:[se.a,Aa,r.e],styles:[".ant-card[_ngcontent-%COMP%]{padding:10px}h3[_ngcontent-%COMP%]{margin-bottom:0}label[_ngcontent-%COMP%]{font:normal normal normal 13px/16px Nunito;color:var(--tertiary-color);margin-bottom:5px;display:block}#actions[_ngcontent-%COMP%]{text-align:right}[_nghost-%COMP%]     .ant-table-thead>tr>th{height:50px!important}[_nghost-%COMP%]     .ant-table-tbody>tr>td{border-bottom:none}.shaded-row[_ngcontent-%COMP%]{background-color:var(--light-grey)}"]}),Mo);function Po(e,t){1&e&&(I.Vb(0),I.Xc(1," 0 "),I.Ub())}function Wo(e,t){if(1&e&&(I.Vb(0),I.Xc(1),I.Ub()),2&e){var n=I.ic(2);I.Db(1),I.Zc(" ",n.serviceCodeTotal.get(n.cptCode)-(null==n.episodeDetails?null:n.episodeDetails.patientComplianceCount[n.serviceCodes.get(n.cptCode)])," ")}}function Ro(e,t){if(1&e&&(I.Xb(0,"span",4),I.Vc(1,Po,2,0,"ng-container",5),I.Vc(2,Wo,2,1,"ng-container",5),I.Wb()),2&e){var n=I.ic();I.rc("nzType",0===(null==n.episodeDetails?null:n.episodeDetails.patientComplianceCount[n.serviceCodes.get(n.cptCode)])?"-":"success"),I.Db(1),I.rc("ngIf",20<=(null==n.episodeDetails?null:n.episodeDetails.patientComplianceCount[n.serviceCodes.get(n.cptCode)])),I.Db(1),I.rc("ngIf",20>(null==n.episodeDetails?null:n.episodeDetails.patientComplianceCount[n.serviceCodes.get(n.cptCode)]))}}function ko(e,t){1&e&&(I.Xb(0,"label"),I.Xc(1," No call activity yet "),I.Wb())}function wo(e,t){1&e&&(I.Vb(0),I.Xc(1),I.jc(2,"translate"),I.Ub()),2&e&&(I.Db(1),I.Yc(I.kc(2,1,"TMS.ADD")))}function Lo(e,t){1&e&&(I.Vb(0),I.Xc(1),I.jc(2,"translate"),I.Ub()),2&e&&(I.Db(1),I.Yc(I.kc(2,1,"ADDITIONAL_TMS.ADD")))}function xo(e,t){1&e&&(I.Vb(0),I.Xc(1),I.jc(2,"translate"),I.Ub()),2&e&&(I.Db(1),I.Yc(I.kc(2,1,"ADDITIONAL_TMS.ADD_B")))}var Vo=function(e){return{"shaded-row":e}};function Uo(e,t){if(1&e){var n=I.Yb();I.Xb(0,"tr",11),I.Xb(1,"td"),I.Xc(2),I.jc(3,"date"),I.Wb(),I.Xb(4,"td"),I.Xc(5),I.Wb(),I.Xb(6,"td"),I.Xc(7),I.Wb(),I.Xb(8,"td",12),I.Xc(9),I.Wb(),I.Xb(10,"td"),I.Xc(11),I.Wb(),I.Xb(12,"td"),I.Xb(13,"app-icons",13),I.ec("click",function(){I.Lc(n);var e=t.$implicit,i=I.ic(2);return i.showLogDetails(e,null==i.episodeDetails?null:i.episodeDetails.monitoringStaff[null==e?null:e.staffId])}),I.Wb(),I.Xc(14," \xa0 "),I.Xb(15,"app-icons",14),I.ec("click",function(){I.Lc(n);var e=t.$implicit;return I.ic(2).showTMSModal(e)}),I.Wb(),I.Xc(16," \xa0 "),I.Xb(17,"a",15),I.ec("nzOnConfirm",function(){I.Lc(n);var e=t.$implicit;return I.ic(2).delete(null==e?null:e.id)}),I.Sb(18,"app-icons",16),I.Wb(),I.Wb(),I.Wb()}if(2&e){var i=t.$implicit,a=t.index,o=I.ic(2);I.rc("ngClass",I.yc(10,Vo,a%2!=0)),I.Db(2),I.Yc(I.lc(3,7,null==i?null:i.startTime,"MMM dd yyyy hh:mm")),I.Db(3),I.Yc(((null==i?null:i.endTime)-(null==i?null:i.startTime))/6e4),I.Db(2),I.Yc(o.mode.get(null==i?null:i.mode)),I.Db(1),I.rc("nzTooltipTitle",null==i?null:i.notes),I.Db(1),I.Yc(null==i?null:i.activity),I.Db(2),I.Yc(null==o.episodeDetails?null:o.episodeDetails.monitoringStaff[null==i?null:i.staffId])}}var Fo=function(){return{x:"1175px"}};function jo(e,t){if(1&e&&(I.Vb(0),I.Sb(1,"br"),I.Xb(2,"nz-table",8,9),I.Xb(4,"thead"),I.Xb(5,"tr"),I.Xb(6,"th"),I.Xc(7),I.jc(8,"translate"),I.Wb(),I.Xb(9,"th"),I.Xc(10),I.jc(11,"translate"),I.Wb(),I.Xb(12,"th"),I.Xc(13),I.jc(14,"translate"),I.Wb(),I.Xb(15,"th"),I.Xc(16),I.jc(17,"translate"),I.Wb(),I.Xb(18,"th"),I.Xc(19),I.jc(20,"translate"),I.Wb(),I.Sb(21,"th"),I.Wb(),I.Wb(),I.Xb(22,"tbody"),I.Vc(23,Uo,19,12,"tr",10),I.Wb(),I.Wb(),I.Ub()),2&e){var n=I.Ic(3),i=I.ic();I.Db(2),I.rc("nzData",null==i.episodeDetails?null:i.episodeDetails.patientCommunications[i.cpt])("nzScroll",I.xc(18,Fo)),I.Db(5),I.Yc(I.kc(8,8,"COMMON.DATE_TIME")),I.Db(3),I.Zc("",I.kc(11,10,"COMMON.DURATION")," (mins)"),I.Db(3),I.Yc(I.kc(14,12,"TMS.COMMUNICATION_MODE")),I.Db(3),I.Yc(I.kc(17,14,"HEADER.ACTIVITY")),I.Db(3),I.Yc(I.kc(20,16,"PATIENT.MONITORING_STAFF")),I.Db(4),I.rc("ngForOf",n.data)}}var Yo,Go=((Yo=function(){function e(t,n,i,a,o){c(this,e),this._dateComparePipe=t,this._notificationsService=n,this._patientCommunicationModalService=i,this._episodesEventLogger=a,this._episodesService=o,this.tmsType="TMS",this.mode=new Map([["VIDEO_CALL","Video Call"],["CALL","Audio Call"],["HOME_VISIT","Home Visit"],["CLINIC_VISIT","In Clinic"],["OTHER","Other"]]),this.serviceCodes=new Map([["TREATMENT_MANAGEMENT_SERVICE","99457"],["ADDITIONAL_TREATMENT_MANAGEMENT_SERVICE","99458"],["ADDITIONAL_TREATMENT_MANAGEMENT_SERVICE_B","99458B"]]),this.serviceCodeTotal=new Map([["TREATMENT_MANAGEMENT_SERVICE",20],["ADDITIONAL_TREATMENT_MANAGEMENT_SERVICE",20],["ADDITIONAL_TREATMENT_MANAGEMENT_SERVICE_B",20]]),this.refreshEpisode=new I.n}return u(e,[{key:"cptCodeSetter",set:function(e){this.cptCode=e,Oo.a.TREATMENT_MANAGEMENT_SERVICE===e?this.cpt="99457":Oo.a.ADDITIONAL_TREATMENT_MANAGEMENT_SERVICE===e?this.cpt="99458":Oo.a.ADDITIONAL_TREATMENT_MANAGEMENT_SERVICE_B===e&&(this.cpt="99458B"),this.checkIfTMSAdditionPossible()}},{key:"ngOnChanges",value:function(e){this.checkIfTMSAdditionPossible()}},{key:"checkIfTMSAdditionPossible",value:function(){var e,t,n,i,a,o,s=!1;s=!!(null===(t=null===(e=this.episodeDetails)||void 0===e?void 0:e.activeCarePlans)||void 0===t?void 0:t.length),(null===(i=null===(n=this.episodeDetails)||void 0===n?void 0:n.activeCarePlans)||void 0===i?void 0:i.length)&&"99458B"===this.cpt&&(s=!0),Oo.a.TREATMENT_MANAGEMENT_SERVICE===this.cptCode?this.canAddTMS=s:Oo.a.ADDITIONAL_TREATMENT_MANAGEMENT_SERVICE===this.cptCode?(null===(a=this.episodeDetails)||void 0===a?void 0:a.patientComplianceCount[99457])>=20&&s&&(this.canAddTMS=!0):Oo.a.ADDITIONAL_TREATMENT_MANAGEMENT_SERVICE_B===this.cptCode&&(null===(o=this.episodeDetails)||void 0===o?void 0:o.patientComplianceCount[99458])>=20&&s&&(this.canAddTMS=!0)}},{key:"validate",value:function(){var e,t;return this._dateComparePipe.transform(this.episodeDetails.endDate)&&"IN_PROGRESS"===this.episodeDetails.status?!!(null===(t=null===(e=this.episodeDetails)||void 0===e?void 0:e.availableConsents)||void 0===t?void 0:t.length):(this._notificationsService.error("Episode Suspended","This episode has been suspended and no further activities can be assigned."),!1)}},{key:"showTMSModal",value:function(e){var t,n,i,a,o=this;if(this.validate()){this._episodesEventLogger.episodeTMSActionEvent(this.episodeDetails.id,this.episodeDetails.patientId,"episode_add_tms");var s=null===(t=this.episodeDetails)||void 0===t?void 0:t.activeCarePlans[(null===(i=null===(n=this.episodeDetails)||void 0===n?void 0:n.activeCarePlans)||void 0===i?void 0:i.length)-1];switch(this.cptCode){case Oo.a.TREATMENT_MANAGEMENT_SERVICE:this.tmsType="TMS",this.episodeTMSProgress=this.episodeDetails.episodeProgress;break;case Oo.a.ADDITIONAL_TREATMENT_MANAGEMENT_SERVICE:this.tmsType="ADDITIONAL_TMS",this.episodeTMSProgress=this.episodeDetails.episodeAdditionalTmsProgress;break;case Oo.a.ADDITIONAL_TREATMENT_MANAGEMENT_SERVICE_B:this.tmsType="ADDITIONAL_TMS_B",this.episodeTMSProgress=this.episodeDetails.episodeAdditionalTmsProgress}this._patientCommunicationModalService.createTMSModal(this.patient,null===(a=this.episodeDetails)||void 0===a?void 0:a.id,this.tmsType,this.cptCode,new Date(null==s?void 0:s.startDate),void 0,void 0,void 0,"OTHER",e).afterClose.subscribe(function(e){e&&o.refreshEpisodeState()})}}},{key:"showLogDetails",value:function(e,t){this._patientCommunicationModalService.createLogDetailsModal(e,t)}},{key:"delete",value:function(e){var t=this;this.validate()&&this._episodesService.archivePatientCommunication(e).subscribe(function(){t._notificationsService.success("Patient Communication","Note deleted successfully!"),t.refreshEpisodeState()})}},{key:"refreshEpisodeState",value:function(){this.refreshEpisode.emit(!0)}}]),e}()).\u0275fac=function(e){return new(e||Yo)(I.Rb(va.a),I.Rb(T.b),I.Rb(Eo.a),I.Rb(Ye.a),I.Rb(bn.a))},Yo.\u0275cmp=I.Lb({type:Yo,selectors:[["app-treatment-management-service"]],inputs:{episodeDetails:"episodeDetails",patient:"patient",cptCodeSetter:["cptCode","cptCodeSetter"]},outputs:{refreshEpisode:"refreshEpisode"},features:[I.Cb([va.a]),I.Bb],decls:19,vars:14,consts:[["nz-row",""],["nz-col","","nzXs","24","nzSm","24","nzMd","21"],["nz-typography",""],["nz-typography","",3,"nzType",4,"ngIf"],["nz-typography","",3,"nzType"],[4,"ngIf"],["nz-col","","nzXs","24","nzSm","24","nzMd","3","id","actions"],["nz-button","","nzType","primary","nzSize","large",3,"disabled","click"],["nzShowPagination","false","nzSize","small","nzBordered","false",3,"nzData","nzScroll"],["tmsTable",""],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],["nz-tooltip","",3,"nzTooltipTitle"],["size","16px","name","view","nz-tooltip","","nzTooltipTitle","View",3,"click"],["size","16px","name","profileEdit","nz-tooltip","","nzTooltipTitle","Edit",3,"click"],["nz-popconfirm","","nzPopconfirmTitle","Are you sure you want to delete this record ?","nzPopconfirmPlacement","bottom",3,"nzOnConfirm"],["name","delete","size","16px","color","#c81c1c"]],template:function(e,t){1&e&&(I.Xb(0,"nz-card"),I.Xb(1,"div",0),I.Xb(2,"div",1),I.Xb(3,"h3",2),I.Vc(4,Ro,3,3,"span",3),I.Xb(5,"span",4),I.Xc(6),I.Wb(),I.Vb(7),I.Xc(8),I.jc(9,"translate"),I.Ub(),I.Wb(),I.Vc(10,ko,2,0,"label",5),I.Wb(),I.Xb(11,"div",6),I.Xb(12,"button",7),I.ec("click",function(){return t.showTMSModal()}),I.jc(13,"validConsent"),I.Vc(14,wo,3,3,"ng-container",5),I.Vc(15,Lo,3,3,"ng-container",5),I.Vc(16,xo,3,3,"ng-container",5),I.Wb(),I.Wb(),I.Wb(),I.Vc(17,jo,24,19,"ng-container",5),I.Wb(),I.Sb(18,"br")),2&e&&(I.Db(4),I.rc("ngIf",!1),I.Db(1),I.rc("nzType",0===(null==t.episodeDetails?null:t.episodeDetails.patientComplianceCount[t.serviceCodes.get(t.cptCode)])?"-":"success"),I.Db(1),I.Zc(" ",null==t.episodeDetails?null:t.episodeDetails.patientComplianceCount[t.serviceCodes.get(t.cptCode)]," "),I.Db(2),I.Zc(" ",I.kc(9,10,t.cptCode)," "),I.Db(2),I.rc("ngIf",!(null!=t.episodeDetails&&t.episodeDetails.patientCommunications&&null!=t.episodeDetails&&null!=t.episodeDetails.patientCommunications[t.cpt]&&t.episodeDetails.patientCommunications[t.cpt].length)),I.Db(2),I.rc("disabled",!I.kc(13,12,t.episodeDetails)||!t.canAddTMS),I.Db(2),I.rc("ngIf","99457"===t.cpt),I.Db(1),I.rc("ngIf","99458"===t.cpt),I.Db(1),I.rc("ngIf","99458B"===t.cpt),I.Db(1),I.rc("ngIf",(null==t.episodeDetails?null:t.episodeDetails.patientCommunications)&&(null==t.episodeDetails||null==t.episodeDetails.patientCommunications[t.cpt]?null:t.episodeDetails.patientCommunications[t.cpt].length)))},directives:[z.a,N.c,N.a,P.a,r.q,kt.a,wt.a,L.a,Va.f,Va.n,Va.o,Va.e,Va.l,Va.i,r.p,r.o,it.d,ve.a,ma.a],pipes:[se.a,Aa,r.e],styles:[".ant-card[_ngcontent-%COMP%]{padding:10px}h3[_ngcontent-%COMP%]{margin-bottom:0}label[_ngcontent-%COMP%]{font:normal normal normal 13px/16px Nunito;color:var(--tertiary-color);margin-bottom:5px;display:block}#actions[_ngcontent-%COMP%]{text-align:right}[_nghost-%COMP%]     .ant-table-thead>tr>th{height:50px!important}[_nghost-%COMP%]     .ant-table-tbody>tr>td{border-bottom:none}.shaded-row[_ngcontent-%COMP%]{background-color:var(--light-grey)}"]}),Yo);function Bo(e,t){1&e&&(I.Xb(0,"label"),I.Xc(1," No call activity yet "),I.Wb())}var Ho=function(e){return{"shaded-row":e}};function Zo(e,t){if(1&e){var n=I.Yb();I.Xb(0,"tr",9),I.Xb(1,"td"),I.Xc(2),I.jc(3,"date"),I.Wb(),I.Xb(4,"td"),I.Xc(5),I.Wb(),I.Xb(6,"td"),I.Xc(7),I.Wb(),I.Xb(8,"td",10),I.Xc(9),I.Wb(),I.Xb(10,"td"),I.Xc(11),I.Wb(),I.Xb(12,"td"),I.Xb(13,"app-icons",11),I.ec("click",function(){I.Lc(n);var e=t.$implicit,i=I.ic(2);return i.showLogDetails(e,null==i.episodeDetails?null:i.episodeDetails.monitoringStaff[null==e?null:e.staffId])}),I.Wb(),I.Xc(14," \xa0 "),I.Xb(15,"app-icons",12),I.ec("click",function(){I.Lc(n);var e=t.$implicit;return I.ic(2).showCMTModal(e)}),I.Wb(),I.Wb(),I.Wb()}if(2&e){var i=t.$implicit,a=t.index,o=I.ic(2);I.rc("ngClass",I.yc(10,Ho,a%2!=0)),I.Db(2),I.Yc(I.lc(3,7,null==i?null:i.startTime,"MMM dd yyyy hh:mm")),I.Db(3),I.Yc(((null==i?null:i.endTime)-(null==i?null:i.startTime))/6e4),I.Db(2),I.Yc(o.mode.get(null==i?null:i.mode)),I.Db(1),I.rc("nzTooltipTitle",null==i?null:i.notes),I.Db(1),I.Yc(null==i?null:i.activity),I.Db(2),I.Yc(null==o.episodeDetails?null:o.episodeDetails.monitoringStaff[null==i?null:i.staffId])}}var qo=function(){return{x:"1175px"}};function $o(e,t){if(1&e&&(I.Vb(0),I.Sb(1,"br"),I.Xb(2,"nz-table",6,7),I.Xb(4,"thead"),I.Xb(5,"tr"),I.Xb(6,"th"),I.Xc(7),I.jc(8,"translate"),I.Wb(),I.Xb(9,"th"),I.Xc(10),I.jc(11,"translate"),I.Wb(),I.Xb(12,"th"),I.Xc(13),I.jc(14,"translate"),I.Wb(),I.Xb(15,"th"),I.Xc(16),I.jc(17,"translate"),I.Wb(),I.Xb(18,"th"),I.Xc(19),I.jc(20,"translate"),I.Wb(),I.Sb(21,"th"),I.Wb(),I.Wb(),I.Xb(22,"tbody"),I.Vc(23,Zo,16,12,"tr",8),I.Wb(),I.Wb(),I.Ub()),2&e){var n=I.Ic(3),i=I.ic();I.Db(2),I.rc("nzData",null==i.episodeDetails?null:i.episodeDetails.patientCommunications[99484])("nzScroll",I.xc(18,qo)),I.Db(5),I.Yc(I.kc(8,8,"COMMON.DATE_TIME")),I.Db(3),I.Zc("",I.kc(11,10,"COMMON.DURATION")," (mins)"),I.Db(3),I.Yc(I.kc(14,12,"TMS.COMMUNICATION_MODE")),I.Db(3),I.Yc(I.kc(17,14,"HEADER.ACTIVITY")),I.Db(3),I.Yc(I.kc(20,16,"PATIENT.MONITORING_STAFF")),I.Db(4),I.rc("ngForOf",n.data)}}var Ko,Qo=((Ko=function(){function e(t,n,i,a){c(this,e),this._dateComparePipe=t,this._notificationsService=n,this._patientCommunicationModalService=i,this._episodesEventLogger=a,this.mode=new Map([["VIDEO_CALL","Video Call"],["CALL","Audio Call"],["HOME_VISIT","Home Visit"],["CLINIC_VISIT","In Clinic"],["OTHER","Other"]]),this.refreshEpisode=new I.n}return u(e,[{key:"cptCodeSetter",set:function(e){this.cptCode=e}},{key:"validate",value:function(){return!(!this._dateComparePipe.transform(this.episodeDetails.endDate)||"IN_PROGRESS"!==this.episodeDetails.status&&"SCHEDULED"!==this.episodeDetails.status)||(this._notificationsService.error("Episode Suspended","This episode has been suspended and no further activities can be assigned."),!1)}},{key:"showCMTModal",value:function(e){var t,n,i=this;if(this.validate()){this._episodesEventLogger.episodeCMTActionEvent(this.episodeDetails.id,this.episodeDetails.patientId,"episode_add_cmt");var a={id:this.patient.id,name:null===(t=this.patient)||void 0===t?void 0:t.fullName,dxCodes:this.patient.healthInfo.dxCodes,episode:{id:null===(n=this.episodeDetails)||void 0===n?void 0:n.id}};this._patientCommunicationModalService.createTOCTMS(a,void 0,e).afterClose.subscribe(function(e){e&&i.refreshEpisodeState()})}}},{key:"showLogDetails",value:function(e,t){this._patientCommunicationModalService.createLogDetailsModal(e,t)}},{key:"refreshEpisodeState",value:function(){this.refreshEpisode.emit(!0)}}]),e}()).\u0275fac=function(e){return new(e||Ko)(I.Rb(va.a),I.Rb(T.b),I.Rb(Eo.a),I.Rb(Ye.a))},Ko.\u0275cmp=I.Lb({type:Ko,selectors:[["app-toc-care-management-time"]],inputs:{patient:"patient",episodeDetails:"episodeDetails",cptCodeSetter:["cptCode","cptCodeSetter"]},outputs:{refreshEpisode:"refreshEpisode"},features:[I.Cb([va.a])],decls:13,vars:9,consts:[["nz-row",""],["nz-col","","nzXs","24","nzSm","18","nzMd","21"],["nz-typography",""],[4,"ngIf"],["nz-col","","nzXs","24","nzSm","6","nzMd","3","id","actions"],["nz-button","","nzType","primary","nzSize","large",3,"disabled","click"],["nzShowPagination","false","nzSize","small","nzBordered","false",3,"nzData","nzScroll"],["cmtTable",""],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],["nz-tooltip","",3,"nzTooltipTitle"],["size","16px","name","view","nz-tooltip","","nzTooltipTitle","View",3,"click"],["size","16px","name","profileEdit","nz-tooltip","","nzTooltipTitle","Edit",3,"click"]],template:function(e,t){1&e&&(I.Xb(0,"nz-card"),I.Xb(1,"div",0),I.Xb(2,"div",1),I.Xb(3,"h3",2),I.Xc(4),I.Wb(),I.Vc(5,Bo,2,0,"label",3),I.Wb(),I.Xb(6,"div",4),I.Xb(7,"button",5),I.ec("click",function(){return t.showCMTModal()}),I.jc(8,"validConsent"),I.Xc(9),I.jc(10,"translate"),I.Wb(),I.Wb(),I.Wb(),I.Vc(11,$o,24,19,"ng-container",3),I.Wb(),I.Sb(12,"br")),2&e&&(I.Db(4),I.Zc(" ",null==t.episodeDetails?null:t.episodeDetails.patientComplianceCount[99484]," CMT minutes completed "),I.Db(1),I.rc("ngIf",!(null!=t.episodeDetails&&t.episodeDetails.patientCommunications&&null!=t.episodeDetails&&null!=t.episodeDetails.patientCommunications[99484]&&t.episodeDetails.patientCommunications[99484].length)),I.Db(2),I.rc("disabled",!I.kc(8,5,t.episodeDetails)),I.Db(2),I.Zc(" ",I.kc(10,7,"CMT.ADD")," "),I.Db(2),I.rc("ngIf",(null==t.episodeDetails?null:t.episodeDetails.patientCommunications)&&(null==t.episodeDetails||null==t.episodeDetails.patientCommunications[99484]?null:t.episodeDetails.patientCommunications[99484].length)))},directives:[z.a,N.c,N.a,P.a,r.q,kt.a,wt.a,L.a,Va.f,Va.n,Va.o,Va.e,Va.l,Va.i,r.p,r.o,it.d,ve.a],pipes:[Aa,se.a,r.e],styles:[".ant-card[_ngcontent-%COMP%]{padding:10px}h3[_ngcontent-%COMP%]{margin-bottom:0}label[_ngcontent-%COMP%]{font:normal normal normal 13px/16px Nunito;color:var(--tertiary-color);margin-bottom:5px;display:block}#actions[_ngcontent-%COMP%]{text-align:right}[_nghost-%COMP%]     .ant-table-thead>tr>th{height:50px!important}[_nghost-%COMP%]     .ant-table-tbody>tr>td{border-bottom:none}.shaded-row[_ngcontent-%COMP%]{background-color:var(--light-grey)}"]}),Ko),Jo=o("l6l4");function es(e,t){1&e&&(I.Vb(0),I.Xc(1," 0 "),I.Ub())}function ts(e,t){if(1&e&&(I.Vb(0),I.Xc(1),I.Ub()),2&e){var n=I.ic(2);I.Db(1),I.Zc(" ",n.serviceCodeTotal.get(n.cptCode)-(null==n.episodeDetails?null:n.episodeDetails.patientComplianceCount[n.serviceCodes.get(n.cptCode)])," ")}}function ns(e,t){if(1&e&&(I.Xb(0,"span",4),I.Vc(1,es,2,0,"ng-container",5),I.Vc(2,ts,2,1,"ng-container",5),I.Wb()),2&e){var n=I.ic();I.rc("nzType",0===(null==n.episodeDetails?null:n.episodeDetails.patientComplianceCount[n.serviceCodes.get(n.cptCode)])?"-":"success"),I.Db(1),I.rc("ngIf",20<=(null==n.episodeDetails?null:n.episodeDetails.patientComplianceCount[n.serviceCodes.get(n.cptCode)])),I.Db(1),I.rc("ngIf",20>(null==n.episodeDetails?null:n.episodeDetails.patientComplianceCount[n.serviceCodes.get(n.cptCode)]))}}function is(e,t){1&e&&(I.Xb(0,"label"),I.Xc(1," No call activity yet "),I.Wb())}var as=function(e){return{"shaded-row":e}};function os(e,t){if(1&e){var n=I.Yb();I.Xb(0,"tr",12),I.Xb(1,"td"),I.Xc(2),I.jc(3,"date"),I.Wb(),I.Xb(4,"td"),I.Xc(5),I.Wb(),I.Xb(6,"td"),I.Xc(7),I.Wb(),I.Xb(8,"td",13),I.Xc(9),I.Wb(),I.Xb(10,"td"),I.Xc(11),I.Wb(),I.Xb(12,"td"),I.Xb(13,"app-icons",14),I.ec("click",function(){I.Lc(n);var e=t.$implicit,i=I.ic(2);return i.showLogDetails(e,null==i.episodeDetails?null:i.episodeDetails.monitoringStaff[null==e?null:e.staffId])}),I.Wb(),I.Xc(14," \xa0 "),I.Xb(15,"app-icons",15),I.ec("click",function(){I.Lc(n);var e=t.$implicit;return I.ic(2).showTMSModal(e)}),I.Wb(),I.Xc(16," \xa0 "),I.Xb(17,"a",16),I.ec("nzOnConfirm",function(){I.Lc(n);var e=t.$implicit;return I.ic(2).delete(null==e?null:e.id)}),I.Sb(18,"app-icons",17),I.Wb(),I.Wb(),I.Wb()}if(2&e){var i=t.$implicit,a=t.index,o=I.ic(2);I.rc("ngClass",I.yc(11,as,a%2!=0)),I.Db(2),I.Yc(I.lc(3,8,null==i?null:i.startTime,"MMM dd yyyy hh:mm")),I.Db(3),I.Yc(((null==i?null:i.endTime)-(null==i?null:i.startTime))/6e4),I.Db(2),I.Yc(o.mode.get(null==i?null:i.mode)),I.Db(1),I.rc("nzTooltipTitle",null==i?null:i.notes)("nzEllipsisRows",2),I.Db(1),I.Zc(" ",null==i?null:i.activity," "),I.Db(2),I.Yc(null==o.episodeDetails?null:o.episodeDetails.monitoringStaff[null==i?null:i.staffId])}}var ss=function(){return{x:"1175px"}};function ls(e,t){if(1&e&&(I.Vb(0),I.Sb(1,"br"),I.Xb(2,"nz-table",9,10),I.Xb(4,"thead"),I.Xb(5,"tr"),I.Xb(6,"th"),I.Xc(7),I.jc(8,"translate"),I.Wb(),I.Xb(9,"th"),I.Xc(10),I.jc(11,"translate"),I.Wb(),I.Xb(12,"th"),I.Xc(13),I.jc(14,"translate"),I.Wb(),I.Xb(15,"th"),I.Xc(16),I.jc(17,"translate"),I.Wb(),I.Xb(18,"th"),I.Xc(19),I.jc(20,"translate"),I.Wb(),I.Sb(21,"th"),I.Wb(),I.Wb(),I.Xb(22,"tbody"),I.Vc(23,os,19,13,"tr",11),I.Wb(),I.Wb(),I.Ub()),2&e){var n=I.Ic(3),i=I.ic();I.Db(2),I.rc("nzData",null==i.episodeDetails?null:i.episodeDetails.patientCommunications[i.serviceCodes.get(i.cptCode)])("nzScroll",I.xc(18,ss)),I.Db(5),I.Yc(I.kc(8,8,"COMMON.DATE_TIME")),I.Db(3),I.Zc("",I.kc(11,10,"COMMON.DURATION")," (mins)"),I.Db(3),I.Yc(I.kc(14,12,"TMS.COMMUNICATION_MODE")),I.Db(3),I.Yc(I.kc(17,14,"HEADER.ACTIVITY")),I.Db(3),I.Yc(I.kc(20,16,"PATIENT.MONITORING_STAFF")),I.Db(4),I.rc("ngForOf",n.data)}}var rs,cs=((rs=function(){function e(t,n,i,a,o,s){c(this,e),this._dateComparePipe=t,this._notificationsService=n,this._patientCommunicationModalService=i,this._episodesEventLogger=a,this._analyticsService=o,this._episodesService=s,this.mode=new Map([["VIDEO_CALL","Video Call"],["CALL","Audio Call"],["INBOUND_CALL","Inbound Call"],["OUTBOUND_CALL","Outbound Call"],["HOME_VISIT","Home Visit"],["CLINIC_VISIT","In Clinic"],["OTHER","Other"]]),this.serviceCodes=new Map([["NON_COMPLEX_TMS","99490"],["NON_COMPLEX_TMS_PHYSICIAN","99491"],["NON_COMPLEX_ADDITIONAL_TMS","99439"],["NON_COMPLEX_ADDITIONAL_TMS_B","99439B"],["COMPLEX_TMS","99487"],["COMPLEX_ADDITIONAL_TMS","99489"]]),this.serviceCodeTotal=new Map([["NON_COMPLEX_TMS",20],["NON_COMPLEX_TMS_PHYSICIAN",30],["NON_COMPLEX_ADDITIONAL_TMS",20],["NON_COMPLEX_ADDITIONAL_TMS_B",20],["COMPLEX_TMS",60],["COMPLEX_ADDITIONAL_TMS",30]]),this.refreshEpisode=new I.n}return u(e,[{key:"cptCodeSetter",set:function(e){this.cptCode=e}},{key:"ngOnChanges",value:function(){this.checkIfTMSAdditionPossible()}},{key:"checkIfTMSAdditionPossible",value:function(){var e,t,n,i,a,o,s=!1;Oo.a.NON_COMPLEX_TMS===this.cptCode&&(null===(e=this.episodeDetails)||void 0===e?void 0:e.patientComplianceCount[99490])<20&&(s=!0),Oo.a.NON_COMPLEX_ADDITIONAL_TMS===this.cptCode&&(null===(t=this.episodeDetails)||void 0===t?void 0:t.patientComplianceCount[99490])>=20&&(null===(n=this.episodeDetails)||void 0===n?void 0:n.patientComplianceCount[99439])<20&&(s=!0),Oo.a.NON_COMPLEX_ADDITIONAL_TMS_B===this.cptCode&&(null===(i=this.episodeDetails)||void 0===i?void 0:i.patientComplianceCount[99439])>=20&&(s=!0),Oo.a.NON_COMPLEX_TMS_PHYSICIAN===this.cptCode&&(s=!0),Oo.a.COMPLEX_TMS===this.cptCode&&(null===(a=this.episodeDetails)||void 0===a?void 0:a.patientComplianceCount[99487])<60&&(s=!0),Oo.a.COMPLEX_ADDITIONAL_TMS===this.cptCode&&(null===(o=this.episodeDetails)||void 0===o?void 0:o.patientComplianceCount[99487])>=60&&(s=!0),this.canAddTMS=s}},{key:"validate",value:function(){return!!this._dateComparePipe.transform(this.episodeDetails.endDate)||(this._notificationsService.error("Episode Status","The episode is not in active state, no further activities can be assigned."),!1)}},{key:"showTMSModal",value:function(e){var t,n,i,a=this;if(this.validate()){this._episodesEventLogger.episodeTMSActionEvent(this.episodeDetails.id,this.episodeDetails.patientId,"episode_add_tms");var o={id:this.episodeDetails.patientId,name:null===(t=this.patient)||void 0===t?void 0:t.fullName,dxCodes:null===(i=null===(n=this.patient)||void 0===n?void 0:n.healthInfo)||void 0===i?void 0:i.dxCodes,episode:{id:this.episodeDetails.id,startDate:this.episodeDetails.startDate,endDate:this.episodeDetails.endDate,blueprintId:this.episodeDetails.blueprintId,totalNonComplexTMSCompleted:this.episodeDetails.patientComplianceCount[99490],totalNonComplexTMSPhysicianCompleted:this.episodeDetails.patientComplianceCount[99491],totalComplexTMSCompleted:this.episodeDetails.patientComplianceCount[99487],totalComplexAdditionalTMSCompleted:this.episodeDetails.patientComplianceCount[99489]}};this._patientCommunicationModalService.createCCMTMS(o,this.episodeDetails.blueprintId,this.cptCode,"EPISODE_SCREEN",e).afterClose.subscribe(function(e){e&&a.refreshEpisodeState()})}}},{key:"showLogDetails",value:function(e,t){this._patientCommunicationModalService.createLogDetailsModal(e,t)}},{key:"downloadReport",value:function(){var e=new Date,t=e.getUTCMonth()+1,n=e.getUTCFullYear(),i=t<10?n+"-0"+t:n+"-"+t;this._analyticsService.generatePatientCommunicationReport(this.episodeDetails.patientId,this.serviceCodes.get("".concat(this.cptCode)),i).subscribe(function(e){window.open("https://api.cooeyhealth.com/v1/assets/view/?filename=".concat(e.filename,"&asset-type=REPORTS"),"_blank")})}},{key:"delete",value:function(e){var t=this;this.validate()&&this._episodesService.archivePatientCommunication(e).subscribe(function(){t._notificationsService.success("Patient Communication","Note deleted successfully!"),t.refreshEpisodeState()})}},{key:"refreshEpisodeState",value:function(){this.refreshEpisode.emit(!0)}}]),e}()).\u0275fac=function(e){return new(e||rs)(I.Rb(va.a),I.Rb(T.b),I.Rb(Eo.a),I.Rb(Ye.a),I.Rb(Jo.a),I.Rb(bn.a))},rs.\u0275cmp=I.Lb({type:rs,selectors:[["app-ccm-treatment-management-services"]],inputs:{episodeDetails:"episodeDetails",patient:"patient",cptCodeSetter:["cptCode","cptCodeSetter"]},outputs:{refreshEpisode:"refreshEpisode"},features:[I.Cb([va.a]),I.Bb],decls:22,vars:13,consts:[["nz-row",""],["nz-col","","nzXs","24","nzSm","24","nzMd","14"],["nz-typography",""],["nz-typography","",3,"nzType",4,"ngIf"],["nz-typography","",3,"nzType"],[4,"ngIf"],["nz-col","","nzXs","24","nzSm","24","nzMd","10","id","actions"],["nz-button","","nzType","primary","nzSize","large",3,"disabled","click"],["nz-button","","nzSize","large",3,"disabled","click"],["nzShowPagination","false","nzSize","small","nzBordered","false",3,"nzData","nzScroll"],["tmsTable",""],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],["nz-tooltip","","nzEllipsis","",3,"nzTooltipTitle","nzEllipsisRows"],["size","16px","name","view","nz-tooltip","","nzTooltipTitle","View",3,"click"],["size","16px","name","profileEdit","nz-tooltip","","nzTooltipTitle","Edit",3,"click"],["nz-popconfirm","","nzPopconfirmTitle","Are you sure you want to delete this record ?","nzPopconfirmPlacement","bottom",3,"nzOnConfirm"],["name","delete","size","16px","color","#c81c1c"]],template:function(e,t){1&e&&(I.Xb(0,"nz-card"),I.Xb(1,"div",0),I.Xb(2,"div",1),I.Xb(3,"h3",2),I.Vc(4,ns,3,3,"span",3),I.Xb(5,"span",4),I.Xc(6),I.Wb(),I.Vb(7),I.Xc(8),I.jc(9,"translate"),I.Ub(),I.Wb(),I.Vc(10,is,2,0,"label",5),I.Wb(),I.Xb(11,"div",6),I.Xb(12,"button",7),I.ec("click",function(){return t.showTMSModal()}),I.Vb(13),I.Xc(14),I.jc(15,"translate"),I.Ub(),I.Wb(),I.Xc(16," \xa0\xa0 "),I.Xb(17,"button",8),I.ec("click",function(){return t.downloadReport()}),I.Vb(18),I.Xc(19," Download as PDF "),I.Ub(),I.Wb(),I.Wb(),I.Wb(),I.Vc(20,ls,24,19,"ng-container",5),I.Wb(),I.Sb(21,"br")),2&e&&(I.Db(4),I.rc("ngIf",!1),I.Db(1),I.rc("nzType",0===(null==t.episodeDetails?null:t.episodeDetails.patientComplianceCount[t.serviceCodes.get(t.cptCode)])?"-":"success"),I.Db(1),I.Zc(" ",null==t.episodeDetails?null:t.episodeDetails.patientComplianceCount[t.serviceCodes.get(t.cptCode)]," "),I.Db(2),I.Zc(" ",I.kc(9,9,t.cptCode)," "),I.Db(2),I.rc("ngIf",!(null!=t.episodeDetails&&t.episodeDetails.patientCommunications&&null!=t.episodeDetails&&null!=t.episodeDetails.patientCommunications[t.serviceCodes.get(t.cptCode)]&&t.episodeDetails.patientCommunications[t.serviceCodes.get(t.cptCode)].length)),I.Db(2),I.rc("disabled","SUSPENDED"===(null==t.episodeDetails?null:t.episodeDetails.status)),I.Db(2),I.Zc(" Add ",I.kc(15,11,t.cptCode)," "),I.Db(3),I.rc("disabled","SUSPENDED"===(null==t.episodeDetails?null:t.episodeDetails.status)),I.Db(3),I.rc("ngIf",(null==t.episodeDetails?null:t.episodeDetails.patientCommunications)&&(null==t.episodeDetails||null==t.episodeDetails.patientCommunications[t.serviceCodes.get(t.cptCode)]?null:t.episodeDetails.patientCommunications[t.serviceCodes.get(t.cptCode)].length)))},directives:[z.a,N.c,N.a,P.a,r.q,kt.a,wt.a,L.a,Va.f,Va.n,Va.o,Va.e,Va.l,Va.i,r.p,r.o,Va.c,it.d,ve.a,ma.a],pipes:[se.a,r.e],styles:["#actions[_ngcontent-%COMP%]{text-align:right}"]}),rs);function ds(e,t){1&e&&(I.Xb(0,"label"),I.Xc(1," No call activity yet "),I.Wb())}var us=function(e){return{"shaded-row":e}};function bs(e,t){if(1&e){var n=I.Yb();I.Xb(0,"tr",7),I.Xb(1,"td"),I.Xc(2),I.jc(3,"date"),I.Wb(),I.Xb(4,"td"),I.Xc(5),I.Wb(),I.Xb(6,"td"),I.Xc(7),I.Wb(),I.Xb(8,"td",8),I.Xc(9),I.Wb(),I.Xb(10,"td"),I.Xc(11),I.Wb(),I.Xb(12,"td"),I.Xb(13,"app-icons",9),I.ec("click",function(){I.Lc(n);var e=t.$implicit,i=I.ic(2);return i.showLogDetails(e,null==i.episodeDetails?null:i.episodeDetails.monitoringStaff[null==e?null:e.staffId])}),I.Wb(),I.Xc(14," \xa0 "),I.Xb(15,"app-icons",10),I.ec("click",function(){I.Lc(n);var e=t.$implicit;return I.ic(2).showTMSModal(e)}),I.Wb(),I.Wb(),I.Wb()}if(2&e){var i=t.$implicit,a=t.index,o=I.ic(2);I.rc("ngClass",I.yc(11,us,a%2!=0)),I.Db(2),I.Yc(I.lc(3,8,null==i?null:i.startTime,"MMM dd yyyy hh:mm")),I.Db(3),I.Yc(((null==i?null:i.endTime)-(null==i?null:i.startTime))/6e4),I.Db(2),I.Yc(o.mode.get(null==i?null:i.mode)),I.Db(1),I.rc("nzTooltipTitle",null==i?null:i.notes)("nzEllipsisRows",2),I.Db(1),I.Zc(" ",null==i?null:i.activity," "),I.Db(2),I.Yc(null==o.episodeDetails?null:o.episodeDetails.monitoringStaff[null==i?null:i.staffId])}}var ps=function(){return{x:"1175px"}};function fs(e,t){if(1&e&&(I.Vb(0),I.Sb(1,"br"),I.Xb(2,"nz-table",4,5),I.Xb(4,"thead"),I.Xb(5,"tr"),I.Xb(6,"th"),I.Xc(7),I.jc(8,"translate"),I.Wb(),I.Xb(9,"th"),I.Xc(10),I.jc(11,"translate"),I.Wb(),I.Xb(12,"th"),I.Xc(13),I.jc(14,"translate"),I.Wb(),I.Xb(15,"th"),I.Xc(16),I.jc(17,"translate"),I.Wb(),I.Xb(18,"th"),I.Xc(19),I.jc(20,"translate"),I.Wb(),I.Sb(21,"th"),I.Wb(),I.Wb(),I.Xb(22,"tbody"),I.Vc(23,bs,16,13,"tr",6),I.Wb(),I.Wb(),I.Ub()),2&e){var n=I.Ic(3),i=I.ic();I.Db(2),I.rc("nzData",null==i.episodeDetails?null:i.episodeDetails.patientCommunications[i.serviceCodes.get(i.cptCode)])("nzScroll",I.xc(18,ps)),I.Db(5),I.Yc(I.kc(8,8,"COMMON.DATE_TIME")),I.Db(3),I.Zc("",I.kc(11,10,"COMMON.DURATION")," (mins)"),I.Db(3),I.Yc(I.kc(14,12,"TMS.COMMUNICATION_MODE")),I.Db(3),I.Yc(I.kc(17,14,"HEADER.ACTIVITY")),I.Db(3),I.Yc(I.kc(20,16,"PATIENT.MONITORING_STAFF")),I.Db(4),I.rc("ngForOf",n.data)}}var vs,hs=((vs=function(){function e(t,n,i,a){c(this,e),this._dateComparePipe=t,this._notificationsService=n,this._patientCommunicationModalService=i,this._episodesEventLogger=a,this.mode=new Map([["VIDEO_CALL","Video Call"],["CALL","Audio Call"],["INBOUND_CALL","Inbound Call"],["OUTBOUND_CALL","Outbound Call"],["HOME_VISIT","Home Visit"],["CLINIC_VISIT","In Clinic"],["OTHER","Other"]]),this.serviceCodes=new Map([["NON_COMPLEX_TMS","99490"],["NON_COMPLEX_TMS_PHYSICIAN","99491"],["NON_COMPLEX_ADDITIONAL_TMS","99439"],["NON_COMPLEX_ADDITIONAL_TMS_B","99439B"],["COMPLEX_TMS","99487"],["COMPLEX_ADDITIONAL_TMS","99489"],["UNKNOWN","UNKNOWN"]]),this.serviceCodeTotal=new Map([["NON_COMPLEX_TMS",20],["NON_COMPLEX_TMS_PHYSICIAN",30],["NON_COMPLEX_ADDITIONAL_TMS",20],["NON_COMPLEX_ADDITIONAL_TMS_B",20],["COMPLEX_TMS",60],["COMPLEX_ADDITIONAL_TMS",30]]),this.refreshEpisode=new I.n}return u(e,[{key:"cptCodeSetter",set:function(e){this.cptCode=e}},{key:"validate",value:function(){return!!this._dateComparePipe.transform(this.episodeDetails.endDate)||(this._notificationsService.error("Episode Status","The episode is not in active state, no further activities can be assigned."),!1)}},{key:"showTMSModal",value:function(e){var t=this;this.validate()&&(this._episodesEventLogger.episodeTMSActionEvent(this.episodeDetails.id,this.episodeDetails.patientId,"episode_add_tms"),this._patientCommunicationModalService.createCCMTMS({id:this.episodeDetails.patientId,name:this.patientName,episode:{id:this.episodeDetails.id,startDate:this.episodeDetails.startDate,endDate:this.episodeDetails.endDate,blueprintId:this.episodeDetails.blueprintId,totalNonComplexTMSCompleted:this.episodeDetails.patientComplianceCount[99490],totalNonComplexTMSPhysicianCompleted:this.episodeDetails.patientComplianceCount[99491],totalComplexTMSCompleted:this.episodeDetails.patientComplianceCount[99487],totalComplexAdditionalTMSCompleted:this.episodeDetails.patientComplianceCount[99489]}},this.episodeDetails.blueprintId,this.cptCode,"EPISODE_SCREEN",e).afterClose.subscribe(function(e){e&&t.refreshEpisodeState()}))}},{key:"showLogDetails",value:function(e,t){this._patientCommunicationModalService.createLogDetailsModal(e,t)}},{key:"refreshEpisodeState",value:function(){this.refreshEpisode.emit(!0)}}]),e}()).\u0275fac=function(e){return new(e||vs)(I.Rb(va.a),I.Rb(T.b),I.Rb(Eo.a),I.Rb(Ye.a))},vs.\u0275cmp=I.Lb({type:vs,selectors:[["app-non-billed-cmt"]],inputs:{episodeDetails:"episodeDetails",patientName:"patientName",cptCodeSetter:["cptCode","cptCodeSetter"]},outputs:{refreshEpisode:"refreshEpisode"},features:[I.Cb([va.a])],decls:8,vars:2,consts:[["nz-row",""],["nz-col","","nzXs","24","nzSm","24","nzMd","18"],["nz-typography",""],[4,"ngIf"],["nzShowPagination","false","nzSize","small","nzBordered","false",3,"nzData","nzScroll"],["tmsTable",""],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],["nz-tooltip","","nzEllipsis","",3,"nzTooltipTitle","nzEllipsisRows"],["size","16px","name","view","nz-tooltip","","nzTooltipTitle","View",3,"click"],["size","16px","name","profileEdit","nz-tooltip","","nzTooltipTitle","Edit",3,"click"]],template:function(e,t){1&e&&(I.Xb(0,"nz-card"),I.Xb(1,"div",0),I.Xb(2,"div",1),I.Xb(3,"h3",2),I.Xc(4,"Non-Billable CMT"),I.Wb(),I.Vc(5,ds,2,0,"label",3),I.Wb(),I.Wb(),I.Vc(6,fs,24,19,"ng-container",3),I.Wb(),I.Sb(7,"br")),2&e&&(I.Db(5),I.rc("ngIf",!(null!=t.episodeDetails&&t.episodeDetails.patientCommunications&&null!=t.episodeDetails&&null!=t.episodeDetails.patientCommunications[t.serviceCodes.get(t.cptCode)]&&t.episodeDetails.patientCommunications[t.serviceCodes.get(t.cptCode)].length)),I.Db(1),I.rc("ngIf",(null==t.episodeDetails?null:t.episodeDetails.patientCommunications)&&(null==t.episodeDetails||null==t.episodeDetails.patientCommunications[t.serviceCodes.get(t.cptCode)]?null:t.episodeDetails.patientCommunications[t.serviceCodes.get(t.cptCode)].length)))},directives:[z.a,N.c,N.a,P.a,r.q,Va.f,Va.n,Va.o,Va.e,Va.l,Va.i,r.p,r.o,Va.c,it.d,ve.a],pipes:[se.a,r.e],styles:[""]}),vs),gs=o("BQXE");function ms(e,t){if(1&e){var n=I.Yb();I.Xb(0,"app-consent-forms",15),I.ec("consentChanged",function(){return I.Lc(n),I.ic(2).getEpisodeData()}),I.Wb()}if(2&e){var i=I.ic(2);I.rc("episodeDetails",i.episodeDetails)}}function Cs(e,t){if(1&e){var n=I.Yb();I.Xb(0,"app-patient-consent",16),I.ec("episodeChange",function(){return I.Lc(n),I.ic(2).getEpisodeData()}),I.Wb()}if(2&e){var i=I.ic(2);I.rc("episodeDetails",i.episodeDetails)}}function Ds(e,t){if(1&e){var n=I.Yb();I.Xb(0,"app-toc-events",14),I.ec("refreshEpisode",function(e){return I.Lc(n),I.ic(2).getEpisodeData(e)}),I.Wb()}if(2&e){var i=I.ic(2);I.rc("episodeDetails",i.episodeDetails)}}function Ss(e,t){if(1&e){var n=I.Yb();I.Xb(0,"app-appointment",17),I.ec("refreshEpisode",function(){return I.Lc(n),I.ic(2).getEpisodeData()}),I.Wb()}if(2&e){var i=I.ic(2);I.rc("episodeDetails",i.episodeDetails)("user",i.patient)}}function Es(e,t){if(1&e){var n=I.Yb();I.Xb(0,"app-device-setup-tasks",18),I.ec("refreshEpisode",function(){return I.Lc(n),I.ic(2).getEpisodeData()}),I.Wb()}if(2&e){var i=I.ic(2);I.rc("episodeDetails",i.episodeDetails)("patient",i.patient)}}function Os(e,t){if(1&e){var n=I.Yb();I.Xb(0,"app-plan-of-care",18),I.ec("refreshEpisode",function(){return I.Lc(n),I.ic(2).getEpisodeData()}),I.Wb()}if(2&e){var i=I.ic(2);I.rc("episodeDetails",i.episodeDetails)("patient",i.patient)}}function Is(e,t){if(1&e){var n=I.Yb();I.Xb(0,"app-careplan",19),I.ec("refresh",function(){return I.Lc(n),I.ic(2).getEpisodeData()}),I.Wb()}if(2&e){var i=I.ic(2);I.rc("episodeDetails",i.episodeDetails)}}function _s(e,t){if(1&e){var n=I.Yb();I.Xb(0,"app-care-management-time",14),I.ec("refreshEpisode",function(){return I.Lc(n),I.ic(2).getEpisodeData()}),I.Wb()}if(2&e){var i=I.ic(2);I.rc("episodeDetails",i.episodeDetails)}}function Ts(e,t){if(1&e){var n=I.Yb();I.Xb(0,"app-treatment-management-service",20),I.ec("refreshEpisode",function(){return I.Lc(n),I.ic(2).getEpisodeData()}),I.Wb()}if(2&e){var i=I.ic(2);I.rc("episodeDetails",i.episodeDetails)("cptCode","TREATMENT_MANAGEMENT_SERVICE")("patient",i.patient)}}function Xs(e,t){if(1&e){var n=I.Yb();I.Xb(0,"app-toc-care-management-time",20),I.ec("refreshEpisode",function(){return I.Lc(n),I.ic(2).getEpisodeData()}),I.Wb()}if(2&e){var i=I.ic(2);I.rc("episodeDetails",i.episodeDetails)("cptCode","CARE_MANAGEMENT_TIME")("patient",i.patient)}}function ys(e,t){if(1&e){var n=I.Yb();I.Xb(0,"app-ccm-treatment-management-services",20),I.ec("refreshEpisode",function(){return I.Lc(n),I.ic(2).getEpisodeData()}),I.Wb()}if(2&e){var i=I.ic(2);I.rc("episodeDetails",i.episodeDetails)("cptCode","NON_COMPLEX_TMS")("patient",i.patient)}}function Ns(e,t){if(1&e){var n=I.Yb();I.Xb(0,"app-ccm-treatment-management-services",20),I.ec("refreshEpisode",function(){return I.Lc(n),I.ic(2).getEpisodeData()}),I.Wb()}if(2&e){var i=I.ic(2);I.rc("episodeDetails",i.episodeDetails)("cptCode","COMPLEX_TMS")("patient",i.patient)}}function zs(e,t){if(1&e){var n=I.Yb();I.Xb(0,"app-non-billed-cmt",21),I.ec("refreshEpisode",function(){return I.Lc(n),I.ic(2).getEpisodeData()}),I.Wb()}if(2&e){var i=I.ic(2);I.rc("episodeDetails",i.episodeDetails)("cptCode","UNKNOWN")("patientName",null==i.patient?null:i.patient.fullName)}}function Ms(e,t){if(1&e){var n=I.Yb();I.Vb(0),I.Xb(1,"div",2),I.Sb(2,"app-basic",3),I.Sb(3,"app-codes",3),I.Vc(4,ms,1,1,"app-consent-forms",4),I.Vc(5,Cs,1,1,"app-patient-consent",5),I.Vc(6,Ds,1,1,"app-toc-events",6),I.Vc(7,Ss,1,2,"app-appointment",7),I.Vc(8,Es,1,2,"app-device-setup-tasks",8),I.Vc(9,Os,1,2,"app-plan-of-care",8),I.Vc(10,Is,1,1,"app-careplan",9),I.Vc(11,_s,1,1,"app-care-management-time",10),I.Vc(12,Ts,1,3,"app-treatment-management-service",11),I.Vc(13,Xs,1,3,"app-toc-care-management-time",12),I.Vc(14,ys,1,3,"app-ccm-treatment-management-services",12),I.jc(15,"filterList"),I.Vc(16,Ns,1,3,"app-ccm-treatment-management-services",12),I.jc(17,"filterList"),I.Vc(18,zs,1,3,"app-non-billed-cmt",13),I.Wb(),I.Xb(19,"app-episode-quick-actions",14),I.ec("refreshEpisode",function(){return I.Lc(n),I.ic().getEpisodeData()}),I.Wb(),I.Ub()}if(2&e){var i=I.ic();I.Db(2),I.rc("episodeDetails",i.episodeDetails),I.Db(1),I.rc("episodeDetails",i.episodeDetails),I.Db(1),I.rc("isComponentEnabled","PHYSICIAN_ORDER"),I.Db(1),I.rc("isComponentEnabled","CONSENT_FORM"),I.Db(1),I.rc("ngIf","TOC"===(null==i.episodeDetails?null:i.episodeDetails.type)),I.Db(1),I.rc("isComponentEnabled","APPOINTMENT"),I.Db(1),I.rc("isComponentEnabled","PATIENT_EDUCATION_APPOINTMENT"),I.Db(1),I.rc("isComponentEnabled","PLAN_OF_CARE"),I.Db(1),I.rc("isComponentEnabled","CARE_PLAN"),I.Db(1),I.rc("isComponentEnabled","CARE_MANAGEMENT_TIME"),I.Db(1),I.rc("isComponentEnabled","TREATMENT_MANAGEMENT_SERVICE"),I.Db(1),I.rc("ngIf","TOC"===(null==i.episodeDetails?null:i.episodeDetails.type)),I.Db(1),I.rc("ngIf",I.lc(15,16,"99490",i.serviceCodes)),I.Db(2),I.rc("ngIf",I.lc(17,19,"99487",i.serviceCodes)),I.Db(2),I.rc("ngIf",!(null==i.episodeDetails||!i.episodeDetails.patientCommunications||null==i.episodeDetails||!i.episodeDetails.patientCommunications.UNKNOWN)),I.Db(1),I.rc("episodeDetails",i.episodeDetails)}}var As,Ps,Ws=((As=function(e){a(n,e);var t=s(n);function n(e,i,a,o,s,l){var r;return c(this,n),(r=t.call(this))._episodesService=e,r._activatedRoute=i,r._dataSharingService=a,r._notificationsService=o,r._patientsService=s,r._router=l,r}return u(n,[{key:"ngOnInit",value:function(){this.getDataFromURL(),this.getTenantConfig(),this.getEpisodeData(),this.getUserDetails(this.patientId)}},{key:"getDataFromURL",value:function(){this.patientId=this._activatedRoute.snapshot.params.patientId,this.episodeId=this._activatedRoute.snapshot.params.episodeId}},{key:"getTenantConfig",value:function(){var e=this;this._dataSharingService.tenantSettings.pipe(Object(E.a)(this.unsubscribed)).subscribe(function(t){e.tenantSettings=t})}},{key:"getEpisodeData",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._episodesService.fetchEpisodeDetails(this.episodeId).subscribe(function(n){t||!e.episodeDetails||JSON.stringify(n)!==JSON.stringify(e.episodeDetails)?(e.episodeDetails=void 0,setTimeout(function(){e.episodeDetails=n,e.processEpisodeDetails()},50)):e.processEpisodeDetails()})}},{key:"processEpisodeDetails",value:function(){var e,t,n,i,a,o,s,l,r=this;if(this.serviceCodes=Object.keys(null===(e=this.episodeDetails)||void 0===e?void 0:e.serviceCodes),localStorage.setItem(O.a.REQUEST_TENANT_TEMP_IDS,this.episodeDetails.tenantId),-1===(null===(a=null===(i=null===(n=null===(t=this.tenantSettings)||void 0===t?void 0:t.episodeBlueprints)||void 0===n?void 0:n.find(function(e){var t;return(null===(t=r.episodeDetails)||void 0===t?void 0:t.blueprintId)===(null==e?void 0:e.id)&&!(null==e?void 0:e.archived)}))||void 0===i?void 0:i.enabledServiceCodes)||void 0===a?void 0:a.findIndex(function(e){return"99484"===e}))){var c=null===(s=null===(o=this.episodeDetails)||void 0===o?void 0:o.activeCarePlans)||void 0===s?void 0:s.filter(function(e){return"IN_PROGRESS"===(null==e?void 0:e.status)});if(null==c?void 0:c.length){var d=null===(l=this.episodeDetails)||void 0===l?void 0:l.patientComplianceCount[99454];0===d?this.timeoutId=setTimeout(function(){return r.getEpisodeData()},15e3):0===this.vitalDaysRemaining&&1===d&&this._notificationsService.success("Vital Measurement","Vital value transmitted successfully, the number of days remaining for the current month is 15")}}}},{key:"getUserDetails",value:function(e){var t=this;this._patientsService.fetchPatientById(e).subscribe(function(e){return t.patient=e})}},{key:"editEpisode",value:function(){this._router.navigate(["episodes/form/edit/".concat(this.episodeDetails.patientId)],{queryParams:{blueprintId:this.episodeDetails.blueprintId,episodeId:this.episodeDetails.id}})}},{key:"ngOnDestroy",value:function(){this.timeoutId&&clearTimeout(this.timeoutId)}}]),n}(D.a)).\u0275fac=function(e){return new(e||As)(I.Rb(C.a),I.Rb(_.a),I.Rb(te.a),I.Rb(T.b),I.Rb(m.a),I.Rb(_.g))},As.\u0275cmp=I.Lb({type:As,selectors:[["app-episode-details"]],features:[I.Ab],decls:2,vars:5,consts:[["title","episodeForm","actionTitle","Edit Episode",3,"defaultTitle","isSearchEnabled","isActionEnabled","action"],[4,"ngIf"],[1,"container"],[3,"episodeDetails"],[3,"episodeDetails","consentChanged",4,"isComponentEnabled"],[3,"episodeDetails","episodeChange",4,"isComponentEnabled"],[3,"episodeDetails","refreshEpisode",4,"ngIf"],[3,"episodeDetails","user","refreshEpisode",4,"isComponentEnabled"],[3,"episodeDetails","patient","refreshEpisode",4,"isComponentEnabled"],[3,"episodeDetails","refresh",4,"isComponentEnabled"],[3,"episodeDetails","refreshEpisode",4,"isComponentEnabled"],[3,"episodeDetails","cptCode","patient","refreshEpisode",4,"isComponentEnabled"],[3,"episodeDetails","cptCode","patient","refreshEpisode",4,"ngIf"],[3,"episodeDetails","cptCode","patientName","refreshEpisode",4,"ngIf"],[3,"episodeDetails","refreshEpisode"],[3,"episodeDetails","consentChanged"],[3,"episodeDetails","episodeChange"],[3,"episodeDetails","user","refreshEpisode"],[3,"episodeDetails","patient","refreshEpisode"],[3,"episodeDetails","refresh"],[3,"episodeDetails","cptCode","patient","refreshEpisode"],[3,"episodeDetails","cptCode","patientName","refreshEpisode"]],template:function(e,t){1&e&&(I.Xb(0,"app-header",0),I.ec("action",function(){return t.editEpisode()}),I.Wb(),I.Vc(1,Ms,20,22,"ng-container",1)),2&e&&(I.uc("defaultTitle","",null==t.patient?null:t.patient.fullName," | ",null==t.episodeDetails?null:t.episodeDetails.name,""),I.rc("isSearchEnabled",!1)("isActionEnabled",!1),I.Db(1),I.rc("ngIf",t.tenantSettings&&t.episodeDetails))},directives:[qe.a,r.q,bt,Dt,$e,At,sn,Zi,fa,La,$a,io,So,Ao,Go,Qo,cs,hs],pipes:[gs.a],styles:[""]}),As),Rs=o("0W7X"),ks=o("T5gh"),ws=o("bA1+"),Ls=o("i680"),xs=o("wOnQ"),Vs=o.n(xs),Us=((Ps=function(){function e(t,n){c(this,e),this._activatedRoute=t,this.consentService=n}return u(e,[{key:"ngOnInit",value:function(){this.getConsentDetails()}},{key:"getConsentDetails",value:function(){var e=this;this.loadingCertificate=!0,this._activatedRoute.queryParams.subscribe(function(t){return e.consentId=t.consentId}),this.consentService.getConsentDetails(this.consentId).subscribe(function(t){var n,i;e.consent=t,e.callStartTime=e.convertUTCDateToLocalDate(new Date(null===(n=null==t?void 0:t.consentDetails)||void 0===n?void 0:n.callStartTime)),e.callEndTime=e.convertUTCDateToLocalDate(new Date(null===(i=null==t?void 0:t.consentDetails)||void 0===i?void 0:i.callEndTime)),e.loadingCertificate=!1},function(t){return e.loadingCertificate=!1})}},{key:"convertUTCDateToLocalDate",value:function(e){if(null!=e)return new Date(e.getTime()-60*e.getTimezoneOffset()*1e3)}},{key:"exportCertificate",value:function(){var e=this.consent.consenteeName+"-"+this.consent.consenteeNumber+" consent-certificate.pdf";Vs()(document.getElementById("formCanvas")).then(function(t){var n=t.toDataURL("image/png"),i=new Ls.default({orientation:"landscape"}),a=i.getImageProperties(n),o=i.internal.pageSize.getWidth();i.addImage(n,"PNG",0,0,o,a.height*o/a.width),i.save(e)})}}]),e}()).\u0275fac=function(e){return new(e||Ps)(I.Rb(_.a),I.Rb(fn.a))},Ps.\u0275cmp=I.Lb({type:Ps,selectors:[["app-consent-certificate"]],decls:76,vars:75,consts:[["title","consentCertificate",3,"defaultTitle","isSearchEnabled","actionTitle","action"],["id","formCanvas",3,"nzLoading"],["nz-typography",""],[1,"call-details-box"],["nz-row",""],["nz-col","","nzSpan","12"]],template:function(e,t){1&e&&(I.Xb(0,"app-header",0),I.ec("action",function(){return t.exportCertificate()}),I.jc(1,"translate"),I.jc(2,"translate"),I.Wb(),I.Xb(3,"nz-card",1),I.Xb(4,"h1",2),I.Xc(5),I.jc(6,"translate"),I.Wb(),I.Xb(7,"h3",2),I.Xc(8),I.jc(9,"translate"),I.Xb(10,"B"),I.Xc(11),I.Wb(),I.Wb(),I.Xb(12,"h3",2),I.Xc(13),I.jc(14,"translate"),I.Xb(15,"B"),I.Xc(16),I.jc(17,"episodeName"),I.Wb(),I.Wb(),I.Xb(18,"h3",2),I.Xc(19),I.jc(20,"translate"),I.Wb(),I.Xb(21,"div",3),I.Xb(22,"h3"),I.Xc(23),I.jc(24,"translate"),I.Wb(),I.Xb(25,"div",4),I.Xb(26,"div",5),I.Xc(27),I.jc(28,"translate"),I.Xb(29,"h4",2),I.Xc(30),I.jc(31,"translate"),I.Wb(),I.Wb(),I.Xb(32,"div",5),I.Xc(33),I.jc(34,"translate"),I.Xb(35,"h4",2),I.Xc(36),I.jc(37,"date"),I.Wb(),I.Wb(),I.Wb(),I.Xb(38,"div",4),I.Xb(39,"div",5),I.Xc(40),I.jc(41,"translate"),I.Xb(42,"h4",2),I.Xc(43),I.Wb(),I.Wb(),I.Xb(44,"div",5),I.Xc(45),I.jc(46,"translate"),I.Xb(47,"h4",2),I.Xc(48),I.Wb(),I.Wb(),I.Wb(),I.Xb(49,"div",4),I.Xb(50,"div",5),I.Xc(51),I.jc(52,"translate"),I.Xb(53,"h4",2),I.Xc(54),I.Wb(),I.Wb(),I.Xb(55,"div",5),I.Xc(56),I.jc(57,"translate"),I.Xb(58,"h4",2),I.Xc(59),I.Wb(),I.Wb(),I.Wb(),I.Xb(60,"div",4),I.Xb(61,"div",5),I.Xc(62),I.jc(63,"translate"),I.Xb(64,"h4",2),I.Xc(65),I.jc(66,"date"),I.Wb(),I.Wb(),I.Xb(67,"div",5),I.Xc(68),I.jc(69,"translate"),I.Xb(70,"h4",2),I.Xc(71),I.jc(72,"date"),I.Wb(),I.Wb(),I.Wb(),I.Wb(),I.Xb(73,"h3",2),I.Xc(74),I.jc(75,"translate"),I.Wb(),I.Wb()),2&e&&(I.sc("defaultTitle",I.kc(1,30,"CONSENT.CONSENT_FORM_CERTIFICATE")),I.sc("actionTitle",I.kc(2,32,"CONSENT.DOWNLOAD_CERTIFICATE")),I.rc("isSearchEnabled",!1),I.Db(3),I.rc("nzLoading",t.loadingCertificate),I.Db(2),I.Yc(I.kc(6,34,"CONSENT.CONSENT_CERTI_HEADING")),I.Db(3),I.Zc("",I.kc(9,36,"CONSENT.HEALTHCARE_PROVIDER_NAME"),": "),I.Db(3),I.Yc(null==t.consent?null:t.consent.tenantName),I.Db(2),I.Zc("",I.kc(14,38,"CONSENT.NAME_OF_PROGRAM"),": "),I.Db(3),I.Yc(I.kc(17,40,null==t.consent?null:t.consent.episodeType)),I.Db(3),I.ad("",I.kc(20,42,"CONSENT.CALL_REFERENCE_ID"),": ",null==t.consent?null:t.consent.id,""),I.Db(4),I.Yc(I.kc(24,44,"CONSENT.CALL_DETAILS")),I.Db(4),I.Zc(" ",I.kc(28,46,"CONSENT.PURPOSE_OF_CALL"),": "),I.Db(3),I.Yc(I.kc(31,48,"CONSENT.CALL_PURPOSE")),I.Db(3),I.Zc(" ",I.kc(34,50,"CONSENT.DATE"),": "),I.Db(3),I.Yc(I.lc(37,52,null==t.consent?null:t.consent.obtainedOn,"mediumDate")),I.Db(4),I.Zc(" ",I.kc(41,55,"CONSENT.CALL_INITIATED_FROM"),": "),I.Db(3),I.Zc(" ",null==t.consent||null==t.consent.consentDetails?null:t.consent.consentDetails.fromNumber," "),I.Db(2),I.Zc(" ",I.kc(46,57,"CONSENT.CALL_RECEIVED_ON"),": "),I.Db(3),I.Yc(null==t.consent?null:t.consent.consenteeNumber),I.Db(3),I.Zc(" ",I.kc(52,59,"CONSENT.CALL_INITIATED_BY"),": "),I.Db(3),I.Yc(null==t.consent||null==t.consent.consentDetails?null:t.consent.consentDetails.callerName),I.Db(2),I.Zc(" ",I.kc(57,61,"CONSENT.CALL_RECEIVED_BY"),": "),I.Db(3),I.Zc("",null==t.consent?null:t.consent.consenteeName," "),I.Db(3),I.Zc(" ",I.kc(63,63,"CONSENT.START_TIME_OF_CALL"),": "),I.Db(3),I.Yc(I.lc(66,65,t.callStartTime,"fullTime")),I.Db(3),I.Zc(" ",I.kc(69,68,"CONSENT.END_TIME_OF_CALL"),": "),I.Db(3),I.Yc(I.lc(72,70,t.callEndTime,"fullTime")),I.Db(3),I.ad("",I.kc(75,73,"CONSENT.VERBAL_CONSENT_GIVEN_BY"),": ",null==t.consent?null:t.consent.consenteeName,""))},directives:[qe.a,z.a,P.a,N.c,N.a],pipes:[se.a,Ke.a,r.e],styles:["nz-card[_ngcontent-%COMP%]{padding:2%;margin:5%;font-weight:700;color:#888}.call-details-box[_ngcontent-%COMP%]{height:300px;padding:25px;background:#f6f6f6 0 0 no-repeat padding-box;border-radius:10px;opacity:1}.call-details-box[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:20px}h4[_ngcontent-%COMP%]{font-weight:700;margin-top:8px}.call-details-box[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{line-height:.5;margin-bottom:10px}"]}),Ps);function Fs(e,t){1&e&&(I.Vb(0),I.Xb(1,"div",1),I.Sb(2,"nz-spin",2),I.Wb(),I.Ub())}function js(e,t){if(1&e){var n=I.Yb();I.Vb(0),I.Sb(1,"div",3),I.jc(2,"sanitizeHtml"),I.Xb(3,"div",4),I.Xb(4,"button",5),I.ec("click",function(){return I.Lc(n),I.ic().consentSubmit("AGREE")}),I.Xc(5),I.jc(6,"translate"),I.Wb(),I.Sb(7,"br"),I.Xb(8,"button",6),I.ec("click",function(){return I.Lc(n),I.ic().consentSubmit("DENY")}),I.Xc(9),I.jc(10,"translate"),I.Wb(),I.Wb(),I.Ub()}if(2&e){var i=I.ic();I.Db(1),I.rc("innerHTML",I.kc(2,3,i.consentForm),I.Mc),I.Db(4),I.Zc(" ",I.kc(6,5,"CONSENT.SUBMIT_CONSENT")," "),I.Db(4),I.Zc(" ",I.kc(10,7,"CONSENT.DENY_CONSENT")," ")}}var Ys,Gs=((Ys=function(){function e(t,n,i,a,o,s){c(this,e),this._episodesService=t,this._modalService=n,this._notificationsService=i,this._route=a,this._router=o,this._ngProgress=s,this.rootURL=Pt.g.url,this.episodeChange=new I.n}return u(e,[{key:"ngOnInit",value:function(){var e=this;this.initValues(),this.loading=!0,this._episodesService.getDigitalConsent(this.patientId,this.episodeType,"SMS_CONSENT").subscribe(function(t){e.loading=!1,e.consentForm=t},function(t){e._notificationsService.error("Consent Form","You have already submitted the response to this form.")})}},{key:"initValues",value:function(){var e=this;this._route.params.forEach(function(t){e.episodeType=t.episodeType.toUpperCase(),e.patientId=t.patientId,e.episodeId=t.episodeId,e.actionItemId=t.actionItemId})}},{key:"consentSubmit",value:function(e){"AGREE"==e?this.acceptConsent():this.denyConsent()}},{key:"acceptConsent",value:function(){var e=this;this._episodesService.submitAcceptConsent({consentType:"SMS_CONSENT",episodeId:this.episodeId,patientId:this.patientId,actionItemId:this.actionItemId}).subscribe(function(t){var n,i;e.loading=!1,null===(i=null===(n=e._ngProgress)||void 0===n?void 0:n.ref())||void 0===i||i.complete(),null!=t?e._router.navigate(["episodes/consent/sms/submitted/AGREE"]):e._notificationsService.error("Consent Form","Something went wrong")})}},{key:"denyConsent",value:function(){var e=this;this._modalService.create({nzContent:Wn,nzComponentParams:{patientId:this.patientId},nzWidth:470,nzFooter:null,nzClosable:!1,nzMaskClosable:!1}).afterClose.subscribe(function(t){var n,i,a={reason:t.reason,consentType:"SMS_CONSENT",episodeId:e.episodeId,patientId:e.patientId,consentId:null};null===(i=null===(n=e._ngProgress)||void 0===n?void 0:n.ref())||void 0===i||i.start(),e._episodesService.submitDenyConsent(a).subscribe(function(t){var n,i;null===(i=null===(n=e._ngProgress)||void 0===n?void 0:n.ref())||void 0===i||i.complete(),e._router.navigate(["episodes/consent/sms/submitted/DENY"])})})}}]),e}()).\u0275fac=function(e){return new(e||Ys)(I.Rb(C.a),I.Rb(He.f),I.Rb(T.b),I.Rb(_.a),I.Rb(_.g),I.Rb(Di.a))},Ys.\u0275cmp=I.Lb({type:Ys,selectors:[["app-sms-consent-form"]],outputs:{episodeChange:"episodeChange"},decls:2,vars:2,consts:[[4,"ngIf"],[1,"spin-container"],["nzSimple",""],[1,"table-responsive",3,"innerHTML"],[1,"consent-actions-container"],["nz-button","","nzType","primary",3,"click"],["nz-button","","nzType","default","nzDanger","",3,"click"]],template:function(e,t){1&e&&(I.Vc(0,Fs,3,0,"ng-container",0),I.Vc(1,js,11,9,"ng-container",0)),2&e&&(I.rc("ngIf",t.loading),I.Db(1),I.rc("ngIf",!t.loading))},directives:[r.q,fe.a,kt.a,wt.a,L.a],pipes:[xt,se.a],styles:[".spin-container[_ngcontent-%COMP%]{text-align:center;border-radius:4px;padding:30px 50px;margin:20px 0;height:400px}.consent-actions-container[_ngcontent-%COMP%]{text-align:center;margin-top:-100px}button[_ngcontent-%COMP%]{margin-top:10px;margin-bottom:10px;height:48px;width:240px}"]}),Ys),Bs=o("yW9e");function Hs(e,t){1&e&&I.Sb(0,"img",7)}function Zs(e,t){1&e&&I.Sb(0,"img",8)}function qs(e,t){1&e&&(I.Xb(0,"div"),I.Xb(1,"p"),I.Xc(2),I.jc(3,"translate"),I.Wb(),I.Wb()),2&e&&(I.Db(2),I.Zc(" ",I.kc(3,1,"CONSENT.PATIENT_SIGNED_MESSAGE"),""))}function $s(e,t){1&e&&(I.Xb(0,"div"),I.Xb(1,"p"),I.Xc(2),I.jc(3,"translate"),I.Wb(),I.Wb()),2&e&&(I.Db(2),I.Zc(" ",I.kc(3,1,"CONSENT.PATIENT_DENIED_MESSAGE"),""))}var Ks,Qs=((Ks=function(){function e(t,n){var i=this;c(this,e),this._route=t,this.location=n,this.mouseY=0,this.mouseX=0,this.onMouseMove=function(e){i.mouseY=e.pageY;var t=(i.pageY/2-i.mouseY)/i.pageY*300;i.mouseX=e.pageX/-i.pageX,i.style={transform:"translate("+(100*-i.mouseX-100)+"%,-"+t+"%)"}},history.pushState(null,null,window.location.href),this.location.onPopState(function(){history.pushState(null,null,window.location.href)})}return u(e,[{key:"ngOnInit",value:function(){var e=this;this.getScreenSize(),window.addEventListener("mousemove",this.onMouseMove),this._route.params.subscribe(function(t){return e.status=t.status})}},{key:"getScreenSize",value:function(){this.pageY=window.innerHeight,this.pageX=window.innerWidth,console.log(this.pageY,this.pageX)}},{key:"close",value:function(){window.close()}}]),e}()).\u0275fac=function(e){return new(e||Ks)(I.Rb(_.a),I.Rb(r.m))},Ks.\u0275cmp=I.Lb({type:Ks,selectors:[["app-sms-consent-submitted"]],hostBindings:function(e,t){1&e&&I.ec("resize",function(e){return t.getScreenSize(e)},!1,I.Kc)},decls:11,vars:4,consts:[[1,"overall-container"],[1,"box"],["id","submitted"],["src","../../../../assets/icons/consent-signed.svg","alt","check",4,"ngIf"],["src","../../../../assets/icons/consent-denied.svg","alt","check",4,"ngIf"],["id","thank-you"],[4,"ngIf"],["src","../../../../assets/icons/consent-signed.svg","alt","check"],["src","../../../../assets/icons/consent-denied.svg","alt","check"]],template:function(e,t){1&e&&(I.Xb(0,"div",0),I.Xb(1,"div",1),I.Xb(2,"div",2),I.Vc(3,Hs,1,0,"img",3),I.Vc(4,Zs,1,0,"img",4),I.Wb(),I.Xb(5,"label",5),I.Xc(6,"Thank You!"),I.Wb(),I.Xb(7,"nz-content"),I.Vc(8,qs,4,3,"div",6),I.Vc(9,$s,4,3,"div",6),I.Wb(),I.Sb(10,"br"),I.Wb(),I.Wb()),2&e&&(I.Db(3),I.rc("ngIf","AGREE"==t.status),I.Db(1),I.rc("ngIf","DENY"==t.status),I.Db(4),I.rc("ngIf","AGREE"==t.status),I.Db(1),I.rc("ngIf","DENY"==t.status))},directives:[r.q,Bs.a],pipes:[se.a],styles:["div[_ngcontent-%COMP%]{margin-top:10%;margin-bottom:10%;text-align:center}h1[_ngcontent-%COMP%]{margin-top:10px;font-size:28px;font-family:Nunito;font-weight:bolder;color:#ff2020}h2[_ngcontent-%COMP%]{width:70%}h2[_ngcontent-%COMP%], p[_ngcontent-%COMP%]{font-family:Nunito;font-size:14px;margin:auto}p[_ngcontent-%COMP%]{color:#0d0d0d;width:95%}button[_ngcontent-%COMP%]{background:#85ae38 0 0 no-repeat padding-box;border:1px solid #88ac34;border-radius:15px;width:80%;height:50px}#submitted[_ngcontent-%COMP%]{width:40px;height:27px;margin:auto auto 25px}#thank-you[_ngcontent-%COMP%]{font-size:20px;font-weight:bolder;margin-top:25px}"]}),Ks),Js={PlanOfCare:{header:!0,title:"Plan Of Care",searchEnabled:!1,primaryAction:{title:"Save",permissions:[],enabled:!0},secondaryAction:{},multiAction:{},showTenantToggle:!1},PlanOfCareTimeline:{header:!0,title:"Plan Of Care",searchEnabled:!1,primaryAction:{title:"Add PoC",permissions:[],enabled:!0},secondaryAction:{},multiAction:{}},EpisodeBillingRate:{header:!1,showTenantToggle:!0,subTenantToggleMode:"SINGLE"}},el=o("pe0G"),tl=o("bA60"),nl=o("oyxB"),il=o("xB20"),al=function(){return["."]},ol=function(){return{tab:"history"}};function sl(e,t){1&e&&(I.Xb(0,"a",17),I.Xc(1,"History"),I.Wb()),2&e&&I.rc("routerLink",I.xc(3,al))("queryParams",I.xc(4,ol))("replaceUrl",!0)}function ll(e,t){if(1&e){var n=I.Yb();I.Xb(0,"nz-timeline-item"),I.Xb(1,"app-plan-of-care-details",18),I.ec("refresh",function(){return I.Lc(n),I.ic().getPlanOfCare()}),I.Wb(),I.Sb(2,"br"),I.Wb()}if(2&e){var i=t.$implicit;I.Db(1),I.rc("planOfCare",i)}}var rl=function(){return{tab:"assessments"}};function cl(e,t){1&e&&(I.Xb(0,"a",17),I.Xc(1,"Assessments"),I.Wb()),2&e&&I.rc("routerLink",I.xc(3,al))("queryParams",I.xc(4,rl))("replaceUrl",!0)}function dl(e,t){if(1&e&&(I.Xb(0,"nz-timeline-item"),I.Xb(1,"nz-descriptions",19),I.Xb(2,"nz-descriptions-item",20),I.Xc(3),I.Wb(),I.Xb(4,"nz-descriptions-item",20),I.Xc(5),I.Wb(),I.Xb(6,"nz-descriptions-item",20),I.Xc(7),I.jc(8,"date"),I.Wb(),I.Wb(),I.Sb(9,"br"),I.Wb()),2&e){var n=t.$implicit;I.Db(1),I.rc("nzTitle",null==n||null==n.schema?null:n.schema.title),I.Db(1),I.rc("nzTitle","Score"),I.Db(1),I.Zc(" ","SCORED_ASSESSMENT"===(null==n||null==n.schema?null:n.schema.type)?null==n?null:n.evaluatedScore:"NA"," "),I.Db(1),I.rc("nzTitle","Risk Category"),I.Db(1),I.Zc(" ","SCORED_ASSESSMENT"===(null==n||null==n.schema?null:n.schema.type)?null==n?null:n.identifiedRisk:"NA"," "),I.Db(1),I.rc("nzTitle","Date"),I.Db(1),I.Zc(" ",I.lc(8,7,null==n?null:n.assessedOn,"medium")," ")}}function ul(e,t){if(1&e&&(I.Xb(0,"nz-option",21),I.Xb(1,"strong",22),I.Xc(2),I.Wb(),I.Sb(3,"br"),I.Xb(4,"p",23),I.Xc(5),I.Wb(),I.Wb()),2&e){var n=t.$implicit,i=I.ic(2);I.rc("nzLabel",null==n?null:n.title)("nzValue",n),I.Db(2),I.Yc(null==n?null:n.title),I.Db(2),I.rc("nzType",(null==n?null:n.scheduledOn)<i.currentDate?"danger":"primary"),I.Db(1),I.Zc(" ",(null==n?null:n.scheduledOn)<i.currentDate?"Overdue":"Due Today"," ")}}function bl(e,t){if(1&e){var n=I.Yb();I.Vb(0),I.Xb(1,"h4",11),I.Xc(2,"Assigned Assessments"),I.Wb(),I.Sb(3,"nz-divider"),I.Xb(4,"div",3),I.Xb(5,"div",12),I.Xb(6,"nz-select",13),I.ec("ngModelChange",function(e){return I.Lc(n),I.ic().selectedForm=e}),I.Vc(7,ul,6,5,"nz-option",14),I.Wb(),I.Wb(),I.Xb(8,"div",15),I.Xb(9,"button",16),I.ec("click",function(){I.Lc(n);var e=I.ic();return e.showFormFiller(e.form)}),I.Xc(10," Assess "),I.Wb(),I.Wb(),I.Wb(),I.Sb(11,"br"),I.Sb(12,"br"),I.Ub()}if(2&e){var i=I.ic();I.Db(6),I.rc("ngModel",i.selectedForm),I.Db(1),I.rc("ngForOf",i.assessments),I.Db(2),I.rc("disabled",!i.selectedForm)}}function pl(e,t){if(1&e&&(I.Xb(0,"nz-option",21),I.Xb(1,"strong",22),I.Xc(2),I.Wb(),I.Wb()),2&e){var n=t.$implicit;I.rc("nzLabel",null==n?null:n.title)("nzValue",n),I.Db(2),I.Yc(null==n?null:n.title)}}var fl,vl,hl=((fl=function(e){a(i,e);var n=s(i);function i(e,t,a,o,s,l,r){var d;c(this,i),(d=n.call(this))._router=e,d._domSanitizer=t,d._formsService=a,d._activateRoute=o,d._planOfCareService=s,d._actionItemsService=l,d._dataSharingService=r,d.rootURL=Pt.g.webFormRootURL;var u=d._activateRoute.snapshot.queryParamMap.get("patientName");return d._routeHelperService.setTitleForRoute("".concat(u," | Plan of Care")),d._routeHelperService.isPrimaryActionTriggered().pipe(Object(S.a)(function(e){return!!e}),Object(E.a)(d.unsubscribed)).subscribe(function(){d.addPlanOfCare()}),d}return u(i,[{key:"onMessage",value:function(e){var t,n;(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.canClose)&&(null===(n=null==e?void 0:e.data)||void 0===n?void 0:n.success)&&this.closeWebForm()}},{key:"ngOnInit",value:function(){this.getPlanOfCare(),this.getAssessments(),this.fetchFormBlueprints(),this.fetchFormActionItems()}},{key:"getPlanOfCare",value:function(){var e=this;this._planOfCareService.fetchPlanOfCare(this._activateRoute.snapshot.params.patientId).subscribe(function(t){e.planOfCare=t})}},{key:"addPlanOfCare",value:function(){this._router.navigate(["episodes/plan-of-care/".concat(this._activateRoute.snapshot.params.patientId,"/").concat(this._activateRoute.snapshot.params.episodeId)])}},{key:"getAssessments",value:function(){var e=this;this._formsService.getPatientEvalForms(this._activateRoute.snapshot.params.patientId,0,999999).subscribe(function(t){var n,i;e.forms=null===(i=null===(n=null==t?void 0:t.data)||void 0===n?void 0:n.answers)||void 0===i?void 0:i.obj,e.getDirectForms()})}},{key:"getDirectForms",value:function(){var e=this;this._formsService.getPatientDirectForms(this._activateRoute.snapshot.params.patientId,0,10).subscribe(function(n){var i,a;e.forms=[].concat(t(e.forms),t(null===(a=null===(i=null==n?void 0:n.data)||void 0===i?void 0:i.answers)||void 0===a?void 0:a.obj)),e.forms=e.forms.sort(function(e,t){var n,i;return(null===(n=new Date(null==t?void 0:t.assessedOn))||void 0===n?void 0:n.getTime())-(null===(i=new Date(null==e?void 0:e.assessedOn))||void 0===i?void 0:i.getTime())})})}},{key:"fetchFormBlueprints",value:function(){var e=this;this._formsService.getFormsWithBody({phq9:!0,gad7:!0},0,9999999,"").subscribe(function(t){var n,i,a;(null===(n=null==t?void 0:t.data)||void 0===n?void 0:n.forms)&&(e.formBlueprints=null===(a=null===(i=null==t?void 0:t.data)||void 0===i?void 0:i.forms)||void 0===a?void 0:a.obj)})}},{key:"fetchFormActionItems",value:function(){var e=this;this._formsService.fetchFormActionItemsForPatient(this._activateRoute.snapshot.params.patientId).subscribe(function(t){(null==t?void 0:t.length)&&(null==t||t.forEach(function(e){e.parameters=JSON.parse(null==e?void 0:e.parameters),(null==e?void 0:e.scheduledOn)||(e.scheduledOn=new Date(null==e?void 0:e.scheduledAt).setHours(23))}),e.assessments=t)})}},{key:"showFormFiller",value:function(){var e,t,n,i,a;if(this.selectedForm){var o=this._activateRoute.snapshot.params.patientId,s=this._activateRoute.snapshot.queryParams.patientName,l=localStorage.getItem("sessionToken"),r="".concat(this.rootURL,"web-form/").concat(null===(t=null===(e=this.selectedForm)||void 0===e?void 0:e.parameters)||void 0===t?void 0:t.formBlueprintId,"/").concat(l,"/").concat(o,"/").concat(null===(n=this.selectedForm)||void 0===n?void 0:n.id,"?source=portal&sourceType=").concat(null===(a=null===(i=this.selectedForm)||void 0===i?void 0:i.parentType)||void 0===a?void 0:a.toLowerCase()),c=this._domSanitizer.bypassSecurityTrustResourceUrl(r);this._dataSharingService.initiatePatientTrigger({patientId:o,patientName:s,url:c})}}},{key:"closeWebForm",value:function(){var e=this;this.forms=[],setTimeout(function(){e.getAssessments(),e.fetchFormActionItems(),e.selectedForm=void 0,e.selectedFormBlueprint=void 0},2e3)}},{key:"assignOnDemandForm",value:function(){var e,t=this;this.selectedFormBlueprint&&this._formsService.assignOnDemandForm(null===(e=this.selectedFormBlueprint)||void 0===e?void 0:e._id,this._activateRoute.snapshot.params.patientId).subscribe(function(e){var n,i,a,o;t.selectedForm=null==e?void 0:e.data,t.selectedForm.parameters=JSON.parse(null===(n=t.selectedForm)||void 0===n?void 0:n.parameters),(null===(i=t.selectedForm)||void 0===i?void 0:i.scheduledOn)||(t.selectedForm.scheduledOn=new Date(null===(a=t.selectedForm)||void 0===a?void 0:a.scheduledAt).setHours(23)),t._actionItemsService.archiveActionItem(null===(o=t.selectedForm)||void 0===o?void 0:o.id).subscribe(),t.showFormFiller()})}}]),i}(D.a)).\u0275fac=function(e){return new(e||fl)(I.Rb(_.g),I.Rb(Lt.b),I.Rb(el.a),I.Rb(_.a),I.Rb(d.a),I.Rb(tl.a),I.Rb(te.a))},fl.\u0275cmp=I.Lb({type:fl,selectors:[["app-timeline"]],hostBindings:function(e,t){1&e&&I.ec("message",function(e){return t.onMessage(e)},!1,I.Kc)},features:[I.Ab],decls:34,vars:6,consts:[["nzLinkRouter",""],["nz-tab-link","","queryParamsHandling","merge",3,"routerLink","queryParams","replaceUrl",4,"nzTabLink"],[1,"container"],["nz-row","","nzGutter","16"],["nz-col","","nzSpan","22"],["nzBorderless","","id","timeline"],[4,"ngFor","ngForOf"],["nz-col","","nzSpan","16"],["nzBorderless",""],["nz-col","","nzSpan","8"],[4,"ngIf"],["nz-typography",""],["nz-col","","nzSpan","18"],["nzPlaceHolder","Select an assessment form","nzAllowClear","",3,"ngModel","ngModelChange"],["nzCustomContent","",3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["nz-col","","nzSpan","4"],["nz-button","","nzType","primary",3,"disabled","click"],["nz-tab-link","","queryParamsHandling","merge",3,"routerLink","queryParams","replaceUrl"],[3,"planOfCare","refresh"],["nzBordered","","nzSize","small",3,"nzTitle"],[3,"nzTitle"],["nzCustomContent","",3,"nzLabel","nzValue"],["nz-typography","","nzType","secondary"],["nz-typography","",3,"nzType"]],template:function(e,t){1&e&&(I.Xb(0,"nz-tabset",0),I.Xb(1,"nz-tab"),I.Vc(2,sl,2,5,"a",1),I.Xb(3,"div",2),I.Xb(4,"div",3),I.Xb(5,"div",4),I.Xb(6,"nz-card",5),I.Xb(7,"nz-timeline"),I.Vc(8,ll,3,1,"nz-timeline-item",6),I.Wb(),I.Wb(),I.Wb(),I.Wb(),I.Wb(),I.Wb(),I.Xb(9,"nz-tab"),I.Vc(10,cl,2,5,"a",1),I.Xb(11,"div",2),I.Xb(12,"div",3),I.Xb(13,"div",7),I.Xb(14,"nz-card",8),I.Xb(15,"h3"),I.Xc(16,"Screenings and Assessments"),I.Wb(),I.Sb(17,"nz-divider"),I.Xb(18,"nz-timeline"),I.Vc(19,dl,10,10,"nz-timeline-item",6),I.Wb(),I.Wb(),I.Wb(),I.Xb(20,"div",9),I.Xb(21,"nz-card",8),I.Vc(22,bl,13,3,"ng-container",10),I.Vb(23),I.Xb(24,"h4",11),I.Xc(25,"On-Demand Assessments"),I.Wb(),I.Sb(26,"nz-divider"),I.Xb(27,"div",3),I.Xb(28,"div",12),I.Xb(29,"nz-select",13),I.ec("ngModelChange",function(e){return t.selectedFormBlueprint=e}),I.Vc(30,pl,3,3,"nz-option",14),I.Wb(),I.Wb(),I.Xb(31,"div",15),I.Xb(32,"button",16),I.ec("click",function(){return t.assignOnDemandForm()}),I.Xc(33," Assess "),I.Wb(),I.Wb(),I.Wb(),I.Ub(),I.Wb(),I.Wb(),I.Wb(),I.Wb(),I.Wb(),I.Wb()),2&e&&(I.Db(8),I.rc("ngForOf",t.planOfCare),I.Db(11),I.rc("ngForOf",t.forms),I.Db(3),I.rc("ngIf",null==t.assessments?null:t.assessments.length),I.Db(7),I.rc("ngModel",t.selectedFormBlueprint),I.Db(1),I.rc("ngForOf",t.formBlueprints),I.Db(2),I.rc("disabled",!t.selectedFormBlueprint))},directives:[nl.d,nl.a,nl.c,N.c,N.a,z.a,ea.a,r.p,w.a,r.q,P.a,R.d,v.u,v.x,kt.a,wt.a,L.a,nl.b,_.j,ea.b,Ka.a,il.a,il.b,R.a],pipes:[r.e],styles:["nz-card[_ngcontent-%COMP%]{border-radius:5px;min-height:50vh}#timeline[_ngcontent-%COMP%]{padding-top:20px}[_nghost-%COMP%]     .ant-timeline-item-content{margin-left:40px}a[_ngcontent-%COMP%]{color:var(--light-black)}#assessments[_ngcontent-%COMP%]{background-color:var(--neutral-color)}[_nghost-%COMP%]     .ant-descriptions-item-label{font-weight:700}"]}),fl),gl=o("Kj3r"),ml=o("/uUt"),Cl=o("eIep"),Dl=((vl=function(){function e(){c(this,e),this.serviceCodes=Oo.b}return u(e,[{key:"transform",value:function(e){var t=this.serviceCodes.find(function(t){return t.cptCode===e});return null==t?"N/A":"".concat(t.label," (CPT Code - ").concat(t.value,")")}}]),e}()).\u0275fac=function(e){return new(e||vl)},vl.\u0275pipe=I.Qb({name:"cptCode",type:vl,pure:!1}),vl),Sl=o("b1TM"),El=function(e){return e.ADD="add",e.REMOVE="remove",e.REPLACE="replace",e}({}),Ol=function e(){c(this,e)},Il=o("h51P"),_l=o("2sp+"),Tl=o("XNiG"),Xl=function(e,t){null==t||t.setValue({streetAddress:e.line1,streetAddress2:e.line2,city:e.city,state:e.state,zipCode:e.zipCode,country:e.country})},yl=function(e){var t,n,i,a,o,s,l,r,c,d,u,b,p,f,v,h,g,m,C,D;return{line1:null===(n=null===(t=null==e?void 0:e.controls)||void 0===t?void 0:t.streetAddress)||void 0===n?void 0:n.value,line2:null===(a=null===(i=null==e?void 0:e.controls)||void 0===i?void 0:i.streetAddress2)||void 0===a?void 0:a.value,city:null===(s=null===(o=null==e?void 0:e.controls)||void 0===o?void 0:o.city)||void 0===s?void 0:s.value,state:null===(r=null===(l=null==e?void 0:e.controls)||void 0===l?void 0:l.state)||void 0===r?void 0:r.value,country:null===(d=null===(c=null==e?void 0:e.controls)||void 0===c?void 0:c.country)||void 0===d?void 0:d.value,pin:null===(b=null===(u=null==e?void 0:e.controls)||void 0===u?void 0:u.zipCode)||void 0===b?void 0:b.value,zipCode:null===(f=null===(p=null==e?void 0:e.controls)||void 0===p?void 0:p.zipCode)||void 0===f?void 0:f.value,poBox:null===(h=null===(v=null==e?void 0:e.controls)||void 0===v?void 0:v.poBox)||void 0===h?void 0:h.value,lat:null===(m=null===(g=null==e?void 0:e.controls)||void 0===g?void 0:g.lat)||void 0===m?void 0:m.value,lng:null===(D=null===(C=null==e?void 0:e.controls)||void 0===C?void 0:C.lng)||void 0===D?void 0:D.value}},Nl=function e(){c(this,e),this.fromAddress=new v.l({streetAddress:new v.i(null,[v.D.required]),streetAddress2:new v.i(null),city:new v.i(null),state:new v.i(null),zipCode:new v.i(null,[v.D.required]),country:new v.i(null)}),this.toAddress=new v.l({streetAddress:new v.i(null,[v.D.required]),streetAddress2:new v.i(null),city:new v.i(null),state:new v.i(null),zipCode:new v.i(null,[v.D.required]),country:new v.i(null)}),this.terms=new v.i(null,[v.D.required]),this.website=new v.i(null,[v.D.required]),this.email=new v.i(null,[v.D.required,v.D.email]),this.fromName=new v.i(null,[v.D.required])},zl=o("pxUr"),Ml=o("z4wI"),Al=["searchFromAddress"],Pl=["searchToAddress"];function Wl(e,t){if(1&e){var n=I.Yb();I.Vb(0),I.Xb(1,"div",32),I.Xb(2,"label",33),I.Xc(3),I.jc(4,"cptCode"),I.Wb(),I.Xb(5,"nz-input-number",34),I.ec("ngModelChange",function(e){I.Lc(n);var i=t.$implicit,a=I.ic().$implicit;return I.ic().rateUpdated(e,i.cptCode,a.id)}),I.Wb(),I.Wb(),I.Ub()}if(2&e){var i=t.$implicit,a=I.ic(2);I.Db(1),I.rc("nzXXl",8)("nzXl",8)("nzLg",12)("nzMd",12)("nzSm",12)("nzXs",24),I.Db(2),I.Yc(I.kc(4,12,i.cptCode)),I.Db(2),I.rc("ngModel",i.billingRate)("nzMin",0)("nzStep",1)("nzFormatter",a.formatterDollar)("nzParser",a.parserDollar)}}function Rl(e,t){if(1&e&&(I.Vb(0),I.Xb(1,"div",23),I.Xb(2,"nz-card",30),I.Xb(3,"div",31),I.Vc(4,Wl,6,14,"ng-container",29),I.Wb(),I.Wb(),I.Wb(),I.Ub()),2&e){var n=t.$implicit;I.Db(2),I.rc("nzTitle",n.name),I.Db(2),I.rc("ngForOf",null==n?null:n.serviceCodeRates)}}var kl,wl=function(){return[16,48]},Ll=((kl=function(e){a(n,e);var t=s(n);function n(e,i,a,o,s,l){var r;return c(this,n),(r=t.call(this))._dataSharingService=e,r._settingsService=i,r._notificationsService=a,r.mapsAPILoader=o,r._googleLocationService=s,r._fb=l,r.loading=!0,r.serviceCodes=Oo.b,r.saving=!1,r.addressFromZipCode$=new Tl.a,r.addressToZipCode$=new Tl.a,r.fromSearchAddress=!1,r.formatterDollar=function(e){return""===e?"$ 0":"$ ".concat(e)},r.parserDollar=function(e){return e.replace("$ ","")},r._routeHelperService.isPrimaryActionTriggered().pipe(Object(S.a)(function(e){return!!e}),Object(E.a)(r.unsubscribed)).subscribe(function(){return r.updateBillingData()}),r}return u(n,[{key:"ngOnInit",value:function(){var e=this;this.billingInfoForm=this._fb.group(new Nl),this.getTenantConfigMap(),this._dataSharingService.onSubTenantChange().pipe(Object(E.a)(this.unsubscribed)).subscribe(function(t){var n,i;if(e.loading=!0,null==t||null==t||0==t.length){var a=localStorage.getItem(O.a.REQUEST_TENANT_IDS).split(",")[0];e.tenantConfig=e.tenantConfigMap.get(a)}else e.tenantConfig=e.tenantConfigMap.get(t);null!=e.tenantConfig&&e._settingsService.getTenantSettings(null===(n=e.tenantConfig)||void 0===n?void 0:n.tenantName,null===(i=e.tenantConfig)||void 0===i?void 0:i.tenantId).subscribe(function(t){e.tenantConfig=t,e.episodeBlueprints=e.tenantConfig.episodeBlueprints,function(e,t){var n,i,a,o;null!=e&&null!=t&&(e.fromAddress&&Xl(e.fromAddress,t.controls.fromAddress),e.billToAddress&&Xl(e.billToAddress,t.controls.toAddress),null===(n=t.controls.terms)||void 0===n||n.setValue(e.terms),null===(i=t.controls.website)||void 0===i||i.setValue(e.website),null===(a=t.controls.email)||void 0===a||a.setValue(e.email),null===(o=t.controls.fromName)||void 0===o||o.setValue(e.fromName))}(e.tenantConfig.billingConfig,e.billingInfoForm),e.updateEpisodeBillingRates(),setTimeout(function(){return e.searchAddress()}),e.loading=!1})}),this.setupFetchLocationFromZipcode()}},{key:"getTenantConfigMap",value:function(){var e=this;this._dataSharingService.assignedTenantSettings.pipe(Object(E.a)(this.unsubscribed)).subscribe(function(t){e.tenantConfigMap=t})}},{key:"updateEpisodeBillingRates",value:function(){var e,t=this;null===(e=this.episodeBlueprints)||void 0===e||e.forEach(function(e){var n,i,a=new Map;null===(n=e.serviceCodeRates)||void 0===n||n.forEach(function(e){return a.set(e.cptCode,e.billingRate)}),null===(i=e.enabledServiceCodes)||void 0===i||i.forEach(function(e){var n=t.serviceCodes.find(function(t){return t.value===e});n&&!a.has(n.cptCode)&&a.set(n.cptCode,0)});var o=[];a.forEach(function(e,t){return o.push({cptCode:t,billingRate:e})}),e.serviceCodeRates=o})}},{key:"rateUpdated",value:function(e,t,n){var i,a=this.episodeBlueprints.find(function(e){return e.id===n});null===(i=null==a?void 0:a.serviceCodeRates)||void 0===i||i.forEach(function(n){n.cptCode===t&&(n.billingRate=""===e?0:e)})}},{key:"submit",value:function(){for(var e in this.billingInfoForm.controls){if("toAddress"===e||"fromAddress"===e)for(var t in this.billingInfoForm.controls[e].controls)this.billingInfoForm.controls[e].controls[t].markAsDirty(),this.billingInfoForm.controls[e].controls[t].updateValueAndValidity();this.billingInfoForm.controls[e].markAsDirty(),this.billingInfoForm.controls[e].updateValueAndValidity()}"VALID"===this.billingInfoForm.status&&this.updateBillingData()}},{key:"updateBillingData",value:function(){var e=this;this.saving=!0;var t=this.generateRequestObject(El.REPLACE);this._settingsService.postPatchRequest(this.tenantConfig.tenantId,t).subscribe(function(){e.saving=!1,e._notificationsService.success("Billing data","Configuration Saved Successfully!"),e.ngOnInit()})}},{key:"generateRequestObject",value:function(e){var t=new Array;return this.episodeBlueprints.forEach(function(n,i){var a=new Ol;a.path="episode-blueprints/"+i,a.op=e.valueOf(),a.value=JSON.stringify(n),t.push(a)}),t.push(function(e,t,n){var i,a,o,s,l=new Ol;return t.fromAddress=yl(e.controls.fromAddress),t.billToAddress=yl(e.controls.toAddress),t.email=null===(i=e.controls.email)||void 0===i?void 0:i.value,t.website=null===(a=e.controls.website)||void 0===a?void 0:a.value,t.terms=null===(o=e.controls.terms)||void 0===o?void 0:o.value,t.fromName=null===(s=e.controls.fromName)||void 0===s?void 0:s.value,l.path="billing-config",l.op=n.valueOf(),l.value=JSON.stringify(t),l}(this.billingInfoForm,this.tenantConfig.billingConfig,e)),t}},{key:"setupFetchLocationFromZipcode",value:function(){var e=this;this.addressFromZipCode$.pipe(Object(gl.a)(500),Object(ml.a)(),Object(S.a)(function(e){return(null==e?void 0:e.length)>4}),Object(Cl.a)(function(t){return e._googleLocationService.fetchLocationFromZipCode(t)})).pipe(Object(E.a)(this.unsubscribed)).subscribe(function(t){var n,i,a,o,s;0!=(null===(n=null==t?void 0:t.results)||void 0===n?void 0:n.length)&&(null===(i=null==t?void 0:t.results)||void 0===i||i.forEach(function(e){var t;null===(t=null==e?void 0:e.address_components)||void 0===t||t.forEach(function(e){var t,n,i;-1!==(null===(t=null==e?void 0:e.types)||void 0===t?void 0:t.findIndex(function(e){return"country"===e}))&&(a=e.long_name),-1!==(null===(n=null==e?void 0:e.types)||void 0===n?void 0:n.findIndex(function(e){return"administrative_area_level_1"===e}))&&(o=e.long_name),-1!==(null===(i=null==e?void 0:e.types)||void 0===i?void 0:i.findIndex(function(e){return"locality"===e}))&&(s=e.long_name)})}),e.billingInfoForm.patchValue({fromAddress:{city:s,country:a,state:o}}))}),this.addressToZipCode$.pipe(Object(gl.a)(500),Object(ml.a)(),Object(S.a)(function(e){return(null==e?void 0:e.length)>4}),Object(Cl.a)(function(t){return e._googleLocationService.fetchLocationFromZipCode(t)})).pipe(Object(E.a)(this.unsubscribed)).subscribe(function(t){var n,i,a,o,s;0!=(null===(n=null==t?void 0:t.results)||void 0===n?void 0:n.length)&&(null===(i=null==t?void 0:t.results)||void 0===i||i.forEach(function(e){var t;null===(t=null==e?void 0:e.address_components)||void 0===t||t.forEach(function(e){var t,n,i;-1!==(null===(t=null==e?void 0:e.types)||void 0===t?void 0:t.findIndex(function(e){return"country"===e}))&&(a=e.long_name),-1!==(null===(n=null==e?void 0:e.types)||void 0===n?void 0:n.findIndex(function(e){return"administrative_area_level_1"===e}))&&(o=e.long_name),-1!==(null===(i=null==e?void 0:e.types)||void 0===i?void 0:i.findIndex(function(e){return"locality"===e}))&&(s=e.long_name)})}),e.billingInfoForm.patchValue({toAddress:{city:s,country:a,state:o}}))})}},{key:"searchFromZipCode",value:function(e){this.addressFromZipCode$.next(e)}},{key:"searchToZipCode",value:function(e){this.addressToZipCode$.next(e)}},{key:"searchAddress",value:function(){var e=this;this.mapsAPILoader.load().then(function(){var t,n,i=new google.maps.places.Autocomplete(null===(t=e.searchToElementRef)||void 0===t?void 0:t.nativeElement),a=new google.maps.places.Autocomplete(null===(n=e.searchFromElementRef)||void 0===n?void 0:n.nativeElement);i.addListener("place_changed",function(){var t=_l.a.mapAddress(i);e.fromSearchAddress=!0,["streetAddress","streetAddress2","city","state","country","zipCode","lat","lng"].forEach(function(n){var i,a,o;null===(o=null===(a=null===(i=e.billingInfoForm)||void 0===i?void 0:i.controls.toAddress)||void 0===a?void 0:a.controls[n])||void 0===o||o.patchValue(t[n],{emitEvent:!1})})}),a.addListener("place_changed",function(){var t=_l.a.mapAddress(a);["streetAddress","streetAddress2","city","state","country","zipCode","lat","lng"].forEach(function(n){var i,a,o;null===(o=null===(a=null===(i=e.billingInfoForm)||void 0===i?void 0:i.controls.fromAddress)||void 0===a?void 0:a.controls[n])||void 0===o||o.patchValue(t[n],{emitEvent:!1})})})})}}]),n}(D.a)).\u0275fac=function(e){return new(e||kl)(I.Rb(te.a),I.Rb(Sl.a),I.Rb(T.b),I.Rb(zl.b),I.Rb(Il.a),I.Rb(v.h))},kl.\u0275cmp=I.Lb({type:kl,selectors:[["app-episode-billing-rate"]],viewQuery:function(e,t){var n;1&e&&(I.ed(Al,1),I.ed(Pl,1)),2&e&&(I.Hc(n=I.fc())&&(t.searchFromElementRef=n.first),I.Hc(n=I.fc())&&(t.searchToElementRef=n.first))},features:[I.Cb([Dl]),I.Ab],decls:166,vars:93,consts:[["defaultTitle","Episode Billing Rate",3,"isSearchEnabled","isActionEnabled"],["nz-button","","nzType","primary","form","billingForm",3,"disabled"],[1,"container"],["nzTip","Loading data ...",3,"nzSpinning"],["id","billingForm","nz-form","","appScrollToFirstInvalid","",3,"formGroup","ngSubmit","keydown.enter"],["formGroupName","fromAddress",2,"margin-bottom","24px"],["nzTitle","From Address"],["nz-row","",3,"nzGutter"],["nz-col","","nzSpan","12"],["nz-row","","nzGutter","16"],[3,"nzErrorTip"],["formControlName","streetAddress","nz-input","","readonly","","onfocus","this.removeAttribute('readonly')"],["searchFromAddress",""],["formControlName","streetAddress2","nz-input","","readonly","","onfocus","this.removeAttribute('readonly')"],[1,"divider"],["nz-col","","nzSpan","6"],["formControlName","zipCode","nz-input","","readonly","","onfocus","this.removeAttribute('readonly')",3,"ngModelChange"],["formControlName","country","nz-input","","readonly",""],["formControlName","state","nz-input","","readonly",""],["formControlName","city","nz-input","","readonly",""],["formGroupName","toAddress",2,"margin-bottom","24px"],["nzTitle","Bill To Address"],["searchToAddress",""],[2,"margin-bottom","24px"],["nzTitle","Others"],["formControlName","terms","nz-input","","readonly","","onfocus","this.removeAttribute('readonly')"],["formControlName","fromName","nz-input","","readonly","","onfocus","this.removeAttribute('readonly')"],["formControlName","email","nz-input","","readonly","","onfocus","this.removeAttribute('readonly')"],["formControlName","website","nz-input","","readonly","","onfocus","this.removeAttribute('readonly')"],[4,"ngFor","ngForOf"],[3,"nzTitle"],["nz-row","","nzSpan","24","nzGutter","32"],["nz-col","",2,"margin-bottom","16px",3,"nzXXl","nzXl","nzLg","nzMd","nzSm","nzXs"],[1,"cpt-label"],[3,"ngModel","nzMin","nzStep","nzFormatter","nzParser","ngModelChange"]],template:function(e,t){1&e&&(I.Xb(0,"app-header",0),I.Xb(1,"button",1),I.Xc(2),I.jc(3,"translate"),I.Wb(),I.Wb(),I.Xb(4,"div",2),I.Xb(5,"nz-spin",3),I.Xb(6,"form",4),I.ec("ngSubmit",function(){return t.submit()})("keydown.enter",function(e){return e.preventDefault()}),I.Xb(7,"div",5),I.Xb(8,"nz-card",6),I.Xb(9,"div",7),I.Xb(10,"div",8),I.Xb(11,"label"),I.Xc(12),I.jc(13,"translate"),I.Wb(),I.Wb(),I.Xb(14,"div",8),I.Xb(15,"label"),I.Xc(16),I.jc(17,"translate"),I.Wb(),I.Wb(),I.Wb(),I.Xb(18,"div",9),I.Xb(19,"div",8),I.Xb(20,"nz-form-item"),I.Xb(21,"nz-form-control",10),I.jc(22,"translate"),I.Sb(23,"input",11,12),I.Wb(),I.Wb(),I.Wb(),I.Xb(25,"div",8),I.Xb(26,"nz-form-item"),I.Xb(27,"nz-form-control"),I.Sb(28,"input",13),I.Wb(),I.Wb(),I.Wb(),I.Wb(),I.Sb(29,"div",14),I.Xb(30,"div",9),I.Xb(31,"div",15),I.Xb(32,"label"),I.Xc(33),I.jc(34,"translate"),I.Wb(),I.Wb(),I.Xb(35,"div",15),I.Xb(36,"label"),I.Xc(37),I.jc(38,"translate"),I.Wb(),I.Wb(),I.Xb(39,"div",15),I.Xb(40,"label"),I.Xc(41),I.jc(42,"translate"),I.Wb(),I.Wb(),I.Xb(43,"div",15),I.Xb(44,"label"),I.Xc(45),I.jc(46,"translate"),I.Wb(),I.Wb(),I.Wb(),I.Xb(47,"div",9),I.Xb(48,"div",15),I.Xb(49,"nz-form-item"),I.Xb(50,"nz-form-control",10),I.jc(51,"translate"),I.Xb(52,"input",16),I.ec("ngModelChange",function(e){return t.searchFromZipCode(e)}),I.Wb(),I.Wb(),I.Wb(),I.Wb(),I.Xb(53,"div",15),I.Xb(54,"nz-form-item"),I.Xb(55,"nz-form-control",10),I.jc(56,"translate"),I.Sb(57,"input",17),I.Wb(),I.Wb(),I.Wb(),I.Xb(58,"div",15),I.Xb(59,"nz-form-item"),I.Xb(60,"nz-form-control",10),I.jc(61,"translate"),I.Sb(62,"input",18),I.Wb(),I.Wb(),I.Wb(),I.Xb(63,"div",15),I.Xb(64,"nz-form-item"),I.Xb(65,"nz-form-control",10),I.jc(66,"translate"),I.Sb(67,"input",19),I.Wb(),I.Wb(),I.Wb(),I.Wb(),I.Wb(),I.Wb(),I.Xb(68,"div",20),I.Xb(69,"nz-card",21),I.Xb(70,"div",7),I.Xb(71,"div",8),I.Xb(72,"label"),I.Xc(73),I.jc(74,"translate"),I.Wb(),I.Wb(),I.Xb(75,"div",8),I.Xb(76,"label"),I.Xc(77),I.jc(78,"translate"),I.Wb(),I.Wb(),I.Wb(),I.Xb(79,"div",9),I.Xb(80,"div",8),I.Xb(81,"nz-form-item"),I.Xb(82,"nz-form-control",10),I.jc(83,"translate"),I.Sb(84,"input",11,22),I.Wb(),I.Wb(),I.Wb(),I.Xb(86,"div",8),I.Xb(87,"nz-form-item"),I.Xb(88,"nz-form-control"),I.Sb(89,"input",13),I.Wb(),I.Wb(),I.Wb(),I.Wb(),I.Sb(90,"div",14),I.Xb(91,"div",9),I.Xb(92,"div",15),I.Xb(93,"label"),I.Xc(94),I.jc(95,"translate"),I.Wb(),I.Wb(),I.Xb(96,"div",15),I.Xb(97,"label"),I.Xc(98),I.jc(99,"translate"),I.Wb(),I.Wb(),I.Xb(100,"div",15),I.Xb(101,"label"),I.Xc(102),I.jc(103,"translate"),I.Wb(),I.Wb(),I.Xb(104,"div",15),I.Xb(105,"label"),I.Xc(106),I.jc(107,"translate"),I.Wb(),I.Wb(),I.Wb(),I.Xb(108,"div",9),I.Xb(109,"div",15),I.Xb(110,"nz-form-item"),I.Xb(111,"nz-form-control",10),I.jc(112,"translate"),I.Xb(113,"input",16),I.ec("ngModelChange",function(e){return t.searchToZipCode(e)}),I.Wb(),I.Wb(),I.Wb(),I.Wb(),I.Xb(114,"div",15),I.Xb(115,"nz-form-item"),I.Xb(116,"nz-form-control",10),I.jc(117,"translate"),I.Sb(118,"input",17),I.Wb(),I.Wb(),I.Wb(),I.Xb(119,"div",15),I.Xb(120,"nz-form-item"),I.Xb(121,"nz-form-control",10),I.jc(122,"translate"),I.Sb(123,"input",18),I.Wb(),I.Wb(),I.Wb(),I.Xb(124,"div",15),I.Xb(125,"nz-form-item"),I.Xb(126,"nz-form-control",10),I.jc(127,"translate"),I.Sb(128,"input",19),I.Wb(),I.Wb(),I.Wb(),I.Wb(),I.Wb(),I.Wb(),I.Xb(129,"div",23),I.Xb(130,"nz-card",24),I.Xb(131,"div",7),I.Xb(132,"div",15),I.Xb(133,"label"),I.Xc(134,"Terms*"),I.Wb(),I.Wb(),I.Xb(135,"div",15),I.Xb(136,"label"),I.Xc(137,"From Name*"),I.Wb(),I.Wb(),I.Xb(138,"div",15),I.Xb(139,"label"),I.Xc(140,"From Email*"),I.Wb(),I.Wb(),I.Xb(141,"div",15),I.Xb(142,"label"),I.Xc(143,"From Website*"),I.Wb(),I.Wb(),I.Wb(),I.Xb(144,"div",9),I.Xb(145,"div",15),I.Xb(146,"nz-form-item"),I.Xb(147,"nz-form-control",10),I.jc(148,"translate"),I.Sb(149,"input",25),I.Wb(),I.Wb(),I.Wb(),I.Xb(150,"div",15),I.Xb(151,"nz-form-item"),I.Xb(152,"nz-form-control",10),I.jc(153,"translate"),I.Sb(154,"input",26),I.Wb(),I.Wb(),I.Wb(),I.Xb(155,"div",15),I.Xb(156,"nz-form-item"),I.Xb(157,"nz-form-control",10),I.jc(158,"translate"),I.Sb(159,"input",27),I.Wb(),I.Wb(),I.Wb(),I.Xb(160,"div",15),I.Xb(161,"nz-form-item"),I.Xb(162,"nz-form-control",10),I.jc(163,"translate"),I.Sb(164,"input",28),I.Wb(),I.Wb(),I.Wb(),I.Wb(),I.Wb(),I.Wb(),I.Wb(),I.Vc(165,Rl,5,2,"ng-container",29),I.Wb(),I.Wb()),2&e&&(I.rc("isSearchEnabled",!1)("isActionEnabled",!1),I.Db(1),I.rc("disabled","PENDING"===(null==t.billingInfoForm?null:t.billingInfoForm.status)),I.Db(1),I.Zc(" ",I.kc(3,36,"COMMON.SAVE")," "),I.Db(3),I.rc("nzSpinning",t.loading),I.Db(1),I.rc("formGroup",t.billingInfoForm),I.Db(3),I.rc("nzGutter",I.xc(90,wl)),I.Db(3),I.Zc("",I.kc(13,38,"SITE.ADDRESS_LINE_1")," *"),I.Db(4),I.Yc(I.kc(17,40,"COMMON.LINE_2")),I.Db(5),I.sc("nzErrorTip",I.kc(22,42,"COMMON.REQUIRED")),I.Db(12),I.Zc("",I.kc(34,44,"ZIP_CODE")," *"),I.Db(4),I.Yc(I.kc(38,46,"COMMON.COUNTRY")),I.Db(4),I.Yc(I.kc(42,48,"COMMON.STATE")),I.Db(4),I.Yc(I.kc(46,50,"COMMON.CITY")),I.Db(5),I.sc("nzErrorTip",I.kc(51,52,"COMMON.REQUIRED")),I.Db(5),I.sc("nzErrorTip",I.kc(56,54,"COMMON.REQUIRED")),I.Db(5),I.sc("nzErrorTip",I.kc(61,56,"COMMON.REQUIRED")),I.Db(5),I.sc("nzErrorTip",I.kc(66,58,"COMMON.REQUIRED")),I.Db(5),I.rc("nzGutter",I.xc(91,wl)),I.Db(3),I.Zc("",I.kc(74,60,"SITE.ADDRESS_LINE_1")," *"),I.Db(4),I.Yc(I.kc(78,62,"COMMON.LINE_2")),I.Db(5),I.sc("nzErrorTip",I.kc(83,64,"COMMON.REQUIRED")),I.Db(12),I.Zc("",I.kc(95,66,"ZIP_CODE")," *"),I.Db(4),I.Yc(I.kc(99,68,"COMMON.COUNTRY")),I.Db(4),I.Yc(I.kc(103,70,"COMMON.STATE")),I.Db(4),I.Yc(I.kc(107,72,"COMMON.CITY")),I.Db(5),I.sc("nzErrorTip",I.kc(112,74,"COMMON.REQUIRED")),I.Db(5),I.sc("nzErrorTip",I.kc(117,76,"COMMON.REQUIRED")),I.Db(5),I.sc("nzErrorTip",I.kc(122,78,"COMMON.REQUIRED")),I.Db(5),I.sc("nzErrorTip",I.kc(127,80,"COMMON.REQUIRED")),I.Db(5),I.rc("nzGutter",I.xc(92,wl)),I.Db(16),I.sc("nzErrorTip",I.kc(148,82,"COMMON.REQUIRED")),I.Db(5),I.sc("nzErrorTip",I.kc(153,84,"COMMON.REQUIRED")),I.Db(5),I.sc("nzErrorTip",I.kc(158,86,"COMMON.REQUIRED")),I.Db(5),I.sc("nzErrorTip",I.kc(163,88,"COMMON.REQUIRED")),I.Db(3),I.rc("ngForOf",t.episodeBlueprints))},directives:[qe.a,kt.a,wt.a,L.a,fe.a,v.F,v.v,A.b,M.a,v.m,v.n,z.a,N.c,N.a,A.c,A.a,v.d,W.b,v.u,v.k,r.p,Ml.a,v.x],pipes:[se.a,Dl],styles:["label[_ngcontent-%COMP%]{font-size:12px;font-weight:900}.cpt-label[_ngcontent-%COMP%]{line-height:1.2em;display:block;max-height:2.4em;min-height:2.4em;overflow:hidden}nz-input-number[_ngcontent-%COMP%]{width:100%;text-align:left}"]}),kl),xl=o("isHH"),Vl=o("iSMj"),Ul=o("g9KO"),Fl=o("/Tr7");function jl(e,t){if(null==e)throw new TypeError("assign requires that input parameter not be null or undefined");for(var n in t=t||{})t.hasOwnProperty(n)&&(e[n]=t[n]);return e}var Yl=o("Ib5w"),Gl=o("JCDJ"),Bl=o("3REe"),Hl=o("/h9T"),Zl=o("Szzx"),ql=o("jIYg");function $l(e,t,n){Object(ql.a)(2,arguments);var i=n||{},a=i.locale,o=a&&a.options&&a.options.weekStartsOn,s=null==o?0:Object(Hl.a)(o),l=null==i.weekStartsOn?s:Object(Hl.a)(i.weekStartsOn);if(!(l>=0&&l<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var r=Object(Fl.a)(e),c=Object(Hl.a)(t),d=r.getUTCDay(),u=c%7,b=(u+7)%7,p=(b<l?7:0)+c-d;return r.setUTCDate(r.getUTCDate()+p),r}var Kl=o("lgZR"),Ql=o("ErpD"),Jl=o("tpup"),er=o("1vjI"),tr=/^(1[0-2]|0?\d)/,nr=/^(3[0-1]|[0-2]?\d)/,ir=/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,ar=/^(5[0-3]|[0-4]?\d)/,or=/^(2[0-3]|[0-1]?\d)/,sr=/^(2[0-4]|[0-1]?\d)/,lr=/^(1[0-1]|0?\d)/,rr=/^(1[0-2]|0?\d)/,cr=/^[0-5]?\d/,dr=/^[0-5]?\d/,ur=/^\d/,br=/^\d{1,2}/,pr=/^\d{1,3}/,fr=/^\d{1,4}/,vr=/^-?\d+/,hr=/^-?\d/,gr=/^-?\d{1,2}/,mr=/^-?\d{1,3}/,Cr=/^-?\d{1,4}/,Dr=/^([+-])(\d{2})(\d{2})?|Z/,Sr=/^([+-])(\d{2})(\d{2})|Z/,Er=/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,Or=/^([+-])(\d{2}):(\d{2})|Z/,Ir=/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/;function _r(e,t,n){var i=t.match(e);if(!i)return null;var a=parseInt(i[0],10);return{value:n?n(a):a,rest:t.slice(i[0].length)}}function Tr(e,t){var n=t.match(e);return n?"Z"===n[0]?{value:0,rest:t.slice(1)}:{value:("+"===n[1]?1:-1)*(36e5*(n[2]?parseInt(n[2],10):0)+6e4*(n[3]?parseInt(n[3],10):0)+1e3*(n[5]?parseInt(n[5],10):0)),rest:t.slice(n[0].length)}:null}function Xr(e,t){return _r(vr,e,t)}function yr(e,t,n){switch(e){case 1:return _r(ur,t,n);case 2:return _r(br,t,n);case 3:return _r(pr,t,n);case 4:return _r(fr,t,n);default:return _r(new RegExp("^\\d{1,"+e+"}"),t,n)}}function Nr(e,t,n){switch(e){case 1:return _r(hr,t,n);case 2:return _r(gr,t,n);case 3:return _r(mr,t,n);case 4:return _r(Cr,t,n);default:return _r(new RegExp("^-?\\d{1,"+e+"}"),t,n)}}function zr(e){switch(e){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function Mr(e,t){var n,i=t>0,a=i?t:1-t;if(a<=50)n=e||100;else{var o=a+50;n=e+100*Math.floor(o/100)-(e>=o%100?100:0)}return i?n:1-n}var Ar=[31,28,31,30,31,30,31,31,30,31,30,31],Pr=[31,29,31,30,31,30,31,31,30,31,30,31];function Wr(e){return e%400==0||e%4==0&&e%100!=0}var Rr={G:{priority:140,parse:function(e,t,n,i){switch(t){case"G":case"GG":case"GGG":return n.era(e,{width:"abbreviated"})||n.era(e,{width:"narrow"});case"GGGGG":return n.era(e,{width:"narrow"});case"GGGG":default:return n.era(e,{width:"wide"})||n.era(e,{width:"abbreviated"})||n.era(e,{width:"narrow"})}},set:function(e,t,n,i){return t.era=n,e.setUTCFullYear(n,0,1),e.setUTCHours(0,0,0,0),e},incompatibleTokens:["R","u","t","T"]},y:{priority:130,parse:function(e,t,n,i){var a=function(e){return{year:e,isTwoDigitYear:"yy"===t}};switch(t){case"y":return yr(4,e,a);case"yo":return n.ordinalNumber(e,{unit:"year",valueCallback:a});default:return yr(t.length,e,a)}},validate:function(e,t,n){return t.isTwoDigitYear||t.year>0},set:function(e,t,n,i){var a=e.getUTCFullYear();if(n.isTwoDigitYear){var o=Mr(n.year,a);return e.setUTCFullYear(o,0,1),e.setUTCHours(0,0,0,0),e}return e.setUTCFullYear("era"in t&&1!==t.era?1-n.year:n.year,0,1),e.setUTCHours(0,0,0,0),e},incompatibleTokens:["Y","R","u","w","I","i","e","c","t","T"]},Y:{priority:130,parse:function(e,t,n,i){var a=function(e){return{year:e,isTwoDigitYear:"YY"===t}};switch(t){case"Y":return yr(4,e,a);case"Yo":return n.ordinalNumber(e,{unit:"year",valueCallback:a});default:return yr(t.length,e,a)}},validate:function(e,t,n){return t.isTwoDigitYear||t.year>0},set:function(e,t,n,i){var a=Object(Zl.a)(e,i);if(n.isTwoDigitYear){var o=Mr(n.year,a);return e.setUTCFullYear(o,0,i.firstWeekContainsDate),e.setUTCHours(0,0,0,0),Object(er.a)(e,i)}return e.setUTCFullYear("era"in t&&1!==t.era?1-n.year:n.year,0,i.firstWeekContainsDate),e.setUTCHours(0,0,0,0),Object(er.a)(e,i)},incompatibleTokens:["y","R","u","Q","q","M","L","I","d","D","i","t","T"]},R:{priority:130,parse:function(e,t,n,i){return Nr("R"===t?4:t.length,e)},set:function(e,t,n,i){var a=new Date(0);return a.setUTCFullYear(n,0,4),a.setUTCHours(0,0,0,0),Object(Jl.a)(a)},incompatibleTokens:["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]},u:{priority:130,parse:function(e,t,n,i){return Nr("u"===t?4:t.length,e)},set:function(e,t,n,i){return e.setUTCFullYear(n,0,1),e.setUTCHours(0,0,0,0),e},incompatibleTokens:["G","y","Y","R","w","I","i","e","c","t","T"]},Q:{priority:120,parse:function(e,t,n,i){switch(t){case"Q":case"QQ":return yr(t.length,e);case"Qo":return n.ordinalNumber(e,{unit:"quarter"});case"QQQ":return n.quarter(e,{width:"abbreviated",context:"formatting"})||n.quarter(e,{width:"narrow",context:"formatting"});case"QQQQQ":return n.quarter(e,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(e,{width:"wide",context:"formatting"})||n.quarter(e,{width:"abbreviated",context:"formatting"})||n.quarter(e,{width:"narrow",context:"formatting"})}},validate:function(e,t,n){return t>=1&&t<=4},set:function(e,t,n,i){return e.setUTCMonth(3*(n-1),1),e.setUTCHours(0,0,0,0),e},incompatibleTokens:["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]},q:{priority:120,parse:function(e,t,n,i){switch(t){case"q":case"qq":return yr(t.length,e);case"qo":return n.ordinalNumber(e,{unit:"quarter"});case"qqq":return n.quarter(e,{width:"abbreviated",context:"standalone"})||n.quarter(e,{width:"narrow",context:"standalone"});case"qqqqq":return n.quarter(e,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(e,{width:"wide",context:"standalone"})||n.quarter(e,{width:"abbreviated",context:"standalone"})||n.quarter(e,{width:"narrow",context:"standalone"})}},validate:function(e,t,n){return t>=1&&t<=4},set:function(e,t,n,i){return e.setUTCMonth(3*(n-1),1),e.setUTCHours(0,0,0,0),e},incompatibleTokens:["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]},M:{priority:110,parse:function(e,t,n,i){var a=function(e){return e-1};switch(t){case"M":return _r(tr,e,a);case"MM":return yr(2,e,a);case"Mo":return n.ordinalNumber(e,{unit:"month",valueCallback:a});case"MMM":return n.month(e,{width:"abbreviated",context:"formatting"})||n.month(e,{width:"narrow",context:"formatting"});case"MMMMM":return n.month(e,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(e,{width:"wide",context:"formatting"})||n.month(e,{width:"abbreviated",context:"formatting"})||n.month(e,{width:"narrow",context:"formatting"})}},validate:function(e,t,n){return t>=0&&t<=11},set:function(e,t,n,i){return e.setUTCMonth(n,1),e.setUTCHours(0,0,0,0),e},incompatibleTokens:["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]},L:{priority:110,parse:function(e,t,n,i){var a=function(e){return e-1};switch(t){case"L":return _r(tr,e,a);case"LL":return yr(2,e,a);case"Lo":return n.ordinalNumber(e,{unit:"month",valueCallback:a});case"LLL":return n.month(e,{width:"abbreviated",context:"standalone"})||n.month(e,{width:"narrow",context:"standalone"});case"LLLLL":return n.month(e,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(e,{width:"wide",context:"standalone"})||n.month(e,{width:"abbreviated",context:"standalone"})||n.month(e,{width:"narrow",context:"standalone"})}},validate:function(e,t,n){return t>=0&&t<=11},set:function(e,t,n,i){return e.setUTCMonth(n,1),e.setUTCHours(0,0,0,0),e},incompatibleTokens:["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]},w:{priority:100,parse:function(e,t,n,i){switch(t){case"w":return _r(ar,e);case"wo":return n.ordinalNumber(e,{unit:"week"});default:return yr(t.length,e)}},validate:function(e,t,n){return t>=1&&t<=53},set:function(e,t,n,i){return Object(er.a)(function(e,t,n){Object(ql.a)(2,arguments);var i=Object(Fl.a)(e),a=Object(Hl.a)(t),o=Object(Ql.a)(i,n)-a;return i.setUTCDate(i.getUTCDate()-7*o),i}(e,n,i),i)},incompatibleTokens:["y","R","u","q","Q","M","L","I","d","D","i","t","T"]},I:{priority:100,parse:function(e,t,n,i){switch(t){case"I":return _r(ar,e);case"Io":return n.ordinalNumber(e,{unit:"week"});default:return yr(t.length,e)}},validate:function(e,t,n){return t>=1&&t<=53},set:function(e,t,n,i){return Object(Jl.a)(function(e,t){Object(ql.a)(2,arguments);var n=Object(Fl.a)(e),i=Object(Hl.a)(t),a=Object(Kl.a)(n)-i;return n.setUTCDate(n.getUTCDate()-7*a),n}(e,n,i),i)},incompatibleTokens:["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]},d:{priority:90,subPriority:1,parse:function(e,t,n,i){switch(t){case"d":return _r(nr,e);case"do":return n.ordinalNumber(e,{unit:"date"});default:return yr(t.length,e)}},validate:function(e,t,n){var i=Wr(e.getUTCFullYear()),a=e.getUTCMonth();return i?t>=1&&t<=Pr[a]:t>=1&&t<=Ar[a]},set:function(e,t,n,i){return e.setUTCDate(n),e.setUTCHours(0,0,0,0),e},incompatibleTokens:["Y","R","q","Q","w","I","D","i","e","c","t","T"]},D:{priority:90,subPriority:1,parse:function(e,t,n,i){switch(t){case"D":case"DD":return _r(ir,e);case"Do":return n.ordinalNumber(e,{unit:"date"});default:return yr(t.length,e)}},validate:function(e,t,n){return Wr(e.getUTCFullYear())?t>=1&&t<=366:t>=1&&t<=365},set:function(e,t,n,i){return e.setUTCMonth(0,n),e.setUTCHours(0,0,0,0),e},incompatibleTokens:["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]},E:{priority:90,parse:function(e,t,n,i){switch(t){case"E":case"EE":case"EEE":return n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});case"EEEEE":return n.day(e,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});case"EEEE":default:return n.day(e,{width:"wide",context:"formatting"})||n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"})}},validate:function(e,t,n){return t>=0&&t<=6},set:function(e,t,n,i){return(e=$l(e,n,i)).setUTCHours(0,0,0,0),e},incompatibleTokens:["D","i","e","c","t","T"]},e:{priority:90,parse:function(e,t,n,i){var a=function(e){var t=7*Math.floor((e-1)/7);return(e+i.weekStartsOn+6)%7+t};switch(t){case"e":case"ee":return yr(t.length,e,a);case"eo":return n.ordinalNumber(e,{unit:"day",valueCallback:a});case"eee":return n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});case"eeeee":return n.day(e,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});case"eeee":default:return n.day(e,{width:"wide",context:"formatting"})||n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"})}},validate:function(e,t,n){return t>=0&&t<=6},set:function(e,t,n,i){return(e=$l(e,n,i)).setUTCHours(0,0,0,0),e},incompatibleTokens:["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]},c:{priority:90,parse:function(e,t,n,i){var a=function(e){var t=7*Math.floor((e-1)/7);return(e+i.weekStartsOn+6)%7+t};switch(t){case"c":case"cc":return yr(t.length,e,a);case"co":return n.ordinalNumber(e,{unit:"day",valueCallback:a});case"ccc":return n.day(e,{width:"abbreviated",context:"standalone"})||n.day(e,{width:"short",context:"standalone"})||n.day(e,{width:"narrow",context:"standalone"});case"ccccc":return n.day(e,{width:"narrow",context:"standalone"});case"cccccc":return n.day(e,{width:"short",context:"standalone"})||n.day(e,{width:"narrow",context:"standalone"});case"cccc":default:return n.day(e,{width:"wide",context:"standalone"})||n.day(e,{width:"abbreviated",context:"standalone"})||n.day(e,{width:"short",context:"standalone"})||n.day(e,{width:"narrow",context:"standalone"})}},validate:function(e,t,n){return t>=0&&t<=6},set:function(e,t,n,i){return(e=$l(e,n,i)).setUTCHours(0,0,0,0),e},incompatibleTokens:["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]},i:{priority:90,parse:function(e,t,n,i){var a=function(e){return 0===e?7:e};switch(t){case"i":case"ii":return yr(t.length,e);case"io":return n.ordinalNumber(e,{unit:"day"});case"iii":return n.day(e,{width:"abbreviated",context:"formatting",valueCallback:a})||n.day(e,{width:"short",context:"formatting",valueCallback:a})||n.day(e,{width:"narrow",context:"formatting",valueCallback:a});case"iiiii":return n.day(e,{width:"narrow",context:"formatting",valueCallback:a});case"iiiiii":return n.day(e,{width:"short",context:"formatting",valueCallback:a})||n.day(e,{width:"narrow",context:"formatting",valueCallback:a});case"iiii":default:return n.day(e,{width:"wide",context:"formatting",valueCallback:a})||n.day(e,{width:"abbreviated",context:"formatting",valueCallback:a})||n.day(e,{width:"short",context:"formatting",valueCallback:a})||n.day(e,{width:"narrow",context:"formatting",valueCallback:a})}},validate:function(e,t,n){return t>=1&&t<=7},set:function(e,t,n,i){return(e=function(e,t){Object(ql.a)(2,arguments);var n=Object(Hl.a)(t);n%7==0&&(n-=7);var i=1,a=Object(Fl.a)(e),o=a.getUTCDay(),s=((n%7+7)%7<i?7:0)+n-o;return a.setUTCDate(a.getUTCDate()+s),a}(e,n,i)).setUTCHours(0,0,0,0),e},incompatibleTokens:["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]},a:{priority:80,parse:function(e,t,n,i){switch(t){case"a":case"aa":case"aaa":return n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"});case"aaaaa":return n.dayPeriod(e,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(e,{width:"wide",context:"formatting"})||n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"})}},set:function(e,t,n,i){return e.setUTCHours(zr(n),0,0,0),e},incompatibleTokens:["b","B","H","K","k","t","T"]},b:{priority:80,parse:function(e,t,n,i){switch(t){case"b":case"bb":case"bbb":return n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"});case"bbbbb":return n.dayPeriod(e,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(e,{width:"wide",context:"formatting"})||n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"})}},set:function(e,t,n,i){return e.setUTCHours(zr(n),0,0,0),e},incompatibleTokens:["a","B","H","K","k","t","T"]},B:{priority:80,parse:function(e,t,n,i){switch(t){case"B":case"BB":case"BBB":return n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"});case"BBBBB":return n.dayPeriod(e,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(e,{width:"wide",context:"formatting"})||n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"})}},set:function(e,t,n,i){return e.setUTCHours(zr(n),0,0,0),e},incompatibleTokens:["a","b","t","T"]},h:{priority:70,parse:function(e,t,n,i){switch(t){case"h":return _r(rr,e);case"ho":return n.ordinalNumber(e,{unit:"hour"});default:return yr(t.length,e)}},validate:function(e,t,n){return t>=1&&t<=12},set:function(e,t,n,i){var a=e.getUTCHours()>=12;return e.setUTCHours(a&&n<12?n+12:a||12!==n?n:0,0,0,0),e},incompatibleTokens:["H","K","k","t","T"]},H:{priority:70,parse:function(e,t,n,i){switch(t){case"H":return _r(or,e);case"Ho":return n.ordinalNumber(e,{unit:"hour"});default:return yr(t.length,e)}},validate:function(e,t,n){return t>=0&&t<=23},set:function(e,t,n,i){return e.setUTCHours(n,0,0,0),e},incompatibleTokens:["a","b","h","K","k","t","T"]},K:{priority:70,parse:function(e,t,n,i){switch(t){case"K":return _r(lr,e);case"Ko":return n.ordinalNumber(e,{unit:"hour"});default:return yr(t.length,e)}},validate:function(e,t,n){return t>=0&&t<=11},set:function(e,t,n,i){var a=e.getUTCHours()>=12;return e.setUTCHours(a&&n<12?n+12:n,0,0,0),e},incompatibleTokens:["a","b","h","H","k","t","T"]},k:{priority:70,parse:function(e,t,n,i){switch(t){case"k":return _r(sr,e);case"ko":return n.ordinalNumber(e,{unit:"hour"});default:return yr(t.length,e)}},validate:function(e,t,n){return t>=1&&t<=24},set:function(e,t,n,i){return e.setUTCHours(n<=24?n%24:n,0,0,0),e},incompatibleTokens:["a","b","h","H","K","t","T"]},m:{priority:60,parse:function(e,t,n,i){switch(t){case"m":return _r(cr,e);case"mo":return n.ordinalNumber(e,{unit:"minute"});default:return yr(t.length,e)}},validate:function(e,t,n){return t>=0&&t<=59},set:function(e,t,n,i){return e.setUTCMinutes(n,0,0),e},incompatibleTokens:["t","T"]},s:{priority:50,parse:function(e,t,n,i){switch(t){case"s":return _r(dr,e);case"so":return n.ordinalNumber(e,{unit:"second"});default:return yr(t.length,e)}},validate:function(e,t,n){return t>=0&&t<=59},set:function(e,t,n,i){return e.setUTCSeconds(n,0),e},incompatibleTokens:["t","T"]},S:{priority:30,parse:function(e,t,n,i){return yr(t.length,e,function(e){return Math.floor(e*Math.pow(10,3-t.length))})},set:function(e,t,n,i){return e.setUTCMilliseconds(n),e},incompatibleTokens:["t","T"]},X:{priority:10,parse:function(e,t,n,i){switch(t){case"X":return Tr(Dr,e);case"XX":return Tr(Sr,e);case"XXXX":return Tr(Er,e);case"XXXXX":return Tr(Ir,e);case"XXX":default:return Tr(Or,e)}},set:function(e,t,n,i){return t.timestampIsSet?e:new Date(e.getTime()-n)},incompatibleTokens:["t","T","x"]},x:{priority:10,parse:function(e,t,n,i){switch(t){case"x":return Tr(Dr,e);case"xx":return Tr(Sr,e);case"xxxx":return Tr(Er,e);case"xxxxx":return Tr(Ir,e);case"xxx":default:return Tr(Or,e)}},set:function(e,t,n,i){return t.timestampIsSet?e:new Date(e.getTime()-n)},incompatibleTokens:["t","T","X"]},t:{priority:40,parse:function(e,t,n,i){return Xr(e)},set:function(e,t,n,i){return[new Date(1e3*n),{timestampIsSet:!0}]},incompatibleTokens:"*"},T:{priority:20,parse:function(e,t,n,i){return Xr(e)},set:function(e,t,n,i){return[new Date(n),{timestampIsSet:!0}]},incompatibleTokens:"*"}},kr=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,wr=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Lr=/^'([^]*?)'?$/,xr=/''/g,Vr=/\S/,Ur=/[a-zA-Z]/;function Fr(e,t){if(t.timestampIsSet)return e;var n=new Date(0);return n.setFullYear(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()),n.setHours(e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()),n}function jr(e){return e.match(Lr)[1].replace(xr,"'")}function Yr(e,t){Object(ql.a)(2,arguments);var n=Object(Fl.a)(e),i=Object(Fl.a)(t);return n.getFullYear()-i.getFullYear()}function Gr(e,t){Object(ql.a)(2,arguments);var n=Object(Fl.a)(e),i=Object(Fl.a)(t),a=n.getTime()-i.getTime();return a<0?-1:a>0?1:a}function Br(e,t){if(1&e&&(I.Xb(0,"span"),I.Xc(1),I.Wb()),2&e){var n=I.ic().$implicit;I.Db(1),I.Yc((null==n?null:n.sourceId)||"N/A")}}function Hr(e,t){if(1&e&&(I.Xb(0,"h4"),I.Xb(1,"strong"),I.Xb(2,"span",5),I.Vc(3,Br,2,1,"span",6),I.Wb(),I.Wb(),I.Wb()),2&e){var n=t.$implicit;I.Db(2),I.rc("ngSwitch",null==n?null:n.source),I.Db(1),I.rc("ngSwitchCase","HOSPITAL_INTERNAL_ID")}}function Zr(e,t){1&e&&(I.Vb(0),I.Xb(1,"h4"),I.Xb(2,"strong"),I.Xc(3,"N/A"),I.Wb(),I.Wb(),I.Ub())}var qr,$r=function(){return[32,32]},Kr=((qr=function(){function e(){c(this,e)}return u(e,[{key:"_patientDetails",set:function(e){if(e){this.patientDetails=e;var t=function(e,t,n,i){Object(ql.a)(3,arguments);var a=String(e),o=String(t),s=i||{},l=s.locale||Vl.a;if(!l.match)throw new RangeError("locale must contain match property");var r=l.options&&l.options.firstWeekContainsDate,c=null==r?1:Object(Hl.a)(r),d=null==s.firstWeekContainsDate?c:Object(Hl.a)(s.firstWeekContainsDate);if(!(d>=1&&d<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var u=l.options&&l.options.weekStartsOn,b=null==u?0:Object(Hl.a)(u),p=null==s.weekStartsOn?b:Object(Hl.a)(s.weekStartsOn);if(!(p>=0&&p<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(""===o)return""===a?Object(Fl.a)(n):new Date(NaN);var f,v={firstWeekContainsDate:d,weekStartsOn:p,locale:l},h=[{priority:10,subPriority:-1,set:Fr,index:0}],g=o.match(wr).map(function(e){var t=e[0];return"p"===t||"P"===t?(0,Yl.a[t])(e,l.formatLong,v):e}).join("").match(kr),m=[];for(f=0;f<g.length;f++){var C=g[f];!s.useAdditionalWeekYearTokens&&Object(Bl.b)(C)&&Object(Bl.c)(C,o,e),!s.useAdditionalDayOfYearTokens&&Object(Bl.a)(C)&&Object(Bl.c)(C,o,e);var D=C[0],S=Rr[D];if(S){var E=S.incompatibleTokens;if(Array.isArray(E)){for(var O=void 0,I=0;I<m.length;I++){var _=m[I].token;if(-1!==E.indexOf(_)||_===D){O=m[I];break}}if(O)throw new RangeError("The format string mustn't contain `".concat(O.fullToken,"` and `").concat(C,"` at the same time"))}else if("*"===S.incompatibleTokens&&m.length)throw new RangeError("The format string mustn't contain `".concat(C,"` and any other token at the same time"));m.push({token:D,fullToken:C});var T=S.parse(a,C,l.match,v);if(!T)return new Date(NaN);h.push({priority:S.priority,subPriority:S.subPriority||0,set:S.set,validate:S.validate,value:T.value,index:h.length}),a=T.rest}else{if(D.match(Ur))throw new RangeError("Format string contains an unescaped latin alphabet character `"+D+"`");if("''"===C?C="'":"'"===D&&(C=jr(C)),0!==a.indexOf(C))return new Date(NaN);a=a.slice(C.length)}}if(a.length>0&&Vr.test(a))return new Date(NaN);var X=h.map(function(e){return e.priority}).sort(function(e,t){return t-e}).filter(function(e,t,n){return n.indexOf(e)===t}).map(function(e){return h.filter(function(t){return t.priority===e}).sort(function(e,t){return t.subPriority-e.subPriority})}).map(function(e){return e[0]}),y=Object(Fl.a)(n);if(isNaN(y))return new Date(NaN);var N=Object(Ul.a)(y,Object(Gl.a)(y)),z={};for(f=0;f<X.length;f++){var M=X[f];if(M.validate&&!M.validate(N,M.value,v))return new Date(NaN);var A=M.set(N,z,M.value,v);A[0]?(N=A[0],jl(z,A[1])):N=A}return N}(e.dateOfBirth,"yyyy-MM-dd",new Date);this.age=function(e,t){Object(ql.a)(2,arguments);var n=Object(Fl.a)(e),i=Object(Fl.a)(t),a=Gr(n,i),o=Math.abs(Yr(n,i));n.setFullYear("1584"),i.setFullYear("1584");var s=Gr(n,i)===-a,l=a*(o-s);return 0===l?0:l}(new Date,t)}}},{key:"episode",set:function(e){var t,n;e&&(this.episodeDetails=e,this.duration=Object(ne.a)(new Date(null===(t=this.episodeDetails)||void 0===t?void 0:t.endDate),new Date(null===(n=this.episodeDetails)||void 0===n?void 0:n.startDate)))}}]),e}()).\u0275fac=function(e){return new(e||qr)},qr.\u0275cmp=I.Lb({type:qr,selectors:[["app-patient-details"]],inputs:{_patientDetails:["patientDetails","_patientDetails"],episode:["episodeDetails","episode"],careplan:"careplan"},decls:26,vars:10,consts:[[1,"container"],["nz-row","",3,"nzGutter"],["nz-col","","nzXs","24","nzSm","12","nzMd","6"],[4,"ngFor","ngForOf"],[4,"ngIf"],[3,"ngSwitch"],[4,"ngSwitchCase"]],template:function(e,t){1&e&&(I.Xb(0,"div",0),I.Xb(1,"div",1),I.Xb(2,"div",2),I.Xb(3,"label"),I.Xc(4,"Patient Name"),I.Wb(),I.Xb(5,"h4"),I.Xb(6,"strong"),I.Xc(7),I.Wb(),I.Wb(),I.Wb(),I.Xb(8,"div",2),I.Xb(9,"label"),I.Xc(10,"Age"),I.Wb(),I.Xb(11,"h4"),I.Xb(12,"strong"),I.Xc(13),I.Wb(),I.Wb(),I.Wb(),I.Xb(14,"div",2),I.Xb(15,"label"),I.Xc(16,"Date of Birth"),I.Wb(),I.Xb(17,"h4"),I.Xb(18,"strong"),I.Xc(19),I.jc(20,"date"),I.Wb(),I.Wb(),I.Wb(),I.Xb(21,"div",2),I.Xb(22,"label"),I.Xc(23,"Patient MRN"),I.Wb(),I.Vc(24,Hr,4,2,"h4",3),I.Vc(25,Zr,4,0,"ng-container",4),I.Wb(),I.Wb(),I.Wb()),2&e&&(I.Db(1),I.rc("nzGutter",I.xc(9,$r)),I.Db(6),I.Yc(null==t.patientDetails?null:t.patientDetails.fullName),I.Db(6),I.Yc(null==t.patientDetails?null:t.patientDetails.age),I.Db(6),I.Yc(I.lc(20,6,null==t.patientDetails?null:t.patientDetails.dateOfBirth,"longDate")),I.Db(5),I.rc("ngForOf",null==t.patientDetails?null:t.patientDetails.externalSources),I.Db(1),I.rc("ngIf",!(null!=t.patientDetails&&null!=t.patientDetails.externalSources&&t.patientDetails.externalSources.length)))},directives:[N.c,N.a,r.p,r.q,r.s,r.t],pipes:[r.e],styles:[".container[_ngcontent-%COMP%]{padding:30px 20px 10px!important}.ant-row[_ngcontent-%COMP%]{margin-bottom:20px!important}label[_ngcontent-%COMP%]{font:normal normal normal 13px/16px Nunito;color:var(--tertiary-color);margin-bottom:5px;display:block}#status[_ngcontent-%COMP%]{padding:0!important}#status[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:90%;border-radius:5px;padding:16px 0 16px 16px}#status[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > h4[_ngcontent-%COMP%]{display:unset}.scheduled-status[_ngcontent-%COMP%]{background:#ffe58f 0 0 no-repeat padding-box}.active-status[_ngcontent-%COMP%]{background:var(--primary-color) 0 0 no-repeat padding-box}.suspended-status[_ngcontent-%COMP%]{background:#ffe07b 0 0 no-repeat padding-box}.completed-status[_ngcontent-%COMP%]{background:#dfdfdf 0 0 no-repeat padding-box}app-icons[_ngcontent-%COMP%]{float:right;margin-right:15px;line-height:2}.no-hover[_ngcontent-%COMP%]{pointer-events:none!important}"]}),qr);function Qr(e,t){if(1&e&&(I.Xb(0,"tr"),I.Xb(1,"td"),I.Xc(2),I.Wb(),I.Xb(3,"td"),I.Xc(4),I.Wb(),I.Xb(5,"td"),I.Xc(6),I.Wb(),I.Xb(7,"td"),I.Xc(8),I.jc(9,"date"),I.Wb(),I.Xb(10,"td"),I.Xc(11),I.Wb(),I.Xb(12,"td"),I.Xc(13,"EMR"),I.Wb(),I.Wb()),2&e){var n=t.$implicit;I.Db(2),I.Yc(n.description),I.Db(2),I.Yc(n.status),I.Db(2),I.Yc(n.code),I.Db(2),I.Yc(n.startDateTime?I.lc(9,5,n.startDateTime,"MM/dd/yyyy"):"N/A"),I.Db(3),I.Yc("CHRONIC"==n.type?"Yes":"No")}}var Jr,ec=((Jr=function e(){c(this,e)}).\u0275fac=function(e){return new(e||Jr)},Jr.\u0275cmp=I.Lb({type:Jr,selectors:[["app-problem-list"]],inputs:{icdCodes:"icdCodes"},decls:23,vars:6,consts:[["nz-typography",""],[1,"no-hover",3,"nzData","nzShowPagination"],["basicTable",""],[4,"ngFor","ngForOf"]],template:function(e,t){if(1&e&&(I.Xb(0,"nz-card"),I.Xb(1,"h3",0),I.Xc(2),I.jc(3,"translate"),I.Wb(),I.Xb(4,"nz-table",1,2),I.Xb(6,"thead"),I.Xb(7,"tr"),I.Xb(8,"th"),I.Xc(9,"Name"),I.Wb(),I.Xb(10,"th"),I.Xc(11,"Status"),I.Wb(),I.Xb(12,"th"),I.Xc(13,"Code"),I.Wb(),I.Xb(14,"th"),I.Xc(15,"Diagnosed"),I.Wb(),I.Xb(16,"th"),I.Xc(17,"Is Chronic"),I.Wb(),I.Xb(18,"th"),I.Xc(19,"Source"),I.Wb(),I.Wb(),I.Wb(),I.Xb(20,"tbody"),I.Vc(21,Qr,14,8,"tr",3),I.Wb(),I.Wb(),I.Wb(),I.Sb(22,"br")),2&e){var n=I.Ic(5);I.Db(2),I.Yc(I.kc(3,4,"COMMON.PROBLEM_LIST")),I.Db(2),I.rc("nzData",t.icdCodes)("nzShowPagination",!1),I.Db(17),I.rc("ngForOf",n.data)}},directives:[z.a,P.a,Va.f,Va.n,Va.o,Va.e,Va.l,Va.i,r.p],pipes:[se.a,r.e],styles:[".no-hover[_ngcontent-%COMP%]{pointer-events:none!important}"]}),Jr),tc=o("cp0P"),nc=o("YRM7");function ic(e,t){1&e&&I.Tb(0)}var ac=function(e){return{address:e}};function oc(e,t){if(1&e&&(I.Xb(0,"tr"),I.Xb(1,"td"),I.Xc(2),I.Wb(),I.Xb(3,"td"),I.Xc(4),I.Wb(),I.Xb(5,"td"),I.Xc(6),I.Wb(),I.Xb(7,"td"),I.Vc(8,ic,1,0,"ng-container",13),I.Wb(),I.Xb(9,"td"),I.Xc(10),I.Wb(),I.Wb()),2&e){var n=t.$implicit;I.ic();var i=I.Ic(39);I.Db(2),I.Yc(null==n?null:n.name),I.Db(2),I.Yc((null==n?null:n.role)||"N/A"),I.Db(2),I.Yc((null==n?null:n.number)||"N/A"),I.Db(2),I.rc("ngTemplateOutlet",i)("ngTemplateOutletContext",I.yc(6,ac,null==n?null:n.address)),I.Db(2),I.Yc((null==n?null:n.note)||"N/A")}}function sc(e,t){if(1&e&&(I.Vb(0),I.Xc(1),I.Ub()),2&e){var n=I.ic().address;I.Db(1),I.Zc(" ",null==n?null:n.line1,",\xa0 ")}}function lc(e,t){if(1&e&&(I.Vb(0),I.Xc(1),I.Ub()),2&e){var n=I.ic().address;I.Db(1),I.Zc(" ",null==n?null:n.line2,",\xa0 ")}}function rc(e,t){if(1&e&&(I.Vb(0),I.Xc(1),I.Ub()),2&e){var n=I.ic().address;I.Db(1),I.Zc(" ",null==n?null:n.city,",\xa0 ")}}function cc(e,t){if(1&e&&(I.Vb(0),I.Xc(1),I.Ub()),2&e){var n=I.ic().address;I.Db(1),I.Zc(" ",null==n?null:n.state,"\xa0 ")}}function dc(e,t){if(1&e&&(I.Vb(0),I.Xc(1),I.Ub()),2&e){var n=I.ic().address;I.Db(1),I.Zc(" -\xa0",null==n?null:n.country," ")}}function uc(e,t){if(1&e&&(I.Vb(0),I.Xc(1),I.Ub()),2&e){var n=I.ic().address;I.Db(1),I.Zc(" -\xa0",null==n?null:n.pin," ")}}function bc(e,t){1&e&&(I.Xb(0,"span"),I.Xc(1," N/A "),I.Wb())}function pc(e,t){if(1&e&&(I.Xb(0,"span",14),I.Vc(1,sc,2,1,"ng-container",15),I.Vc(2,lc,2,1,"ng-container",15),I.Vc(3,rc,2,1,"ng-container",15),I.Vc(4,cc,2,1,"ng-container",15),I.Vc(5,dc,2,1,"ng-container",15),I.Vc(6,uc,2,1,"ng-container",15),I.Wb(),I.Vc(7,bc,2,0,"span",15)),2&e){var n=t.address;I.wc("nzTooltipTitle","",null==n?null:n.line1,"\n                                         ",null==n?null:n.line2," ",null==n?null:n.city,"\n                                         ",null==n?null:n.state," ",null==n?null:n.country,"\n                                         ",null==n?null:n.pin,""),I.Db(1),I.rc("ngIf",null==n?null:n.line1),I.Db(1),I.rc("ngIf",null==n?null:n.line2),I.Db(1),I.rc("ngIf",null==n?null:n.city),I.Db(1),I.rc("ngIf",null==n?null:n.state),I.Db(1),I.rc("ngIf",null==n?null:n.country),I.Db(1),I.rc("ngIf",null==n?null:n.pin),I.Db(1),I.rc("ngIf",!(null!=n&&n.line1||null!=n&&n.line2||null!=n&&n.city||null!=n&&n.state||null!=n&&n.country||null!=n&&n.pin))}}var fc,vc=function(){return["15%","15%","15%","35%","20%"]},hc=((fc=function(e){a(i,e);var n=s(i);function i(e,t){var a;return c(this,i),(a=n.call(this))._patientService=e,a._patientsViewService=t,a.contactDetails=[],a}return u(i,[{key:"ngOnInit",value:function(){this.patientId?this.updateContactDetails():this.addStaff()}},{key:"addStaff",value:function(){var e=this;this.staffs&&this.staffs.forEach(function(t){var n,i,a;e.contactDetails.push({name:t.fullName,role:(e.primaryIds.includes(null==t?void 0:t.id)?"Primary ":"")+(null===(n=null==t?void 0:t.defaultRole)||void 0===n?void 0:n.name),number:null===(i=null==t?void 0:t.preferredNumber)||void 0===i?void 0:i.number,address:null==t?void 0:t.address,note:null===(a=null==t?void 0:t.quickNote)||void 0===a?void 0:a.content})})}},{key:"updateContactDetails",value:function(){var e=this;Object(tc.a)([this._patientService.fetchGuardiansForPatient(this.patientId),this._patientService.fetchEmergencyContactsForPatient(this.patientId)]).subscribe(function(n){e.contactDetails=[],e.addStaff(),e.guardians=n[0],e.guardians.forEach(function(t){e.contactDetails.push({name:t.fullName,role:"Guardian",number:null==t?void 0:t.mobile,address:null==t?void 0:t.address,note:null==t?void 0:t.relationship})}),e.contacts=n[1],e.contacts.forEach(function(t){e.contactDetails.push({name:t.name,role:null==t?void 0:t.type,number:null==t?void 0:t.mobile,address:null==t?void 0:t.address,note:null==t?void 0:t.relationship})}),e.contactDetails=t(e.contactDetails)})}},{key:"addGuardian",value:function(){var e=this;this._patientsViewService.showGuardianModal(this.patientId).afterClose.pipe(Object(E.a)(this.unsubscribed)).subscribe(function(t){t&&e.updateContactDetails()})}},{key:"addContact",value:function(){var e=this;this._patientsViewService.showContactModal(this.patientId).afterClose.pipe(Object(E.a)(this.unsubscribed)).subscribe(function(t){t&&e.updateContactDetails()})}}]),i}(D.a)).\u0275fac=function(e){return new(e||fc)(I.Rb(m.a),I.Rb(nc.a))},fc.\u0275cmp=I.Lb({type:fc,selectors:[["app-staff-details"]],inputs:{staffs:"staffs",primaryIds:"primaryIds",patientId:"patientId"},features:[I.Ab],decls:40,vars:19,consts:[["nz-row","","nzJustify","space-between"],["nz-col",""],["nz-typography",""],["nz-button","","nzType","primary","nz-dropdown","",3,"nzDropdownMenu"],["color","#ffffff","stroke","2px","size","10px","altColor","#ffffff","name","down"],["addNewMenu","nzDropdownMenu"],["nz-menu",""],["nz-menu-item","",3,"click"],["nz-menu-divider","",1,"menu-divider"],[3,"nzData","nzShowPagination","nzPageSize","nzWidthConfig"],["basicTable",""],[4,"ngFor","ngForOf"],["addressTemplate",""],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["nz-tooltip","",3,"nzTooltipTitle"],[4,"ngIf"]],template:function(e,t){if(1&e&&(I.Xb(0,"nz-card"),I.Xb(1,"div",0),I.Xb(2,"div",1),I.Xb(3,"h3",2),I.Xc(4),I.jc(5,"translate"),I.Wb(),I.Wb(),I.Xb(6,"div",1),I.Xb(7,"button",3),I.Xc(8),I.jc(9,"translate"),I.Sb(10,"app-icons",4),I.Wb(),I.Xb(11,"nz-dropdown-menu",null,5),I.Xb(13,"ul",6),I.Xb(14,"li",7),I.ec("click",function(){return t.addGuardian()}),I.Xc(15),I.jc(16,"translate"),I.Wb(),I.Sb(17,"li",8),I.Xb(18,"li",7),I.ec("click",function(){return t.addContact()}),I.Xc(19),I.jc(20,"translate"),I.Wb(),I.Wb(),I.Wb(),I.Wb(),I.Wb(),I.Xb(21,"nz-table",9,10),I.Xb(23,"thead"),I.Xb(24,"tr"),I.Xb(25,"th"),I.Xc(26,"Name"),I.Wb(),I.Xb(27,"th"),I.Xc(28,"Role"),I.Wb(),I.Xb(29,"th"),I.Xc(30,"Contact Number"),I.Wb(),I.Xb(31,"th"),I.Xc(32,"Address"),I.Wb(),I.Xb(33,"th"),I.Xc(34,"Notes"),I.Wb(),I.Wb(),I.Wb(),I.Xb(35,"tbody"),I.Vc(36,oc,11,8,"tr",11),I.Wb(),I.Wb(),I.Wb(),I.Sb(37,"br"),I.Vc(38,pc,8,13,"ng-template",null,12,I.Wc)),2&e){var n=I.Ic(12),i=I.Ic(22);I.Db(4),I.Yc(I.kc(5,10,"COMMON.PATIENT_CARE_TEAM")),I.Db(3),I.rc("nzDropdownMenu",n),I.Db(1),I.Zc(" ",I.kc(9,12,"COMMON.ADD_NEW")," \xa0"),I.Db(7),I.Yc(I.kc(16,14,"PATIENT.ADD_GUARDIAN")),I.Db(4),I.Yc(I.kc(20,16,"COMMON.ADD_CONTACT")),I.Db(2),I.rc("nzData",t.contactDetails)("nzShowPagination",!0)("nzPageSize",5)("nzWidthConfig",I.xc(18,vc)),I.Db(15),I.rc("ngForOf",i.data)}},directives:[z.a,N.c,N.a,P.a,kt.a,wt.a,L.a,X.d,X.b,ve.a,X.e,y.c,y.e,y.d,Va.f,Va.n,Va.o,Va.e,Va.l,Va.i,r.p,r.v,it.d,r.q],pipes:[se.a],styles:[".no-hover[_ngcontent-%COMP%]{pointer-events:none!important}"]}),fc),gc=o("mrSG"),mc=o("/KA4"),Cc=o("vDMs");function Dc(e,t){if(1&e){var n=I.Yb();I.Xb(0,"div",5),I.Xb(1,"button",6),I.ec("click",function(){return I.Lc(n),I.ic().saveGoal()}),I.Xc(2,"Add Patient Goal"),I.Wb(),I.Wb()}}function Sc(e,t){1&e&&(I.Xb(0,"strong"),I.Xc(1," No notes have been added yet. "),I.Wb())}function Ec(e,t){if(1&e&&(I.Xb(0,"nz-timeline-item"),I.Xc(1),I.jc(2,"titlecase"),I.Sb(3,"br"),I.Xb(4,"em",11),I.Xc(5),I.jc(6,"date"),I.Wb(),I.Wb()),2&e){var n=t.$implicit,i=I.ic(2).$implicit;I.Db(1),I.Zc(" ",I.kc(2,4,null==n?null:n.note)," "),I.Db(4),I.bd(" ",(null==n?null:n.note)==(null==i||null==i.notes[0]?null:i.notes[0].note)?"Added ":"Edited ","",null!=n&&n.context?"by "+(null==n?null:n.context):""," on ",I.lc(6,6,null==n?null:n.createdAt,"mediumDate")," ")}}function Oc(e,t){if(1&e&&(I.Vb(0),I.Xb(1,"strong"),I.Xc(2,"Notes:"),I.Wb(),I.Sb(3,"br"),I.Sb(4,"br"),I.Xb(5,"nz-timeline"),I.Vc(6,Ec,7,9,"nz-timeline-item",4),I.Wb(),I.Ub()),2&e){var n=I.ic().$implicit;I.Db(6),I.rc("ngForOf",null==n?null:n.notes)}}function Ic(e,t){if(1&e){var n=I.Yb();I.Vb(0),I.Xb(1,"tr"),I.Xb(2,"td",7),I.ec("nzExpandChange",function(e){I.Lc(n);var i=t.$implicit;return I.ic().onExpandChange(i.id,e)}),I.Wb(),I.Xb(3,"td"),I.Xc(4),I.Wb(),I.Xb(5,"td"),I.Xc(6),I.Wb(),I.Xb(7,"td"),I.Xc(8),I.Wb(),I.Xb(9,"td"),I.Xc(10),I.Wb(),I.Xb(11,"td"),I.Xc(12),I.jc(13,"date"),I.Wb(),I.Xb(14,"td"),I.Xb(15,"app-icons",8),I.ec("click",function(){I.Lc(n);var e=t.$implicit;return I.ic().addResource(e)}),I.Wb(),I.Wb(),I.Wb(),I.Xb(16,"tr",9),I.Vc(17,Sc,2,0,"strong",10),I.Vc(18,Oc,7,1,"ng-container",10),I.Wb(),I.Ub()}if(2&e){var i=t.$implicit,a=I.ic();I.Db(2),I.rc("nzExpand",a.expandSet.has(i.id)),I.Db(2),I.Yc(null==i?null:i.name),I.Db(2),I.Yc((null==i?null:i.resourceType)||"N/A"),I.Db(2),I.Yc((null==i?null:i.contactNumber)||"N/A"),I.Db(2),I.Yc((null==i?null:i.status)||"N/A"),I.Db(2),I.Yc(null!=i&&i.dateRequested?I.lc(13,9,null==i?null:i.dateRequested,"MM/dd/yyyy"):"N/A"),I.Db(4),I.rc("nzExpand",a.expandSet.has(i.id)),I.Db(1),I.rc("ngIf",!(null!=i&&null!=i.notes&&i.notes.length)),I.Db(1),I.rc("ngIf",null==i||null==i.notes?null:i.notes.length)}}var _c,Tc,Xc=((Tc=function(e){a(n,e);var t=s(n);function n(e,i){var a;return c(this,n),(a=t.call(this))._homeCommunityResourceService=e,a._patientViewModalService=i,a.resources=[],a.hideAction=!1,a.expandSet=new Set,a}return u(n,[{key:"ngOnInit",value:function(){this.getData()}},{key:"getData",value:function(){var e=this;this._homeCommunityResourceService.fetchHomeCommunityResources(this.patientId).subscribe(function(t){return e.resources=t})}},{key:"onExpandChange",value:function(e,t){t?this.expandSet.add(e):this.expandSet.delete(e)}},{key:"addResource",value:function(e){var t=this;this._patientViewModalService.showResourceModal(this.patientId,e).afterClose.pipe(Object(E.a)(this.unsubscribed)).subscribe(function(e){t.getData()})}}]),n}(D.a)).\u0275fac=function(e){return new(e||Tc)(I.Rb(Cc.a),I.Rb(nc.a))},Tc.\u0275cmp=I.Lb({type:Tc,selectors:[["app-home-community-resources"]],inputs:{patientId:"patientId",hideAction:"hideAction"},features:[I.Ab],decls:22,vars:4,consts:[["id","actions",4,"ngIf"],[3,"nzData","nzShowPagination"],["basicTable",""],["nzWidth","60px"],[4,"ngFor","ngForOf"],["id","actions"],["nz-button","","nzType","primary",3,"click"],[3,"nzExpand","nzExpandChange"],["name","edit",3,"click"],[3,"nzExpand"],[4,"ngIf"],["nz-typography","","nzType","secondary"]],template:function(e,t){if(1&e&&(I.Xb(0,"div"),I.Vc(1,Dc,3,0,"div",0),I.Xb(2,"nz-table",1,2),I.Xb(4,"thead"),I.Xb(5,"tr"),I.Sb(6,"th",3),I.Xb(7,"th"),I.Xc(8,"Name"),I.Wb(),I.Xb(9,"th"),I.Xc(10,"Resource Type"),I.Wb(),I.Xb(11,"th"),I.Xc(12,"Contact Number"),I.Wb(),I.Xb(13,"th"),I.Xc(14,"Status"),I.Wb(),I.Xb(15,"th"),I.Xc(16,"Date Requested"),I.Wb(),I.Xb(17,"th"),I.Xc(18,"Action"),I.Wb(),I.Wb(),I.Wb(),I.Xb(19,"tbody"),I.Vc(20,Ic,19,12,"ng-container",4),I.Wb(),I.Wb(),I.Wb(),I.Sb(21,"br")),2&e){var n=I.Ic(3);I.Db(1),I.rc("ngIf",!t.hideAction),I.Db(1),I.rc("nzData",t.resources)("nzShowPagination",!1),I.Db(18),I.rc("ngForOf",null==n?null:n.data)}},directives:[r.q,Va.f,Va.n,Va.o,Va.e,Va.l,Va.i,r.p,kt.a,wt.a,L.a,Va.j,ve.a,Va.p,Va.g,ea.a,ea.b,P.a],pipes:[r.e,r.A],styles:[".no-hover[_ngcontent-%COMP%]{pointer-events:none!important}#actions[_ngcontent-%COMP%]{display:block;width:100%;text-align:right}"]}),Object(gc.b)([Object(mc.a)(),Object(gc.c)("design:type",Boolean)],Tc.prototype,"hideAction",void 0),Tc),yc=((_c=function(){function e(){c(this,e)}return u(e,[{key:"ngOnInit",value:function(){}},{key:"addResource",value:function(){var e;null===(e=this.community)||void 0===e||e.addResource()}}]),e}()).\u0275fac=function(e){return new(e||_c)},_c.\u0275cmp=I.Lb({type:_c,selectors:[["app-careplan-home-community"]],viewQuery:function(e,t){var n;1&e&&I.ed(Xc,1),2&e&&I.Hc(n=I.fc())&&(t.community=n.first)},inputs:{patientId:"patientId",blueprintId:"blueprintId"},decls:12,vars:7,consts:[["nz-row","","nzJustify","space-between"],["nz-col",""],["nz-typography",""],["nz-button","","nzType","primary",3,"click"],["hideAction","",3,"patientId"]],template:function(e,t){1&e&&(I.Xb(0,"nz-card"),I.Xb(1,"div",0),I.Xb(2,"div",1),I.Xb(3,"h3",2),I.Xc(4),I.jc(5,"translate"),I.Wb(),I.Wb(),I.Xb(6,"div",1),I.Xb(7,"button",3),I.ec("click",function(){return t.addResource()}),I.Xc(8),I.jc(9,"translate"),I.Wb(),I.Wb(),I.Wb(),I.Sb(10,"app-home-community-resources",4),I.Wb(),I.Sb(11,"br")),2&e&&(I.Db(4),I.Yc(I.kc(5,3,"COMMON.HOME_COMMUNITY_RESOURCE")),I.Db(4),I.Zc(" ",I.kc(9,5,"COMMON.ADD_NEW")," "),I.Db(2),I.rc("patientId",t.patientId))},directives:[z.a,N.c,N.a,P.a,kt.a,wt.a,L.a,Xc],pipes:[se.a],styles:[""]}),_c),Nc=o("lyZ/");function zc(e,t){1&e&&(I.Xb(0,"strong"),I.Xc(1," No notes have been added yet. "),I.Wb())}function Mc(e,t){if(1&e&&(I.Xb(0,"nz-timeline-item"),I.Xc(1),I.jc(2,"titlecase"),I.Sb(3,"br"),I.Xb(4,"em",12),I.Xc(5),I.jc(6,"date"),I.Wb(),I.Wb()),2&e){var n=t.$implicit,i=I.ic(2).$implicit;I.Db(1),I.Zc(" ",I.kc(2,4,null==n?null:n.note)," "),I.Db(4),I.bd(" ",(null==n?null:n.note)==(null==i||null==i.notes[0]?null:i.notes[0].note)?"Added ":"Edited ","",null!=n&&n.context?"by "+(null==n?null:n.context):""," on ",I.lc(6,6,null==n?null:n.createdAt,"mediumDate")," ")}}function Ac(e,t){if(1&e&&(I.Vb(0),I.Xb(1,"strong"),I.Xc(2,"Notes:"),I.Wb(),I.Sb(3,"br"),I.Sb(4,"br"),I.Xb(5,"nz-timeline"),I.Vc(6,Mc,7,9,"nz-timeline-item",7),I.Wb(),I.Ub()),2&e){var n=I.ic().$implicit;I.Db(6),I.rc("ngForOf",null==n?null:n.notes)}}function Pc(e,t){if(1&e){var n=I.Yb();I.Vb(0),I.Xb(1,"tr"),I.Xb(2,"td",8),I.ec("nzExpandChange",function(e){I.Lc(n);var i=t.$implicit;return I.ic().onExpandChange(i.id,e)}),I.Wb(),I.Xb(3,"td"),I.Xc(4),I.Wb(),I.Xb(5,"td"),I.Xc(6),I.Wb(),I.Xb(7,"td"),I.Xc(8),I.jc(9,"date"),I.Wb(),I.Xb(10,"td"),I.Xc(11),I.jc(12,"date"),I.Wb(),I.Xb(13,"td"),I.Xb(14,"app-icons",9),I.ec("click",function(){I.Lc(n);var e=t.$implicit;return I.ic().addHealthScreening(e)}),I.Wb(),I.Wb(),I.Wb(),I.Xb(15,"tr",10),I.Vc(16,zc,2,0,"strong",11),I.Vc(17,Ac,7,1,"ng-container",11),I.Wb(),I.Ub()}if(2&e){var i=t.$implicit,a=I.ic();I.Db(2),I.rc("nzExpand",a.expandSet.has(i.id)),I.Db(2),I.Yc((null==i?null:i.name)||"N/A"),I.Db(2),I.Yc((null==i?null:i.status)||"N/A"),I.Db(2),I.Yc(null!=i&&i.dueDate?I.lc(9,8,null==i?null:i.dueDate,"MM/dd/yyyy"):"N/A"),I.Db(3),I.Yc(null!=i&&i.lastCompleted?I.lc(12,11,null==i?null:i.lastCompleted,"MM/dd/yyyy"):"N/A"),I.Db(4),I.rc("nzExpand",a.expandSet.has(i.id)),I.Db(1),I.rc("ngIf",!(null!=i&&null!=i.notes&&i.notes.length)),I.Db(1),I.rc("ngIf",null==i||null==i.notes?null:i.notes.length)}}var Wc,Rc=((Wc=function(e){a(n,e);var t=s(n);function n(e,i){var a;return c(this,n),(a=t.call(this))._healthScreeningService=e,a._patientViewModalService=i,a.expandSet=new Set,a}return u(n,[{key:"ngOnInit",value:function(){this.getData()}},{key:"getData",value:function(){var e=this;this._healthScreeningService.fetchHealthScreenings(this.patientId,this.blueprintId).subscribe(function(t){return e.healthScreenings=t})}},{key:"onExpandChange",value:function(e,t){t?this.expandSet.add(e):this.expandSet.delete(e)}},{key:"addHealthScreening",value:function(e){var t=this;this._patientViewModalService.showHealthScreeningModal(this.patientId,this.blueprintId,e).afterClose.pipe(Object(E.a)(this.unsubscribed)).subscribe(function(e){t.getData()})}}]),n}(D.a)).\u0275fac=function(e){return new(e||Wc)(I.Rb(Nc.a),I.Rb(nc.a))},Wc.\u0275cmp=I.Lb({type:Wc,selectors:[["app-health-screenings"]],inputs:{patientId:"patientId",blueprintId:"blueprintId"},features:[I.Ab],decls:30,vars:15,consts:[["nz-row","","nzJustify","space-between"],["nz-col",""],["nz-typography",""],["nz-button","","nzType","primary",3,"click"],[3,"nzData","nzPageSize"],["screeningsTable",""],["nzWidth","60px"],[4,"ngFor","ngForOf"],[3,"nzExpand","nzExpandChange"],["name","edit",3,"click"],[3,"nzExpand"],[4,"ngIf"],["nz-typography","","nzType","secondary"]],template:function(e,t){if(1&e&&(I.Xb(0,"nz-card"),I.Xb(1,"div",0),I.Xb(2,"div",1),I.Xb(3,"h3",2),I.Xc(4),I.jc(5,"translate"),I.Wb(),I.Wb(),I.Xb(6,"div",1),I.Xb(7,"button",3),I.ec("click",function(){return t.addHealthScreening()}),I.Xc(8),I.jc(9,"translate"),I.Wb(),I.Wb(),I.Wb(),I.Xb(10,"nz-table",4,5),I.Xb(12,"thead"),I.Xb(13,"tr"),I.Sb(14,"th",6),I.Xb(15,"th"),I.Xc(16),I.jc(17,"translate"),I.Wb(),I.Xb(18,"th"),I.Xc(19),I.jc(20,"translate"),I.Wb(),I.Xb(21,"th"),I.Xc(22,"Due Date"),I.Wb(),I.Xb(23,"th"),I.Xc(24,"Last Completed"),I.Wb(),I.Xb(25,"th"),I.Xc(26,"Action"),I.Wb(),I.Wb(),I.Wb(),I.Xb(27,"tbody"),I.Vc(28,Pc,18,14,"ng-container",7),I.Wb(),I.Wb(),I.Wb(),I.Sb(29,"br")),2&e){var n=I.Ic(11);I.Db(4),I.Yc(I.kc(5,7,"COMMON.HEALTH_SCREENING")),I.Db(4),I.Zc(" ",I.kc(9,9,"COMMON.ADD_NEW")," "),I.Db(2),I.rc("nzData",t.healthScreenings)("nzPageSize",10),I.Db(6),I.Yc(I.kc(17,11,"COMMON.NAME")),I.Db(3),I.Yc(I.kc(20,13,"COMMON.STATUS")),I.Db(9),I.rc("ngForOf",null==n?null:n.data)}},directives:[z.a,N.c,N.a,P.a,kt.a,wt.a,L.a,Va.f,Va.n,Va.o,Va.e,Va.l,Va.i,r.p,Va.j,ve.a,Va.p,Va.g,r.q,ea.a,ea.b],pipes:[se.a,r.e,r.A],styles:[""]}),Wc),kc=o("s3hQ"),wc=o("xn8p");function Lc(e,t){1&e&&(I.Vb(0),I.Xb(1,"nz-tag",12),I.Xc(2,"Low"),I.Wb(),I.Ub())}function xc(e,t){1&e&&(I.Vb(0),I.Xb(1,"nz-tag",13),I.Xc(2,"Medium"),I.Wb(),I.Ub())}function Vc(e,t){1&e&&(I.Vb(0),I.Xb(1,"nz-tag",14),I.Xc(2,"High"),I.Wb(),I.Ub())}function Uc(e,t){1&e&&(I.Vb(0),I.Xb(1,"nz-tag"),I.Xc(2,"New"),I.Wb(),I.Ub())}function Fc(e,t){1&e&&(I.Vb(0),I.Xb(1,"nz-tag",15),I.Xc(2,"Ongoing"),I.Wb(),I.Ub())}function jc(e,t){1&e&&(I.Vb(0),I.Xb(1,"nz-tag",12),I.Xc(2,"Improved"),I.Wb(),I.Ub())}function Yc(e,t){1&e&&(I.Vb(0),I.Xb(1,"nz-tag",14),I.Xc(2,"Worsening"),I.Wb(),I.Ub())}function Gc(e,t){1&e&&(I.Vb(0),I.Xb(1,"nz-tag",12),I.Xc(2,"Resolved"),I.Wb(),I.Ub())}function Bc(e,t){if(1&e&&(I.Xb(0,"nz-tag"),I.Xc(1),I.Wb()),2&e){var n=t.$implicit;I.Db(1),I.Yc(n)}}var Hc,Zc=function(){return[16,24]},qc=((Hc=function(){function e(){c(this,e),this.categoriesMap={}}return u(e,[{key:"ngOnInit",value:function(){var e=this;this.categoriesMap=new Map,f.a.forEach(function(t){return e.categoriesMap[null==t?void 0:t.type]=t.label})}}]),e}()).\u0275fac=function(e){return new(e||Hc)},Hc.\u0275cmp=I.Lb({type:Hc,selectors:[["app-plan-of-care-details-modal"]],inputs:{planOfCare:"planOfCare"},decls:79,vars:46,consts:[[1,"container"],["nz-typography",""],[3,"ngSwitch"],[4,"ngSwitchCase"],["nz-row",""],["nz-typography","","nzType","secondary"],["nz-row","",3,"nzGutter"],["nz-col","","nzSpan","4"],["nz-col","","nzSpan","20"],[4,"ngFor","ngForOf"],["nz-col","","nzSpan","16"],[3,"innerHTML"],["nzColor","#a7c853"],["nzColor","gold"],["nzColor","#c81c1c"],["nzColor","gainsboro"]],template:function(e,t){1&e&&(I.Xb(0,"div",0),I.Xb(1,"h4",1),I.Xc(2),I.Vb(3,2),I.Vc(4,Lc,3,0,"ng-container",3),I.Vc(5,xc,3,0,"ng-container",3),I.Vc(6,Vc,3,0,"ng-container",3),I.Ub(),I.Xc(7," \xa0 "),I.Vb(8,2),I.Vc(9,Uc,3,0,"ng-container",3),I.Vc(10,Fc,3,0,"ng-container",3),I.Vc(11,jc,3,0,"ng-container",3),I.Vc(12,Yc,3,0,"ng-container",3),I.Vc(13,Gc,3,0,"ng-container",3),I.Ub(),I.Wb(),I.Xb(14,"div",4),I.Xb(15,"label",5),I.Xc(16," Created by "),I.Xb(17,"strong"),I.Xc(18),I.jc(19,"titlecase"),I.Wb(),I.Xc(20," at "),I.Xb(21,"strong"),I.Xc(22),I.jc(23,"utcToLocalTime"),I.Wb(),I.Wb(),I.Wb(),I.Xb(24,"div",4),I.Xb(25,"label",5),I.Xc(26," Last updated by "),I.Xb(27,"strong"),I.Xc(28),I.jc(29,"titlecase"),I.Wb(),I.Xc(30," at "),I.Xb(31,"strong"),I.Xc(32),I.jc(33,"utcToLocalTime"),I.Wb(),I.Wb(),I.Wb(),I.Sb(34,"nz-divider"),I.Xb(35,"div",6),I.Xb(36,"div",7),I.Xb(37,"strong",1),I.Xc(38,"Category: "),I.Wb(),I.Wb(),I.Xb(39,"div",8),I.Xc(40),I.Wb(),I.Wb(),I.Xb(41,"div",6),I.Xb(42,"div",7),I.Xb(43,"strong",1),I.Xc(44,"Relative Problems: "),I.Wb(),I.Wb(),I.Xb(45,"div",8),I.Vc(46,Bc,2,1,"nz-tag",9),I.Wb(),I.Wb(),I.Xb(47,"div",6),I.Xb(48,"div",7),I.Xb(49,"strong",1),I.Xc(50,"Prescribed By: "),I.Wb(),I.Wb(),I.Xb(51,"div",8),I.Xc(52),I.jc(53,"titlecase"),I.Wb(),I.Wb(),I.Sb(54,"nz-divider"),I.Xb(55,"div",6),I.Xb(56,"div",7),I.Xb(57,"strong",1),I.Xc(58,"Provider Plan of Care: "),I.Wb(),I.Wb(),I.Xb(59,"div",10),I.Sb(60,"span",11),I.Wb(),I.Wb(),I.Xb(61,"div",6),I.Xb(62,"div",7),I.Xb(63,"strong",1),I.Xc(64,"Nursing Interventions: "),I.Wb(),I.Wb(),I.Xb(65,"div",10),I.Sb(66,"span",11),I.Wb(),I.Wb(),I.Xb(67,"div",6),I.Xb(68,"div",7),I.Xb(69,"strong",1),I.Xc(70,"Nursing Education: "),I.Wb(),I.Wb(),I.Xb(71,"div",10),I.Sb(72,"span",11),I.Wb(),I.Wb(),I.Xb(73,"div",6),I.Xb(74,"div",7),I.Xb(75,"strong",1),I.Xc(76,"Goals: "),I.Wb(),I.Wb(),I.Xb(77,"div",10),I.Sb(78,"span",11),I.Wb(),I.Wb(),I.Wb()),2&e&&(I.Db(2),I.Zc(" ",null==t.planOfCare?null:t.planOfCare.title," \xa0 "),I.Db(1),I.rc("ngSwitch",null==t.planOfCare||null==t.planOfCare.events[(null==t.planOfCare||null==t.planOfCare.events?null:t.planOfCare.events.length)-1]?null:t.planOfCare.events[(null==t.planOfCare||null==t.planOfCare.events?null:t.planOfCare.events.length)-1].priority),I.Db(1),I.rc("ngSwitchCase","LOW"),I.Db(1),I.rc("ngSwitchCase","MEDIUM"),I.Db(1),I.rc("ngSwitchCase","HIGH"),I.Db(2),I.rc("ngSwitch",null==t.planOfCare||null==t.planOfCare.events[(null==t.planOfCare||null==t.planOfCare.events?null:t.planOfCare.events.length)-1]?null:t.planOfCare.events[(null==t.planOfCare||null==t.planOfCare.events?null:t.planOfCare.events.length)-1].outcome),I.Db(1),I.rc("ngSwitchCase","NEW"),I.Db(1),I.rc("ngSwitchCase","ONGOING"),I.Db(1),I.rc("ngSwitchCase","IMPROVED"),I.Db(1),I.rc("ngSwitchCase","WORSENING"),I.Db(1),I.rc("ngSwitchCase","RESOLVED"),I.Db(5),I.Yc(I.kc(19,29,null==t.planOfCare?null:t.planOfCare.staffMap[null==t.planOfCare?null:t.planOfCare.createdBy])),I.Db(4),I.Yc(I.kc(23,31,null==t.planOfCare?null:t.planOfCare.createdAt)),I.Db(6),I.Yc(I.kc(29,33,null==t.planOfCare?null:t.planOfCare.staffMap[null==t.planOfCare?null:t.planOfCare.changedBy])),I.Db(4),I.Yc(I.kc(33,35,null==t.planOfCare?null:t.planOfCare.updatedAt)),I.Db(3),I.rc("nzGutter",I.xc(39,Zc)),I.Db(5),I.Zc(" ",t.categoriesMap[null==t.planOfCare?null:t.planOfCare.category]," "),I.Db(1),I.rc("nzGutter",I.xc(40,Zc)),I.Db(5),I.rc("ngForOf",null==t.planOfCare?null:t.planOfCare.icdCodes),I.Db(1),I.rc("nzGutter",I.xc(41,Zc)),I.Db(5),I.Zc(" ",I.kc(53,37,null==t.planOfCare?null:t.planOfCare.staffMap[null==t.planOfCare?null:t.planOfCare.provider])," "),I.Db(3),I.rc("nzGutter",I.xc(42,Zc)),I.Db(5),I.rc("innerHTML",null==t.planOfCare?null:t.planOfCare.providerPlanOfCare,I.Mc),I.Db(1),I.rc("nzGutter",I.xc(43,Zc)),I.Db(5),I.rc("innerHTML",null==t.planOfCare?null:t.planOfCare.nursingInterventions,I.Mc),I.Db(1),I.rc("nzGutter",I.xc(44,Zc)),I.Db(5),I.rc("innerHTML",null==t.planOfCare?null:t.planOfCare.nursingEducation,I.Mc),I.Db(1),I.rc("nzGutter",I.xc(45,Zc)),I.Db(5),I.rc("innerHTML",null==t.planOfCare?null:t.planOfCare.goals,I.Mc))},directives:[P.a,r.s,r.t,N.c,w.a,N.a,r.p,ye.a],pipes:[r.A,ta.a],styles:[".container[_ngcontent-%COMP%]{padding:0 20px!important;max-height:75vh!important;overflow-y:scroll}"]}),Hc);function $c(e,t){1&e&&(I.Vb(0),I.Xb(1,"nz-tag",20),I.Xc(2,"Low"),I.Wb(),I.Ub())}function Kc(e,t){1&e&&(I.Vb(0),I.Xb(1,"nz-tag",21),I.Xc(2,"Medium"),I.Wb(),I.Ub())}function Qc(e,t){1&e&&(I.Vb(0),I.Xb(1,"nz-tag",22),I.Xc(2,"High"),I.Wb(),I.Ub())}function Jc(e,t){1&e&&(I.Vb(0),I.Xb(1,"nz-tag"),I.Xc(2,"New"),I.Wb(),I.Ub())}function ed(e,t){1&e&&(I.Vb(0),I.Xb(1,"nz-tag",23),I.Xc(2,"Ongoing"),I.Wb(),I.Ub())}function td(e,t){1&e&&(I.Vb(0),I.Xb(1,"nz-tag",20),I.Xc(2,"Improved"),I.Wb(),I.Ub())}function nd(e,t){1&e&&(I.Vb(0),I.Xb(1,"nz-tag",22),I.Xc(2,"Worsening"),I.Wb(),I.Ub())}function id(e,t){1&e&&(I.Vb(0),I.Xb(1,"nz-tag",20),I.Xc(2,"Resolved"),I.Wb(),I.Ub())}function ad(e,t){if(1&e){var n=I.Yb();I.Xb(0,"tr"),I.Xb(1,"td"),I.Xc(2),I.Wb(),I.Xb(3,"td"),I.Vb(4,11),I.Vc(5,$c,3,0,"ng-container",12),I.Vc(6,Kc,3,0,"ng-container",12),I.Vc(7,Qc,3,0,"ng-container",12),I.Ub(),I.Wb(),I.Xb(8,"td"),I.Vb(9,11),I.Vc(10,Jc,3,0,"ng-container",12),I.Vc(11,ed,3,0,"ng-container",12),I.Vc(12,td,3,0,"ng-container",12),I.Vc(13,nd,3,0,"ng-container",12),I.Vc(14,id,3,0,"ng-container",12),I.Ub(),I.Wb(),I.Xb(15,"td"),I.Xb(16,"div",13),I.Xb(17,"div",3),I.Xb(18,"app-icons",14),I.ec("click",function(){I.Lc(n);var e=t.$implicit;return I.ic(2).logEvent(null==e?null:e.id,e)}),I.Wb(),I.Sb(19,"nz-divider",15),I.Wb(),I.Xb(20,"div",3),I.Xb(21,"app-icons",16),I.ec("click",function(){I.Lc(n);var e=t.$implicit;return I.ic(2).viewEventHistory(e)}),I.Wb(),I.Sb(22,"nz-divider",15),I.Wb(),I.Xb(23,"div",3),I.Xb(24,"app-icons",17),I.ec("click",function(){I.Lc(n);var e=t.$implicit;return I.ic(2).edit(null==e?null:e.id)}),I.Wb(),I.Sb(25,"nz-divider",15),I.Wb(),I.Xb(26,"div",3),I.Xb(27,"app-icons",18),I.ec("click",function(){I.Lc(n);var e=t.$implicit;return I.ic(2).show(e)}),I.Wb(),I.Sb(28,"nz-divider",15),I.Wb(),I.Xb(29,"div",3),I.Xb(30,"app-icons",19),I.ec("nzOnConfirm",function(){I.Lc(n);var e=t.$implicit;return I.ic(2).delete(null==e?null:e.id)}),I.Wb(),I.Wb(),I.Wb(),I.Wb(),I.Wb()}if(2&e){var i=t.$implicit;I.Db(2),I.Yc(null==i?null:i.title),I.Db(2),I.rc("ngSwitch",null==i||null==i.events[(null==i||null==i.events?null:i.events.length)-1]?null:i.events[(null==i||null==i.events?null:i.events.length)-1].priority),I.Db(1),I.rc("ngSwitchCase","LOW"),I.Db(1),I.rc("ngSwitchCase","MEDIUM"),I.Db(1),I.rc("ngSwitchCase","HIGH"),I.Db(2),I.rc("ngSwitch",null==i||null==i.events[(null==i||null==i.events?null:i.events.length)-1]?null:i.events[(null==i||null==i.events?null:i.events.length)-1].outcome),I.Db(1),I.rc("ngSwitchCase","NEW"),I.Db(1),I.rc("ngSwitchCase","ONGOING"),I.Db(1),I.rc("ngSwitchCase","IMPROVED"),I.Db(1),I.rc("ngSwitchCase","WORSENING"),I.Db(1),I.rc("ngSwitchCase","RESOLVED")}}function od(e,t){if(1&e&&(I.Xb(0,"nz-table",8,9),I.Xb(2,"thead"),I.Xb(3,"tr"),I.Xb(4,"th"),I.Xc(5,"Name"),I.Wb(),I.Xb(6,"th"),I.Xc(7,"Priority"),I.Wb(),I.Xb(8,"th"),I.Xc(9,"Outcome"),I.Wb(),I.Sb(10,"th"),I.Wb(),I.Wb(),I.Xb(11,"tbody"),I.Vc(12,ad,31,11,"tr",10),I.Wb(),I.Wb()),2&e){var n=I.Ic(1),i=I.ic();I.rc("nzData",i.planOfCares)("nzShowPagination",!1),I.Db(12),I.rc("ngForOf",n.data)}}function sd(e,t){1&e&&(I.Vb(0),I.Xb(1,"strong"),I.Xc(2),I.jc(3,"translate"),I.Wb(),I.Ub()),2&e&&(I.Db(2),I.Zc("",I.kc(3,1,"COMMON.CONDITION_MANAGEMENT")," has not been assigned yet!"))}var ld,rd,cd,dd=((ld=function(){function e(t,n,i,a,o,s){c(this,e),this._router=t,this._activatedRoute=n,this._planOfCareService=i,this._notificationsService=a,this._modalService=o,this._analyticsService=s,this.refresh=new I.n}return u(e,[{key:"ngOnInit",value:function(){this.getPlanOfCare()}},{key:"getPlanOfCare",value:function(){var e=this;this._planOfCareService.fetchPlanOfCare(this.patientId).subscribe(function(t){e.planOfCares=t})}},{key:"viewHistory",value:function(){var e,t;this._router.navigate(["episodes/plan-of-care/details/".concat(this.patientId,"/").concat(null===(e=this.episodeDetails)||void 0===e?void 0:e.id)],{queryParams:{tab:"history",patientName:null===(t=this.patient)||void 0===t?void 0:t.fullName}})}},{key:"addPlanOfCare",value:function(){var e;this._router.navigate(["episodes/plan-of-care/".concat(this.patientId,"/").concat(null===(e=this.episodeDetails)||void 0===e?void 0:e.id)])}},{key:"edit",value:function(e){this._router.navigate(["episodes/plan-of-care/edit/".concat(e,"/").concat(this.patientId,"/").concat(this._activatedRoute.snapshot.params.episodeId)])}},{key:"delete",value:function(e){var t=this;this._planOfCareService.archivePlanOfCare(e).subscribe(function(){t._notificationsService.success("Plan Of Care","Provider's plan of care removed successfully"),t.getPlanOfCare(),t.refresh.emit()})}},{key:"logEvent",value:function(e,t){var n=this;this._modalService.create({nzTitle:"Log Event",nzContent:kc.a,nzComponentParams:{planOfCareId:e,planOfCare:t},nzBodyStyle:{paddingTop:"0"},nzStyle:{top:"20px"},nzWidth:"800px",nzFooter:null,nzMaskClosable:!1,nzKeyboard:!1}).afterClose.subscribe(function(e){e&&(n.getPlanOfCare(),n.refresh.emit())})}},{key:"viewEventHistory",value:function(e){this._modalService.create({nzTitle:"Event History",nzContent:wc.a,nzComponentParams:{events:null==e?void 0:e.events,staffMap:null==e?void 0:e.staffMap},nzBodyStyle:{paddingTop:"0"},nzStyle:{top:"20px"},nzWidth:"800px",nzFooter:null})}},{key:"show",value:function(e){this._modalService.create({nzTitle:"Plan Of Care Details",nzContent:qc,nzComponentParams:{planOfCare:e},nzBodyStyle:{paddingTop:"0"},nzStyle:{top:"20px"},nzWidth:"800px",nzFooter:null})}},{key:"downloadReport",value:function(){var e=new Date,t=e.getUTCMonth()+1,n=e.getUTCFullYear();this._analyticsService.generatePlanOfCareReport(this.episodeDetails.patientId,t<10?n+"-0"+t:n+"-"+t).subscribe(function(e){window.open("https://api.cooeyhealth.com/v1/assets/view/?filename=".concat(e.filename,"&asset-type=REPORTS"),"_blank")})}}]),e}()).\u0275fac=function(e){return new(e||ld)(I.Rb(_.g),I.Rb(_.a),I.Rb(d.a),I.Rb(T.b),I.Rb(He.f),I.Rb(Jo.a))},ld.\u0275cmp=I.Lb({type:ld,selectors:[["app-conditions-management"]],inputs:{episodeDetails:"episodeDetails",patient:"patient",patientId:"patientId"},outputs:{refresh:"refresh"},decls:18,vars:5,consts:[["nz-row","","nzGutter","16"],["nz-col","","nzFlex","1"],["nz-typography",""],["nz-col",""],["nz-button","","id","full-width-button","nzSize","large",3,"click"],["nz-button","","id","full-width-button","nzType","primary","nzSize","large",3,"click"],[3,"nzData","nzShowPagination",4,"ngIf"],[4,"ngIf"],[3,"nzData","nzShowPagination"],["basicTable",""],[4,"ngFor","ngForOf"],[3,"ngSwitch"],[4,"ngSwitchCase"],["nz-row","","nzJustify","end"],["nz-tooltip","","nzTooltipTitle","Log Event","name","plusCircle",3,"click"],["nzType","vertical"],["nz-tooltip","","nzTooltipTitle","View Event History","name","history",3,"click"],["nz-tooltip","","nzTooltipTitle","Edit","name","edit",3,"click"],["nz-tooltip","","nzTooltipTitle","View","name","view",3,"click"],["nz-tooltip","","nzTooltipTitle","Delete","name","delete","nz-popconfirm","","nzPopconfirmTitle","Are you sure you want to delete this plan of care?","nzPopconfirmPlacement","bottom",3,"nzOnConfirm"],["nzColor","#a7c853"],["nzColor","gold"],["nzColor","#c81c1c"],["nzColor","gainsboro"]],template:function(e,t){1&e&&(I.Xb(0,"nz-card"),I.Xb(1,"div",0),I.Xb(2,"div",1),I.Xb(3,"h3",2),I.Xc(4),I.jc(5,"translate"),I.Wb(),I.Wb(),I.Xb(6,"div",3),I.Xb(7,"button",4),I.ec("click",function(){return t.viewHistory()}),I.Xc(8," History "),I.Wb(),I.Wb(),I.Xb(9,"div",3),I.Xb(10,"button",5),I.ec("click",function(){return t.addPlanOfCare()}),I.Xc(11," Add New "),I.Wb(),I.Wb(),I.Xb(12,"div",3),I.Xb(13,"button",5),I.ec("click",function(){return t.downloadReport()}),I.Xc(14," Download as PDF "),I.Wb(),I.Wb(),I.Wb(),I.Vc(15,od,13,3,"nz-table",6),I.Vc(16,sd,4,3,"ng-container",7),I.Wb(),I.Sb(17,"br")),2&e&&(I.Db(4),I.Yc(I.kc(5,3,"COMMON.CONDITION_MANAGEMENT")),I.Db(11),I.rc("ngIf",t.planOfCares&&(null==t.planOfCares?null:t.planOfCares.length)),I.Db(1),I.rc("ngIf",t.planOfCares&&!(null!=t.planOfCares&&t.planOfCares.length)))},directives:[z.a,N.c,N.a,P.a,kt.a,wt.a,L.a,r.q,Va.f,Va.n,Va.o,Va.e,Va.l,Va.i,r.p,r.s,r.t,ve.a,it.d,w.a,ma.a,ye.a],pipes:[se.a],styles:[".no-hover[_ngcontent-%COMP%]{pointer-events:none!important}[_nghost-%COMP%]     .ant-table-row:hover{box-shadow:none!important}"]}),ld),ud=function e(){c(this,e),this.startDate=new Date,this.status=bd.PENDING},bd=function(e){return e.MET="MET",e.UNMET="UNMET",e.PENDING="PENDING",e}({}),pd=function e(){c(this,e)},fd=((rd=function(){function e(t){c(this,e),this._http=t,this.rootURL=Pt.g.url+"/v3/patient-goals"}return u(e,[{key:"savePatientGoal",value:function(e){return this._http.post("".concat(this.rootURL),JSON.stringify(e))}},{key:"updatePatientGoal",value:function(e){return this._http.put("".concat(this.rootURL),JSON.stringify(e))}},{key:"fetchPatientGoals",value:function(e,t){return this._http.get("".concat(this.rootURL,"/").concat(e,"/").concat(t))}}]),e}()).\u0275fac=function(e){return new(e||rd)(I.bc($n.c))},rd.\u0275prov=I.Nb({token:rd,factory:rd.\u0275fac,providedIn:"root"}),rd),vd=o("r0o6"),hd=function(){return{minRows:6,maxRows:9}},gd=((cd=function(){function e(t,n,i,a){var o=this;c(this,e),this._datePipe=t,this._modalRef=n,this._patientGoalsService=i,this._notificationsService=a,this.disabledDate=function(e){return Object(ne.a)(e,o.startDate)<0},this.newNote=new pd}return u(e,[{key:"goal",set:function(e){if(!e)return this.patientGoal=new ud,void(this.startDate=new Date);this.patientGoal=JSON.parse(JSON.stringify(e)),this.startDate=JSON.parse(JSON.stringify(null==e?void 0:e.startDate)),this.targetEndDate=JSON.parse(JSON.stringify(null==e?void 0:e.targetEndDate))}},{key:"ngOnInit",value:function(){var e,t,n,i;this.newNote.note=null===(t=null===(e=this.patientGoal)||void 0===e?void 0:e.notes)||void 0===t?void 0:t[(null===(i=null===(n=this.patientGoal)||void 0===n?void 0:n.notes)||void 0===i?void 0:i.length)-1].note}},{key:"save",value:function(){var e,t,n,i,a,o,s,l,r,c,d=this;(null===(t=null===(e=this.patientGoal)||void 0===e?void 0:e.patientId)||void 0===t?void 0:t.length)||(this.patientGoal.patientId=this.patientId),(null===(i=null===(n=this.patientGoal)||void 0===n?void 0:n.blueprintId)||void 0===i?void 0:i.length)||(this.patientGoal.blueprintId=this.blueprintId),this.newNote&&(null===(o=null===(a=this.newNote)||void 0===a?void 0:a.note)||void 0===o?void 0:o.length)&&((null===(l=null===(s=this.patientGoal)||void 0===s?void 0:s.notes)||void 0===l?void 0:l.length)||(this.patientGoal.notes=[]),this.newNote.createdBy=localStorage.getItem("loggedInUser"),this.patientGoal.notes.push(this.newNote)),(null===(c=null===(r=this.patientGoal)||void 0===r?void 0:r.id)||void 0===c?void 0:c.length)||(this.patientGoal.startDate=this._datePipe.transform(this.startDate,"yyyy-MM-dd")),this.targetEndDate&&(this.patientGoal.targetEndDate=this._datePipe.transform(this.targetEndDate,"yyyy-MM-dd"));var u=this._patientGoalsService.savePatientGoal(this.patientGoal),b=this._patientGoalsService.updatePatientGoal(this.patientGoal);Object(vd.a)(function(){var e,t;return!!(null===(t=null===(e=d.patientGoal)||void 0===e?void 0:e.id)||void 0===t?void 0:t.length)},b,u).subscribe(function(e){d._notificationsService.success("Patient Goals","Goal saved successfully!"),d._modalRef.close(e)})}}]),e}()).\u0275fac=function(e){return new(e||cd)(I.Rb(r.e),I.Rb(He.e),I.Rb(fd),I.Rb(T.b))},cd.\u0275cmp=I.Lb({type:cd,selectors:[["app-patient-goals-form"]],inputs:{goal:"goal",patientId:"patientId",blueprintId:"blueprintId"},features:[I.Cb([r.e])],decls:42,vars:17,consts:[[1,"container"],["nz-typography",""],["nz-row","","nzGutter","16"],["nz-col","","nzSpan","24"],["nz-typography","","nzType","danger"],["nz-input","","placeholder","Enter goal name",3,"ngModel","ngModelChange"],["nz-col","","nzSpan","8"],[3,"ngModel","nzDisabled","ngModelChange"],[3,"ngModel","nzDisabledDate","nzDisabled","ngModelChange"],[3,"nzValue","nzLabel"],["nz-input","","placeholder","Enter note...",3,"nzAutosize","ngModel","ngModelChange"],["id","actions"],["nz-button","","nzType","primary",3,"click"]],template:function(e,t){1&e&&(I.Xb(0,"div",0),I.Xb(1,"h3",1),I.Xc(2,"Patient Goal"),I.Wb(),I.Sb(3,"nz-divider"),I.Xb(4,"div",2),I.Xb(5,"div",3),I.Xb(6,"span",4),I.Xc(7,"* "),I.Wb(),I.Xb(8,"strong"),I.Xc(9,"Patient Centered Goal: "),I.Wb(),I.Xb(10,"input",5),I.ec("ngModelChange",function(e){return t.patientGoal.name=e}),I.Wb(),I.Wb(),I.Wb(),I.Sb(11,"br"),I.Xb(12,"div",2),I.Xb(13,"div",6),I.Xb(14,"span",4),I.Xc(15,"* "),I.Wb(),I.Xb(16,"strong"),I.Xc(17,"Start Date: "),I.Wb(),I.Xb(18,"nz-date-picker",7),I.ec("ngModelChange",function(e){return t.startDate=e})("ngModelChange",function(){return t.targetEndDate=null}),I.Wb(),I.Wb(),I.Xb(19,"div",6),I.Xb(20,"strong"),I.Xc(21,"Target End Date: "),I.Wb(),I.Xb(22,"nz-date-picker",8),I.ec("ngModelChange",function(e){return t.targetEndDate=e}),I.Wb(),I.Wb(),I.Xb(23,"div",6),I.Xb(24,"span",4),I.Xc(25,"* "),I.Wb(),I.Xb(26,"strong"),I.Xc(27,"Status: "),I.Wb(),I.Xb(28,"nz-select",7),I.ec("ngModelChange",function(e){return t.patientGoal.status=e}),I.Sb(29,"nz-option",9),I.Sb(30,"nz-option",9),I.Sb(31,"nz-option",9),I.Wb(),I.Wb(),I.Wb(),I.Sb(32,"br"),I.Xb(33,"div",2),I.Xb(34,"div",3),I.Xb(35,"strong"),I.Xc(36,"Progress Notes: "),I.Wb(),I.Xb(37,"textarea",10),I.ec("ngModelChange",function(e){return t.newNote.note=e}),I.Wb(),I.Wb(),I.Wb(),I.Sb(38,"br"),I.Xb(39,"div",11),I.Xb(40,"button",12),I.ec("click",function(){return t.save()}),I.Xc(41,"Save"),I.Wb(),I.Wb(),I.Wb()),2&e&&(I.Db(10),I.rc("ngModel",t.patientGoal.name),I.Db(8),I.rc("ngModel",t.startDate)("nzDisabled",!(null==t.patientGoal||null==t.patientGoal.id||!t.patientGoal.id.length)),I.Db(4),I.rc("ngModel",t.targetEndDate)("nzDisabledDate",t.disabledDate)("nzDisabled","MET"===(null==t.patientGoal?null:t.patientGoal.status)),I.Db(6),I.rc("ngModel",t.patientGoal.status)("nzDisabled","MET"===(null==t.patientGoal?null:t.patientGoal.status)),I.Db(1),I.rc("nzValue","PENDING")("nzLabel","Pending"),I.Db(1),I.rc("nzValue","UNMET")("nzLabel","Unmet"),I.Db(1),I.rc("nzValue","MET")("nzLabel","Met"),I.Db(6),I.rc("nzAutosize",I.xc(16,hd))("ngModel",t.newNote.note))},directives:[P.a,w.a,N.c,N.a,W.b,v.d,v.u,v.x,oe.a,R.d,R.a,W.a,kt.a,wt.a,L.a],styles:["h3[_ngcontent-%COMP%]{font-size:18px}#actions[_ngcontent-%COMP%]{display:block;width:100%;text-align:right}"]}),cd);function md(e,t){if(1&e){var n=I.Yb();I.Xb(0,"div",5),I.Xb(1,"button",6),I.ec("click",function(){return I.Lc(n),I.ic().saveGoal()}),I.Xc(2,"Add Patient Goal"),I.Wb(),I.Wb()}}function Cd(e,t){1&e&&(I.Xb(0,"nz-tag",12),I.Xc(1,"Pending"),I.Wb()),2&e&&I.rc("nzColor","blue")}function Dd(e,t){1&e&&(I.Xb(0,"nz-tag",12),I.Xc(1,"Unmet"),I.Wb()),2&e&&I.rc("nzColor","orange")}function Sd(e,t){1&e&&(I.Xb(0,"nz-tag",12),I.Xc(1,"Met"),I.Wb()),2&e&&I.rc("nzColor","green")}function Ed(e,t){1&e&&(I.Xb(0,"strong"),I.Xc(1," No notes have been added yet. "),I.Wb())}function Od(e,t){if(1&e&&(I.Xb(0,"nz-timeline-item"),I.Xc(1),I.jc(2,"titlecase"),I.Sb(3,"br"),I.Xb(4,"em",13),I.Xc(5),I.jc(6,"date"),I.Wb(),I.Wb()),2&e){var n=t.$implicit,i=I.ic(2).$implicit;I.Db(1),I.Zc(" ",I.kc(2,4,null==n?null:n.note)," "),I.Db(4),I.bd(" ",(null==n?null:n.note)==(null==i||null==i.notes[0]?null:i.notes[0].note)?"Added ":"Edited ","",null!=n&&n.context?"by "+(null==n?null:n.context):""," on ",I.lc(6,6,null==n?null:n.createdAt,"mediumDate")," ")}}function Id(e,t){if(1&e&&(I.Vb(0),I.Xb(1,"strong"),I.Xc(2,"Notes:"),I.Wb(),I.Sb(3,"br"),I.Sb(4,"br"),I.Xb(5,"nz-timeline"),I.Vc(6,Od,7,9,"nz-timeline-item",4),I.Wb(),I.Ub()),2&e){var n=I.ic().$implicit;I.Db(6),I.rc("ngForOf",null==n?null:n.notes)}}function _d(e,t){if(1&e){var n=I.Yb();I.Vb(0),I.Xb(1,"tr"),I.Xb(2,"td",7),I.ec("nzExpandChange",function(e){I.Lc(n);var i=t.$implicit;return I.ic().onExpandChange(i.id,e)}),I.Wb(),I.Xb(3,"td"),I.Xc(4),I.Wb(),I.Xb(5,"td"),I.Xc(6),I.jc(7,"date"),I.Wb(),I.Xb(8,"td"),I.Xc(9),I.jc(10,"date"),I.Wb(),I.Xb(11,"td"),I.Xc(12),I.jc(13,"date"),I.Wb(),I.Xb(14,"td"),I.Vc(15,Cd,2,1,"nz-tag",8),I.Vc(16,Dd,2,1,"nz-tag",8),I.Vc(17,Sd,2,1,"nz-tag",8),I.Wb(),I.Xb(18,"td"),I.Xb(19,"app-icons",9),I.ec("click",function(){I.Lc(n);var e=t.$implicit;return I.ic().saveGoal(e)}),I.Wb(),I.Wb(),I.Wb(),I.Xb(20,"tr",10),I.Vc(21,Ed,2,0,"strong",11),I.Vc(22,Id,7,1,"ng-container",11),I.Wb(),I.Ub()}if(2&e){var i=t.$implicit,a=I.ic();I.Db(2),I.rc("nzExpand",a.expandSet.has(i.id)),I.Db(2),I.Yc(i.name),I.Db(2),I.Yc(I.lc(7,11,i.startDate,"mediumDate")||"N/A"),I.Db(3),I.Yc(I.lc(10,14,i.targetEndDate,"mediumDate")||"N/A"),I.Db(3),I.Yc(I.lc(13,17,i.endDate,"mediumDate")||"N/A"),I.Db(3),I.rc("ngIf","PENDING"===i.status),I.Db(1),I.rc("ngIf","UNMET"===i.status),I.Db(1),I.rc("ngIf","MET"===i.status),I.Db(3),I.rc("nzExpand",a.expandSet.has(i.id)),I.Db(1),I.rc("ngIf",!(null!=i&&null!=i.notes&&i.notes.length)),I.Db(1),I.rc("ngIf",null==i||null==i.notes?null:i.notes.length)}}var Td,Xd,yd=((Xd=function(){function e(t,n,i){c(this,e),this._patientGoalsService=t,this._activatedRoute=n,this._modalService=i,this.expandSet=new Set}return u(e,[{key:"ngOnInit",value:function(){this.getAllGoals()}},{key:"getAllGoals",value:function(){var e=this;this._patientGoalsService.fetchPatientGoals(this.patientId,this.blueprintId).subscribe(function(t){e.patientGoals=t})}},{key:"onExpandChange",value:function(e,t){t?this.expandSet.add(e):this.expandSet.delete(e)}},{key:"saveGoal",value:function(e){var t=this;this._modalService.create({nzContent:gd,nzComponentParams:{goal:e,patientId:this.patientId,blueprintId:this.blueprintId},nzWidth:700,nzFooter:null}).afterClose.subscribe(function(e){(null==e?void 0:e.id)&&t.getAllGoals()})}}]),e}()).\u0275fac=function(e){return new(e||Xd)(I.Rb(fd),I.Rb(_.a),I.Rb(He.f))},Xd.\u0275cmp=I.Lb({type:Xd,selectors:[["app-patient-goals"]],inputs:{patientId:"patientId",blueprintId:"blueprintId",hideAction:"hideAction"},decls:21,vars:3,consts:[["id","actions",4,"ngIf"],["nzTableLayout","fixed",3,"nzData"],["patientGoalsTable",""],["nzWidth","60px"],[4,"ngFor","ngForOf"],["id","actions"],["nz-button","","nzType","primary",3,"click"],[3,"nzExpand","nzExpandChange"],[3,"nzColor",4,"ngIf"],["name","edit",3,"click"],[3,"nzExpand"],[4,"ngIf"],[3,"nzColor"],["nz-typography","","nzType","secondary"]],template:function(e,t){if(1&e&&(I.Xb(0,"div"),I.Vc(1,md,3,0,"div",0),I.Xb(2,"nz-table",1,2),I.Xb(4,"thead"),I.Xb(5,"tr"),I.Sb(6,"th",3),I.Xb(7,"th"),I.Xc(8,"Name"),I.Wb(),I.Xb(9,"th"),I.Xc(10,"Start Date"),I.Wb(),I.Xb(11,"th"),I.Xc(12,"Target Date"),I.Wb(),I.Xb(13,"th"),I.Xc(14,"End Date"),I.Wb(),I.Xb(15,"th"),I.Xc(16,"Status"),I.Wb(),I.Xb(17,"th"),I.Xc(18,"Actions"),I.Wb(),I.Wb(),I.Wb(),I.Xb(19,"tbody"),I.Vc(20,_d,23,20,"ng-container",4),I.Wb(),I.Wb(),I.Wb()),2&e){var n=I.Ic(3);I.Db(1),I.rc("ngIf",!t.hideAction),I.Db(1),I.rc("nzData",t.patientGoals),I.Db(18),I.rc("ngForOf",null==n?null:n.data)}},directives:[r.q,Va.f,Va.n,Va.o,Va.e,Va.l,Va.i,r.p,kt.a,wt.a,L.a,Va.j,ve.a,Va.p,Va.g,ye.a,ea.a,ea.b,P.a],pipes:[r.e,r.A],styles:["#actions[_ngcontent-%COMP%]{display:block;width:100%;text-align:right}"]}),Object(gc.b)([Object(mc.a)(),Object(gc.c)("design:type",Boolean)],Xd.prototype,"hideAction",void 0),Xd),Nd=((Td=function(){function e(){c(this,e)}return u(e,[{key:"ngOnInit",value:function(){}},{key:"addGoal",value:function(){var e;null===(e=this.patientGoals)||void 0===e||e.saveGoal()}}]),e}()).\u0275fac=function(e){return new(e||Td)},Td.\u0275cmp=I.Lb({type:Td,selectors:[["app-careplan-patient-goals"]],viewQuery:function(e,t){var n;1&e&&I.ed(yd,1),2&e&&I.Hc(n=I.fc())&&(t.patientGoals=n.first)},inputs:{patientId:"patientId",blueprintId:"blueprintId"},decls:12,vars:8,consts:[["nz-row","","nzJustify","space-between"],["nz-col",""],["nz-typography",""],["nz-button","","nzType","primary",3,"click"],["hideAction","",3,"patientId","blueprintId"]],template:function(e,t){1&e&&(I.Xb(0,"nz-card"),I.Xb(1,"div",0),I.Xb(2,"div",1),I.Xb(3,"h3",2),I.Xc(4),I.jc(5,"translate"),I.Wb(),I.Wb(),I.Xb(6,"div",1),I.Xb(7,"button",3),I.ec("click",function(){return t.addGoal()}),I.Xc(8),I.jc(9,"translate"),I.Wb(),I.Wb(),I.Wb(),I.Sb(10,"app-patient-goals",4),I.Wb(),I.Sb(11,"br")),2&e&&(I.Db(4),I.Yc(I.kc(5,4,"COMMON.PATIENT_GOALS")),I.Db(4),I.Zc(" ",I.kc(9,6,"COMMON.ADD_NEW")," "),I.Db(2),I.rc("patientId",t.patientId)("blueprintId",t.blueprintId))},directives:[z.a,N.c,N.a,P.a,kt.a,wt.a,L.a,yd],pipes:[se.a],styles:[""]}),Td),zd=o("KAwd");function Md(e,t){if(1&e&&(I.Xb(0,"tr",6),I.Xb(1,"td",7),I.Xc(2),I.Wb(),I.Xb(3,"td"),I.Xc(4),I.jc(5,"titlecase"),I.Wb(),I.Xb(6,"td"),I.Xc(7),I.Wb(),I.Xb(8,"td"),I.Xc(9),I.Wb(),I.Xb(10,"td"),I.Xc(11),I.jc(12,"date"),I.Wb(),I.Xb(13,"td"),I.Xc(14),I.Wb(),I.Wb()),2&e){var n=t.$implicit;I.tc("routerLink","/form/evalforms/view/",null==n?null:n._id,""),I.Db(1),I.sc("nzTooltipTitle",null==n||null==n.schema?null:n.schema.description),I.Db(1),I.Zc(" ",null==n||null==n.schema?null:n.schema.title," "),I.Db(2),I.Yc("SCORED_ASSESSMENT"===(null==n||null==n.schema?null:n.schema.type)?"Scored Assessment":I.kc(5,8,null==n||null==n.schema?null:n.schema.type)),I.Db(3),I.Yc("SCORED_ASSESSMENT"===(null==n||null==n.schema?null:n.schema.type)?null==n?null:n.evaluatedScore:"NA"),I.Db(2),I.Yc("SCORED_ASSESSMENT"===(null==n||null==n.schema?null:n.schema.type)?null==n?null:n.identifiedRisk:"NA"),I.Db(2),I.Yc(I.lc(12,10,null==n?null:n.assessedOn,"medium")),I.Db(3),I.Yc((null==n||null==n.careplan?null:n.careplan.name)||"N/A")}}var Ad,Pd=((Ad=function(){function e(t){c(this,e),this._formsService=t}return u(e,[{key:"ngOnInit",value:function(){this.getAssessedFormsForPatients()}},{key:"getAssessedFormsForPatients",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._formsService.getPatientEvalForms(this.patientId,t,10).subscribe(function(t){var n,i,a,o;e.forms=null===(i=null===(n=null==t?void 0:t.data)||void 0===n?void 0:n.answers)||void 0===i?void 0:i.obj,e.count=null===(o=null===(a=null==t?void 0:t.data)||void 0===a?void 0:a.answers)||void 0===o?void 0:o.total})}}]),e}()).\u0275fac=function(e){return new(e||Ad)(I.Rb(el.a))},Ad.\u0275cmp=I.Lb({type:Ad,selectors:[["app-poc-assessed-forms"]],inputs:{patientId:"patientId"},decls:31,vars:24,consts:[["nz-row","","nzJustify","space-between"],["nz-col",""],["nz-typography",""],[3,"nzData","nzTotal"],["formsTable",""],[3,"routerLink",4,"ngFor","ngForOf"],[3,"routerLink"],["nz-tooltip","",3,"nzTooltipTitle"]],template:function(e,t){if(1&e&&(I.Xb(0,"nz-card"),I.Xb(1,"div",0),I.Xb(2,"div",1),I.Xb(3,"h3",2),I.Xc(4),I.jc(5,"translate"),I.Wb(),I.Wb(),I.Wb(),I.Xb(6,"nz-table",3,4),I.Xb(8,"thead"),I.Xb(9,"tr"),I.Xb(10,"th"),I.Xc(11),I.jc(12,"translate"),I.Wb(),I.Xb(13,"th"),I.Xc(14),I.jc(15,"translate"),I.Wb(),I.Xb(16,"th"),I.Xc(17),I.jc(18,"translate"),I.Wb(),I.Xb(19,"th"),I.Xc(20),I.jc(21,"translate"),I.Wb(),I.Xb(22,"th"),I.Xc(23),I.jc(24,"translate"),I.Wb(),I.Xb(25,"th"),I.Xc(26),I.jc(27,"translate"),I.Wb(),I.Wb(),I.Wb(),I.Xb(28,"tbody"),I.Vc(29,Md,15,13,"tr",5),I.Wb(),I.Wb(),I.Wb(),I.Sb(30,"br")),2&e){var n=I.Ic(7);I.Db(4),I.Yc(I.kc(5,10,"COMMON.CARE_PLAN_ASSESSMENT")),I.Db(2),I.rc("nzData",t.forms)("nzTotal",t.count),I.Db(5),I.Yc(I.kc(12,12,"COMMON.NAME")),I.Db(3),I.Yc(I.kc(15,14,"PURPOSE")),I.Db(3),I.Yc(I.kc(18,16,"SCORE")),I.Db(3),I.Yc(I.kc(21,18,"RISK_CATEGORY")),I.Db(3),I.Yc(I.kc(24,20,"COMMON.DATE")),I.Db(3),I.Yc(I.kc(27,22,"CARE_PLAN")),I.Db(3),I.rc("ngForOf",null==n?null:n.data)}},directives:[z.a,N.c,N.a,P.a,Va.f,Va.n,Va.o,Va.e,Va.l,Va.i,r.p,_.h,it.d],pipes:[se.a,r.A,r.e],styles:[""]}),Ad);function Wd(e,t){if(1&e&&(I.Xb(0,"tr",6),I.Xb(1,"td",7),I.Xc(2),I.Wb(),I.Xb(3,"td"),I.Xc(4),I.jc(5,"titlecase"),I.Wb(),I.Xb(6,"td"),I.Xc(7),I.Wb(),I.Xb(8,"td"),I.Xc(9),I.Wb(),I.Xb(10,"td"),I.Xc(11),I.jc(12,"date"),I.Wb(),I.Wb()),2&e){var n=t.$implicit;I.tc("routerLink","/form/directevalforms/view/",null==n?null:n._id,""),I.Db(1),I.sc("nzTooltipTitle",null==n||null==n.schema?null:n.schema.description),I.Db(1),I.Zc(" ",null==n||null==n.schema?null:n.schema.title," "),I.Db(2),I.Yc("SCORED_ASSESSMENT"===(null==n||null==n.schema?null:n.schema.type)?"Scored Assessment":I.kc(5,7,null==n||null==n.schema?null:n.schema.type)),I.Db(3),I.Yc("SCORED_ASSESSMENT"===(null==n||null==n.schema?null:n.schema.type)?null==n?null:n.evaluatedScore:"NA"),I.Db(2),I.Yc("SCORED_ASSESSMENT"===(null==n||null==n.schema?null:n.schema.type)?null==n?null:n.identifiedRisk:"NA"),I.Db(2),I.Yc(I.lc(12,9,null==n?null:n.assessedOn,"medium"))}}var Rd,kd=((Rd=function(){function e(t){c(this,e),this._formsService=t}return u(e,[{key:"ngOnInit",value:function(){this.getDirectFormsForPatients()}},{key:"getDirectFormsForPatients",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._formsService.getPatientDirectForms(this.patientId,t,10).subscribe(function(t){var n,i,a,o;e.forms=null===(i=null===(n=null==t?void 0:t.data)||void 0===n?void 0:n.answers)||void 0===i?void 0:i.obj,e.count=null===(o=null===(a=null==t?void 0:t.data)||void 0===a?void 0:a.answers)||void 0===o?void 0:o.total})}}]),e}()).\u0275fac=function(e){return new(e||Rd)(I.Rb(el.a))},Rd.\u0275cmp=I.Lb({type:Rd,selectors:[["app-episode-direct-forms"]],inputs:{patientId:"patientId"},decls:28,vars:21,consts:[["nz-row","","nzJustify","space-between"],["nz-col",""],["nz-typography",""],[3,"nzData","nzTotal"],["formsTable",""],[3,"routerLink",4,"ngFor","ngForOf"],[3,"routerLink"],["nz-tooltip","",3,"nzTooltipTitle"]],template:function(e,t){if(1&e&&(I.Xb(0,"nz-card"),I.Xb(1,"div",0),I.Xb(2,"div",1),I.Xb(3,"h3",2),I.Xc(4),I.jc(5,"translate"),I.Wb(),I.Wb(),I.Wb(),I.Xb(6,"nz-table",3,4),I.Xb(8,"thead"),I.Xb(9,"tr"),I.Xb(10,"th"),I.Xc(11),I.jc(12,"translate"),I.Wb(),I.Xb(13,"th"),I.Xc(14),I.jc(15,"translate"),I.Wb(),I.Xb(16,"th"),I.Xc(17),I.jc(18,"translate"),I.Wb(),I.Xb(19,"th"),I.Xc(20),I.jc(21,"translate"),I.Wb(),I.Xb(22,"th"),I.Xc(23),I.jc(24,"translate"),I.Wb(),I.Wb(),I.Wb(),I.Xb(25,"tbody"),I.Vc(26,Wd,13,12,"tr",5),I.Wb(),I.Wb(),I.Wb(),I.Sb(27,"br")),2&e){var n=I.Ic(7);I.Db(4),I.Yc(I.kc(5,9,"COMMON.CARE_PLAN_ASSESSMENT")),I.Db(2),I.rc("nzData",t.forms)("nzTotal",t.count),I.Db(5),I.Yc(I.kc(12,11,"COMMON.NAME")),I.Db(3),I.Yc(I.kc(15,13,"PURPOSE")),I.Db(3),I.Yc(I.kc(18,15,"SCORE")),I.Db(3),I.Yc(I.kc(21,17,"RISK_CATEGORY")),I.Db(3),I.Yc(I.kc(24,19,"COMMON.DATE")),I.Db(3),I.rc("ngForOf",null==n?null:n.data)}},directives:[z.a,N.c,N.a,P.a,Va.f,Va.n,Va.o,Va.e,Va.l,Va.i,r.p,_.h,it.d],pipes:[se.a,r.A,r.e],styles:[""]}),Rd);function wd(e,t){if(1&e&&I.Sb(0,"app-poc-assessed-forms",20),2&e){var n=I.ic(2);I.rc("patientId",n.patientId)("blueprintId",n.blueprintId)}}function Ld(e,t){if(1&e&&I.Sb(0,"app-episode-direct-forms",20),2&e){var n=I.ic(2);I.rc("patientId",n.patientId)("blueprintId",n.blueprintId)}}function xd(e,t){1&e&&(I.Xb(0,"button",21),I.Sb(1,"app-icons",22),I.Wb())}var Vd=function(){return[24,24]};function Ud(e,t){if(1&e){var n=I.Yb();I.Vb(0),I.Xb(1,"div",2),I.Sb(2,"app-patient-details",3),I.Xb(3,"div",4),I.Xb(4,"div",5),I.Xb(5,"span",6),I.Xc(6),I.jc(7,"translate"),I.Wb(),I.Wb(),I.Xb(8,"div",5),I.Xb(9,"span",7),I.ec("click",function(){return I.Lc(n),I.ic().scrollTo("staff-details")}),I.Xc(10),I.jc(11,"translate"),I.Wb(),I.Wb(),I.Xb(12,"div",8),I.Xb(13,"span",7),I.ec("click",function(){return I.Lc(n),I.ic().scrollTo("home-community")}),I.Xc(14),I.jc(15,"translate"),I.Wb(),I.Wb(),I.Xb(16,"div",8),I.Xb(17,"span",7),I.ec("click",function(){return I.Lc(n),I.ic().scrollTo("patient-forms")}),I.Xc(18),I.jc(19,"translate"),I.Wb(),I.Wb(),I.Xb(20,"div",8),I.Xb(21,"span",7),I.ec("click",function(){return I.Lc(n),I.ic().scrollTo("health-screening")}),I.Xc(22),I.jc(23,"translate"),I.Wb(),I.Wb(),I.Xb(24,"div",8),I.Xb(25,"span",7),I.ec("click",function(){return I.Lc(n),I.ic().scrollTo("poc")}),I.Xc(26),I.jc(27,"translate"),I.Wb(),I.Wb(),I.Xb(28,"div",9),I.Xb(29,"span",7),I.ec("click",function(){return I.Lc(n),I.ic().scrollTo("goals")}),I.Xc(30),I.jc(31,"translate"),I.Wb(),I.Wb(),I.Wb(),I.Sb(32,"app-problem-list",10),I.Sb(33,"app-staff-details",11),I.Sb(34,"app-careplan-home-community",12),I.Xb(35,"div",13),I.Vc(36,wd,1,2,"app-poc-assessed-forms",14),I.Vc(37,Ld,1,2,"app-episode-direct-forms",14),I.Wb(),I.Sb(38,"app-health-screenings",15),I.Xb(39,"app-conditions-management",16),I.ec("refresh",function(){return I.Lc(n),I.ic().getEpisodeData()}),I.Wb(),I.Sb(40,"app-careplan-patient-goals",17),I.Vb(41),I.Xb(42,"nz-back-top",18),I.Vc(43,xd,2,0,"ng-template",null,19,I.Wc),I.Wb(),I.Ub(),I.Wb(),I.Ub()}if(2&e){var i=I.Ic(44),a=I.ic();I.Db(2),I.rc("patientDetails",a.patient)("episodeDetails",a.episodeDetails),I.Db(1),I.rc("nzGutter",I.xc(41,Vd)),I.Db(3),I.Yc(I.kc(7,27,"COMMON.PROBLEM_LIST")),I.Db(4),I.Yc(I.kc(11,29,"COMMON.PATIENT_CARE_TEAM")),I.Db(4),I.Yc(I.kc(15,31,"COMMON.HOME_COMMUNITY_RESOURCE")),I.Db(4),I.Yc(I.kc(19,33,"COMMON.CARE_PLAN_ASSESSMENT")),I.Db(4),I.Yc(I.kc(23,35,"COMMON.HEALTH_SCREENING")),I.Db(4),I.Yc(I.kc(27,37,"COMMON.CONDITION_MANAGEMENT")),I.Db(4),I.Yc(I.kc(31,39,"COMMON.PATIENT_GOALS")),I.Db(2),I.rc("icdCodes",null==a.patient||null==a.patient.healthInfo?null:a.patient.healthInfo.dxCodes),I.Db(1),I.rc("staffs",a.staffs)("primaryIds",a.primaryIds)("patientId",a.patientId)("blueprintId",a.blueprintId),I.Db(1),I.rc("patientId",a.patientId)("blueprintId",a.blueprintId),I.Db(2),I.rc("ngIf",a.isCareplanEnabled),I.Db(1),I.rc("ngIf",!a.isCareplanEnabled),I.Db(1),I.rc("patientId",a.patientId)("blueprintId",a.blueprintId),I.Db(1),I.rc("patientId",a.patientId)("episodeDetails",a.episodeDetails)("patient",a.patient),I.Db(1),I.rc("patientId",a.patientId)("blueprintId",a.blueprintId),I.Db(2),I.rc("nzTemplate",i)}}var Fd,jd,Yd,Gd=[{path:"form/:mode/:patientId",component:tt},{path:"consent/sms/:patientId/:episodeType/:episodeId/:actionItemId",component:Gs},{path:"consent/sms/submitted/:status",component:Qs},{path:"details/:patientId/:episodeId",data:{privileges:[Rs.a.VIEW_EPISODE],showTenantToggle:!1},component:Ws,canActivate:[ks.a,ws.a]},{path:"ccm/careplan/:patientId/:episodeId/:blueprintId",data:{privileges:[Rs.a.VIEW_EPISODE],showTenantToggle:!1},component:(Fd=function(e){a(i,e);var n=s(i);function i(e,t,a,o,s,l,r,d,u){var b;return c(this,i),(b=n.call(this))._episodesService=e,b._activatedRoute=t,b._dataSharingService=a,b._notificationsService=o,b._patientsService=s,b._staffService=l,b._careplanService=r,b._router=d,b.scroller=u,b.scroller.setOffset([0,150]),b}return u(i,[{key:"ngOnInit",value:function(){this.getDataFromURL(),this.getTenantConfig(),this.getEpisodeData(),this.getStaffDetails(this.patientId)}},{key:"getDataFromURL",value:function(){this.patientId=this._activatedRoute.snapshot.params.patientId,this.episodeId=this._activatedRoute.snapshot.params.episodeId,this.blueprintId=this._activatedRoute.snapshot.params.blueprintId}},{key:"getTenantConfig",value:function(){var e=this;this._dataSharingService.tenantSettings.pipe(Object(E.a)(this.unsubscribed)).subscribe(function(t){e.tenantSettings=t})}},{key:"getEpisodeData",value:function(){var e=this;this._episodesService.fetchEpisodeDetails(this.episodeId).subscribe(function(t){e.episodeDetails&&JSON.stringify(t)===JSON.stringify(e.episodeDetails)||(e.episodeDetails=void 0,setTimeout(function(){var n;e.episodeDetails=t,e.isCareplanEnabled=(null===(n=null==t?void 0:t.activeCarePlans)||void 0===n?void 0:n.length)>0},50))})}},{key:"getUserDetails",value:function(e){var t=this;this._patientsService.fetchPatientById(e).subscribe(function(e){return t.patient=e})}},{key:"getStaffDetails",value:function(e){var n=this;this._staffService.fetchStaffMemberById(e).subscribe(function(e){var i,a,o;n.patient=e.user,n.primaryIds=[],null===(o=n.patient.assignedStaffs)||void 0===o||o.forEach(function(e){"PRIMARY"==(null==e?void 0:e.assignedStaffType)&&n.primaryIds.push(e.staffId)}),n.staffs=[],null!=e.assignedUsers&&null!=e.assignedUsers[h.a.MONITORING_STAFF]&&(i=n.staffs).push.apply(i,t(e.assignedUsers[h.a.MONITORING_STAFF])),null!=e.assignedUsers&&null!=e.assignedUsers[h.a.PHYSICIAN]&&(a=n.staffs).push.apply(a,t(e.assignedUsers[h.a.PHYSICIAN]))})}},{key:"scrollTo",value:function(e){this.scroller.scrollToAnchor(e)}}]),i}(D.a),Fd.\u0275fac=function(e){return new(e||Fd)(I.Rb(C.a),I.Rb(_.a),I.Rb(te.a),I.Rb(T.b),I.Rb(m.a),I.Rb(p.a),I.Rb(xl.a),I.Rb(_.g),I.Rb(r.D))},Fd.\u0275cmp=I.Lb({type:Fd,selectors:[["app-episode-careplan-details"]],features:[I.Ab],decls:2,vars:5,consts:[["title","episodeForm",3,"defaultTitle","isSearchEnabled","isActionEnabled"],[4,"ngIf"],[1,"container"],[3,"patientDetails","episodeDetails"],["nz-row","","nzJustify","start","nzAlign","middle",1,"pad-20",3,"nzGutter"],["nz-col","",1,"vertical-divider"],[1,"inactive-title"],[1,"active-title",3,"click"],["nz-col","",1,"vertical-divider","text-center"],["nz-col","",1,"text-center"],[3,"icdCodes"],["id","staff-details",3,"staffs","primaryIds","patientId","blueprintId"],["id","home-community",3,"patientId","blueprintId"],["id","patient-forms"],[3,"patientId","blueprintId",4,"ngIf"],["id","health-screening",3,"patientId","blueprintId"],["id","poc",3,"patientId","episodeDetails","patient","refresh"],["id","goals",3,"patientId","blueprintId"],[3,"nzTemplate"],["backUp",""],[3,"patientId","blueprintId"],["nz-button","","nzType","primary","nzShape","circle",1,"scrollup"],["name","up","color","#ffffff","size","20",2,"margin","0px"]],template:function(e,t){1&e&&(I.Sb(0,"app-header",0),I.Vc(1,Ud,45,42,"ng-container",1)),2&e&&(I.uc("defaultTitle","",null==t.patient?null:t.patient.fullName," | ",null==t.episodeDetails?null:t.episodeDetails.name,""),I.rc("isSearchEnabled",!1)("isActionEnabled",!1),I.Db(1),I.rc("ngIf",t.tenantSettings&&t.episodeDetails))},directives:[qe.a,r.q,Kr,N.c,N.a,ec,hc,yc,Rc,dd,Nd,zd.a,Pd,kd,kt.a,wt.a,L.a,ve.a],pipes:[se.a],styles:['.scrollup[_ngcontent-%COMP%]{height:43px;width:43px;font-size:16px}[_nghost-%COMP%]     .ant-back-top{bottom:48px;right:48px}.vertical-divider[_ngcontent-%COMP%]{content:""}.vertical-divider[_ngcontent-%COMP%]:before{border-right:2px solid #000;height:40%;position:absolute;right:0;bottom:12px;top:14px;content:""}.text-center[_ngcontent-%COMP%]{text-align:center}.active-title[_ngcontent-%COMP%]{color:var(--primary-color);cursor:pointer}.active-title[_ngcontent-%COMP%], .inactive-title[_ngcontent-%COMP%]{font-weight:700;font-size:14px;margin-left:16px;margin-right:16px}.inactive-title[_ngcontent-%COMP%]{color:#000}.pad-20[_ngcontent-%COMP%]{padding:10px 10px 40px}']}),Fd),canActivate:[ks.a,ws.a]},{path:"consentCertificate/:episodeId",data:{showTenantToggle:!1},component:Us},{path:"plan-of-care/:patientId/:episodeId",component:K,data:Js.PlanOfCare},{path:"plan-of-care/edit/:planOfCareId/:patientId/:episodeId",component:K,data:Js.PlanOfCare},{path:"plan-of-care/details/:patientId/:episodeId",component:hl,data:Js.PlanOfCareTimeline},{path:"billing-rate",component:Ll,data:Js.EpisodeBillingRate}],Bd=((jd=function e(){c(this,e)}).\u0275mod=I.Pb({type:jd}),jd.\u0275inj=I.Ob({factory:function(e){return new(e||jd)},imports:[[_.k.forChild(Gd)],_.k]}),jd),Hd=o("KZX/"),Zd=o("UFn0"),qd=o("SHZf"),$d=o("rbUg"),Kd=((Yd=function e(t){c(this,e),this.translationService=t,t.setLanguage()}).\u0275mod=I.Pb({type:Yd}),Yd.\u0275inj=I.Ob({factory:function(e){return new(e||Yd)(I.bc(J.a))},imports:[[r.c,Bd,Hd.a,Zd.a,v.o,v.B,l.a,V.b,$d.a,qd.a.forRoot(),zl.a.forRoot({apiKey:"AIzaSyCkujBUnFmDto5Ui2EKj4AcpWXMrizEDRc",libraries:["places"]})]]}),Yd)},wpKq:function(e,t,n){"use strict";n.d(t,"a",function(){return A});var i,a=n("ighe"),o=n("fXoL"),s=n("dEAy"),l=n("eHCX"),r=n("bE2y"),d=n("3Pt+"),b=n("PTRe"),p=n("B+r4"),f=n("OzZK"),v=n("RwU8"),h=n("C2AL"),g=((i=function(){function e(t,n){c(this,e),this._episodesService=t,this._modalRef=n}return u(e,[{key:"suspendEpisode",value:function(){var e,t=this,n={episodeId:this.episodeId,reason:"Other"!==this.suspendReason?this.suspendReason+((null===(e=this.otherReason)||void 0===e?void 0:e.trim().length)>0?" : ".concat(this.otherReason):""):this.otherReason};this._episodesService.suspendEpisodeNew(n).subscribe(function(e){t._modalRef.close(!0)})}}]),e}()).\u0275fac=function(e){return new(e||i)(o.Rb(a.a),o.Rb(s.e))},i.\u0275cmp=o.Lb({type:i,selectors:[["app-suspender"]],inputs:{episodeId:"episodeId"},decls:17,vars:3,consts:[["nz-typography",""],[3,"ngModel","ngModelChange"],["nz-radio","","nzValue","Patient is hospitalized"],["nz-radio","","nzValue","Moved to a different service area"],["nz-radio","","nzValue","Poor medical condition"],["nz-radio","","nzValue","Other"],["rows","4","nz-input","","placeholder","Add additional notes...",3,"ngModel","ngModelChange"],["nz-row","","nzGutter","32","nzJustify","center"],["nz-col","","nzSpan","14"],["nz-button","","nzSize","large","nzType","primary",1,"suspender",3,"disabled","click"]],template:function(e,t){1&e&&(o.Xb(0,"h3",0),o.Xc(1,"This episode is being suspended because..."),o.Wb(),o.Xb(2,"nz-radio-group",1),o.ec("ngModelChange",function(e){return t.suspendReason=e}),o.Xb(3,"label",2),o.Xc(4,"Patient is hospitalized"),o.Wb(),o.Xb(5,"label",3),o.Xc(6,"Moved to a different service area"),o.Wb(),o.Xb(7,"label",4),o.Xc(8,"Poor medical condition"),o.Wb(),o.Xb(9,"label",5),o.Xc(10,"Other"),o.Wb(),o.Wb(),o.Xb(11,"textarea",6),o.ec("ngModelChange",function(e){return t.otherReason=e}),o.Wb(),o.Xb(12,"div",7),o.Xb(13,"div",8),o.Sb(14,"br"),o.Xb(15,"button",9),o.ec("click",function(){return t.suspendEpisode()}),o.Xc(16," Suspend Episode "),o.Wb(),o.Wb(),o.Wb()),2&e&&(o.Db(2),o.rc("ngModel",t.suspendReason),o.Db(9),o.rc("ngModel",t.otherReason),o.Db(4),o.rc("disabled",!(null!=t.suspendReason&&t.suspendReason.length||null!=t.otherReason&&t.otherReason.length)))},directives:[l.a,r.c,d.u,d.x,r.b,b.b,d.d,p.c,p.a,f.a,v.a,h.a],styles:["h3[_ngcontent-%COMP%]{color:#0f2015;margin-bottom:15px;letter-spacing:0;font:normal normal 700 20px/27px Nunito}.suspender[_ngcontent-%COMP%]{width:100%;margin-top:10px}[_nghost-%COMP%]     .ant-modal-content{border-radius:20px}[nz-radio][_ngcontent-%COMP%]{display:block;height:32px;line-height:32px}textarea[_ngcontent-%COMP%]{background:#f6f6f6 0 0 no-repeat padding-box;border-radius:5px;margin-top:10px}"]}),i);n("cauy");var m=n("zAKX"),C=n("ofXK"),D=n("FwiY"),S=n("dRHE");function E(e,t){1&e&&(o.Xb(0,"span",16),o.Sb(1,"span",17),o.Xc(2," Primary "),o.Wb())}function O(e,t){if(1&e&&(o.Vb(0),o.Xb(1,"nz-option",12),o.Xb(2,"span",13),o.Xb(3,"span",14),o.Xc(4),o.Wb(),o.Vc(5,E,3,0,"span",15),o.Wb(),o.Wb(),o.Ub()),2&e){var n=t.$implicit,i=o.ic();o.Db(1),o.sc("nzLabel",n.value),o.rc("nzValue",n.key),o.Db(3),o.Zc(" ",n.value," "),o.Db(1),o.rc("ngIf",i.primaryStaff.has(n.key))}}function I(e,t){1&e&&(o.Xb(0,"label",18),o.Xc(1,"Required"),o.Wb())}function _(e,t){if(1&e&&o.Sb(0,"nz-option",19),2&e){var n=t.$implicit;o.rc("nzLabel",n.name+" - "+n.brandName)("nzValue",n.model)}}function T(e,t){1&e&&(o.Xb(0,"label",18),o.Xc(1,"Required"),o.Wb())}var X,y,N=function(){return[32,32]},z=function(){return[","]},M=((y=function(){function e(t){c(this,e),this._modalRef=t,this.primaryStaff=new Set}return u(e,[{key:"ngOnInit",value:function(){var e=this;this.patient.monitoringStaffs.primaryStaff.forEach(function(t){return e.primaryStaff.add(t)}),this.patient.physicianStaffs.primaryStaff.forEach(function(t){return e.primaryStaff.add(t)})}},{key:"onStaffSelect",value:function(e){this.selectedStaff=e}},{key:"assignTasks",value:function(){var e;this.staffError=!1,this.deviceError=!1,this.selectedStaff||(this.staffError=!0),(null===(e=this.selectedDevices)||void 0===e?void 0:e.length)||(this.deviceError=!0),this.staffError||this.deviceError||this.close({scheduledTime:Date.now(),caretakerId:this.selectedStaff,deviceModelsForEducation:this.selectedDevices,tenantId:localStorage.getItem("loggedInTenant")})}},{key:"close",value:function(e){this._modalRef.close(e)}}]),e}()).\u0275fac=function(e){return new(e||y)(o.Rb(s.e))},y.\u0275cmp=o.Lb({type:y,selectors:[["app-device-setup-assigner"]],inputs:{monitoringStaff:"monitoringStaff",devices:"devices",patient:"patient"},decls:25,vars:24,consts:[[1,"container"],["nz-typography",""],["nz-row","",3,"nzGutter"],["nz-col","","nzSpan","24"],["nzShowSearch","","nzAllowClear","","nzPlaceHolder","Select Monitoring Staff","ngModel","",3,"ngModelChange"],[4,"ngFor","ngForOf"],["nz-typography","","nzType","danger",4,"ngIf"],["nzMode","tags",3,"nzTokenSeparators","ngModel","ngModelChange"],[3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["nz-row","","nzJustify","end",3,"nzGutter"],["nz-col","","nzSpan","5"],["nz-button","","nzType","primary",3,"click"],["nzCustomContent","",3,"nzLabel","nzValue"],[2,"display","flex"],[2,"width","70%"],["style","width: 30%; text-align: right; color: var(--primary-color);",4,"ngIf"],[2,"width","30%","text-align","right","color","var(--primary-color)"],["nz-icon","","nzType","crown","nzTheme","outline",2,"font-size","14px"],["nz-typography","","nzType","danger"],[3,"nzLabel","nzValue"]],template:function(e,t){1&e&&(o.Xb(0,"div",0),o.Xb(1,"h3",1),o.Xc(2),o.jc(3,"translate"),o.Wb(),o.Xb(4,"div",2),o.Xb(5,"div",3),o.Xb(6,"label"),o.Xc(7,"Add Monitoring Staff"),o.Wb(),o.Xb(8,"nz-select",4),o.ec("ngModelChange",function(e){return t.onStaffSelect(e)}),o.Vc(9,O,6,4,"ng-container",5),o.jc(10,"keyvalue"),o.Wb(),o.Vc(11,I,2,0,"label",6),o.Wb(),o.Wb(),o.Xb(12,"div",2),o.Xb(13,"div",3),o.Xb(14,"label"),o.Xc(15),o.jc(16,"translate"),o.Wb(),o.Xb(17,"nz-select",7),o.ec("ngModelChange",function(e){return t.selectedDevices=e}),o.Vc(18,_,1,2,"nz-option",8),o.Wb(),o.Vc(19,T,2,0,"label",6),o.Wb(),o.Wb(),o.Xb(20,"div",9),o.Xb(21,"div",10),o.Xb(22,"button",11),o.ec("click",function(){return t.assignTasks()}),o.Xc(23),o.jc(24,"translate"),o.Wb(),o.Wb(),o.Wb(),o.Wb()),2&e&&(o.Db(2),o.Yc(o.kc(3,12,"EPISODE.ADDDEVICE_SETUP_TASK")),o.Db(2),o.rc("nzGutter",o.xc(20,N)),o.Db(5),o.rc("ngForOf",o.kc(10,14,t.monitoringStaff)),o.Db(2),o.rc("ngIf",!t.selectedStaff&&t.staffError),o.Db(1),o.rc("nzGutter",o.xc(21,N)),o.Db(3),o.Yc(o.kc(16,16,"DEVICES.ADD")),o.Db(2),o.rc("nzTokenSeparators",o.xc(22,z))("ngModel",t.selectedDevices),o.Db(1),o.rc("ngForOf",t.devices),o.Db(1),o.rc("ngIf",!(null!=t.selectedDevices&&t.selectedDevices.length)&&t.deviceError),o.Db(1),o.rc("nzGutter",o.xc(23,N)),o.Db(3),o.Zc(" ",o.kc(24,18,"COMMON.SAVE")," "))},directives:[l.a,p.c,p.a,m.d,d.u,d.x,C.p,C.q,f.a,v.a,h.a,m.a,D.a],pipes:[S.a,C.j],styles:["h3[_ngcontent-%COMP%]{margin-bottom:20px}label[_ngcontent-%COMP%]{font:normal normal normal 13px/16px Nunito;color:var(--tertiary-color);margin-top:5px;margin-bottom:5px;display:block}"]}),y),A=((X=function(){function e(t){c(this,e),this._modalService=t}return u(e,[{key:"createDeviceSetupTaskModal",value:function(e,t,n){return this._modalService.create({nzContent:M,nzComponentParams:{monitoringStaff:e,devices:t,patient:n},nzWidth:500,nzFooter:null})}},{key:"createSuspendModal",value:function(e){return this._modalService.create({nzContent:g,nzComponentParams:{episodeId:e},nzStyle:{"border-radius":"20px"},nzWidth:470,nzFooter:null})}}]),e}()).\u0275fac=function(e){return new(e||X)(o.bc(s.f))},X.\u0275prov=o.Nb({token:X,factory:X.\u0275fac,providedIn:"root"}),X)},xn8p:function(e,t,n){"use strict";n.d(t,"a",function(){return C});var i=n("fXoL"),a=n("ncdi"),o=n("ofXK"),s=n("B+r4"),l=n("eHCX"),r=n("fhRi");function d(e,t){1&e&&(i.Vb(0),i.Xb(1,"p",8),i.Xc(2,"New"),i.Wb(),i.Ub())}function u(e,t){1&e&&(i.Vb(0),i.Xb(1,"p",9),i.Xc(2,"Ongoing"),i.Wb(),i.Ub())}function b(e,t){1&e&&(i.Vb(0),i.Xb(1,"p",10),i.Xc(2,"Improved"),i.Wb(),i.Ub())}function p(e,t){1&e&&(i.Vb(0),i.Xb(1,"p",11),i.Xc(2,"Worsening"),i.Wb(),i.Ub())}function f(e,t){1&e&&(i.Vb(0),i.Xb(1,"p",10),i.Xc(2,"Resolved"),i.Wb(),i.Ub())}function v(e,t){1&e&&(i.Vb(0),i.Xb(1,"p",10),i.Xc(2,"Low"),i.Wb(),i.Ub())}function h(e,t){1&e&&(i.Vb(0),i.Xb(1,"p",9),i.Xc(2,"Medium"),i.Wb(),i.Ub())}function g(e,t){1&e&&(i.Vb(0),i.Xb(1,"p",11),i.Xc(2,"High"),i.Wb(),i.Ub())}function m(e,t){if(1&e&&(i.Xb(0,"nz-timeline-item"),i.Xb(1,"div",2),i.Xb(2,"div",3),i.Xb(3,"p",4),i.Xc(4,"Event"),i.Wb(),i.Wb(),i.Xb(5,"div",5),i.Xb(6,"p",4),i.Xc(7," Entered on "),i.Xb(8,"strong",4),i.Xc(9),i.jc(10,"utcToLocalTime"),i.Wb(),i.Xc(11," by "),i.Xb(12,"strong",4),i.Xc(13),i.jc(14,"titlecase"),i.Wb(),i.Wb(),i.Wb(),i.Wb(),i.Xb(15,"div",2),i.Xb(16,"div",3),i.Xb(17,"p",4),i.Xc(18,"Outcome"),i.Wb(),i.Wb(),i.Xb(19,"div",5),i.Xb(20,"strong"),i.Vb(21,6),i.Vc(22,d,3,0,"ng-container",7),i.Vc(23,u,3,0,"ng-container",7),i.Vc(24,b,3,0,"ng-container",7),i.Vc(25,p,3,0,"ng-container",7),i.Vc(26,f,3,0,"ng-container",7),i.Ub(),i.Wb(),i.Wb(),i.Wb(),i.Xb(27,"div",2),i.Xb(28,"div",3),i.Xb(29,"p",4),i.Xc(30,"Priority"),i.Wb(),i.Wb(),i.Xb(31,"div",5),i.Xb(32,"strong"),i.Vb(33,6),i.Vc(34,v,3,0,"ng-container",7),i.Vc(35,h,3,0,"ng-container",7),i.Vc(36,g,3,0,"ng-container",7),i.Ub(),i.Wb(),i.Wb(),i.Wb(),i.Wb()),2&e){var n=t.$implicit,a=i.ic();i.Db(9),i.Yc(i.kc(10,12,null==n?null:n.createdAt)),i.Db(4),i.Yc(i.kc(14,14,a.staffMap[null==n?null:n.createdBy])),i.Db(8),i.rc("ngSwitch",null==n?null:n.outcome),i.Db(1),i.rc("ngSwitchCase","NEW"),i.Db(1),i.rc("ngSwitchCase","ONGOING"),i.Db(1),i.rc("ngSwitchCase","IMPROVED"),i.Db(1),i.rc("ngSwitchCase","WORSENING"),i.Db(1),i.rc("ngSwitchCase","RESOLVED"),i.Db(7),i.rc("ngSwitch",null==n?null:n.priority),i.Db(1),i.rc("ngSwitchCase","LOW"),i.Db(1),i.rc("ngSwitchCase","MEDIUM"),i.Db(1),i.rc("ngSwitchCase","HIGH")}}var C=function(){var e=function e(){c(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Lb({type:e,selectors:[["app-event-history"]],inputs:{events:"events",staffMap:"staffMap"},decls:3,vars:1,consts:[[1,"container"],[4,"ngFor","ngForOf"],["nz-row","","nzGutter","16"],["nz-col","","nzSpan","4"],["nz-typography",""],["nz-col","","nzSpan","20"],[3,"ngSwitch"],[4,"ngSwitchCase"],["nz-typography","","nzType","secondary"],["nz-typography","","nzType","warning"],["nz-typography","","nzType","success"],["nz-typography","","nzType","danger"]],template:function(e,t){1&e&&(i.Xb(0,"div",0),i.Xb(1,"nz-timeline"),i.Vc(2,m,37,16,"nz-timeline-item",1),i.Wb(),i.Wb()),2&e&&(i.Db(2),i.rc("ngForOf",t.events))},directives:[a.a,o.p,a.b,s.c,s.a,l.a,o.s,o.t],pipes:[r.a,o.A],styles:["strong[_ngcontent-%COMP%]{font-weight:700!important}"]}),e}()}}])}();