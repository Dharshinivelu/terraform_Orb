(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{"1YrE":function(e,t,n){"use strict";n.d(t,"a",function(){return o});var i=n("AytR"),s=n("fXoL"),a=n("tk/3");let o=(()=>{class e{constructor(e){this._http=e,this.rootURL=i.g.url}savePlanOfCare(e){return this._http.post(`${this.rootURL}/v3/plan-of-care`,JSON.stringify(e))}savePlanOfCareEvent(e,t){return this._http.post(`${this.rootURL}/v3/plan-of-care/${e}/event`,JSON.stringify(t))}fetchPlanOfCare(e){return this._http.get(`${this.rootURL}/v3/plan-of-care/${e}`)}fetchPlanOfCareById(e){return this._http.get(`${this.rootURL}/v3/plan-of-care/details/${e}`)}archivePlanOfCare(e){return this._http.delete(`${this.rootURL}/v3/plan-of-care/${e}`)}}return e.\u0275fac=function(t){return new(t||e)(s.bc(a.c))},e.\u0275prov=s.Nb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},Edj7:function(e,t,n){"use strict";n.d(t,"a",function(){return g});var i=n("FH+g"),s=n("igu/"),a=n("WoUL"),o=n("fXoL"),l=n("tyNb"),r=n("bNXi"),c=n("ofXK"),d=n("ZKr6"),b=n("glKu");function p(e,t){if(1&e){const e=o.Yb();o.Xb(0,"app-icons",2),o.ec("click",function(){return o.Lc(e),o.ic(2).initiateVideoCall()}),o.Wb()}}const u=function(){return["VIDEO_CALL"]};function h(e,t){1&e&&(o.Vb(0),o.Vc(1,p,1,0,"app-icons",1),o.Ub()),2&e&&(o.Db(1),o.rc("isFeaturePermitted",o.xc(1,u)))}let g=(()=>{class e{constructor(e,t,n,i,s,a){this._router=e,this._activatedRoute=t,this._videoCallService=n,this._dataSharingService=i,this._translationService=s,this._notificationsService=a}ngOnInit(){this.$tenantConfigObserver=this._dataSharingService.tenantSettings,this.env="prod",this.isCallButtonEnabled=!0,this.$translationSubscription=this._translationService.getMultiple("PATIENT_ALREADY_IN_ANOTHER_CALL","YOU_ARE_ALREADY_IN_CALL","VIDEOCALL.VIDEOCALL","COMMON.INVALID_SESSION","COMMON.SESSION_EXPIRED").subscribe(e=>{this.translatedStrings=e})}ngOnDestroy(){var e,t;null===(e=this.$activatedRouteObserver)||void 0===e||e.unsubscribe(),null===(t=this.$translationSubscription)||void 0===t||t.unsubscribe()}subscribeToActivatedRoute(){this.$activatedRouteObserver=this._activatedRoute.queryParams.subscribe(e=>{"debug"==e.env&&(this.env=e.env)})}initiateVideoCall(){if(!this.isCallButtonEnabled)return;this.isCallButtonEnabled=!1;const e=localStorage.getItem("loggedInUser");this._videoCallService.videocallSessionCheck(e).subscribe(e=>{this._videoCallService.videocallSessionCheck(this.userId).subscribe(()=>{this.openCallWindow(this.userId)},e=>{this.callError(e,this.translatedStrings.get("PATIENT_ALREADY_IN_ANOTHER_CALL"))})},e=>{this.callError(e,this.translatedStrings.get("YOU_ARE_ALREADY_IN_CALL"))})}openCallWindow(e){const t=this._router.serializeUrl(this._router.createUrlTree(["/video-call/"+e],{queryParams:{env:this.env,appointmentSessionId:this.appointmentSessionId,appointmentId:this.appointmentId}}));this.isCallButtonEnabled=!0,window.open(t,"_blank")}callError(e,t){403==e.status?this._notificationsService.create("error",this.translatedStrings.get("VIDEOCALL.VIDEOCALL"),t):401==e.status&&(this._notificationsService.create("error",this.translatedStrings.get("COMMON.INVALID_SESSION"),this.translatedStrings.get("COMMON.SESSION_EXPIRED")),this._router.navigate(["logout"])),this.isCallButtonEnabled=!0}}return e.\u0275fac=function(t){return new(t||e)(o.Rb(l.g),o.Rb(l.a),o.Rb(i.a),o.Rb(s.a),o.Rb(a.a),o.Rb(r.b))},e.\u0275cmp=o.Lb({type:e,selectors:[["app-video-call-widget"]],inputs:{userId:"userId",appointmentId:"appointmentId",appointmentSessionId:"appointmentSessionId"},decls:2,vars:3,consts:[[4,"ngIf"],["name","videoCall","size","20px",3,"click",4,"isFeaturePermitted"],["name","videoCall","size","20px",3,"click"]],template:function(e,t){if(1&e&&(o.Vc(0,h,2,2,"ng-container",0),o.jc(1,"async")),2&e){let e=null;o.rc("ngIf",null==(e=o.kc(1,1,t.$tenantConfigObserver))||null==e.videoCallConfig?null:e.videoCallConfig.enabled)}},directives:[c.q,d.a,b.a],pipes:[c.b],styles:["app-icons[_ngcontent-%COMP%]{margin:0 10px}"]}),e})()},I2os:function(e,t,n){"use strict";n.d(t,"a",function(){return i});class i{}},KZd8:function(e,t,n){"use strict";n.d(t,"b",function(){return s}),n.d(t,"a",function(){return a});class i{constructor(){this.isDurationEditable=!0,this.timeInDays=30}}class s{constructor(){this.type="RPM",this.tmsSummaryAdherenceEnabled=!0,this.vitalAdherenceEnabled=!0,this.archived=!1,this.durationSettings=new i}}class a{}},Lrxu:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return s}),n("rqHP"),n("ua0i");var i=function(e){return e.OBTAINED="OBTAINED",e.IN_PROGRESS="IN_PROGRESS",e.DENIED="DENIED",e.TO_BE_PROCESSED="TO_BE_PROCESSED",e.ARCHIVED="ARCHIVED",e.REVOKED="REVOKED",e}({}),s=function(e){return e.VERBAL_CONSENT="VERBAL_CONSENT",e.APP_CONSENT="APP_CONSENT",e.SMS_CONSENT="SMS_CONSENT",e.MANUAL_CONSENT="MANUAL_CONSENT",e.DIGITAL_CONSENT="DIGITAL_CONSENT",e}({})},"OG+h":function(e,t,n){"use strict";n.d(t,"a",function(){return C});var i=n("M34a"),s=n("jKzE"),a=n("ofXK"),o=n("3pGX"),l=n("Dwgb"),r=n("AytR"),c=n("I2os"),d=n("fXoL"),b=n("dEAy"),p=n("bNXi"),u=n("tyNb"),h=n("rMZv"),g=n("wjar"),f=n("glKu"),v=n("dRHE");function m(e,t){if(1&e){const e=d.Yb();d.Xb(0,"tr"),d.Xb(1,"td",3),d.ec("click",function(){d.Lc(e);const n=t.$implicit;return d.ic().showCareplanTemplate(null==n?null:n.id)}),d.Xc(2),d.Wb(),d.Xb(3,"td",4),d.Xb(4,"app-icons",5),d.ec("click",function(){d.Lc(e);const n=t.$implicit;return d.ic().assignCareplan(null==n?null:n.id)}),d.Wb(),d.Wb(),d.Wb()}if(2&e){const e=t.$implicit;d.Db(2),d.Yc(e.name)}}let C=(()=>{class e{constructor(e,t,n,i,s,a){this._modalRef=e,this._partnerService=t,this._regimeService=n,this._notificationsService=i,this._router=s,this._datePipe=a,this.totalCount=0,this.pageSize=r.g.pageSize,this.courses=[],this.loading=!1}ngOnInit(){var e;this.careplanTypeMap=new Map,this.careplanTypeMap.set("GENERAL","DEFAULT"),this.careplanTypeMap.set("RPM","REMOTE_PATIENT_MONITORING"),this.careplanTypeMap.set("HEALTH_SCORE","HEALTH_SCORE"),this.careplanTypeMap.set("CCM","CHRONIC_CARE_MANAGEMENT"),this._regimeService.getCourse(this.pageSize,0,this.tenantId,this.careplanTypeMap.get(null===(e=this.episodeDetails)||void 0===e?void 0:e.type)||"DEFAULT").subscribe(e=>{this.courses=e.body,this.totalCount=this._partnerService.getTotalCount(e.headers)})}getCpTemplatesOnPage(e){var t;this._regimeService.getCourse(this.pageSize,this.pageSize*e,this.tenantId,this.careplanTypeMap.get(null===(t=this.episodeDetails)||void 0===t?void 0:t.type)||"DEFAULT").subscribe(e=>{this.courses=e.body})}getCpTemplates(e){this.getCpTemplatesOnPage(e-1)}assignCareplan(e){this.loading?this._notificationsService.info("Care Plan","Please wait..."):(this.loading=!0,"auto-assign"===this.mode?this.autoAssignCareplan(e):this.gotoAssignCareplan(e))}autoAssignCareplan(e){var t,n;const a=new c.a;a.patientId=this.patientId,a.episodeId=this.episodeDetails.id,a.episodeName=this.episodeDetails.name,a.episodeBlueprintId=this.episodeDetails.blueprintId;let o=new Date,l=Object(i.a)(o);const r=Object(s.a)(l);(null===(n=null===(t=this.episodeDetails)||void 0===t?void 0:t.deviceSetupTasks)||void 0===n?void 0:n.length)&&(l=Object(i.a)(new Date(this.episodeDetails.deviceSetupTasks[0].scheduledAt))),l<o&&(l=Object(i.a)(o)),a.assignedOn=Date.now(),a.startTime=l.getTime(),a.startDate=this._datePipe.transform(l,"yyyy-MM-dd"),a.endDate=this._datePipe.transform(r,"yyyy-MM-dd"),a.assignerId=localStorage.getItem("loggedInUser"),a.tenantId=localStorage.getItem("loggedInTenant"),this._regimeService.autoAssignCareplan(e,a).subscribe(e=>{this._notificationsService.success("Episode",e.message),this.closeDialog(!0)},e=>{this._notificationsService.error("Episode",e.error.message),this.closeDialog()})}gotoAssignCareplan(e){this.closeDialog(),this.episodeDetails&&this.episodeDetails.id?this._router.navigate(["course/episode",e,this.patientId,this.episodeDetails.id,this.episodeDetails.tenantId],{queryParams:{episodeStartDate:this.episodeDetails.startDate,episodeEndDate:this.episodeDetails.endDate,episodeBlueprintId:this.episodeDetails.blueprintId,episodeName:this.episodeDetails.name}}):this._router.navigate(["course/assign",e,this.patientId])}closeDialog(e){this._modalRef.close(e)}}return e.\u0275fac=function(t){return new(t||e)(d.Rb(b.e),d.Rb(l.a),d.Rb(o.a),d.Rb(p.b),d.Rb(u.g),d.Rb(a.e))},e.\u0275cmp=d.Lb({type:e,selectors:[["app-careplan-templates-dialog"]],inputs:{patientId:"patientId",tenantId:"tenantId",episodeDetails:"episodeDetails",mode:"mode"},features:[d.Cb([a.e])],decls:12,vars:11,consts:[[3,"nzData","nzShowPagination","nzFrontPagination","nzTotal","nzPageIndexChange"],["courseTable",""],[4,"ngFor","ngForOf"],[3,"click"],["actionable",""],["name","clone",3,"click"]],template:function(e,t){if(1&e&&(d.Xb(0,"nz-table",0,1),d.ec("nzPageIndexChange",function(e){return t.getCpTemplates(e)}),d.Xb(2,"thead"),d.Xb(3,"tr"),d.Xb(4,"th"),d.Xc(5),d.jc(6,"translate"),d.Wb(),d.Xb(7,"th"),d.Xc(8),d.jc(9,"translate"),d.Wb(),d.Wb(),d.Wb(),d.Xb(10,"tbody"),d.Vc(11,m,5,1,"tr",2),d.Wb(),d.Wb()),2&e){const e=d.Ic(1);d.rc("nzData",t.courses)("nzShowPagination",!0)("nzFrontPagination",!1)("nzTotal",t.totalCount),d.Db(5),d.Yc(d.kc(6,7,"COMMON.NAME")),d.Db(3),d.Yc(d.kc(9,9,"TABLEHEADER.ACTIONS")),d.Db(3),d.rc("ngForOf",null==e?null:e.data)}},directives:[h.f,h.n,h.o,h.e,h.l,h.i,a.p,g.a,f.a],pipes:[v.a],styles:[""]}),e})()},b1TM:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var i=n("AytR"),s=n("SxV6"),a=n("tk/3"),o=n("fXoL");let l=(()=>{class e{constructor(e){this._http=e,this.rootUrl=i.g.url}createConfigSetting(e){return this._http.post(this.rootUrl+"//",JSON.stringify(e)).pipe(Object(s.a)())}updateConfigSetting(e){return e.tenantId=localStorage.getItem("loggedInTenant"),this._http.put(this.rootUrl+"/v2/tenants/settings/",JSON.stringify(e)).pipe(Object(s.a)())}getConfigSetting(){return this._http.get(this.rootUrl+"/v2/tenants/settings/").pipe(Object(s.a)())}updatePassword(e){return this._http.put(this.rootUrl+"/v2/users/changePassword/",JSON.stringify(e)).pipe(Object(s.a)())}postPatchRequest(e,t){let n=new a.g({patch_json:"yes"});return e&&(n=n.append("tenant-id",e)),this._http.patch(this.rootUrl+"/ehealth/v3/tenant-configurations/"+e,t,{headers:n}).pipe(Object(s.a)())}getTenantSettings(e,t){let n=new a.g;return t&&(n=n.append("tenant-id",t)),this._http.get(this.rootUrl+"/ehealth/v2/tenants/"+encodeURIComponent(e)+"/"+t+"/settings",{headers:n}).pipe(Object(s.a)())}}return e.\u0275fac=function(t){return new(t||e)(o.bc(a.c))},e.\u0275prov=o.Nb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},cTUG:function(e,t,n){"use strict";n.d(t,"a",function(){return P});var i=n("s3hQ"),s=n("1YrE"),a=n("fXoL"),o=n("iD/K"),l=n("xn8p"),r=n("tyNb"),c=n("bNXi"),d=n("dEAy"),b=n("eHCX"),p=n("ofXK"),u=n("OzZK"),h=n("C2AL"),g=n("Nqz0"),f=n("glKu"),v=n("Q8cG"),m=n("KupA"),C=n("5vDB"),D=n("B+r4"),S=n("ZyQt"),E=n("fhRi");function O(e,t){1&e&&(a.Vb(0),a.Xb(1,"nz-tag",17),a.Xc(2,"Low"),a.Wb(),a.Ub())}function I(e,t){1&e&&(a.Vb(0),a.Xb(1,"nz-tag",18),a.Xc(2,"Medium"),a.Wb(),a.Ub())}function _(e,t){1&e&&(a.Vb(0),a.Xb(1,"nz-tag",19),a.Xc(2,"High"),a.Wb(),a.Ub())}function X(e,t){1&e&&(a.Vb(0),a.Xb(1,"nz-tag"),a.Xc(2,"New"),a.Wb(),a.Ub())}function T(e,t){1&e&&(a.Vb(0),a.Xb(1,"nz-tag",20),a.Xc(2,"Ongoing"),a.Wb(),a.Ub())}function N(e,t){1&e&&(a.Vb(0),a.Xb(1,"nz-tag",17),a.Xc(2,"Improved"),a.Wb(),a.Ub())}function z(e,t){1&e&&(a.Vb(0),a.Xb(1,"nz-tag",19),a.Xc(2,"Worsening"),a.Wb(),a.Ub())}function M(e,t){1&e&&(a.Vb(0),a.Xb(1,"nz-tag",17),a.Xc(2,"Resolved"),a.Wb(),a.Ub())}function y(e,t){if(1&e&&(a.Xb(0,"nz-tag"),a.Xc(1),a.Wb()),2&e){const e=t.$implicit;a.Db(1),a.Yc(e)}}const A=function(){return[16,24]};let P=(()=>{class e{constructor(e,t,n,i,s){this._activatedRoute=e,this._router=t,this._planOfCareService=n,this._notificationsService=i,this._modalService=s,this.refresh=new a.n,this.categoriesMap=new Map,o.a.forEach(e=>this.categoriesMap[null==e?void 0:e.type]=e.label)}edit(e){var t;this._router.navigate([`episodes/plan-of-care/edit/${e}/${null===(t=this.planOfCare)||void 0===t?void 0:t.patientId}/${this._activatedRoute.snapshot.params.episodeId}`])}delete(e){this._planOfCareService.archivePlanOfCare(e).subscribe(()=>{this._notificationsService.success("Plan Of Care","Provider's plan of care removed successfully"),this.refresh.emit()})}logEvent(e){this._modalService.create({nzTitle:"Log Event",nzContent:i.a,nzComponentParams:{planOfCareId:e,planOfCare:this.planOfCare},nzBodyStyle:{paddingTop:"0"},nzStyle:{top:"20px"},nzWidth:"800px",nzFooter:null,nzMaskClosable:!1,nzKeyboard:!1}).afterClose.subscribe(e=>{e&&this.refresh.emit()})}viewEventHistory(e){this._modalService.create({nzTitle:"Event History",nzContent:l.a,nzComponentParams:{events:null==e?void 0:e.events,staffMap:null==e?void 0:e.staffMap},nzBodyStyle:{paddingTop:"0"},nzStyle:{top:"20px"},nzWidth:"800px",nzFooter:null})}}return e.\u0275fac=function(t){return new(t||e)(a.Rb(r.a),a.Rb(r.g),a.Rb(s.a),a.Rb(c.b),a.Rb(d.f))},e.\u0275cmp=a.Lb({type:e,selectors:[["app-plan-of-care-details"]],inputs:{planOfCare:"planOfCare"},outputs:{refresh:"refresh"},decls:90,vars:47,consts:[["nz-typography",""],[3,"ngSwitch"],[4,"ngSwitchCase"],["nz-button","","nzType","text","nz-dropdown","","nzPlacement","right","id","more",3,"nzDropdownMenu"],["name","moreFilled","size","16px"],["menu","nzDropdownMenu"],["nz-menu",""],["nz-menu-item","",3,"click"],["nz-menu-item",""],["nz-popconfirm","","nzPopconfirmTitle","Are you sure you want to delete this plan of care?","nzPopconfirmPlacement","top",3,"nzOnConfirm"],["nz-typography","","nzType","secondary"],["nz-row","",3,"nzGutter"],["nz-col","","nzSpan","4"],["nz-col","","nzSpan","20"],[4,"ngFor","ngForOf"],["nz-col","","nzSpan","16"],[3,"innerHTML"],["nzColor","#a7c853"],["nzColor","gold"],["nzColor","#c81c1c"],["nzColor","gainsboro"]],template:function(e,t){if(1&e&&(a.Xb(0,"h4",0),a.Xc(1),a.Vb(2,1),a.Vc(3,O,3,0,"ng-container",2),a.Vc(4,I,3,0,"ng-container",2),a.Vc(5,_,3,0,"ng-container",2),a.Ub(),a.Xc(6," \xa0 "),a.Vb(7,1),a.Vc(8,X,3,0,"ng-container",2),a.Vc(9,T,3,0,"ng-container",2),a.Vc(10,N,3,0,"ng-container",2),a.Vc(11,z,3,0,"ng-container",2),a.Vc(12,M,3,0,"ng-container",2),a.Ub(),a.Xb(13,"button",3),a.Sb(14,"app-icons",4),a.Wb(),a.Xb(15,"nz-dropdown-menu",null,5),a.Xb(17,"ul",6),a.Xb(18,"li",7),a.ec("click",function(){return t.logEvent(null==t.planOfCare?null:t.planOfCare.id)}),a.Xc(19,"Log Event"),a.Wb(),a.Xb(20,"li",7),a.ec("click",function(){return t.viewEventHistory(t.planOfCare)}),a.Xc(21,"Event History"),a.Wb(),a.Xb(22,"li",7),a.ec("click",function(){return t.edit(null==t.planOfCare?null:t.planOfCare.id)}),a.Xc(23,"Edit"),a.Wb(),a.Xb(24,"li",8),a.Xb(25,"a",9),a.ec("nzOnConfirm",function(){return t.delete(null==t.planOfCare?null:t.planOfCare.id)}),a.Xc(26," Delete "),a.Wb(),a.Wb(),a.Wb(),a.Wb(),a.Wb(),a.Xb(27,"label",10),a.Xc(28," Created by "),a.Xb(29,"strong"),a.Xc(30),a.jc(31,"titlecase"),a.Wb(),a.Xc(32," at "),a.Xb(33,"strong"),a.Xc(34),a.jc(35,"utcToLocalTime"),a.Wb(),a.Wb(),a.Xb(36,"label",10),a.Xc(37," Last updated by "),a.Xb(38,"strong"),a.Xc(39),a.jc(40,"titlecase"),a.Wb(),a.Xc(41," at "),a.Xb(42,"strong"),a.Xc(43),a.jc(44,"utcToLocalTime"),a.Wb(),a.Wb(),a.Sb(45,"nz-divider"),a.Xb(46,"div",11),a.Xb(47,"div",12),a.Xb(48,"strong",0),a.Xc(49,"Category: "),a.Wb(),a.Wb(),a.Xb(50,"div",13),a.Xc(51),a.Wb(),a.Wb(),a.Xb(52,"div",11),a.Xb(53,"div",12),a.Xb(54,"strong",0),a.Xc(55,"Relative Problems: "),a.Wb(),a.Wb(),a.Xb(56,"div",13),a.Vc(57,y,2,1,"nz-tag",14),a.Wb(),a.Wb(),a.Xb(58,"div",11),a.Xb(59,"div",12),a.Xb(60,"strong",0),a.Xc(61,"Prescribed By: "),a.Wb(),a.Wb(),a.Xb(62,"div",13),a.Xc(63),a.jc(64,"titlecase"),a.Wb(),a.Wb(),a.Sb(65,"nz-divider"),a.Xb(66,"div",11),a.Xb(67,"div",12),a.Xb(68,"strong",0),a.Xc(69,"Provider Plan of Care: "),a.Wb(),a.Wb(),a.Xb(70,"div",15),a.Sb(71,"span",16),a.Wb(),a.Wb(),a.Xb(72,"div",11),a.Xb(73,"div",12),a.Xb(74,"strong",0),a.Xc(75,"Nursing Interventions: "),a.Wb(),a.Wb(),a.Xb(76,"div",15),a.Sb(77,"span",16),a.Wb(),a.Wb(),a.Xb(78,"div",11),a.Xb(79,"div",12),a.Xb(80,"strong",0),a.Xc(81,"Nursing Education: "),a.Wb(),a.Wb(),a.Xb(82,"div",15),a.Sb(83,"span",16),a.Wb(),a.Wb(),a.Xb(84,"div",11),a.Xb(85,"div",12),a.Xb(86,"strong",0),a.Xc(87,"Goals: "),a.Wb(),a.Wb(),a.Xb(88,"div",15),a.Sb(89,"span",16),a.Wb(),a.Wb()),2&e){const e=a.Ic(16);a.Db(1),a.Zc(" ",null==t.planOfCare?null:t.planOfCare.title," \xa0 "),a.Db(1),a.rc("ngSwitch",null==t.planOfCare||null==t.planOfCare.events[(null==t.planOfCare||null==t.planOfCare.events?null:t.planOfCare.events.length)-1]?null:t.planOfCare.events[(null==t.planOfCare||null==t.planOfCare.events?null:t.planOfCare.events.length)-1].priority),a.Db(1),a.rc("ngSwitchCase","LOW"),a.Db(1),a.rc("ngSwitchCase","MEDIUM"),a.Db(1),a.rc("ngSwitchCase","HIGH"),a.Db(2),a.rc("ngSwitch",null==t.planOfCare||null==t.planOfCare.events[(null==t.planOfCare||null==t.planOfCare.events?null:t.planOfCare.events.length)-1]?null:t.planOfCare.events[(null==t.planOfCare||null==t.planOfCare.events?null:t.planOfCare.events.length)-1].outcome),a.Db(1),a.rc("ngSwitchCase","NEW"),a.Db(1),a.rc("ngSwitchCase","ONGOING"),a.Db(1),a.rc("ngSwitchCase","IMPROVED"),a.Db(1),a.rc("ngSwitchCase","WORSENING"),a.Db(1),a.rc("ngSwitchCase","RESOLVED"),a.Db(1),a.rc("nzDropdownMenu",e),a.Db(17),a.Yc(a.kc(31,30,null==t.planOfCare?null:t.planOfCare.staffMap[null==t.planOfCare?null:t.planOfCare.createdBy])),a.Db(4),a.Yc(a.kc(35,32,null==t.planOfCare?null:t.planOfCare.createdAt)),a.Db(5),a.Yc(a.kc(40,34,null==t.planOfCare?null:t.planOfCare.staffMap[null==t.planOfCare?null:t.planOfCare.changedBy])),a.Db(4),a.Yc(a.kc(44,36,null==t.planOfCare?null:t.planOfCare.updatedAt)),a.Db(3),a.rc("nzGutter",a.xc(40,A)),a.Db(5),a.Zc(" ",t.categoriesMap[null==t.planOfCare?null:t.planOfCare.category]," "),a.Db(1),a.rc("nzGutter",a.xc(41,A)),a.Db(5),a.rc("ngForOf",null==t.planOfCare?null:t.planOfCare.icdCodes),a.Db(1),a.rc("nzGutter",a.xc(42,A)),a.Db(5),a.Zc(" ",a.kc(64,38,null==t.planOfCare?null:t.planOfCare.staffMap[null==t.planOfCare?null:t.planOfCare.provider])," "),a.Db(3),a.rc("nzGutter",a.xc(43,A)),a.Db(5),a.rc("innerHTML",null==t.planOfCare?null:t.planOfCare.providerPlanOfCare,a.Mc),a.Db(1),a.rc("nzGutter",a.xc(44,A)),a.Db(5),a.rc("innerHTML",null==t.planOfCare?null:t.planOfCare.nursingInterventions,a.Mc),a.Db(1),a.rc("nzGutter",a.xc(45,A)),a.Db(5),a.rc("innerHTML",null==t.planOfCare?null:t.planOfCare.nursingEducation,a.Mc),a.Db(1),a.rc("nzGutter",a.xc(46,A)),a.Db(5),a.rc("innerHTML",null==t.planOfCare?null:t.planOfCare.goals,a.Mc)}},directives:[b.a,p.s,p.t,u.a,h.a,g.d,g.b,f.a,g.e,v.c,v.e,m.a,C.a,D.c,D.a,p.p,S.a],pipes:[p.A,E.a],styles:["h4[_ngcontent-%COMP%]{margin-bottom:15px}label[_ngcontent-%COMP%], span[_ngcontent-%COMP%]{display:block}strong[_ngcontent-%COMP%]{font-weight:700}app-icons[_ngcontent-%COMP%]{vertical-align:sub}[_nghost-%COMP%]     *{text-align:justify}"]}),e})()},"d+1G":function(e,t,n){"use strict";n.d(t,"d",function(){return s}),n.d(t,"c",function(){return a}),n.d(t,"a",function(){return o}),n.d(t,"b",function(){return l});var i=n("ua0i");const s=[{id:"99453",name:"RPM - Device Setup",description:"Remote monitoring of physiologic parameter(s) (eg, weight, blood pressure, pulse oximetry, respiratory flow rate), initial; set-up and patient education on use of equipment",billRate:21,selected:!0,type:i.a.RPM},{id:"99454",name:"RPM - Vital Signs Monitoring",description:"Remote monitoring of physiologic parameter(s) (eg, weight, blood pressure, pulse oximetry, respiratory flow rate), initial; device(s) supply with daily recording(s) or programmed alert(s) transmission, each 30 days",billRate:69,selected:!0,type:i.a.RPM},{id:"99457",name:"RPM - TMS Time",description:"Remote physiologic monitoring treatment management services, 20 minutes or more of clinical staff/physician/other qualified healthcare professional time in a calendar month requiring interactive communication with the patient/caregiver during the month",billRate:54,selected:!0,type:i.a.RPM},{id:"99458",name:"RPM - Additional TMS - A Time",description:"Remote physiologic monitoring treatment management services, 20 minutes or more of clinical staff/physician/other qualified healthcare professional time in a calendar month requiring interactive communication with the patient/caregiver during the month",billRate:39,selected:!0,type:i.a.RPM},{id:"99458B",name:"RPM - Additional TMS - B Time",description:"Once TMS 40 is completed, there is an additional option to record up to 20 minutes more of clinical staff/physician/other qualified healthcare professional time in a calendar month requiring interactive communication with the patient/caregiver during the month.",billRate:40,selected:!0,type:i.a.RPM},{id:"99484",name:"BHI - Patient Interaction",description:"Systematic assessment and monitoring, using applicable validated clinical rating scales",billRate:50,selected:!0,type:i.a.BHI},{id:"99490",name:"CCM - Non-complex 20 min",description:"Non-complex CCM is a 20-minute timed service provided by clinical staff to coordinate care across providers and support patient accountability.",billRate:50,selected:!0,type:i.a.CCM},{id:"99491",name:"CCM - 30 mins",description:"CCM services provided personally by a physician or other qualified health care professional for at least 30 minutes.",billRate:50,selected:!0,type:i.a.CCM},{id:"99439",name:"CCM - Additional Non-complex A 20 mins",description:"Each additional 20 minutes of clinical staff time spent providing non-complex CCM directed by a physician or other qualified health care professional",billRate:50,selected:!0,type:i.a.CCM},{id:"99439B",name:"CCM - Additional Non-complex B 20 mins",description:"Each additional 20 minutes of clinical staff time spent providing non-complex CCM directed by a physician or other qualified health care professional",billRate:50,selected:!0,type:i.a.CCM},{id:"99487",name:"CCM - Complex 60 mins",description:"Complex CCM is a 60-minute timed service provided by clinical staff to substantially revise or establish comprehensive care plan that involves moderate- to high-complexity medical decision making.",billRate:50,selected:!0,type:i.a.CCM},{id:"99489",name:"CCM - Additional Complex 30 mins",description:"99489 is each additional 30 minutes of clinical staff time spent providing complex CCM directed by a physician or other qualified health care professional",billRate:50,selected:!0,type:i.a.CCM}],a=()=>s.filter(e=>i.a.RPM===e.type),o=()=>s.filter(e=>i.a.BHI===e.type),l=()=>s.filter(e=>i.a.CCM===e.type)},"gDH+":function(e,t,n){"use strict";n.d(t,"a",function(){return T});var i=n("N+jK"),s=n("WoUL"),a=n("oYoK"),o=n("fXoL"),l=n("dEAy"),r=n("bNXi"),c=n("zAKX"),d=n("3Pt+"),b=n("ofXK"),p=n("PTRe"),u=n("OzZK"),h=n("RwU8"),g=n("C2AL"),f=n("eHCX");function v(e,t){1&e&&(o.Xb(0,"h4"),o.Xc(1,"IMEI*"),o.Wb())}function m(e,t){1&e&&(o.Xb(0,"h4"),o.Xc(1,"Serial No*"),o.Wb())}function C(e,t){1&e&&(o.Xb(0,"h4"),o.Xc(1,"Device ID*"),o.Wb())}function D(e,t){1&e&&(o.Xb(0,"label",15),o.Xc(1,"Required"),o.Wb())}function S(e,t){1&e&&(o.Xb(0,"span"),o.Xc(1,"IMEI number should be 15 digits"),o.Wb())}function E(e,t){1&e&&(o.Xb(0,"span"),o.Xc(1,"Serial number should be 8 digits"),o.Wb())}function O(e,t){1&e&&(o.Xb(0,"span"),o.Xc(1,"Device ID should be 7 digits"),o.Wb())}function I(e,t){if(1&e&&(o.Xb(0,"label",15),o.Vc(1,S,2,0,"span",11),o.Vc(2,E,2,0,"span",11),o.Vc(3,O,2,0,"span",11),o.Wb()),2&e){const e=o.ic();o.Db(1),o.rc("ngIf","BGMD1"!==e.type&&"GM291V"!==e.type),o.Db(1),o.rc("ngIf","BGMD1"===e.type),o.Db(1),o.rc("ngIf","GM291V"===e.type)}}const _=function(e){return{border:e}};let X=(()=>{class e{constructor(e,t,n,i,s){this._devicesService=e,this._modalRef=t,this._translationService=n,this._notificationsService=i,this._devicesEventLogger=s,this.type="SM5000IB"}ngOnInit(){this.$translationSubscription=this._translationService.getMultiple("DEVICE.DEVICE_ADDITION_TITLE","DEVICE.DEVICE_INVALID_IMEI","DEVICE.DEVICE_ADDITION_SUCCESS_TITLE","DEVICE.DEVICE_ADDITION_SUCCESS_MESSAGE","DEVICE.DEVICE_ADDITION_FAILED_TITLE","DEVICE.DEVICE_ADDITION_DUPLICATE_MESSAGE","DEVICE.DEVICE_ADDITION_DUPLICATE_MESSAGE_FOR_PATIENT").subscribe(e=>{this.translatedStrings=e})}ngOnDestroy(){var e;null===(e=this.$translationSubscription)||void 0===e||e.unsubscribe()}validateIMEI(){return this.onImeiChange(),!this.emptyInput&&!this.invalidImei}save(){this.validateIMEI()&&this._devicesService.assignDeviceToPatient(this.type,this.imei,this.userId).subscribe(e=>{this._notificationsService.success(this.translatedStrings.get("DEVICE.DEVICE_ADDITION_SUCCESS_TITLE"),this.translatedStrings.get("DEVICE.DEVICE_ADDITION_SUCCESS_MESSAGE")),this._devicesEventLogger.devicesActionEvent(this.userId,this.imei,"add_device_for_patient"),this._modalRef.close(e)},e=>{const t=e.error;if("DUPLICATE_DEVICE_IMEI"==t.type){let e=this.translatedStrings.get((null==t?void 0:t.parameters.PATIENT_NAME)?"DEVICE.DEVICE_ADDITION_DUPLICATE_MESSAGE_FOR_PATIENT":"DEVICE.DEVICE_ADDITION_DUPLICATE_MESSAGE");e=null==e?void 0:e.replace("{PATIENT_NAME}",null==t?void 0:t.parameters.PATIENT_NAME),this._notificationsService.error(this.translatedStrings.get("DEVICE.DEVICE_ADDITION_FAILED_TITLE"),e),this._modalRef.close()}})}onImeiChange(){var e,t,n,i,s,a,o,l,r;this.emptyInput=!(null===(e=this.imei)||void 0===e?void 0:e.length),this.invalidImei="BGMD1"===this.type?8!==(null===(n=null===(t=this.imei.replace(/\s/g,""))||void 0===t?void 0:t.trim())||void 0===n?void 0:n.length):"GM291V"===this.type?7!==(null===(s=null===(i=this.imei.replace(/\s/g,""))||void 0===i?void 0:i.trim())||void 0===s?void 0:s.length):15!==(null===(o=null===(a=this.imei.replace(/\s/g,""))||void 0===a?void 0:a.trim())||void 0===o?void 0:o.length),this.imei=null===(r=null===(l=this.imei)||void 0===l?void 0:l.replace(/\s/g,""))||void 0===r?void 0:r.toUpperCase()}}return e.\u0275fac=function(t){return new(t||e)(o.Rb(i.a),o.Rb(l.e),o.Rb(s.a),o.Rb(r.b),o.Rb(a.a))},e.\u0275cmp=o.Lb({type:e,selectors:[["app-bt105-create-form"]],inputs:{userId:"userId"},decls:26,vars:11,consts:[[1,"container"],[3,"ngModel","ngModelChange"],["nzValue","SM5000IB","nzLabel","SmartMeter Blood Pressure Monitor"],["nzValue","SMCLBS","nzLabel","SmartMeter Weighing Scale"],["nzValue","SMCOX","nzLabel","SmartMeter SPO2 Monitor"],["nzValue","GM291V","nzLabel","SmartMeter BG Monitor"],["nzValue","BT105","nzLabel","Body Trace Blood Pressure Monitor"],["nzValue","BT005","nzLabel","Body Trace Weighing Scale"],["nzValue","PY802LTE","nzLabel","Pylo Blood Pressure Monitor"],["nzValue","PY300LTE","nzLabel","Pylo Weighing Scale"],["nzValue","BGMD1","nzLabel","Biotel-Blood Glucose Monitor"],[4,"ngIf"],["nz-input","",3,"placeholder","ngModel","ngStyle","ngModelChange"],["nz-typography","","nzType","danger",4,"ngIf"],["id","save","nz-button","","nzType","primary","nzSize","large",3,"click"],["nz-typography","","nzType","danger"]],template:function(e,t){1&e&&(o.Xb(0,"div",0),o.Xb(1,"h3"),o.Xc(2,"Add a device"),o.Wb(),o.Xb(3,"h4"),o.Xc(4,"Choose Device"),o.Wb(),o.Xb(5,"nz-select",1),o.ec("ngModelChange",function(e){return t.type=e}),o.Sb(6,"nz-option",2),o.Sb(7,"nz-option",3),o.Sb(8,"nz-option",4),o.Sb(9,"nz-option",5),o.Sb(10,"nz-option",6),o.Sb(11,"nz-option",7),o.Sb(12,"nz-option",8),o.Sb(13,"nz-option",9),o.Sb(14,"nz-option",10),o.Wb(),o.Sb(15,"br"),o.Sb(16,"br"),o.Vb(17),o.Vc(18,v,2,0,"h4",11),o.Vc(19,m,2,0,"h4",11),o.Vc(20,C,2,0,"h4",11),o.Ub(),o.Xb(21,"input",12),o.ec("ngModelChange",function(e){return t.imei=e})("ngModelChange",function(){return t.onImeiChange()}),o.Wb(),o.Vc(22,D,2,0,"label",13),o.Vc(23,I,4,3,"label",13),o.Xb(24,"button",14),o.ec("click",function(){return t.save()}),o.Xc(25,"Save"),o.Wb(),o.Wb()),2&e&&(o.Db(5),o.rc("ngModel",t.type),o.Db(13),o.rc("ngIf","BGMD1"!==t.type&&"GM291V"!==t.type),o.Db(1),o.rc("ngIf","BGMD1"===t.type),o.Db(1),o.rc("ngIf","GM291V"===t.type),o.Db(1),o.rc("placeholder","BGMD1"===t.type?"Serial No.":"GM291V"===t.type?"Device ID":"IMEI")("ngModel",t.imei)("ngStyle",o.yc(9,_,t.emptyInput||t.invalidImei?"1px solid red":"")),o.Db(1),o.rc("ngIf",t.emptyInput),o.Db(1),o.rc("ngIf",t.invalidImei))},directives:[c.d,d.u,d.x,c.a,b.q,p.b,d.d,b.r,u.a,h.a,g.a,f.a],styles:["h3[_ngcontent-%COMP%]{font:normal normal 700 15px/23px Nunito;letter-spacing:-.38px;color:#2b2b2b}h4[_ngcontent-%COMP%]{font:normal normal normal 12px/16px Nunito;color:var(--tertiary-color)}[_nghost-%COMP%]     .ant-btn{width:75%;display:block;margin:auto}label[_ngcontent-%COMP%]{display:block;margin-top:10px}#save[_ngcontent-%COMP%]{margin-top:15px}"]}),e})(),T=(()=>{class e{constructor(e){this.modalService=e}showModal(e){return this.modalService.create({nzContent:X,nzComponentParams:{userId:e},nzWidth:"350px",nzFooter:null})}}return e.\u0275fac=function(t){return new(t||e)(o.bc(l.f))},e.\u0275prov=o.Nb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},"iD/K":function(e,t,n){"use strict";n.d(t,"a",function(){return i});const i=[{label:"Problem",type:"PROBLEM"},{label:"Coordination of Care",type:"CARE_COORDINATION"},{label:"Appointment Request",type:"APPOINTMENT_REQUEST"},{label:"Medication Management",type:"MEDICATION_MANAGEMENT"},{label:"Patient Support/Education",type:"PATIENT_SUPPORT"},{label:"Preventive Care",type:"PREVENTIVE_CARE"},{label:"Report of new signs and symptoms",type:"NEW_SYMPTOMS_REPORTING"}]},s3hQ:function(e,t,n){"use strict";n.d(t,"a",function(){return _});var i=n("3Pt+"),s=n("+gyu"),a=n("1YrE"),o=n("c36b"),l=n("fXoL"),r=n("dEAy"),c=n("bNXi"),d=n("5iDH"),b=n("ocnv"),p=n("B+r4"),u=n("eHCX"),h=n("bE2y"),g=n("Nqz0"),f=n("C2AL"),v=n("FwiY"),m=n("mUB+"),C=n("TaO5"),D=n("OzZK"),S=n("RwU8"),E=n("Q8cG"),O=n("ofXK");function I(e,t){if(1&e){const e=l.Yb();l.Xb(0,"li",20),l.ec("click",function(){l.Lc(e);const n=t.$implicit;return l.ic().setNoteTemplate(null==n?null:n.template)}),l.Xc(1),l.Wb()}if(2&e){const e=t.$implicit;l.Db(1),l.Zc(" ",null==e?null:e.title," ")}}let _=(()=>{class e{constructor(e,t,n,i,s){this.fb=e,this._modalRef=t,this._planOfCareService=n,this._noteTemplatesService=i,this._notificationsService=s,this.config=JSON.parse(JSON.stringify(o.b)),this.config.height="10rem"}ngOnInit(){this.initializeForm(),this.getNoteTemplates()}getNoteTemplates(){this._noteTemplatesService.fetchNoteTemplates(0,1e4).subscribe(e=>this.noteTemplates=null==e?void 0:e.content)}initializeForm(){var e,t,n,s,a,o,l,r,c,d,b,p,u,h,g,f;this.form=this.fb.group({priority:(null===(s=null===(e=this.planOfCare)||void 0===e?void 0:e.events[(null===(n=null===(t=this.planOfCare)||void 0===t?void 0:t.events)||void 0===n?void 0:n.length)-1])||void 0===s?void 0:s.priority)?null===(r=null===(a=this.planOfCare)||void 0===a?void 0:a.events[(null===(l=null===(o=this.planOfCare)||void 0===o?void 0:o.events)||void 0===l?void 0:l.length)-1])||void 0===r?void 0:r.priority:["LOW",[i.D.required]],note:[null,[]],outcome:"NEW"!=(null===(p=null===(c=this.planOfCare)||void 0===c?void 0:c.events[(null===(b=null===(d=this.planOfCare)||void 0===d?void 0:d.events)||void 0===b?void 0:b.length)-1])||void 0===p?void 0:p.outcome)?null===(f=null===(u=this.planOfCare)||void 0===u?void 0:u.events[(null===(g=null===(h=this.planOfCare)||void 0===h?void 0:h.events)||void 0===g?void 0:g.length)-1])||void 0===f?void 0:f.outcome:["ONGOING",[i.D.required]],medicalSupport:[null,[]],erVisit:[null,[]],practiceVisit:[null,[]]})}setNoteTemplate(e){var t,n;null===(n=null===(t=this.form)||void 0===t?void 0:t.controls.note)||void 0===n||n.setValue(e)}validateForm(){for(const e in this.form.controls)this.form.controls[e].markAsDirty(),this.form.controls[e].updateValueAndValidity()}submit(){var e,t,n,i,s,a,o,l,r;const c={};null!==(null===(e=this.form)||void 0===e?void 0:e.value.medicalSupport)&&(c.MEDICAL_DECISION_SUPPORT=null===(t=this.form)||void 0===t?void 0:t.value.medicalSupport),null!==(null===(n=this.form)||void 0===n?void 0:n.value.erVisit)&&(c.ER_VISIT=null===(i=this.form)||void 0===i?void 0:i.value.erVisit),null!==(null===(s=this.form)||void 0===s?void 0:s.value.practiceVisit)&&(c.PRACTICE_VISIT=null===(a=this.form)||void 0===a?void 0:a.value.practiceVisit);const d={priority:null===(o=this.form)||void 0===o?void 0:o.value.priority,note:null===(l=this.form)||void 0===l?void 0:l.value.note,outcome:null===(r=this.form)||void 0===r?void 0:r.value.outcome,checklist:c};this._planOfCareService.savePlanOfCareEvent(this.planOfCareId,d).subscribe(()=>{this._notificationsService.success("Plan Of Care Event","Event logged successfully!"),this._modalRef.close(!0)})}}return e.\u0275fac=function(t){return new(t||e)(l.Rb(i.h),l.Rb(r.e),l.Rb(a.a),l.Rb(s.a),l.Rb(c.b))},e.\u0275cmp=l.Lb({type:e,selectors:[["app-event-form"]],inputs:{planOfCareId:"planOfCareId",planOfCare:"planOfCare"},decls:69,vars:16,consts:[[1,"container"],["appScrollToFirstInvalid","","nz-form","",3,"formGroup","ngSubmit"],["nzErrorTip","Please select a priority!"],[1,"priority"],["nz-typography","","nzType","danger"],["formControlName","priority"],["nz-radio","",3,"nzValue"],["nz-dropdown","",3,"nzDropdownMenu"],["nz-icon","","nzType","down"],["id","note","placeholder","Enter note here...","formControlName","note",3,"config"],["nz-checkbox","","formControlName","medicalSupport"],[1,"checklist"],["formControlName","erVisit"],["formControlName","practiceVisit"],["nzErrorTip","Please choose an outcome!"],["formControlName","outcome"],["nz-button","","nzType","primary",3,"disabled"],["templateMenu","nzDropdownMenu"],["nz-menu",""],["nz-menu-item","",3,"click",4,"ngFor","ngForOf"],["nz-menu-item","",3,"click"]],template:function(e,t){if(1&e&&(l.Xb(0,"div",0),l.Xb(1,"form",1),l.ec("ngSubmit",function(){return t.submit()}),l.Xb(2,"nz-form-item"),l.Xb(3,"nz-form-control",2),l.Xb(4,"strong",3),l.Xc(5,"Priority "),l.Xb(6,"span",4),l.Xc(7,"*"),l.Wb(),l.Wb(),l.Xb(8,"nz-radio-group",5),l.Xb(9,"label",6),l.Xc(10,"Low"),l.Wb(),l.Xb(11,"label",6),l.Xc(12,"Medium"),l.Wb(),l.Xb(13,"label",6),l.Xc(14,"High"),l.Wb(),l.Wb(),l.Wb(),l.Wb(),l.Xb(15,"nz-form-item"),l.Xb(16,"nz-form-control"),l.Xb(17,"strong"),l.Xc(18," Note (Optional) \xa0 "),l.Xb(19,"a",7),l.Xc(20," Template "),l.Sb(21,"em",8),l.Wb(),l.Wb(),l.Sb(22,"angular-editor",9),l.Wb(),l.Wb(),l.Xb(23,"nz-form-item"),l.Xb(24,"nz-form-control"),l.Xb(25,"label",10),l.Xb(26,"strong"),l.Xc(27,"Received Medical Decision Making Support (Optional)"),l.Wb(),l.Wb(),l.Wb(),l.Wb(),l.Xb(28,"nz-form-item"),l.Xb(29,"nz-form-control"),l.Xb(30,"strong",11),l.Xc(31,"ER or Hospital visit was (Optional)"),l.Wb(),l.Xb(32,"nz-radio-group",12),l.Xb(33,"label",6),l.Xc(34,"Prevented"),l.Wb(),l.Xb(35,"label",6),l.Xc(36,"Resulted"),l.Wb(),l.Wb(),l.Wb(),l.Wb(),l.Xb(37,"nz-form-item"),l.Xb(38,"nz-form-control"),l.Xb(39,"strong",11),l.Xc(40,"Practice visit was (Optional)"),l.Wb(),l.Xb(41,"nz-radio-group",13),l.Xb(42,"label",6),l.Xc(43,"Prevented"),l.Wb(),l.Xb(44,"label",6),l.Xc(45,"Resulted"),l.Wb(),l.Wb(),l.Wb(),l.Wb(),l.Xb(46,"nz-form-item"),l.Xb(47,"nz-form-control",14),l.Xb(48,"strong",11),l.Xc(49,"Outcome "),l.Xb(50,"span",4),l.Xc(51,"*"),l.Wb(),l.Wb(),l.Xb(52,"nz-radio-group",15),l.Xb(53,"label",6),l.Xc(54,"Ongoing"),l.Wb(),l.Xb(55,"label",6),l.Xc(56,"Improved"),l.Wb(),l.Xb(57,"label",6),l.Xc(58,"Worsening"),l.Wb(),l.Xb(59,"label",6),l.Xc(60,"Resolved"),l.Wb(),l.Wb(),l.Wb(),l.Wb(),l.Xb(61,"nz-form-item"),l.Xb(62,"nz-form-control"),l.Xb(63,"button",16),l.Xc(64,"Save"),l.Wb(),l.Wb(),l.Wb(),l.Wb(),l.Wb(),l.Xb(65,"nz-dropdown-menu",null,17),l.Xb(67,"ul",18),l.Vc(68,I,2,1,"li",19),l.Wb(),l.Wb()),2&e){const e=l.Ic(66);l.Db(1),l.rc("formGroup",t.form),l.Db(8),l.rc("nzValue","LOW"),l.Db(2),l.rc("nzValue","MEDIUM"),l.Db(2),l.rc("nzValue","HIGH"),l.Db(6),l.rc("nzDropdownMenu",e),l.Db(3),l.rc("config",t.config),l.Db(11),l.rc("nzValue",!1),l.Db(2),l.rc("nzValue",!0),l.Db(7),l.rc("nzValue",!1),l.Db(2),l.rc("nzValue",!0),l.Db(9),l.rc("nzValue","ONGOING"),l.Db(2),l.rc("nzValue","IMPROVED"),l.Db(2),l.rc("nzValue","WORSENING"),l.Db(2),l.rc("nzValue","RESOLVED"),l.Db(4),l.rc("disabled",!t.form.valid),l.Db(5),l.rc("ngForOf",t.noteTemplates)}},directives:[i.F,i.v,d.a,b.b,i.m,p.c,b.c,p.a,b.a,u.a,h.c,i.u,i.k,h.b,g.a,g.b,f.a,v.a,m.a,C.a,D.a,S.a,g.e,E.c,O.p,E.e],styles:[".priority[_ngcontent-%COMP%]{width:15%;display:inline-block}.checklist[_ngcontent-%COMP%]{width:40%;display:inline-block}a[_ngcontent-%COMP%]{font-weight:100}[_nghost-%COMP%]     .angular-editor-textarea{border-radius:5px}button[_ngcontent-%COMP%]{width:300px;display:block;margin:auto}"]}),e})()},ttvE:function(e,t,n){"use strict";n.r(t),n.d(t,"EpisodesModule",function(){return Pc});var i=n("bKRa"),s=n("ofXK"),a=n("1YrE"),o=n("+gyu"),l=n("2lmJ"),r=n("iD/K"),c=n("3Pt+"),d=n("nLCl"),b=n("c36b"),p=n("geco"),u=n("ighe"),h=n("qQcL"),g=n("pLZG"),f=n("1G5W"),v=n("4RGM"),m=n("fXoL"),C=n("tyNb"),D=n("bNXi"),S=n("Nqz0"),E=n("Q8cG"),O=n("B+r4"),I=n("JA5x"),_=n("5iDH"),X=n("ocnv"),T=n("eHCX"),N=n("PTRe"),z=n("zAKX"),M=n("bE2y"),y=n("5vDB"),A=n("C2AL"),P=n("FwiY"),W=n("mUB+");function R(e,t){if(1&e&&(m.Vb(0),m.Sb(1,"nz-option",34),m.Ub()),2&e){const e=t.$implicit;m.Db(1),m.rc("nzLabel",null==e?null:e.label)("nzValue",null==e?null:e.type)}}function w(e,t){if(1&e&&(m.Vb(0),m.Sb(1,"nz-option",34),m.Ub()),2&e){const e=t.$implicit;m.Db(1),m.rc("nzLabel",null==e?null:e.fullName)("nzValue",null==e?null:e.id)}}function L(e,t){if(1&e&&(m.Vb(0),m.Sb(1,"nz-option",34),m.Ub()),2&e){const e=t.$implicit;m.Db(1),m.rc("nzLabel",e)("nzValue",e)}}function x(e,t){if(1&e){const e=m.Yb();m.Xb(0,"div",7),m.Xb(1,"div",8),m.Xb(2,"div",9),m.Xb(3,"nz-card",10),m.Xb(4,"form",11),m.ec("ngSubmit",function(){return m.Lc(e),m.ic().submit()}),m.Xb(5,"nz-form-item"),m.Xb(6,"nz-form-control",12),m.Xb(7,"strong"),m.Xc(8,"Title "),m.Xb(9,"span",13),m.Xc(10,"*"),m.Wb(),m.Wb(),m.Sb(11,"input",14),m.Wb(),m.Wb(),m.Xb(12,"div",15),m.Xb(13,"div",16),m.Xb(14,"nz-form-item"),m.Xb(15,"nz-form-control",17),m.Xb(16,"strong"),m.Xc(17,"Category "),m.Xb(18,"span",13),m.Xc(19,"*"),m.Wb(),m.Wb(),m.Xb(20,"nz-select",18),m.Vc(21,R,2,2,"ng-container",19),m.Wb(),m.Wb(),m.Wb(),m.Wb(),m.Xb(22,"div",16),m.Xb(23,"nz-form-item"),m.Xb(24,"nz-form-control",20),m.Xb(25,"strong"),m.Xc(26,"Provider "),m.Xb(27,"span",13),m.Xc(28,"*"),m.Wb(),m.Wb(),m.Xb(29,"nz-select",21),m.Vc(30,w,2,2,"ng-container",19),m.Wb(),m.Wb(),m.Wb(),m.Wb(),m.Wb(),m.Xb(31,"div",15),m.Xb(32,"div",22),m.Xb(33,"nz-form-item"),m.Xb(34,"nz-form-control"),m.Xb(35,"strong"),m.Xc(36,"Diagnosis (Optional)"),m.Wb(),m.Xb(37,"nz-select",23),m.Vc(38,L,2,2,"ng-container",19),m.Wb(),m.Wb(),m.Wb(),m.Wb(),m.Xb(39,"div",24),m.Xb(40,"nz-form-item"),m.Xb(41,"nz-form-control"),m.Xb(42,"strong"),m.Xc(43,"\xa0"),m.Wb(),m.Xb(44,"nz-radio-group",25),m.Xb(45,"label",26),m.Xc(46," Low "),m.Wb(),m.Xb(47,"label",26),m.Xc(48," Medium "),m.Wb(),m.Xb(49,"label",26),m.Xc(50," High "),m.Wb(),m.Wb(),m.Wb(),m.Wb(),m.Wb(),m.Wb(),m.Sb(51,"nz-divider"),m.Xb(52,"nz-form-item"),m.Xb(53,"nz-form-control",27),m.Xb(54,"strong"),m.Xc(55," Provider Plan Of Care From EMR "),m.Xb(56,"span",13),m.Xc(57,"*"),m.Wb(),m.Xc(58," \xa0 "),m.Xb(59,"a",28),m.Xc(60," Template "),m.Sb(61,"em",29),m.Wb(),m.Wb(),m.Sb(62,"angular-editor",30),m.Wb(),m.Wb(),m.Sb(63,"br"),m.Xb(64,"nz-form-item"),m.Xb(65,"nz-form-control"),m.Xb(66,"strong"),m.Xc(67," Nursing Interventions \xa0 "),m.Xb(68,"a",28),m.Xc(69," Template "),m.Sb(70,"em",29),m.Wb(),m.Wb(),m.Sb(71,"angular-editor",31),m.Wb(),m.Wb(),m.Sb(72,"br"),m.Xb(73,"nz-form-item"),m.Xb(74,"nz-form-control"),m.Xb(75,"strong"),m.Xc(76," Nursing Education \xa0 "),m.Xb(77,"a",28),m.Xc(78," Template "),m.Sb(79,"em",29),m.Wb(),m.Wb(),m.Sb(80,"angular-editor",32),m.Wb(),m.Wb(),m.Sb(81,"br"),m.Xb(82,"nz-form-item"),m.Xb(83,"nz-form-control"),m.Xb(84,"strong"),m.Xc(85," Goals \xa0 "),m.Xb(86,"a",28),m.Xc(87," Template "),m.Sb(88,"em",29),m.Wb(),m.Wb(),m.Sb(89,"angular-editor",33),m.Wb(),m.Wb(),m.Wb(),m.Wb(),m.Wb(),m.Wb(),m.Wb()}if(2&e){const e=m.ic(),t=m.Ic(2),n=m.Ic(6),i=m.Ic(10),s=m.Ic(14);m.Db(4),m.rc("formGroup",e.form),m.Db(17),m.rc("ngForOf",e.planOfCareCategories),m.Db(8),m.rc("nzDisabled",!0),m.Db(1),m.rc("ngForOf",e.providers),m.Db(8),m.rc("ngForOf",null==e.episodeDetails?null:e.episodeDetails.icdCodes),m.Db(7),m.rc("nzValue","LOW"),m.Db(2),m.rc("nzValue","MEDIUM"),m.Db(2),m.rc("nzValue","HIGH"),m.Db(10),m.rc("nzDropdownMenu",t),m.Db(3),m.rc("config",e.config),m.Db(6),m.rc("nzDropdownMenu",n),m.Db(3),m.rc("config",e.config),m.Db(6),m.rc("nzDropdownMenu",i),m.Db(3),m.rc("config",e.config),m.Db(6),m.rc("nzDropdownMenu",s),m.Db(3),m.rc("config",e.config)}}function k(e,t){if(1&e){const e=m.Yb();m.Xb(0,"li",35),m.ec("click",function(){m.Lc(e);const n=t.$implicit;return m.ic().setNoteTemplate("providerPlanOfCare",null==n?null:n.template)}),m.Xc(1),m.Wb()}if(2&e){const e=t.$implicit;m.Db(1),m.Yc(null==e?null:e.title)}}function V(e,t){if(1&e){const e=m.Yb();m.Xb(0,"li",35),m.ec("click",function(){m.Lc(e);const n=t.$implicit;return m.ic().setNoteTemplate("nursingInterventions",null==n?null:n.template)}),m.Xc(1),m.Wb()}if(2&e){const e=t.$implicit;m.Db(1),m.Yc(null==e?null:e.title)}}function U(e,t){if(1&e){const e=m.Yb();m.Xb(0,"li",35),m.ec("click",function(){m.Lc(e);const n=t.$implicit;return m.ic().setNoteTemplate("nursingEducation",null==n?null:n.template)}),m.Xc(1),m.Wb()}if(2&e){const e=t.$implicit;m.Db(1),m.Yc(null==e?null:e.title)}}function F(e,t){if(1&e){const e=m.Yb();m.Xb(0,"li",35),m.ec("click",function(){m.Lc(e);const n=t.$implicit;return m.ic().setNoteTemplate("goals",null==n?null:n.template)}),m.Xc(1),m.Wb()}if(2&e){const e=t.$implicit;m.Db(1),m.Zc(" ",null==e?null:e.title," ")}}let j=(()=>{class e extends h.a{constructor(e,t,n,i,s,a,o,l,c){super(),this.fb=e,this._location=t,this._staffService=n,this._activatedRoute=i,this._episodesService=s,this._patientsService=a,this._planOfCareService=o,this._noteTemplatesService=l,this._notificationsService=c,this.planOfCareCategories=r.a,this.config=b.b,this._routeHelperService.isPrimaryActionTriggered().pipe(Object(g.a)(e=>!!e),Object(f.a)(this.unsubscribed)).subscribe(()=>{var e;(null===(e=this.form)||void 0===e?void 0:e.valid)?this.submit():this.validateForm()})}ngAfterViewInit(){this._activatedRoute.snapshot.params.planOfCareId?(this.getPlanOfCareById(),this.mode="EDIT"):(this.initializeForm(),this.mode="ADD"),this.getUserDetails(),this.getEpisodeData()}getPlanOfCareById(){this._planOfCareService.fetchPlanOfCareById(this._activatedRoute.snapshot.params.planOfCareId).subscribe(e=>{this.planOfCare=e,this.initializeForm(this.planOfCare)})}getUserDetails(){this._patientsService.fetchPatientById(this._activatedRoute.snapshot.params.patientId).subscribe(e=>{this.patient=e,this.subTenantId=e.tenantId,this.getProviders(),this.getNoteTemplates(e.tenantId)})}getEpisodeData(){this._episodesService.fetchEpisodeDetails(this._activatedRoute.snapshot.params.episodeId).subscribe(e=>{this.episodeDetails=e})}initializeForm(e={}){this.form=this.fb.group({title:[null==e?void 0:e.title,[c.D.required]],category:[(null==e?void 0:e.category)||"PROBLEM",[c.D.required]],priority:[(null==e?void 0:e.priority)||"LOW",[c.D.required]],icdCodes:[null==e?void 0:e.icdCodes,[]],provider:[null==e?void 0:e.provider,[c.D.required]],providerPlanOfCare:[null==e?void 0:e.providerPlanOfCare,[c.D.required]],nursingInterventions:[null==e?void 0:e.nursingInterventions,[]],nursingEducation:[null==e?void 0:e.nursingEducation,[]],goals:[null==e?void 0:e.goals,[]]})}getProviders(){this._staffService.fetchAssignableStaffMembersById(this._activatedRoute.snapshot.params.patientId,d.a.PHYSICIAN).subscribe(e=>{var t,n,i,s;this.providers=e;const a=null==e?void 0:e.filter(e=>{var t,n;return-1!==(null===(n=null===(t=this.patient)||void 0===t?void 0:t.assignedStaffIds)||void 0===n?void 0:n.findIndex(t=>t===(null==e?void 0:e.id)))});null===(i=null===(n=null===(t=this.form)||void 0===t?void 0:t.controls)||void 0===n?void 0:n.provider)||void 0===i||i.setValue(null===(s=a[0])||void 0===s?void 0:s.id)})}getNoteTemplates(e){this._noteTemplatesService.fetchNoteTemplates(0,1e4,null,e).subscribe(e=>this.noteTemplates=null==e?void 0:e.content)}setNoteTemplate(e,t){var n,i;null===(i=null===(n=this.form)||void 0===n?void 0:n.controls[e])||void 0===i||i.setValue(t)}validateForm(){for(const e in this.form.controls)this.form.controls[e].markAsDirty(),this.form.controls[e].updateValueAndValidity();this.valid=!(null==this.subTenantId||null==this.subTenantId),this.showToggleError=!this.valid}onSubTenantChange(e){"object"==typeof e&&""!=e&&null!=e&&null!=e?(localStorage.setItem(v.a.REQUEST_TENANT_IDS,e),this.subTenantId=e,this.showToggleError=!1):(this.subTenantId=null,this.showToggleError=!0)}submit(){var e;if(this.validateForm(),!this.valid)return;let t;(null===(e=this.planOfCare)||void 0===e?void 0:e.id)?t=this.updatePlanOfCareRequestObject(JSON.parse(JSON.stringify(this.form.value))):(t=this.createPlanOfCareRequestObject(JSON.parse(JSON.stringify(this.form.value))),t.tenantId=this.subTenantId),this._planOfCareService.savePlanOfCare(t).subscribe(()=>{this._notificationsService.success("Plan of Care","Provider's plan of care saved successfully!"),this._location.back()})}createPlanOfCareRequestObject(e){const t={priority:e.priority,note:"New plan of care added",outcome:"NEW",checklist:new Map,createdBy:localStorage.getItem("loggedInUser")};return e.episodeId=this._activatedRoute.snapshot.params.episodeId,e.patientId=this._activatedRoute.snapshot.params.patientId,e.createdBy=localStorage.getItem("loggedInUser"),e.events=[t],e}updatePlanOfCareRequestObject(e){return this.planOfCare.title=null==e?void 0:e.title,this.planOfCare.category=null==e?void 0:e.category,this.planOfCare.provider=null==e?void 0:e.provider,this.planOfCare.icdCodes=null==e?void 0:e.icdCodes,this.planOfCare.priority=null==e?void 0:e.priority,this.planOfCare.providerPlanOfCare=null==e?void 0:e.providerPlanOfCare,this.planOfCare.nursingInterventions=null==e?void 0:e.nursingInterventions,this.planOfCare.nursingEducation=null==e?void 0:e.nursingEducation,this.planOfCare.goals=null==e?void 0:e.goals,this.planOfCare}}return e.\u0275fac=function(t){return new(t||e)(m.Rb(c.h),m.Rb(s.l),m.Rb(l.a),m.Rb(C.a),m.Rb(u.a),m.Rb(p.a),m.Rb(a.a),m.Rb(o.a),m.Rb(D.b))},e.\u0275cmp=m.Lb({type:e,selectors:[["app-plan-of-care-form"]],features:[m.Ab],decls:17,vars:5,consts:[["class","container",4,"ngIf"],["templateMenu1","nzDropdownMenu"],["nz-menu",""],["nz-menu-item","",3,"click",4,"ngFor","ngForOf"],["templateMenu2","nzDropdownMenu"],["templateMenu3","nzDropdownMenu"],["templateMenu4","nzDropdownMenu"],[1,"container"],["nz-row",""],["nz-col","","nzSpan","18"],["nzBorderless",""],["appScrollToFirstInvalid","","nz-form","",3,"formGroup","ngSubmit"],["nzErrorTip","Please enter a title!"],["nz-typography","","nzType","danger"],["formControlName","title","nz-input","","placeholder","Enter plan of care title here..."],["nz-row","","nzGutter","16"],["nz-col","","nzSpan","12"],["nzErrorTip","Please select a category!"],["formControlName","category","nzPlaceHolder","Please select a category..."],[4,"ngFor","ngForOf"],["nzErrorTip","Please select a provider!"],["formControlName","provider","nzPlaceHolder","Please select a provider...",3,"nzDisabled"],["nz-col","","nzSpan","16"],["nzMode","multiple","formControlName","icdCodes","nzPlaceHolder","Select problems..."],["nz-col","","nzSpan","8"],["formControlName","priority"],["nz-radio-button","","nzButtonStyle","solid",3,"nzValue"],["nzErrorTip","Please enter a plan of care!"],["nz-dropdown","",3,"nzDropdownMenu"],["nz-icon","","nzType","down"],["id","pocEditor","placeholder","Enter plan of care here...","formControlName","providerPlanOfCare",3,"config"],["id","nursingInterventionsEditor","placeholder","Enter nursing interventions here...","formControlName","nursingInterventions",3,"config"],["id","nursingEducationEditor","placeholder","Enter nursing education here...","formControlName","nursingEducation",3,"config"],["id","goals","placeholder","Enter goals here...","formControlName","goals",3,"config"],[3,"nzLabel","nzValue"],["nz-menu-item","",3,"click"]],template:function(e,t){1&e&&(m.Vc(0,x,90,16,"div",0),m.Xb(1,"nz-dropdown-menu",null,1),m.Xb(3,"ul",2),m.Vc(4,k,2,1,"li",3),m.Wb(),m.Wb(),m.Xb(5,"nz-dropdown-menu",null,4),m.Xb(7,"ul",2),m.Vc(8,V,2,1,"li",3),m.Wb(),m.Wb(),m.Xb(9,"nz-dropdown-menu",null,5),m.Xb(11,"ul",2),m.Vc(12,U,2,1,"li",3),m.Wb(),m.Wb(),m.Xb(13,"nz-dropdown-menu",null,6),m.Xb(15,"ul",2),m.Vc(16,F,2,1,"li",3),m.Wb(),m.Wb()),2&e&&(m.rc("ngIf",!!t.form),m.Db(4),m.rc("ngForOf",t.noteTemplates),m.Db(4),m.rc("ngForOf",t.noteTemplates),m.Db(4),m.rc("ngForOf",t.noteTemplates),m.Db(4),m.rc("ngForOf",t.noteTemplates))},directives:[s.q,S.e,E.c,s.p,O.c,O.a,I.a,c.F,c.v,_.a,X.b,c.m,X.c,X.a,T.a,c.d,N.b,c.u,c.k,z.d,M.c,M.b,M.a,y.a,S.a,S.b,A.a,P.a,W.a,z.a,E.e],styles:[".container[_ngcontent-%COMP%]{background-color:var(--neutral-color)}strong[_ngcontent-%COMP%]{display:block}span[_ngcontent-%COMP%]{vertical-align:sub}[_nghost-%COMP%]     .ant-divider-horizontal{margin-top:14px}a[_ngcontent-%COMP%]{font-weight:100}[_nghost-%COMP%]     .angular-editor-textarea{border-radius:5px}"]}),e})();var Y=n("/XTn"),G=n("WoUL");let B=(()=>{class e{constructor(e){this._translationsService=e,this.$translationObserver=this._translationsService.getMultiple("EPISODE","EPISODE.PRIMARY_INSURANCE_REQUIRED","EPISODE.ICD_CODE_REQUIRED","EPISODE.RPM_ICD_CODE_REQUIRED","EPISODE.CPT_CODE_REQUIRED").subscribe(e=>{this.translatedStrings=e})}ngOnDestroy(){this.$translationObserver.unsubscribe()}validateGeneralEpisode(e,t){var n,i,s,a;const o=[],l=null==t?void 0:t.insuranceInformation;return e&&!(null===(n=null==l?void 0:l.primaryInsuranceDetails)||void 0===n?void 0:n.carrierName)&&o.push("INVALID_PRIMARY_INSURANCE_CARRIER"),e&&!(null===(i=null==l?void 0:l.primaryInsuranceDetails)||void 0===i?void 0:i.insuranceId)&&o.push("INVALID_PRIMARY_INSURANCE_ID"),(null===(s=null==t?void 0:t.cptCodeList)||void 0===s?void 0:s.length)&&!(null===(a=null==t?void 0:t.icdCodeList)||void 0===a?void 0:a.length)&&o.push("INVALID_ICD_CODES"),o}validateRPMEpisode(e){var t,n,i,s;const a=[],o=null==e?void 0:e.insuranceInformation;return(null===(t=null==o?void 0:o.primaryInsuranceDetails)||void 0===t?void 0:t.carrierName)||a.push("INVALID_PRIMARY_INSURANCE_CARRIER"),(null===(n=null==o?void 0:o.primaryInsuranceDetails)||void 0===n?void 0:n.insuranceId)||a.push("INVALID_PRIMARY_INSURANCE_ID"),(null===(i=null==e?void 0:e.cptCodeList)||void 0===i?void 0:i.length)||a.push("INVALID_CPT_CODES"),(null===(s=null==e?void 0:e.icdCodeList)||void 0===s?void 0:s.length)||a.push("INVALID_ICD_CODES"),a}}return e.\u0275fac=function(t){return new(t||e)(m.bc(G.a))},e.\u0275prov=m.Nb({token:e,factory:e.\u0275fac}),e})();var H=n("igu/"),$=n("gXqy"),Z=n("jKzE"),q=n("9ig3"),K=(n("tkii"),n("0lU3")),Q=n("dRHE");function J(e,t){if(1&e&&m.Sb(0,"nz-option",11),2&e){const e=t.$implicit;m.rc("nzValue",null==e?null:e.id)("nzLabel",null==e?null:e.name)}}function ee(e,t){1&e&&(m.Xb(0,"label"),m.Xc(1),m.jc(2,"translate"),m.Wb()),2&e&&(m.Db(1),m.Yc(m.kc(2,1,"TITLE.DAYS")))}const te=function(){return[16,16]};function ne(e,t){1&e&&(m.Xb(0,"div",12),m.Xb(1,"div",3),m.Xb(2,"label",13),m.Xc(3,"Required"),m.Wb(),m.Wb(),m.Wb()),2&e&&m.rc("nzGutter",m.xc(1,te))}const ie=function(e){return{danger:e}};let se=(()=>{class e{constructor(e,t){this._router=e,this._activatedRoute=t,this.disabledDates=e=>Object($.a)(new Date,e)>0||Object($.a)(Object(Z.a)(Date.now()),e)<0,this.duration=[new Date,Object(Z.a)(Date.now())]}set tenantConfig(e){var t,n;if(!e)return;this.tenantSettings=e;const i=null===(n=null===(t=this.tenantSettings)||void 0===t?void 0:t.episodeBlueprints)||void 0===n?void 0:n.filter(e=>!e.archived);this.tenantSettings.episodeBlueprints=i}ngOnInit(){var e;this._activatedRoute.queryParams.subscribe(e=>{this.selectedBlueprintId=e.blueprintId}),this.mode=null===(e=this._activatedRoute.snapshot.paramMap.get("mode"))||void 0===e?void 0:e.toUpperCase(),this.presetDateRange()}presetDateRange(){var e,t;null===(t=null===(e=this.tenantSettings)||void 0===e?void 0:e.episodeBlueprints)||void 0===t||t.forEach(e=>{if(!this.selectedBlueprintId)return;if(this.selectedBlueprintId!==e.id)return;let t=Object(Z.a)(Date.now());const n=new Date((new Date).setDate((new Date).getDate()+e.durationSettings.timeInDays));n<t&&(t=n),this.duration=[new Date,t]}),this.setDaysRemaining(),this.setBlueprintIdToURL()}setDuration(e,t){let n=Object(q.a)(new Date),i=null==e?void 0:e.split("-");this.duration=[new Date(n.setDate(parseInt(i[2]))),this.duration[1]]}setDaysRemaining(){var e;(null===(e=this.duration)||void 0===e?void 0:e.length)>1&&(this.durationInDays=Object($.a)(this.duration[1],this.duration[0]))}setBlueprintIdToURL(){this._router.navigate([],{replaceUrl:!0,queryParams:{blueprintId:this.selectedBlueprintId},queryParamsHandling:"merge"})}}return e.\u0275fac=function(t){return new(t||e)(m.Rb(C.g),m.Rb(C.a))},e.\u0275cmp=m.Lb({type:e,selectors:[["app-duration"]],inputs:{tenantConfig:["tenantSettings","tenantConfig"],errors:"errors"},decls:25,vars:26,consts:[[1,"container"],["nz-typography",""],["nz-row","","nzGutter","16"],["nz-col","","nzXs","12","nzSm","8","nzMd","6"],[3,"ngModel","nzPlaceHolder","nzDisabled","ngClass","nzBorderless","ngModelChange"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],["nzFormat","MMM d, y",3,"nzAllowClear","nzDisabledDate","ngModel","nzDisabled","ngModelChange"],["id","durationDays"],["nz-typography","","nzType","success"],[4,"ngIf"],["nz-row","",3,"nzGutter",4,"ngIf"],[3,"nzValue","nzLabel"],["nz-row","",3,"nzGutter"],["nz-typography","","nzType","danger"]],template:function(e,t){1&e&&(m.Xb(0,"div",0),m.Xb(1,"h3",1),m.Xc(2),m.jc(3,"translate"),m.Wb(),m.Xb(4,"div",2),m.Xb(5,"div",3),m.Xb(6,"label"),m.Xc(7),m.jc(8,"translate"),m.Wb(),m.Xb(9,"nz-select",4),m.ec("ngModelChange",function(e){return t.selectedBlueprintId=e})("ngModelChange",function(){return t.presetDateRange()}),m.jc(10,"translate"),m.Vc(11,J,1,2,"nz-option",5),m.Wb(),m.Wb(),m.Xb(12,"div",3),m.Xb(13,"label"),m.Xc(14),m.jc(15,"translate"),m.Wb(),m.Xb(16,"nz-range-picker",6),m.ec("ngModelChange",function(e){return t.duration=e})("ngModelChange",function(){return t.setDaysRemaining()}),m.Wb(),m.Wb(),m.Xb(17,"div",3),m.Xb(18,"div",7),m.Xb(19,"h3",8),m.Xc(20),m.Wb(),m.Vc(21,ee,3,3,"label",9),m.Wb(),m.Wb(),m.Wb(),m.Vc(22,ne,4,2,"div",10),m.Sb(23,"br"),m.Sb(24,"nz-divider"),m.Wb()),2&e&&(m.Db(2),m.Yc(m.kc(3,16,"COMMON.EPISODE_DETAILS")),m.Db(5),m.Zc("",m.kc(8,18,"COMMON.EPISODE_NAME")," *"),m.Db(2),m.sc("nzPlaceHolder",m.kc(10,20,"EPISODE.CHOOSE_EPISODE_TYPE")),m.rc("ngModel",t.selectedBlueprintId)("nzDisabled","EDIT"===t.mode)("ngClass",m.yc(24,ie,!t.selectedBlueprintId&&!(null==t.errors||!t.errors.includes("INVALID_BLUEPRINT"))))("nzBorderless",!t.selectedBlueprintId&&!(null==t.errors||!t.errors.includes("INVALID_BLUEPRINT"))),m.Db(2),m.rc("ngForOf",null==t.tenantSettings?null:t.tenantSettings.episodeBlueprints),m.Db(3),m.Zc("",m.kc(15,22,"COMMON.SELECT_START_END_DATE")," *"),m.Db(2),m.rc("nzAllowClear",!1)("nzDisabledDate",t.disabledDates)("ngModel",t.duration)("nzDisabled",!0),m.Db(4),m.Yc(t.durationInDays),m.Db(1),m.rc("ngIf",t.durationInDays),m.Db(1),m.rc("ngIf",!t.selectedBlueprintId&&!(null==t.errors||!t.errors.includes("INVALID_BLUEPRINT"))))},directives:[T.a,O.c,O.a,z.d,c.u,c.x,s.o,s.p,K.a,K.c,s.q,y.a,z.a],pipes:[Q.a],styles:["nz-range-picker[_ngcontent-%COMP%]{width:100%}h3[_ngcontent-%COMP%]{margin-bottom:25px}h3[_ngcontent-%COMP%], label[_ngcontent-%COMP%]{margin-left:5px}label[_ngcontent-%COMP%]{font:normal normal normal 12px/16px Nunito;color:var(--tertiary-color);margin-bottom:5px;display:block}#durationDays[_ngcontent-%COMP%]{margin-top:15px}#durationDays[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:-5px}.danger[_ngcontent-%COMP%]{border:1px solid #c81c1c}[_nghost-%COMP%]     .ant-select-selector{background-color:var(--neutral-color)!important}"]}),e})();var ae=n("qAZ0"),oe=n("glKu");function le(e,t){if(1&e&&m.Sb(0,"nz-option",10),2&e){const e=t.$implicit;m.uc("nzLabel","",e[0]||"",", ",e[1]||"",""),m.uc("nzValue","",e[0]||"",", ",e[1]||"","")}}function re(e,t){if(1&e&&(m.Vb(0),m.Vc(1,le,1,4,"nz-option",9),m.Ub()),2&e){const e=m.ic();m.Db(1),m.rc("ngForOf",e.icdCodes)}}function ce(e,t){1&e&&(m.Xb(0,"nz-option",11),m.Sb(1,"nz-spin",12),m.Xc(2),m.jc(3,"translate"),m.Wb()),2&e&&(m.Db(2),m.Zc(" ",m.kc(3,1,"COMMON.ICD_CODES_LOADING")," "))}function de(e,t){1&e&&(m.Xb(0,"nz-option",11),m.Xc(1),m.jc(2,"translate"),m.Wb()),2&e&&(m.Db(1),m.Zc(" ",m.kc(2,1,"COMMON.SEARCH_INPUT")," "))}function be(e,t){1&e&&m.Sb(0,"app-icons",13)}function pe(e,t){1&e&&(m.Xb(0,"div",2),m.Xb(1,"div",14),m.Xb(2,"label",15),m.Xc(3,"Required"),m.Wb(),m.Wb(),m.Wb())}const ue=function(e){return{danger:e}};let he=(()=>{class e{constructor(e){this._episodesService=e,this.initialState=!0,this.selectedCodes=[],this.icdCodes=[]}getICDCodes(e){e?(this.isLoading=!0,this.initialState=!1,this._episodesService.fetchICDCodes(e).subscribe(e=>{this.isLoading=!1,(null==e?void 0:e.length)&&(this.icdCodes=e[3])})):this.initialState=!0}setAssignedICDCodes(e){null==e||e.forEach(e=>{this.selectedCodes.push(`${e.id||""}, ${e.description||""}`),this.icdCodes.push([e.id,e.description])})}getSelectedICDCodes(){var e;return null===(e=this.selectedCodes)||void 0===e?void 0:e.map(e=>{var t,n;const i=e.split(",");return{id:i[0],description:null===(n=null===(t=null==i?void 0:i.slice(1))||void 0===t?void 0:t.join())||void 0===n?void 0:n.trim()}})}}return e.\u0275fac=function(t){return new(t||e)(m.Rb(u.a))},e.\u0275cmp=m.Lb({type:e,selectors:[["app-icd-codes"]],inputs:{disabled:"disabled",errors:"errors"},decls:17,vars:16,consts:[[1,"container"],["nz-typography",""],["nz-row",""],[3,"nzSuffix","ngClass"],["nzMode","multiple","nzServerSearch","true",3,"ngModel","nzNotFoundContent","nzPlaceHolder","nzDisabled","ngModelChange","nzOnSearch"],[4,"ngIf"],["nzDisabled","","nzCustomContent","",4,"ngIf"],["suffixIconSearch",""],["nz-row","",4,"ngIf"],[3,"nzLabel","nzValue",4,"ngFor","ngForOf"],[3,"nzLabel","nzValue"],["nzDisabled","","nzCustomContent",""],["nzSimple","","nzSize","small"],["size","16px","name","search","color","white","strokeColor","black"],["nz-col","","nzSpan","6"],["nz-typography","","nzType","danger"]],template:function(e,t){if(1&e&&(m.Xb(0,"div",0),m.Xb(1,"h3",1),m.Xc(2,"ICD Codes *"),m.Wb(),m.Xb(3,"div",2),m.Xb(4,"nz-input-group",3),m.Xb(5,"nz-select",4),m.ec("ngModelChange",function(e){return t.selectedCodes=e})("nzOnSearch",function(e){return t.getICDCodes(e)}),m.jc(6,"translate"),m.jc(7,"translate"),m.Vc(8,re,2,1,"ng-container",5),m.Vc(9,ce,4,3,"nz-option",6),m.Vc(10,de,3,3,"nz-option",6),m.Wb(),m.Wb(),m.Vc(11,be,1,0,"ng-template",null,7,m.Wc),m.Wb(),m.Vc(13,pe,4,0,"div",8),m.Sb(14,"br"),m.Sb(15,"br"),m.Sb(16,"nz-divider"),m.Wb()),2&e){const e=m.Ic(12);m.Db(4),m.rc("nzSuffix",e)("ngClass",m.yc(14,ue,!(null==t.errors||!t.errors.includes("INVALID_ICD_CODES")))),m.Db(1),m.sc("nzNotFoundContent",m.kc(6,10,"COMMON.ICD_CODES_NOT_FOUND")),m.sc("nzPlaceHolder",m.kc(7,12,"COMMON.SEARCH")),m.rc("ngModel",t.selectedCodes)("nzDisabled",t.disabled),m.Db(3),m.rc("ngIf",!t.isLoading),m.Db(1),m.rc("ngIf",t.isLoading),m.Db(1),m.rc("ngIf",t.initialState&&!(null!=t.icdCodes&&t.icdCodes.length)),m.Db(3),m.rc("ngIf",!(null==t.errors||!t.errors.includes("INVALID_ICD_CODES")))}},directives:[T.a,O.c,A.a,N.c,N.d,s.o,z.d,c.u,c.x,s.q,y.a,s.p,z.a,ae.a,oe.a,O.a],pipes:[Q.a],styles:["h3[_ngcontent-%COMP%]{margin-bottom:25px;margin-left:5px}label[_ngcontent-%COMP%]{margin-top:5px;display:block}[_nghost-%COMP%]     .ant-input-affix-wrapper{border:1px solid #2f4f4f;padding:0 10px 0 0}[_nghost-%COMP%]     .ant-select:not(.ant-select-customize-input) .ant-select-selector{border:none}app-icons[_ngcontent-%COMP%]{margin-top:3px;pointer-events:none}.danger[_ngcontent-%COMP%]{border:1px solid #c81c1c}"]}),e})();var ge=n("GMnC"),fe=n("d+1G"),ve=n("TaO5"),me=n("ZyQt");function Ce(e,t){if(1&e){const e=m.Yb();m.Vb(0),m.Xb(1,"label",7),m.ec("ngModelChange",function(t){return m.Lc(e),m.ic(2).complexCCM=t})("ngModelChange",function(){return m.Lc(e),m.ic(2).toggleComplexCCM()}),m.Xc(2," Complex CCM Patient "),m.Wb(),m.Sb(3,"br"),m.Sb(4,"br"),m.Ub()}if(2&e){const e=m.ic(2);m.Db(1),m.rc("nzDisabled","EDIT"===e.mode)("ngModel",e.complexCCM)}}function De(e,t){if(1&e&&(m.Xb(0,"nz-tag",8),m.Xc(1),m.Wb()),2&e){const e=t.$implicit;m.rc("nzColor","#E8E8E8"),m.Db(1),m.Yc(null==e?null:e.name)}}function Se(e,t){if(1&e&&(m.Xb(0,"div",1),m.Xb(1,"h3",2),m.Xc(2),m.jc(3,"translate"),m.Wb(),m.Vc(4,Ce,5,2,"ng-container",3),m.Xb(5,"div",4),m.Xb(6,"div",5),m.Xb(7,"label"),m.Xc(8),m.jc(9,"translate"),m.Wb(),m.Xc(10," \xa0\xa0 "),m.Vc(11,De,2,2,"nz-tag",6),m.Wb(),m.Wb(),m.Sb(12,"br"),m.Sb(13,"nz-divider"),m.Wb()),2&e){const e=m.ic();m.Db(2),m.Yc(m.kc(3,4,"EPISODE.SERVICE_CODES")),m.Db(2),m.rc("ngIf","CCM"===(null==e.episodeBlueprint?null:e.episodeBlueprint.type)),m.Db(4),m.Zc("",m.kc(9,6,"COMMON.APPLIED"),":"),m.Db(3),m.rc("ngForOf",e.serviceCodes)}}let Ee=(()=>{class e{constructor(e){this._activatedRoute=e,this.serviceCodes=[]}set episodeData(e){e&&(this.episode=e,ge.a.CCM===(null==e?void 0:e.episodeType)&&this.toggleComplexCCM(null==e?void 0:e.cptCodeList))}ngOnInit(){this._activatedRoute.queryParams.subscribe(e=>{this.selectedBlueprintId=null==e?void 0:e.blueprintId,this.getEnabledServiceCodes()})}getEnabledServiceCodes(){this.tenantSettings&&this.tenantSettings.episodeBlueprints&&this.tenantSettings.episodeBlueprints.forEach(e=>{this.selectedBlueprintId&&this.selectedBlueprintId===e.id&&(this.episodeBlueprint=e,this.filterServiceCodes(e.enabledServiceCodes),"CCM"===e.type&&this.toggleComplexCCM())})}filterServiceCodes(e){this.serviceCodes=(null==e?void 0:e.length)?fe.d.filter(t=>-1!==e.findIndex(e=>e===t.id)):[]}setServiceCodes(e){this.serviceCodes=e,this.getEnabledServiceCodes()}toggleComplexCCM(e){const t=["99490","99439","99439B"],n=["99487","99489","99491"];let i=[],s=[];(null==e?void 0:e.length)?(this.serviceCodes=e,i=e.filter(e=>-1!==n.findIndex(t=>t===e.id)),s=e.filter(e=>-1!==t.findIndex(t=>t===e.id))):(this.serviceCodes=fe.d.filter(e=>-1!==this.episodeBlueprint.enabledServiceCodes.findIndex(t=>t===e.id)),i=this.serviceCodes.filter(e=>-1!==n.findIndex(t=>t===e.id)),s=this.serviceCodes.filter(e=>-1!==t.findIndex(t=>t===e.id)),this.complexCCM?s=[]:i=[]),(null==i?void 0:i.length)&&(this.serviceCodes=i,this.complexCCM=!0),(null==s?void 0:s.length)&&(this.serviceCodes=s)}}return e.\u0275fac=function(t){return new(t||e)(m.Rb(C.a))},e.\u0275cmp=m.Lb({type:e,selectors:[["app-service-codes"]],inputs:{mode:"mode",tenantSettings:"tenantSettings",episodeData:["episode","episodeData"]},decls:1,vars:1,consts:[["class","container",4,"ngIf"],[1,"container"],["nz-typography",""],[4,"ngIf"],["nz-row",""],["nz-col","","nzSpan","24"],[3,"nzColor",4,"ngFor","ngForOf"],["nz-checkbox","",3,"nzDisabled","ngModel","ngModelChange"],[3,"nzColor"]],template:function(e,t){1&e&&m.Vc(0,Se,14,8,"div",0),2&e&&m.rc("ngIf",null==t.serviceCodes?null:t.serviceCodes.length)},directives:[s.q,T.a,O.c,O.a,s.p,y.a,ve.a,c.u,c.x,me.a],pipes:[Q.a],styles:["h3[_ngcontent-%COMP%]{margin-bottom:25px}h3[_ngcontent-%COMP%], label[_ngcontent-%COMP%]{margin-left:5px}nz-tag[_ngcontent-%COMP%]{color:#888;border-radius:2px}"]}),e})();var Oe=n("rqHP"),Ie=(n("cauy"),n("CLv8")),_e=n("EGpF");function Xe(e,t){if(1&e){const e=m.Yb();m.Xb(0,"nz-switch",15),m.ec("ngModelChange",function(t){return m.Lc(e),m.ic().insurance.secondaryInsured=t}),m.Wb()}if(2&e){const e=m.ic();m.rc("ngModel",e.insurance.secondaryInsured)}}function Te(e,t){1&e&&(m.Xb(0,"span",16),m.Xc(1,"Required"),m.Wb())}function Ne(e,t){1&e&&(m.Xb(0,"span",16),m.Xc(1," Required "),m.Wb())}const ze=function(e){return{danger:e}};let Me=(()=>{class e{constructor(){this.insurance=new Oe.a}set patientProfile(e){this.setInsuranceInfo(null==e?void 0:e.insuranceInformation)}setInsuranceInfo(e){(null==e?void 0:e.primaryInsuranceDetails)||(e=new Oe.a),(null==e?void 0:e.secondaryInsuranceDetails)||(e.secondaryInsuranceDetails=new Ie.a),this.insurance=e}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=m.Lb({type:e,selectors:[["app-insurance"]],inputs:{patientProfile:["patient","patientProfile"],errors:"errors"},decls:39,vars:28,consts:[[1,"container"],["nz-row","","nzGutter","16"],["nz-col","","nzSpan","12"],["nz-typography",""],["nz-col","","nzXs","10","nzSm","10","nzMd","6","id","top-left",1,"shaded"],["id","multiple"],["nz-col","","nzXs","2","nzSm","2","nzMd","6","id","top-right",1,"shaded"],["nzSize","small",3,"ngModel","ngModelChange",4,"ngIf"],["nz-col","","nzSpan","6"],["nz-typography","","nzEllipsis",""],["nz-input","","disabled","","readonly","","onfocus","this.removeAttribute('readonly')",3,"ngModel","ngClass","ngModelChange"],["nz-typography","","nzType","danger",4,"ngIf"],["nz-col","","nzSpan","6","id","bottom-left",1,"shaded"],["nz-input","","disabled","",3,"ngModel","ngModelChange"],["nz-col","","nzSpan","6","id","bottom-right",1,"shaded"],["nzSize","small",3,"ngModel","ngModelChange"],["nz-typography","","nzType","danger"]],template:function(e,t){1&e&&(m.Xb(0,"div",0),m.Xb(1,"div",1),m.Xb(2,"div",2),m.Xb(3,"h3",3),m.Xc(4),m.jc(5,"translate"),m.Wb(),m.Wb(),m.Vb(6),m.Xb(7,"div",4),m.Xb(8,"label",5),m.Xc(9,"Secondary Insurance"),m.Wb(),m.Wb(),m.Xb(10,"div",6),m.Vc(11,Xe,1,1,"nz-switch",7),m.Wb(),m.Ub(),m.Wb(),m.Xb(12,"div",1),m.Xb(13,"div",8),m.Xb(14,"label",9),m.Xc(15),m.jc(16,"translate"),m.Wb(),m.Xb(17,"input",10),m.ec("ngModelChange",function(e){return t.insurance.primaryInsuranceDetails.carrierName=e}),m.Wb(),m.Vc(18,Te,2,0,"span",11),m.Wb(),m.Xb(19,"div",8),m.Xb(20,"label",9),m.Xc(21),m.jc(22,"translate"),m.Wb(),m.Xb(23,"input",10),m.ec("ngModelChange",function(e){return t.insurance.primaryInsuranceDetails.insuranceId=e}),m.Wb(),m.Vc(24,Ne,2,0,"span",11),m.Wb(),m.Xb(25,"div",12),m.Xb(26,"label",9),m.Xc(27),m.jc(28,"translate"),m.Wb(),m.Xb(29,"input",13),m.ec("ngModelChange",function(e){return t.insurance.secondaryInsuranceDetails.carrierName=e}),m.Wb(),m.Wb(),m.Xb(30,"div",14),m.Xb(31,"label",9),m.Xc(32),m.jc(33,"translate"),m.Wb(),m.Xb(34,"input",13),m.ec("ngModelChange",function(e){return t.insurance.secondaryInsuranceDetails.insuranceId=e}),m.Wb(),m.Sb(35,"br"),m.Sb(36,"br"),m.Wb(),m.Wb(),m.Sb(37,"br"),m.Sb(38,"nz-divider"),m.Wb()),2&e&&(m.Db(4),m.Yc(m.kc(5,14,"PATIENT.INSURANCE_INFORMATION")),m.Db(7),m.rc("ngIf",!1),m.Db(4),m.Zc("",m.kc(16,16,"INSURANCE.PRIMARY_INSURANCE_CARRIER_NAME")," *"),m.Db(2),m.rc("ngModel",t.insurance.primaryInsuranceDetails.carrierName)("ngClass",m.yc(24,ze,!t.insurance.primaryInsuranceDetails.carrierName&&!(null==t.errors||!t.errors.includes("INVALID_PRIMARY_INSURANCE_CARRIER")))),m.Db(1),m.rc("ngIf",!t.insurance.primaryInsuranceDetails.carrierName&&!(null==t.errors||!t.errors.includes("INVALID_PRIMARY_INSURANCE_CARRIER"))),m.Db(3),m.Zc("",m.kc(22,18,"INSURANCE.INSURER_MEMBER_ID")," *"),m.Db(2),m.rc("ngModel",t.insurance.primaryInsuranceDetails.insuranceId)("ngClass",m.yc(26,ze,!t.insurance.primaryInsuranceDetails.insuranceId&&!(null==t.errors||!t.errors.includes("INVALID_PRIMARY_INSURANCE_ID")))),m.Db(1),m.rc("ngIf",!t.insurance.primaryInsuranceDetails.insuranceId&&!(null==t.errors||!t.errors.includes("INVALID_PRIMARY_INSURANCE_ID"))),m.Db(3),m.Yc(m.kc(28,20,"INSURANCE.SECONDARY_INSURANCE_CARRIER_NAME")),m.Db(2),m.rc("ngModel",t.insurance.secondaryInsuranceDetails.carrierName),m.Db(3),m.Yc(m.kc(33,22,"INSURANCE.INSURER_MEMBER_ID")),m.Db(2),m.rc("ngModel",t.insurance.secondaryInsuranceDetails.insuranceId))},directives:[O.c,O.a,T.a,s.q,N.b,c.d,c.u,c.x,s.o,y.a,_e.a],pipes:[Q.a],styles:["h3[_ngcontent-%COMP%]{margin-bottom:25px;margin-left:5px}input[_ngcontent-%COMP%]{background:#fbfbfb 0 0 no-repeat padding-box;border:1px solid var(--grey)}#multiple[_ngcontent-%COMP%]{font-weight:700}label[_ngcontent-%COMP%]{font:normal normal normal 12px/16px Nunito;color:var(--tertiary-color);margin-left:5px;margin-bottom:5px;display:block}.shaded[_ngcontent-%COMP%]{background:#dbdbdb 0 0 no-repeat padding-box}#top-left[_ngcontent-%COMP%]{padding-top:15px;padding-bottom:10px;border-top-left-radius:5px}#top-right[_ngcontent-%COMP%]{padding-top:15px;border-top-right-radius:5px}#bottom-left[_ngcontent-%COMP%]{border-bottom-left-radius:5px}#bottom-right[_ngcontent-%COMP%]{border-bottom-right-radius:5px}span[_ngcontent-%COMP%]{display:block;margin-left:5px;margin-top:5px}.danger[_ngcontent-%COMP%]{border-color:#c81c1c}"]}),e})();var ye=n("Dm2S"),Ae=n("ua0i"),Pe=n("HZ0a"),We=n("dEAy"),Re=n("PScX"),we=n("S5rh");let Le=(()=>{class e{constructor(e,t,n,i,s){this._cdRef=e,this._templateRef=t,this._activatedRoute=n,this._viewContainerRef=i,this._dataSharingService=s}ngOnInit(){this.getDataFromURL()}ngOnDestroy(){this.$route.unsubscribe(),this.$tenantSettings.unsubscribe()}getDataFromURL(){this.$route=this._activatedRoute.queryParams.subscribe(e=>{this.blueprintId=null==e?void 0:e.blueprintId,this.getTenantSettings(),this.disableFeature(),this.checkStatus()})}getTenantSettings(){this.$tenantSettings=this._dataSharingService.assignedTenantSettings.subscribe(e=>{var t;e.forEach((e,n)=>{e.episodeBlueprints.findIndex(e=>e.id===this.blueprintId)>=0&&(t=e)}),t&&!this.tenantSettings&&(this.tenantSettings=t,this.checkStatus())})}checkStatus(){switch(this.isComponentEnabled){case"PHYSICIAN_ORDER":this.isPhysicianOrderEnabled();break;case"CONSENT_FORM":this.isConsentFormEnabled();break;case"INSURANCE":this.isInsuranceEnabled();break;case"APPOINTMENT":this.isAppointmentEnabled();break;case"PATIENT_EDUCATION_APPOINTMENT":this.isPatientEducationTaskEnabled();break;case"PLAN_OF_CARE":this.isPlanOfCareEnabled();break;case"CARE_PLAN":this.isCareplanEnabled();break;case"CARE_MANAGEMENT_TIME":this.isCareManagementTimeEnabled();break;case"TREATMENT_MANAGEMENT_SERVICE":this.isTreatmentManagementServiceEnabled();break;case"ADDITIONAL_TREATMENT_MANAGEMENT_SERVICE":this.isAdditionalTreatmentManagementServiceEnabled();break;default:this.disableFeature()}}enableFeature(){this._viewContainerRef.createEmbeddedView(this._templateRef),this._cdRef.detectChanges()}disableFeature(){this._viewContainerRef.clear(),this._cdRef.detectChanges()}getEpisodeBlueprint(){var e;const t=null===(e=this.tenantSettings)||void 0===e?void 0:e.episodeBlueprints;return null==t?void 0:t.find(e=>this.blueprintId===e.id&&!e.archived)}isPhysicianOrderEnabled(){var e;const t=this.getEpisodeBlueprint();(null===(e=null==t?void 0:t.episodeComponent)||void 0===e?void 0:e.physicianOrderEnabled)?this.enableFeature():this.disableFeature()}isConsentFormEnabled(){var e;const t=this.getEpisodeBlueprint();(null===(e=null==t?void 0:t.episodeComponent)||void 0===e?void 0:e.enableConsentForm)?this.enableFeature():this.disableFeature()}isInsuranceEnabled(){var e;const t=this.getEpisodeBlueprint();(null===(e=null==t?void 0:t.episodeComponent)||void 0===e?void 0:e.enableInsuranceInfo)?this.enableFeature():this.disableFeature()}isAppointmentEnabled(){var e,t;const n=this.getEpisodeBlueprint();!(null===(e=null==n?void 0:n.enabledServiceCodes)||void 0===e?void 0:e.find(e=>"99453"===e))&&(null===(t=null==n?void 0:n.episodeComponent)||void 0===t?void 0:t.enableAppointment)?this.enableFeature():this.disableFeature()}isPatientEducationTaskEnabled(){var e;const t=this.getEpisodeBlueprint();(null===(e=null==t?void 0:t.enabledServiceCodes)||void 0===e?void 0:e.find(e=>"99453"===e))?this.enableFeature():this.disableFeature()}isPlanOfCareEnabled(){var e;const t=this.getEpisodeBlueprint();(null===(e=null==t?void 0:t.episodeComponent)||void 0===e?void 0:e.enablePlanOfCare)?this.enableFeature():this.disableFeature()}isCareplanEnabled(){var e;const t=this.getEpisodeBlueprint();"CCM"===(null==t?void 0:t.type)||(null===(e=null==t?void 0:t.episodeComponent)||void 0===e?void 0:e.enableCarePlan)?this.enableFeature():this.disableFeature()}isCareManagementTimeEnabled(){const e=this.getEpisodeBlueprint(),t=null==e?void 0:e.enabledServiceCodes.findIndex(e=>"99484"===e);void 0!==t&&-1!==t?this.enableFeature():this.disableFeature()}isTreatmentManagementServiceEnabled(){const e=this.getEpisodeBlueprint(),t=null==e?void 0:e.enabledServiceCodes.findIndex(e=>"99457"===e);void 0!==t&&-1!==t?this.enableFeature():this.disableFeature()}isAdditionalTreatmentManagementServiceEnabled(){const e=this.getEpisodeBlueprint(),t=null==e?void 0:e.enabledServiceCodes.findIndex(e=>"99458"===e);void 0!==t&&-1!==t?this.enableFeature():this.disableFeature()}}return e.\u0275fac=function(t){return new(t||e)(m.Rb(m.h),m.Rb(m.N),m.Rb(C.a),m.Rb(m.R),m.Rb(H.a))},e.\u0275dir=m.Mb({type:e,selectors:[["","isComponentEnabled",""]],inputs:{isComponentEnabled:"isComponentEnabled"}}),e})();var xe=n("mLmo");function ke(e,t){if(1&e&&m.Sb(0,"app-insurance",8),2&e){const e=m.ic(2);m.rc("patient",e.patient)("errors",e.errors)}}function Ve(e,t){if(1&e&&(m.Xb(0,"div",3),m.Sb(1,"app-duration",4),m.Vc(2,ke,1,2,"app-insurance",5),m.Sb(3,"app-icd-codes",6),m.Sb(4,"app-service-codes",7),m.Wb()),2&e){const e=m.ic();m.Db(1),m.rc("tenantSettings",e.tenantSettings)("errors",e.errors),m.Db(1),m.rc("isComponentEnabled","INSURANCE"),m.Db(1),m.rc("disabled",!0)("errors",e.errors),m.Db(1),m.rc("mode",e.mode)("tenantSettings",e.tenantSettings)("episode",e.episode)}}let Ue=(()=>{class e extends h.a{constructor(e,t,n,i,s,a,o,l,r,c,d,b,p){super(),this._dataSharingService=e,this._patientsService=t,this._episodesService=n,this._router=i,this._datePipe=s,this._modalService=a,this._notificationsService=o,this._episodeFormValidator=l,this._translationsService=r,this._patientsEventLogger=c,this._episodesEventLogger=d,this._activatedRoute=b,this._messageService=p,this._translationsService.getMultiple("EPISODE","EPISODE.CREATED","EPISODE.UPDATED","EPISODE.SUSPEND_POPUP_TITLE","EPISODE.SUSPEND_POPUP_CONTENT","EPISODE.SELECT_TEMPLATE","EPISODE.SUSPEND_REASON").pipe(Object(f.a)(this.unsubscribed)).subscribe(e=>{this.translatedStrings=e})}ngAfterViewInit(){this.checkComponentMode(),this.getTenantSettings()}checkComponentMode(){this._activatedRoute.params.pipe(Object(f.a)(this.unsubscribed)).subscribe(e=>{var t;this.mode=null===(t=e.mode)||void 0===t?void 0:t.toUpperCase(),this.patientId=e.patientId}),this._activatedRoute.queryParams.pipe(Object(f.a)(this.unsubscribed)).subscribe(e=>{this.blueprintId&&!(null==e?void 0:e.blueprintId)&&(this.errors||(this.errors=[]),this.errors.push("INVALID_BLUEPRINT")),this.episodeId=e.episodeId,this.blueprintId=e.blueprintId,this.context=this._activatedRoute.snapshot.queryParams.context,this.contextMode=this._activatedRoute.snapshot.queryParams.contextMode,this.tenantId=this._activatedRoute.snapshot.queryParams.tenantId,this.setSelectedBlueprint()})}getTenantSettings(){this._dataSharingService.assignedTenantSettings.pipe(Object(f.a)(this.unsubscribed)).subscribe(e=>{const t=e.get(this.tenantId);t&&(this.tenantSettings=t,this.setSelectedBlueprint(),this.initializeEpisodeData())})}initializeEpisodeData(){"ADD"===this.mode?this.getPatientData().subscribe(e=>{this.patient=e,localStorage.setItem(v.a.REQUEST_TENANT_TEMP_IDS,this.patient.tenantId),this.setICDCodesInfo()}):"EDIT"===this.mode&&(this.getPatientData().subscribe(e=>{this.patient=e,localStorage.setItem(v.a.REQUEST_TENANT_TEMP_IDS,this.patient.tenantId)}),this.getEpisodeData())}setSelectedBlueprint(){var e,t;this.blueprintId||(this.selectedBlueprint=void 0),null===(t=null===(e=this.tenantSettings)||void 0===e?void 0:e.episodeBlueprints)||void 0===t||t.forEach(e=>{(null==e?void 0:e.id)===this.blueprintId&&(this.selectedBlueprint=e)})}getEpisodeData(){this._episodesService.fetchEpisode(this.episodeId).subscribe(e=>{this.episode=e,this.durationComponent.setDuration(e.startDate,e.endDate),this.insuranceComponent.setInsuranceInfo(e.insuranceInformation),this.icdCodesComponent.setAssignedICDCodes(e.icdCodeList),this.serviceCodesComponent.setServiceCodes(e.cptCodeList)})}getPatientData(){return this._patientsService.getSpecificUser(this.patientId)}setICDCodesInfo(){this._episodesService.fetchEpisodePrefillData(this.patientId).subscribe(e=>{this.icdCodesComponent.setAssignedICDCodes(e.icdCodes),"AUTO_CREATION"===this.context&&this.blueprintId&&this.selectedBlueprint&&this.saveEpisode()})}validateEpisode(e){var t,n,i;return this.errors=[],this.selectedBlueprint?(Ae.a.RPM===(null===(t=this.selectedBlueprint)||void 0===t?void 0:t.type)?this.errors.push(...this._episodeFormValidator.validateRPMEpisode(e)):this.errors.push(...this._episodeFormValidator.validateGeneralEpisode(!!this.insuranceComponent,e)),"AUTO_CREATION"===this.context&&(null===(n=this.errors)||void 0===n?void 0:n.length)&&this.errors.forEach(e=>{let t;switch(e){case"INVALID_PRIMARY_INSURANCE_CARRIER":t="Primary insurance carrier name cannot be blank";break;case"INVALID_PRIMARY_INSURANCE_ID":t="Primary insurance id cannot be blank";break;case"INVALID_CPT_CODES":t="At least 1 CPT code is needed";break;case"INVALID_ICD_CODES":t="Dx codes cannot be empty"}(null==t?void 0:t.length)&&this._messageService.error(t,{nzDuration:2e4})}),!(null===(i=this.errors)||void 0===i?void 0:i.length)):(this.errors.push("INVALID_BLUEPRINT"),!1)}saveEpisode(){const e=this.getEpisodeRequestObject();this.validateEpisode(e)&&("ADD"===this.mode?this.createNewEpisode(e):"EDIT"===this.mode&&this.updateEpisode(e))}createNewEpisode(e){e.blueprintId=this.blueprintId;const t=this.selectedBlueprint.type;this._episodesService.fetchActiveEpisodes(this.patientId,1,0,this.selectedBlueprint.id,[Y.a.SCHEDULED,Y.a.IN_PROGRESS]).subscribe(n=>{var i,s;if(!(null==n?void 0:n.totalCount))return this._patientsEventLogger.patientActionEvent(this.patientId,"create_episode"),void this.createEpisode(e);const a=n.result.filter(e=>e.endTime>Date.now());if(!(null==a?void 0:a.length))return this._patientsEventLogger.patientActionEvent(this.patientId,"create_episode"),void this.createEpisode(e);const o={assignerId:localStorage.getItem("loggedInUser"),archived:!1,reason:null===(i=this.translatedStrings.get("EPISODE.SUSPEND_REASON"))||void 0===i?void 0:i.replace("{EPISODE_NAME}",null===(s=this.selectedBlueprint)||void 0===s?void 0:s.name)};this._modalService.confirm({nzTitle:this.translatedStrings.get("EPISODE.SUSPEND_POPUP_TITLE"),nzContent:this.translatedStrings.get("EPISODE.SUSPEND_POPUP_CONTENT"),nzOkText:"Yes",nzCancelText:"No",nzOnOk:()=>{this._episodesEventLogger.episodeActionEventAddAndSuspendEpisode(a[0].id,this.patientId,t,"suspend_episode"),this.createEpisode(e),this._episodesService.suspendEpisode(a[0].id,o).subscribe(e=>{})}})})}createEpisode(e){this._episodesService.saveEpisode(e).subscribe(t=>{this._episodesEventLogger.episodeActionEventAddAndSuspendEpisode(t.id,e.patientId,e.episodeType,"add_episode"),this._notificationsService.success(this.translatedStrings.get("EPISODE"),this.translatedStrings.get("EPISODE.CREATED")),"AUTO_CREATION"===this.context&&this.blueprintId&&this.selectedBlueprint&&"lead"===this.contextMode?this._router.navigate(["/leads"],{replaceUrl:!0,queryParams:{tab:"ACTIVE",status:"ACTIVE"}}):"AUTO_CREATION"===this.context&&this.blueprintId&&this.selectedBlueprint?this._router.navigate([`/patient/view/${this.patientId}`,{replaceUrl:!0}]):this.viewEpisodeDetails(t.id)},()=>{this._notificationsService.error(this.translatedStrings.get("EPISODE"),"Error creating episode!")})}updateEpisode(e){e.id=this.episodeId,this._episodesService.updateEpisode(e).subscribe(()=>{this._episodesEventLogger.episodeActionEvent(e.id,e.patientId,"edit_episode"),this._notificationsService.success(this.translatedStrings.get("EPISODE"),this.translatedStrings.get("EPISODE.UPDATED")),this.viewEpisodeDetails(e.id)},()=>{this._notificationsService.error(this.translatedStrings.get("EPISODE"),"Error saving episode!")})}getEpisodeRequestObject(){var e,t,n,i,s,a,o,l,r;const c=null===(t=null===(e=this.durationComponent)||void 0===e?void 0:e.duration[0])||void 0===t?void 0:t.getTime(),d=null===(i=null===(n=this.durationComponent)||void 0===n?void 0:n.duration[1])||void 0===i?void 0:i.setHours(23,59,59,59);return{patientId:this.patientId,startTime:c,endTime:d,startDate:this._datePipe.transform(this.durationComponent.duration[0],"yyyy-MM-dd"),endDate:this._datePipe.transform(this.durationComponent.duration[1],"yyyy-MM-dd"),episodeType:null===(s=this.selectedBlueprint)||void 0===s?void 0:s.type,icdCodeList:null===(a=this.icdCodesComponent)||void 0===a?void 0:a.getSelectedICDCodes(),cptCodeList:this.getCPTCodes(),insuranceInformation:(null===(o=this.insuranceComponent)||void 0===o?void 0:o.insurance)||{},consentFiles:null===(l=this.episode)||void 0===l?void 0:l.consentFiles,tenantId:null===(r=this.tenantSettings)||void 0===r?void 0:r.tenantId}}getCPTCodes(){return this.serviceCodesComponent.serviceCodes.filter(e=>e.selected)}viewEpisodeDetails(e){this._router.navigate([`episodes/details/${this.patientId}/${e}`],{replaceUrl:!0,queryParams:{blueprintId:this.selectedBlueprint.id}})}}return e.\u0275fac=function(t){return new(t||e)(m.Rb(H.a),m.Rb(p.a),m.Rb(u.a),m.Rb(C.g),m.Rb(s.e),m.Rb(We.f),m.Rb(D.b),m.Rb(B),m.Rb(G.a),m.Rb(Pe.a),m.Rb(ye.a),m.Rb(C.a),m.Rb(Re.e))},e.\u0275cmp=m.Lb({type:e,selectors:[["app-episode-form"]],viewQuery:function(e,t){if(1&e&&(m.ed(se,1),m.ed(Me,1),m.ed(he,1),m.ed(Ee,1)),2&e){let e;m.Hc(e=m.fc())&&(t.durationComponent=e.first),m.Hc(e=m.fc())&&(t.insuranceComponent=e.first),m.Hc(e=m.fc())&&(t.icdCodesComponent=e.first),m.Hc(e=m.fc())&&(t.serviceCodesComponent=e.first)}},features:[m.Cb([s.e,B]),m.Ab],decls:6,vars:16,consts:[["title","episodeForm",3,"defaultTitle","isActionEnabled","actionTitle","isSearchEnabled","action"],["nzTip","Please wait while we generate an episode for the patient...",3,"nzSpinning"],["class","container",4,"ngIf"],[1,"container"],[3,"tenantSettings","errors"],[3,"patient","errors",4,"isComponentEnabled"],[3,"disabled","errors"],[3,"mode","tenantSettings","episode"],[3,"patient","errors"]],template:function(e,t){1&e&&(m.Xb(0,"app-header",0),m.ec("action",function(){return t.saveEpisode()}),m.jc(1,"episodeName"),m.jc(2,"episodeName"),m.jc(3,"translate"),m.Wb(),m.Xb(4,"nz-spin",1),m.Vc(5,Ve,5,8,"div",2),m.Wb()),2&e&&(m.uc("defaultTitle","",null==t.patient?null:t.patient.fullName," | ","ADD"===t.mode?m.mc(1,7,(null==t.selectedBlueprint?null:t.selectedBlueprint.type)||"","Create","Episode"):m.lc(2,11,(null==t.selectedBlueprint?null:t.selectedBlueprint.type)||"","Edit"),""),m.sc("actionTitle",m.kc(3,14,"COMMON.SAVE_EPISODE")),m.rc("isActionEnabled","AUTO_CREATION"!==t.context)("isSearchEnabled",!1),m.Db(4),m.rc("nzSpinning","AUTO_CREATION"===t.context),m.Db(1),m.rc("ngIf",t.tenantSettings))},directives:[we.a,ae.a,s.q,se,Le,he,Ee,Me],pipes:[xe.a,Q.a],styles:[".text-center[_ngcontent-%COMP%]{text-align:center}[_nghost-%COMP%]     .ant-spin-blur{opacity:0}[_nghost-%COMP%]     .ant-spin-text{font-size:16px}"]}),e})();var Fe=n("wjar"),je=n("nJia"),Ye=n("Pp+U");function Ge(e,t){1&e&&(m.Vb(0),m.Xc(1,",\xa0 "),m.Ub())}function Be(e,t){if(1&e&&(m.Vb(0),m.Xc(1),m.Vc(2,Ge,2,0,"ng-container",6),m.jc(3,"keyvalue"),m.Ub()),2&e){const e=t.$implicit,n=t.index,i=m.ic();let s=null;m.Db(1),m.Zc(" ",null==e?null:e.value,""),m.Db(1),m.rc("ngIf",n<(null==(s=m.kc(3,2,null==i.episodeDetails?null:i.episodeDetails.monitoringStaff))?null:s.length)-1)}}function He(e,t){if(1&e&&(m.Xb(0,"h4"),m.Xc(1),m.jc(2,"episodeStatusName"),m.Wb()),2&e){const e=m.ic();m.Db(1),m.Yc(m.kc(2,1,null==e.episodeDetails?null:e.episodeDetails.status))}}function $e(e,t){if(1&e&&(m.Vb(0),m.Xb(1,"h4"),m.Xc(2),m.jc(3,"date"),m.Wb(),m.Sb(4,"app-icons",7),m.Ub()),2&e){const e=m.ic();m.Db(2),m.Zc(" Suspended on ",m.lc(3,2,null==e.episodeDetails?null:e.episodeDetails.updatedOn,"d MMMM y")," "),m.Db(2),m.tc("nzTooltipTitle","Reason for suspension: ",(null==e.episodeDetails?null:e.episodeDetails.statusChangeReason)||"N/A","")}}const Ze=function(){return[32,32]},qe=function(e,t,n,i){return{"scheduled-status":e,"active-status":t,"suspended-status":n,"completed-status":i}};let Ke=(()=>{class e{set episode(e){var t,n;this.episodeDetails=e,this.duration=Object($.a)(new Date(null===(t=this.episodeDetails)||void 0===t?void 0:t.endDate),new Date(null===(n=this.episodeDetails)||void 0===n?void 0:n.startDate))}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=m.Lb({type:e,selectors:[["app-basic"]],inputs:{episode:["episodeDetails","episode"]},decls:40,vars:27,consts:[[1,"container"],["nz-row","",3,"nzGutter"],["nz-col","","nzXs","24","nzSm","12","nzMd","6"],[4,"ngFor","ngForOf"],["id","status","nz-col","","nzXs","24","nzSm","12","nzMd","6"],[3,"ngClass"],[4,"ngIf"],["actionable","","originalStyle","true","name","infoCircle","size","16px","nz-tooltip","","nzTooltipPlacement","bottomLeft",3,"nzTooltipTitle"]],template:function(e,t){1&e&&(m.Xb(0,"div",0),m.Xb(1,"div",1),m.Xb(2,"div",2),m.Xb(3,"label"),m.Xc(4,"Episode Name"),m.Wb(),m.Xb(5,"h4"),m.Xc(6),m.Wb(),m.Wb(),m.Xb(7,"div",2),m.Xb(8,"label"),m.Xc(9,"Monitoring Staff"),m.Wb(),m.Xb(10,"h4"),m.Vc(11,Be,4,4,"ng-container",3),m.jc(12,"keyvalue"),m.Wb(),m.Wb(),m.Xb(13,"div",4),m.Xb(14,"div",5),m.Xb(15,"label"),m.Xc(16,"Status"),m.Wb(),m.Vc(17,He,3,3,"h4",6),m.Vc(18,$e,5,5,"ng-container",6),m.Wb(),m.Wb(),m.Wb(),m.Xb(19,"div",1),m.Xb(20,"div",2),m.Xb(21,"label"),m.Xc(22,"Episode Duration"),m.Wb(),m.Xb(23,"h4"),m.Xc(24),m.jc(25,"date"),m.jc(26,"date"),m.Wb(),m.Xb(27,"h4"),m.Xc(28),m.Wb(),m.Wb(),m.Xb(29,"div",2),m.Xb(30,"label"),m.Xc(31,"Primary Insurance Carrier Name"),m.Wb(),m.Xb(32,"h4"),m.Xc(33),m.Wb(),m.Wb(),m.Xb(34,"div",2),m.Xb(35,"label"),m.Xc(36,"Primary Insurance ID"),m.Wb(),m.Xb(37,"h4"),m.Xc(38),m.Wb(),m.Wb(),m.Wb(),m.Sb(39,"nz-divider"),m.Wb()),2&e&&(m.Db(1),m.rc("nzGutter",m.xc(20,Ze)),m.Db(5),m.Yc(null==t.episodeDetails?null:t.episodeDetails.name),m.Db(5),m.rc("ngForOf",m.kc(12,12,null==t.episodeDetails?null:t.episodeDetails.monitoringStaff)),m.Db(3),m.rc("ngClass",m.Bc(21,qe,"SCHEDULED"===(null==t.episodeDetails?null:t.episodeDetails.status),"IN_PROGRESS"===(null==t.episodeDetails?null:t.episodeDetails.status),"SUSPENDED"===(null==t.episodeDetails?null:t.episodeDetails.status),"COMPLETED"===(null==t.episodeDetails?null:t.episodeDetails.status))),m.Db(3),m.rc("ngIf","SUSPENDED"!==(null==t.episodeDetails?null:t.episodeDetails.status)),m.Db(1),m.rc("ngIf","SUSPENDED"===(null==t.episodeDetails?null:t.episodeDetails.status)),m.Db(1),m.rc("nzGutter",m.xc(26,Ze)),m.Db(5),m.ad(" ",m.lc(25,14,null==t.episodeDetails?null:t.episodeDetails.startDate,"mediumDate")," - ",m.lc(26,17,null==t.episodeDetails?null:t.episodeDetails.endDate,"mediumDate")," "),m.Db(4),m.Zc("(",t.duration," Days)"),m.Db(5),m.Yc(null==t.episodeDetails||null==t.episodeDetails.insuranceInformation||null==t.episodeDetails.insuranceInformation.primaryInsuranceDetails?null:t.episodeDetails.insuranceInformation.primaryInsuranceDetails.carrierName),m.Db(5),m.Yc(null==t.episodeDetails||null==t.episodeDetails.insuranceInformation||null==t.episodeDetails.insuranceInformation.primaryInsuranceDetails?null:t.episodeDetails.insuranceInformation.primaryInsuranceDetails.insuranceId))},directives:[O.c,O.a,s.p,s.o,s.q,y.a,oe.a,Fe.a,je.d],pipes:[s.j,s.e,Ye.a],styles:[".container[_ngcontent-%COMP%]{padding:30px 20px 10px!important}.ant-row[_ngcontent-%COMP%]{margin-bottom:20px!important}label[_ngcontent-%COMP%]{color:var(--tertiary-color);margin-bottom:5px;display:block}h4[_ngcontent-%COMP%], label[_ngcontent-%COMP%]{font:normal normal normal 13px/16px Nunito}h4[_ngcontent-%COMP%]{font-weight:700;margin-bottom:0}#status[_ngcontent-%COMP%]{padding:0!important}#status[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:90%;border-radius:5px;padding:16px 0 16px 16px}#status[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > h4[_ngcontent-%COMP%]{display:unset}.scheduled-status[_ngcontent-%COMP%]{background:#ffe58f 0 0 no-repeat padding-box}.active-status[_ngcontent-%COMP%]{background:var(--primary-color) 0 0 no-repeat padding-box}.suspended-status[_ngcontent-%COMP%]{background:#ffe07b 0 0 no-repeat padding-box}.completed-status[_ngcontent-%COMP%]{background:#dfdfdf 0 0 no-repeat padding-box}app-icons[_ngcontent-%COMP%]{float:right;margin-right:15px;line-height:2}"]}),e})();function Qe(e,t){if(1&e&&(m.Vb(0),m.Xb(1,"nz-tag",6),m.Xc(2),m.Wb(),m.Ub()),2&e){const e=t.$implicit;m.Db(1),m.rc("nzColor","#EFFEE2"),m.Db(1),m.Yc(e)}}function Je(e,t){1&e&&(m.Vb(0),m.Xb(1,"h4"),m.Xc(2),m.jc(3,"translate"),m.Wb(),m.Ub()),2&e&&(m.Db(2),m.Yc(m.kc(3,1,"EPISODE.NO_ICD_CODES_ADDED")))}function et(e,t){if(1&e&&(m.Xb(0,"div",2),m.Xb(1,"h4"),m.Xc(2),m.Wb(),m.Wb()),2&e){const e=t.$implicit;m.Db(2),m.Yc(e.value)}}function tt(e,t){if(1&e&&(m.Xb(0,"div",7),m.Vc(1,et,3,1,"div",8),m.jc(2,"keyvalue"),m.Wb()),2&e){const e=m.ic();m.Db(1),m.rc("ngForOf",m.kc(2,1,null==e.episodeDetails?null:e.episodeDetails.serviceCodes))}}function nt(e,t){1&e&&(m.Vb(0),m.Xb(1,"h4"),m.Xc(2),m.jc(3,"translate"),m.Wb(),m.Ub()),2&e&&(m.Db(2),m.Yc(m.kc(3,1,"EPISODE.NO_SERVICE_CODES_ADDED")))}const it=function(){return[32,32]};let st=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=m.Lb({type:e,selectors:[["app-codes"]],inputs:{episodeDetails:"episodeDetails"},decls:14,vars:10,consts:[[1,"container"],["nz-row","",3,"nzGutter"],["nz-col","","nzSpan","12"],[4,"ngFor","ngForOf"],[4,"ngIf"],["nz-row","","nzGutter","16",4,"ngIf"],[3,"nzColor"],["nz-row","","nzGutter","16"],["nz-col","","nzSpan","12",4,"ngFor","ngForOf"]],template:function(e,t){if(1&e&&(m.Xb(0,"div",0),m.Xb(1,"div",1),m.Xb(2,"div",2),m.Xb(3,"label"),m.Xc(4,"ICD Codes - Diagnosis"),m.Wb(),m.Vc(5,Qe,3,2,"ng-container",3),m.Vc(6,Je,4,3,"ng-container",4),m.Wb(),m.Xb(7,"div",2),m.Xb(8,"label"),m.Xc(9,"CPT Codes - Services"),m.Wb(),m.Vc(10,tt,3,3,"div",5),m.jc(11,"keyvalue"),m.Vc(12,nt,4,3,"ng-container",4),m.jc(13,"keyvalue"),m.Wb(),m.Wb(),m.Wb()),2&e){let e=null,n=null;m.Db(1),m.rc("nzGutter",m.xc(9,it)),m.Db(4),m.rc("ngForOf",null==t.episodeDetails?null:t.episodeDetails.icdCodes),m.Db(1),m.rc("ngIf",!(null!=t.episodeDetails&&null!=t.episodeDetails.icdCodes&&t.episodeDetails.icdCodes.length)),m.Db(4),m.rc("ngIf",null==(e=m.kc(11,5,null==t.episodeDetails?null:t.episodeDetails.serviceCodes))?null:e.length),m.Db(2),m.rc("ngIf",!(null!=(n=m.kc(13,7,null==t.episodeDetails?null:t.episodeDetails.serviceCodes))&&n.length))}},directives:[O.c,O.a,s.p,s.q,me.a],pipes:[s.j,Q.a],styles:[".ant-row[_ngcontent-%COMP%]{margin-bottom:20px!important}label[_ngcontent-%COMP%]{color:var(--tertiary-color);margin-bottom:10px;display:block}h4[_ngcontent-%COMP%], label[_ngcontent-%COMP%]{font:normal normal normal 13px/16px Nunito}h4[_ngcontent-%COMP%]{font-weight:700;margin-bottom:0}.ant-tag[_ngcontent-%COMP%]{background-color:#effee2;font:normal normal normal 12px/16px Nunito;font-weight:700;color:var(--light-black);padding:5px;max-width:100%;overflow:hidden;text-overflow:ellipsis}"]}),e})();var at=n("wpKq"),ot=n("ZKr6");function lt(e,t){1&e&&(m.Xb(0,"strong",13),m.Xb(1,"label",14),m.Xc(2,"Convert To Complex CCM"),m.Wb(),m.Wb())}function rt(e,t){1&e&&(m.Xb(0,"strong",13),m.Xb(1,"label",14),m.Xc(2,"Convert To Non-Complex CCM"),m.Wb(),m.Wb())}function ct(e,t){if(1&e){const e=m.Yb();m.Xb(0,"div",10),m.ec("click",function(){return m.Lc(e),m.ic(2).convertCCMEpisode()}),m.Xb(1,"div",4),m.Sb(2,"app-icons",11),m.Wb(),m.Xc(3," \xa0 "),m.Vc(4,lt,3,0,"strong",12),m.Vc(5,rt,3,0,"strong",12),m.Xc(6," \xa0 "),m.Sb(7,"app-icons",8),m.Wb()}if(2&e){const e=m.ic(2);m.Db(2),m.rc("originalStyle",!0),m.Db(2),m.rc("ngIf",!(null==e.episodeDetails||!e.episodeDetails.serviceCodes[99490])),m.Db(1),m.rc("ngIf",!(null==e.episodeDetails||!e.episodeDetails.serviceCodes[99487]))}}const dt=function(){return[32,32]},bt=function(e){return{disabled:e}};function pt(e,t){if(1&e){const e=m.Yb();m.Xb(0,"div",1),m.Xb(1,"h4"),m.Xc(2,"Other actions"),m.Wb(),m.Xb(3,"div",2),m.Xb(4,"div",3),m.ec("click",function(){return m.Lc(e),m.ic().showEpisodeSuspender()}),m.Xb(5,"div",4),m.Sb(6,"app-icons",5),m.Wb(),m.Xc(7," \xa0 "),m.Xb(8,"strong",6),m.Xb(9,"label",7),m.Xc(10),m.jc(11,"translate"),m.Wb(),m.Wb(),m.Xc(12," \xa0 "),m.Sb(13,"app-icons",8),m.Wb(),m.Vc(14,ct,8,3,"div",9),m.Wb(),m.Wb()}if(2&e){const e=m.ic();m.Db(3),m.rc("nzGutter",m.xc(8,dt)),m.Db(1),m.rc("ngClass",m.yc(9,bt,"SUSPENDED"===(null==e.episodeDetails?null:e.episodeDetails.status)||"COMPLETED"===(null==e.episodeDetails?null:e.episodeDetails.status))),m.Db(2),m.rc("originalStyle",!0),m.Db(3),m.rc("ngClass",m.yc(11,bt,"SUSPENDED"===(null==e.episodeDetails?null:e.episodeDetails.status)||"COMPLETED"===(null==e.episodeDetails?null:e.episodeDetails.status))),m.Db(1),m.Zc(" ",m.kc(11,6,"CONSENT.SUSPEND_EPISODE")," "),m.Db(4),m.rc("ngIf","CCM"===(null==e.episodeDetails?null:e.episodeDetails.type)&&"IN_PROGRESS"===(null==e.episodeDetails?null:e.episodeDetails.status))}}const ut=function(){return["SUSPEND_EPISODE"]};let ht=(()=>{class e{constructor(e,t,n,i){this._episodeModalService=e,this._episodesService=t,this._activatedRoute=n,this._notificationsService=i,this.refreshEpisode=new m.n}showEpisodeSuspender(){const e=this._activatedRoute.snapshot.paramMap.get("episodeId");this._episodeModalService.createSuspendModal(e).afterClose.subscribe(e=>{e&&this.refreshEpisodeState()})}convertCCMEpisode(){var e;this._episodesService.switchCCMEpisodeComplexity(null===(e=this.episodeDetails)||void 0===e?void 0:e.id).subscribe(()=>{this._notificationsService.success("CCM Episode","CCM episode complexity switched!"),this.refreshEpisodeState()})}refreshEpisodeState(){this.refreshEpisode.emit(!0)}}return e.\u0275fac=function(t){return new(t||e)(m.Rb(at.a),m.Rb(u.a),m.Rb(C.a),m.Rb(D.b))},e.\u0275cmp=m.Lb({type:e,selectors:[["app-episode-quick-actions"]],inputs:{episodeDetails:"episodeDetails"},outputs:{refreshEpisode:"refreshEpisode"},decls:1,vars:2,consts:[["class","container",4,"isFeaturePermitted"],[1,"container"],["nz-row","",3,"nzGutter"],["nz-col","","nzXs","24","nzSm","12","nzMd","8",3,"ngClass","click"],[1,"profile-icon"],["name","profileDelete","size","23px",3,"originalStyle"],["nz-typography","","nzType","danger"],["actionable","","nz-typography","","nzType","danger",3,"ngClass"],["name","arrowRight"],["nz-col","","nzXs","24","nzSm","12","nzMd","8",3,"click",4,"ngIf"],["nz-col","","nzXs","24","nzSm","12","nzMd","8",3,"click"],["name","profileEdit","size","23px",3,"originalStyle"],["nz-typography","",4,"ngIf"],["nz-typography",""],["actionable","","nz-typography",""]],template:function(e,t){1&e&&m.Vc(0,pt,15,13,"div",0),2&e&&m.rc("isFeaturePermitted",m.xc(1,ut))},directives:[ot.a,O.c,O.a,s.o,oe.a,T.a,Fe.a,s.q],pipes:[Q.a],styles:["*[_ngcontent-%COMP%]{font-size:12px}.container[_ngcontent-%COMP%]{width:100%;height:150px;background:var(--neutral-color) 0 0 no-repeat padding-box;border:1px solid var(--grey)}h4[_ngcontent-%COMP%]{padding:8px 8px 0;font-weight:700;margin-bottom:25px}[_nghost-%COMP%]     .ant-col-6{cursor:pointer}.profile-icon[_ngcontent-%COMP%]{padding:8px;background-color:#e9e9e9;border-radius:50%;height:40px;width:40px;text-align:center;display:inline-block}strong[_ngcontent-%COMP%]{line-height:32px}app-icons[_ngcontent-%COMP%], strong[_ngcontent-%COMP%]{vertical-align:text-bottom;display:inline-block;height:70%}app-icons[_ngcontent-%COMP%]{line-height:40px}.profile-icon[_ngcontent-%COMP%]   app-icons[_ngcontent-%COMP%]{vertical-align:unset}.disabled[_ngcontent-%COMP%]{color:grey;pointer-events:none}@media screen and (orientation:portrait){.container[_ngcontent-%COMP%]{height:-moz-fit-content;height:fit-content;height:-webkit-fit-content}}"]}),e})();var gt=n("AytR");class ft{}var vt=n("7Xlp"),mt=n("OzZK"),Ct=n("RwU8"),Dt=n("jhN1");let St=(()=>{class e{constructor(e){this._sanitizer=e}transform(e){return this._sanitizer.bypassSecurityTrustHtml(e)}}return e.\u0275fac=function(t){return new(t||e)(m.Rb(Dt.b))},e.\u0275pipe=m.Qb({name:"sanitizeHtml",type:e,pure:!0}),e})();function Et(e,t){1&e&&(m.Vb(0),m.Xb(1,"div",1),m.Sb(2,"nz-spin",2),m.Wb(),m.Ub())}function Ot(e,t){if(1&e){const e=m.Yb();m.Xb(0,"button",9),m.ec("click",function(){return m.Lc(e),m.ic(2).consentSubmit("DENY")}),m.Xc(1),m.jc(2,"translate"),m.Wb()}2&e&&(m.Db(1),m.Zc(" ",m.kc(2,1,"CONSENT.DENY_CONSENT")," "))}function It(e,t){1&e&&(m.Vb(0),m.Xc(1),m.jc(2,"translate"),m.Ub()),2&e&&(m.Db(1),m.Zc(" ",m.kc(2,1,"CONSENT.ISSUE_ORDER")," "))}function _t(e,t){1&e&&(m.Vb(0),m.Xc(1),m.jc(2,"translate"),m.Ub()),2&e&&(m.Db(1),m.Zc(" ",m.kc(2,1,"CONSENT.SUBMIT_CONSENT")," "))}function Xt(e,t){if(1&e){const e=m.Yb();m.Vb(0),m.Sb(1,"div",3),m.jc(2,"sanitizeHtml"),m.Xb(3,"div",4),m.Xb(4,"div",5),m.Vc(5,Ot,3,3,"button",6),m.Wb(),m.Xb(6,"div",7),m.Xb(7,"button",8),m.ec("click",function(){return m.Lc(e),m.ic().consentSubmit("AGREE")}),m.Vc(8,It,3,3,"ng-container",0),m.Vc(9,_t,3,3,"ng-container",0),m.Wb(),m.Wb(),m.Wb(),m.Ub()}if(2&e){const e=m.ic();m.Db(1),m.rc("innerHTML",m.kc(2,4,e.consentForm),m.Mc),m.Db(4),m.rc("ngIf","DOCTORS_ORDER"!==e.consent),m.Db(3),m.rc("ngIf","DOCTORS_ORDER"===e.consent),m.Db(1),m.rc("ngIf","DOCTORS_ORDER"!==e.consent)}}let Tt=(()=>{class e{constructor(e,t){this._episodesService=e,this._modalRef=t,this.rootURL=gt.g.url}ngOnInit(){this.loading=!0,"DOCTORS_ORDER"==this.consent?this._episodesService.getDigitalDoctorsOrder(this.patientId,this.episodeId,"DIGITAL_CONSENT").subscribe(e=>{this.loading=!1,this.consentForm=e},e=>{if(e.error){const t=JSON.parse(e.error);this.loading=!1,this._modalRef.close(t.type)}}):this._episodesService.getDigitalConsent(this.patientId,this.episodeType,"DIGITAL_CONSENT").subscribe(e=>{this.loading=!1,this.consentForm=e})}consentSubmit(e){this._modalRef.close(e)}}return e.\u0275fac=function(t){return new(t||e)(m.Rb(u.a),m.Rb(We.e))},e.\u0275cmp=m.Lb({type:e,selectors:[["app-consent-form-sign-popup"]],inputs:{patientId:"patientId",episodeType:"episodeType",episodeId:"episodeId",consent:"consent"},decls:2,vars:2,consts:[[4,"ngIf"],[1,"spin-container"],["nzSimple",""],[1,"table-responsive",3,"innerHTML"],["nz-row",""],["nz-col","","nzSpan","8"],["nz-button","","nzType","default","nzDanger","",3,"click",4,"ngIf"],["nz-col","","nzSpan","8","nzOffset","8",2,"text-align","right"],["nz-button","","nzType","primary",3,"click"],["nz-button","","nzType","default","nzDanger","",3,"click"]],template:function(e,t){1&e&&(m.Vc(0,Et,3,0,"ng-container",0),m.Vc(1,Xt,10,6,"ng-container",0)),2&e&&(m.rc("ngIf",t.loading),m.Db(1),m.rc("ngIf",!t.loading))},directives:[s.q,ae.a,O.c,O.a,mt.a,Ct.a,A.a],pipes:[St,Q.a],styles:[".spin-container[_ngcontent-%COMP%]{text-align:center;border-radius:4px;padding:30px 50px;margin:20px 0;height:400px}"]}),e})(),Nt=(()=>{class e{constructor(e){this._notificationsService=e}handle(e,t){switch(e){case"CARETAKER_NOT_ASSIGNED":this._notificationsService.error(t.get("PHYSICIAN_ORDER"),t.get("DOCTORS_ORDER.NO_CLINICIANS_ASSIGNED"));break;case"DST_NOT_ASSIGNED":this._notificationsService.error(t.get("PHYSICIAN_ORDER"),t.get("DOCTORS_ORDER.DST_NOT_ASSIGNED_MESSAGE"));break;case"MR_NUMBER_NOT_ADDED":this._notificationsService.error(t.get("PHYSICIAN_ORDER"),t.get("DOCTORS_ORDER.MR_NUMBER_NOT_ASSIGNED_MESSAGE"));break;case"INVALID_ADDRESS_ADDED":this._notificationsService.error(t.get("PHYSICIAN_ORDER"),t.get("DOCTORS_ORDER.INVALID_ADDRESS_NOT_ASSIGNED_MESSAGE"));break;case"DST_NOT_COMPLETED":this._notificationsService.error(t.get("PHYSICIAN_ORDER"),t.get("DOCTORS_ORDER.DST_NOT_COMPLETED_MESSAGE"));break;case"INVALID_PATIENT_PHONE_NUMBER":this._notificationsService.error(t.get("PHYSICIAN_ORDER"),t.get("DOCTORS_ORDER.INVALID_PATIENT_PHONE_NUMBER_MESSAGE"))}}}return e.\u0275fac=function(t){return new(t||e)(m.bc(D.b))},e.\u0275prov=m.Nb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var zt=function(e){return e.MANUAL_ORDER="MANUAL_ORDER",e.DIGITAL_ORDER="DIGITAL_ORDER",e}({}),Mt=n("D9mS");function yt(e,t){if(1&e){const e=m.Yb();m.Xb(0,"div",6),m.Xb(1,"p"),m.Xc(2),m.jc(3,"translate"),m.Wb(),m.Xb(4,"button",7),m.ec("click",function(){return m.Lc(e),m.ic(2).getDigitalDoctorsOrder()}),m.Xc(5),m.jc(6,"translate"),m.Wb(),m.Wb()}if(2&e){const e=m.ic(2);m.Db(2),m.Zc(" ",m.kc(3,3,"CONSENT.DIGITAL_SIGNATURE_MESSAGE")," "),m.Db(2),m.rc("disabled","SCHEDULED"!==(null==e.episodeDetails?null:e.episodeDetails.status)&&"IN_PROGRESS"!==(null==e.episodeDetails?null:e.episodeDetails.status)),m.Db(1),m.Yc(m.kc(6,5,"COMMON.NEXT"))}}function At(e,t){if(1&e&&(m.Xb(0,"div",6),m.Xb(1,"p"),m.Xc(2),m.jc(3,"translate"),m.Wb(),m.Xb(4,"nz-upload",8),m.Xb(5,"button",9),m.Xc(6),m.jc(7,"translate"),m.Wb(),m.Wb(),m.Wb()),2&e){const e=m.ic(2);m.Db(2),m.Yc(m.kc(3,5,"CONSENT.PHYSICIAN_ORDER_MANUAL_UPLOAD_DESCRIPTION")),m.Db(2),m.rc("nzCustomRequest",e.handleUpload)("nzShowUploadList",!1),m.Db(1),m.rc("disabled","SCHEDULED"!==(null==e.episodeDetails?null:e.episodeDetails.status)&&"IN_PROGRESS"!==(null==e.episodeDetails?null:e.episodeDetails.status)),m.Db(1),m.Yc(m.kc(7,7,"COMMON.UPLOAD"))}}function Pt(e,t){if(1&e){const e=m.Yb();m.Vb(0),m.Xb(1,"p"),m.Xc(2),m.jc(3,"translate"),m.Wb(),m.Xb(4,"nz-radio-group",2),m.ec("ngModelChange",function(t){return m.Lc(e),m.ic().physicianOrderType=t}),m.Xb(5,"label",3),m.Xc(6),m.jc(7,"translate"),m.Wb(),m.Xb(8,"label",4),m.Xc(9),m.jc(10,"translate"),m.Wb(),m.Wb(),m.Vc(11,yt,7,7,"div",5),m.Vc(12,At,8,9,"div",5),m.Ub()}if(2&e){const e=m.ic();m.Db(2),m.Zc(" ",m.kc(3,7,"CONSENT.PHYSICIAN_ORDER_DESCRIPTION")," "),m.Db(2),m.rc("ngModel",e.physicianOrderType)("nzDisabled",e.fileList&&(null==e.fileList?null:e.fileList.length)>0||"SCHEDULED"!==(null==e.episodeDetails?null:e.episodeDetails.status)&&"IN_PROGRESS"!==(null==e.episodeDetails?null:e.episodeDetails.status)),m.Db(2),m.Zc(" ",m.kc(7,9,"CONSENT.VIA_DIGITAL_SIGNATURE")," "),m.Db(3),m.Zc(" ",m.kc(10,11,"CONSENT.BY_UPLOADING_SIGNED_PHYSICIAN_ORDER")," "),m.Db(2),m.rc("ngIf","DIGITAL_ORDER"===e.physicianOrderType&&0===(null==e.fileList?null:e.fileList.length)),m.Db(1),m.rc("ngIf","MANUAL_ORDER"===e.physicianOrderType)}}function Wt(e,t){if(1&e){const e=m.Yb();m.Vb(0),m.Sb(1,"br"),m.Xb(2,"div",10),m.Xb(3,"div",11),m.Xb(4,"h4",12),m.Xc(5,"Physician order obtained"),m.Wb(),m.Xb(6,"label"),m.Xc(7),m.jc(8,"date"),m.Wb(),m.Wb(),m.Xb(9,"div",11),m.Xb(10,"div",13),m.Xb(11,"label"),m.Xc(12,"Physician order"),m.Wb(),m.Xb(13,"p",14),m.ec("click",function(){m.Lc(e);const t=m.ic();return t.view(null==t.episodeDetails||null==t.episodeDetails.physicianOrders[0]?null:t.episodeDetails.physicianOrders[0].orderURL)}),m.Sb(14,"app-icons",15),m.Xc(15),m.jc(16,"translate"),m.Wb(),m.Wb(),m.Wb(),m.Wb(),m.Ub()}if(2&e){const e=m.ic();m.Db(7),m.Zc("on ",m.lc(8,3,null==e.episodeDetails||null==e.episodeDetails.physicianOrders[0]?null:e.episodeDetails.physicianOrders[0].uploadedOn,"mediumDate"),""),m.Db(7),m.rc("altColorScheme",!0),m.Db(1),m.Zc(" ",m.kc(16,6,"CONSENT.VIEW")," ")}}let Rt=(()=>{class e{constructor(e,t,n,i,s,a,o){this._notificationsService=e,this._episodesService=t,this._modalService=n,this._episodesEventLogger=i,this._applicationInsightsService=s,this._translationService=a,this.consentFormErrorHandler=o,this.fileList=[],this.rootUrl=gt.g.url,this.strings=["EPISODE","PHYSICIAN_ORDER","CONSENT.UNABLE_TO_UPLOAD_FILE","PHYSICIAN_ORDER.ADDED_TO_EPISODE","PHYSICIAN_ORDER.REMOVED_SUCCESSFULLY","PHYSICIAN_ORDER.DELETE_CONSENT_TITLE","SELECT_CLINICIAN_B4_PROCEEDING","DOCTORS_ORDER.DST_NOT_ASSIGNED_MESSAGE","DOCTORS_ORDER.INVALID_ADDRESS_NOT_ASSIGNED_MESSAGE","DOCTORS_ORDER.MR_NUMBER_NOT_ASSIGNED_MESSAGE","DOCTORS_ORDER.DST_NOT_COMPLETED_MESSAGE","DOCTORS_ORDER.INVALID_PATIENT_PHONE_NUMBER_MESSAGE"],this.consentChanged=new m.n,this.handleUpload=e=>{this.loading=!0,this._episodesEventLogger.pictureUploadEvent("upload_physician_order"),this._episodesService.uploadConsent(e.file.name,e.file,this.patientId,"PHYSICIAN_ORDER").subscribe(e=>{this.addPhysicianOrderFileToEpisode(e.filename)},()=>{this._notificationsService.error(this.translatedStrings.get("EPISODE"),this.translatedStrings.get("CONSENT.UNABLE_TO_UPLOAD_FILE"))},()=>{this.loading=!1})}}set episode(e){this.episodeDetails=e,this.patientId=this.episodeDetails.patientId,this.episodeId=this.episodeDetails.id,this.episodeType=this.episodeDetails.type,this.episodeEndDate=this.episodeDetails.endDate,this.setPhysicianOrders(e.physicianOrders)}ngOnInit(){this.$translationSubscription=this._translationService.getMultiple(...this.strings).subscribe(e=>this.translatedStrings=e)}setPhysicianOrders(e){var t;this.fileList=[],e&&(this.physicianOrderType=(null===(t=e.find(e=>zt.DIGITAL_ORDER==e.physicianOrderType))||void 0===t?void 0:t.physicianOrderType)||zt.MANUAL_ORDER,e.forEach(e=>{const t=this.getPhysicianOrderObject(e);this.fileList.push(t)}))}getPhysicianOrderObject(e){if(!e)return;let t=e.orderURL,n=t.substring(t.lastIndexOf(":")+1,t.length);return t.startsWith("http")&&(n=t.split(":")[2]),{url:t,uid:"_"+Math.random().toString(36).substr(2,9),status:"done",name:n,dateOfSubmission:e.uploadedOn,episodeType:""}}view(e){this._episodesEventLogger.episodeActionEvent(this.episodeId,this.patientId,"download_physicianOrder");let t="";t=e.startsWith("http")?`filename=${e.substring(e.lastIndexOf("/")+1,e.length)}`:`filename=${e}&asset-type=PHYSICIAN_ORDER`;let n=`${this.rootUrl}/v1/assets/view?${t}`;this._applicationInsightsService.downloadSuccessReportEvent(this.patientId,n,"patients_consent","patients_consent"),window.open(n,"_blank")}addPhysicianOrderFileToEpisode(e){const t=new ft;t.orderURL=e,t.uploadedOn=Date.now(),this._episodesService.addPhysicianOrderToPatientAndEpisode(this.episodeId,t).subscribe(e=>{if(e){this.fileList=[];let t=e.physicianOrders;for(let e of t)this.fileList.push(this.getPhysicianOrderObject(e));this._notificationsService.success(this.translatedStrings.get("PHYSICIAN_ORDER"),this.translatedStrings.get("PHYSICIAN_ORDER.ADDED_TO_EPISODE")),this.consentChanged.emit()}})}deleteConsentFileToEpisode(e){this._modalService.confirm({nzTitle:this.translatedStrings.get("PHYSICIAN_ORDER.DELETE_CONSENT_TITLE"),nzOnOk:()=>{const t={consentFile:e,assignerId:localStorage.getItem("loggedInUser")};this._episodesService.deleteEpisodeConsent(this.episodeId,t).subscribe(()=>{this.fileList=this.fileList.filter(t=>t.url!==e),this._notificationsService.success(this.translatedStrings.get("PHYSICIAN_ORDER"),this.translatedStrings.get("PHYSICIAN_ORDER.REMOVED_SUCCESSFULLY")),this.consentChanged.emit()})}})}getDigitalDoctorsOrder(){this._modalService.create({nzContent:Tt,nzComponentParams:{patientId:this.patientId,episodeType:this.episodeType,consent:"DOCTORS_ORDER",episodeId:this.episodeId},nzFooter:null,nzWidth:1e3,nzClosable:!0,nzMaskClosable:!1}).afterClose.subscribe(e=>{"AGREE"==e&&this.acceptConsent(),this.consentFormErrorHandler.handle(e,this.translatedStrings)})}acceptConsent(){this._episodesService.submitDoctorsOrder({consentType:"DIGITAL_CONSENT",episodeId:this.episodeId,patientId:this.patientId}).subscribe(e=>{this._episodesEventLogger.episodeConsentActionEvent(this.episodeId,this.patientId,"doctors_order_accepted","DIGITAL_CONSENT"),this.consentChanged.emit(),this._notificationsService.create("success",this.translatedStrings.get("PHYSICIAN_ORDER"),this.translatedStrings.get("PHYSICIAN_ORDER.ADDED_TO_EPISODE"))})}}return e.\u0275fac=function(t){return new(t||e)(m.Rb(D.b),m.Rb(u.a),m.Rb(We.f),m.Rb(ye.a),m.Rb(vt.a),m.Rb(G.a),m.Rb(Nt))},e.\u0275cmp=m.Lb({type:e,selectors:[["app-consent-forms"]],inputs:{episode:["episodeDetails","episode"]},outputs:{consentChanged:"consentChanged"},decls:7,vars:5,consts:[["nz-typography",""],[4,"ngIf"],[3,"ngModel","nzDisabled","ngModelChange"],["nz-radio","","nzValue","DIGITAL_ORDER"],["nz-radio","","nzValue","MANUAL_ORDER"],["class","order-actions-div",4,"ngIf"],[1,"order-actions-div"],["nz-button","","nzType","primary",1,"upload-btn",3,"disabled","click"],[3,"nzCustomRequest","nzShowUploadList"],["nz-button","","nzType","primary",1,"upload-btn",3,"disabled"],["nz-row","","nzGutter","32"],["nz-col","","nzXs","24","nzSm","12","nzMd","6"],["nz-typography","","nzType","success"],[1,"order-container"],["actionable","","nz-typography","","nzType","success",3,"click"],["size","14px","name","view",3,"altColorScheme"]],template:function(e,t){1&e&&(m.Xb(0,"nz-card"),m.Xb(1,"h3",0),m.Xc(2),m.jc(3,"translate"),m.Wb(),m.Vc(4,Pt,13,13,"ng-container",1),m.Vc(5,Wt,17,8,"ng-container",1),m.Wb(),m.Sb(6,"br")),2&e&&(m.Db(2),m.Yc(m.kc(3,3,"PHYSICIAN_ORDER")),m.Db(2),m.rc("ngIf",!(null!=t.episodeDetails&&null!=t.episodeDetails.physicianOrders&&t.episodeDetails.physicianOrders.length)),m.Db(1),m.rc("ngIf",null==t.episodeDetails||null==t.episodeDetails.physicianOrders?null:t.episodeDetails.physicianOrders.length))},directives:[I.a,T.a,s.q,M.c,c.u,c.x,M.b,mt.a,Ct.a,A.a,Mt.a,O.c,O.a,Fe.a,oe.a],pipes:[Q.a,s.e],styles:["nz-card[_ngcontent-%COMP%]{padding:10px;text-align:left}h3[_ngcontent-%COMP%]{margin-bottom:0}.text-center[_ngcontent-%COMP%]{text-align:center}.action-buttons[_ngcontent-%COMP%]{width:200px}.consent-action[_ngcontent-%COMP%]{color:#5bbd71;border-color:#5bbd71}[nz-radio][_ngcontent-%COMP%]{font-weight:700;margin-right:100px}button[_ngcontent-%COMP%]{min-width:160px;min-height:40px;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content}p[_ngcontent-%COMP%]:first-of-type{margin-top:20px;margin-bottom:20px}.upload-btn[_ngcontent-%COMP%]{display:block}.order-actions-div[_ngcontent-%COMP%]{margin:20px 0 10px}.order-container[_ngcontent-%COMP%]{width:100%;border-radius:10px;border:1px solid #dcdcdc;padding:30px 15px 15px!important}.order-container[_ngcontent-%COMP%]:hover{box-shadow:0 3px 6px #00000029;border:1px solid #8bc34a}.order-container[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600}.order-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 1em}app-icons[_ngcontent-%COMP%]{vertical-align:text-top}"]}),e})();var wt=n("W4mZ");let Lt=(()=>{class e{constructor(e){this.scriptService=e}ngOnInit(){this.scriptService.setShowConsentScriptObservable(!0)}ngOnDestroy(){this.scriptService.setShowConsentScriptObservable(!1)}}return e.\u0275fac=function(t){return new(t||e)(m.Rb(wt.a))},e.\u0275cmp=m.Lb({type:e,selectors:[["app-consent-script"]],inputs:{htmlContent:"htmlContent"},decls:1,vars:1,consts:[[3,"innerHTML"]],template:function(e,t){1&e&&m.Sb(0,"div",0),2&e&&m.rc("innerHTML",t.htmlContent,m.Mc)},styles:[""]}),e})(),xt=(()=>{class e{constructor(e){this._modalRef=e,this.dontShowAgain=!1}initiateCall(){this.close({hidePopup:this.dontShowAgain,continueToCall:!0})}close(e={hidePopup:!1,continueToCall:!1}){this._modalRef.destroy(e)}}return e.\u0275fac=function(t){return new(t||e)(m.Rb(We.e))},e.\u0275cmp=m.Lb({type:e,selectors:[["app-audio-call-info-popup"]],decls:29,vars:22,consts:[["nz-typography",""],[2,"color","var(--primary-color)"],["xmlns","http://www.w3.org/2000/svg","height","10","viewBox","0 0 30.378 38.004"],["d","M-150.765,233.958h0a.3.3,0,0,0-.117-.234.057.057,0,0,0-.059-.059c-.059-.059-.117-.176-.176-.234h0l-8.606-8.255h0c-.059-.059-.117-.117-.176-.117h-.059a.352.352,0,0,0-.234-.059h-15.983a4.635,4.635,0,0,0-4.625,4.625v28.454a4.635,4.635,0,0,0,4.625,4.625h20.726a4.635,4.635,0,0,0,4.625-4.625v-23.77C-150.707,234.133-150.707,234.016-150.765,233.958Zm-8.548-5.621,5.035,4.8h-2.459a2.6,2.6,0,0,1-2.576-2.576Zm3.981,32.2h-20.726a2.6,2.6,0,0,1-2.576-2.576V229.508a2.6,2.6,0,0,1,2.576-2.576h14.7v3.688a4.635,4.635,0,0,0,4.625,4.625h3.981v22.775A2.588,2.588,0,0,1-155.332,260.538ZM-157.5,246.37a.987.987,0,0,1-1,1H-172.72a1.039,1.039,0,0,1-1.054-1,1,1,0,0,1,1.054-1h14.227A1.026,1.026,0,0,1-157.5,246.37Zm-16.393-6.323a.987.987,0,0,1,1-1h14.227a.987.987,0,0,1,1,1,1.026,1.026,0,0,1-1,1H-172.9A1.026,1.026,0,0,1-173.891,240.047Zm16.393,12.7a.987.987,0,0,1-1,1H-172.72a1.039,1.039,0,0,1-1.054-1,1,1,0,0,1,1.054-1h14.227A.987.987,0,0,1-157.5,252.751Z","transform","translate(180.95 -224.85)",1,"a"],["nz-checkbox","",3,"ngModel","ngModelChange"],["nz-button","","nzType","primary",3,"click"]],template:function(e,t){1&e&&(m.Xb(0,"h2",0),m.Xc(1,"Note"),m.Wb(),m.Xb(2,"p"),m.Xc(3),m.jc(4,"translate"),m.Wb(),m.Xb(5,"p"),m.Xc(6),m.jc(7,"translate"),m.Wb(),m.Xb(8,"p"),m.Xc(9),m.jc(10,"translate"),m.Wb(),m.Xb(11,"p"),m.Xc(12),m.jc(13,"translate"),m.Xb(14,"i",1),m.hc(),m.Xb(15,"svg",2),m.Xb(16,"style"),m.Xc(17," .a { fill: var(--primary-color); stroke: var(--primary-color); stroke-width: 0.3px; } "),m.Wb(),m.Sb(18,"defs"),m.Sb(19,"path",3),m.Wb(),m.Wb(),m.Xc(20),m.jc(21,"translate"),m.Wb(),m.gc(),m.Xb(22,"div"),m.Xb(23,"label",4),m.ec("ngModelChange",function(e){return t.dontShowAgain=e}),m.Xc(24),m.jc(25,"translate"),m.Wb(),m.Xb(26,"button",5),m.ec("click",function(){return t.initiateCall()}),m.Xc(27),m.jc(28,"translate"),m.Wb(),m.Wb()),2&e&&(m.Db(3),m.Yc(m.kc(4,8,"CONSENT.AUDIO_CALL_INFO_LINE1")),m.Db(3),m.Yc(m.kc(7,10,"CONSENT.AUDIO_CALL_INFO_LINE2")),m.Db(3),m.Yc(m.kc(10,12,"CONSENT.AUDIO_CALL_INFO_LINE3")),m.Db(3),m.Zc("",m.kc(13,14,"CONSENT.AUDIO_CALL_INFO_LINE4_PREICON")," "),m.Db(8),m.Zc(" ",m.kc(21,16,"CONSENT.AUDIO_CALL_INFO_LINE4_POSTICON"),"\n"),m.Db(3),m.rc("ngModel",t.dontShowAgain),m.Db(1),m.Yc(m.kc(25,18,"CONSENT.DONT_SHOW_AGAIN")),m.Db(3),m.Zc(" ",m.kc(28,20,"CONSENT.PROCEED_TO_CALL")," "))},directives:[T.a,ve.a,c.u,c.x,mt.a,Ct.a,A.a],pipes:[Q.a],styles:["div[_ngcontent-%COMP%]{margin-top:50px;display:flex;flex-direction:row;justify-content:space-between}"]}),e})();var kt=n("Lrxu");let Vt=(()=>{class e{constructor(e){this._dialog=e}ngOnInit(){}denied(){this._dialog.close(kt.b.DENIED)}obtained(){this._dialog.close(kt.b.OBTAINED)}other(){this._dialog.close(kt.b.IN_PROGRESS)}}return e.\u0275fac=function(t){return new(t||e)(m.Rb(We.e))},e.\u0275cmp=m.Lb({type:e,selectors:[["app-consent-status-popup"]],inputs:{episodeType:"episodeType"},decls:14,vars:15,consts:[["nz-button","","nzSize","default","nzType","default","nzDanger","",3,"click"],["nz-button","","nzSize","default","nzType","primary",3,"click"],["id","other-button","nz-button","","nzSize","default","nzType","default",3,"click"]],template:function(e,t){1&e&&(m.Xb(0,"h3"),m.Xc(1),m.jc(2,"translate"),m.jc(3,"episodeName"),m.Wb(),m.Xb(4,"div"),m.Xb(5,"button",0),m.ec("click",function(){return t.denied()}),m.Xc(6),m.jc(7,"translate"),m.Wb(),m.Xb(8,"button",1),m.ec("click",function(){return t.obtained()}),m.Xc(9),m.jc(10,"translate"),m.Wb(),m.Xb(11,"button",2),m.ec("click",function(){return t.other()}),m.Xc(12),m.jc(13,"translate"),m.Wb(),m.Wb()),2&e&&(m.Db(1),m.ad("",m.kc(2,5,"CONSENT.DID_PATIENT_AGREE")," ",m.kc(3,7,t.episodeType)," episode? "),m.Db(5),m.Zc(" ",m.kc(7,9,"CONSENT.CONSENT_DENIED")," "),m.Db(3),m.Zc(" ",m.kc(10,11,"CONSENT.CONSENT_OBTAINED")," "),m.Db(3),m.Zc(" ",m.kc(13,13,"CONSENT.CONSENT_OTHER")," "))},directives:[mt.a,Ct.a,A.a],pipes:[Q.a,xe.a],styles:["div[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,29%);grid-column-gap:4%;margin-top:15px}button[_ngcontent-%COMP%]{border-width:2px;border-radius:7px;border-style:solid;font-size:13px;font-weight:600;padding:2px}h3[_ngcontent-%COMP%]{font-weight:700}#other-button[_ngcontent-%COMP%]{color:var(--primary-color);border-color:var(--primary-color)}"]}),e})();var Ut=n("Gskk"),Ft=n("KZd8"),jt=n("BZRL");class Yt{}var Gt=n("t6gT");function Bt(e,t){if(1&e&&(m.Xb(0,"label",6),m.Xc(1),m.Wb()),2&e){const e=m.ic().$implicit;m.rc("ngModel",!0),m.Db(1),m.Yc(e)}}function Ht(e,t){if(1&e&&(m.Vb(0),m.Vc(1,Bt,2,2,"label",5),m.Ub()),2&e){const e=t.$implicit;m.Db(1),m.rc("ngIf",e)}}const $t=function(){return{minRows:5,maxRows:5}};function Zt(e,t){if(1&e){const e=m.Yb();m.Vb(0),m.Vc(1,Ht,2,1,"ng-container",3),m.Xb(2,"textarea",4),m.ec("ngModelChange",function(t){return m.Lc(e),m.ic().consentDeniedReasons.additionalReason=t}),m.Wb(),m.Ub()}if(2&e){const e=m.ic();m.Db(1),m.rc("ngForOf",e.consentDeniedReasons.checkboxReasons),m.Db(1),m.rc("disabled",!0)("nzAutosize",m.xc(4,$t))("ngModel",e.consentDeniedReasons.additionalReason)}}let qt=(()=>{class e{constructor(e,t){this._patientsService=e,this._modalRef=t}ngOnInit(){this._patientsService.fetchVitalNote(this.noteId).subscribe(e=>{this.populateConsentDeniedReasons(e.content)})}populateConsentDeniedReasons(e){this.consentDeniedReasons={checkBoxReasons:[],additionalReason:""};const t=e.split(";");this.consentDeniedReasons.checkboxReasons=t[0].split(","),this.consentDeniedReasons.additionalReason=t[1]}close(){this._modalRef.close()}}return e.\u0275fac=function(t){return new(t||e)(m.Rb(p.a),m.Rb(We.e))},e.\u0275cmp=m.Lb({type:e,selectors:[["app-view-consent-denied-details"]],inputs:{noteId:"noteId"},decls:7,vars:7,consts:[["nz-typography",""],[4,"ngIf"],["nz-button","","nzType","primary","nzSize","large",3,"click"],[4,"ngFor","ngForOf"],["nz-input","",3,"disabled","nzAutosize","ngModel","ngModelChange"],["nz-checkbox","","nzDisabled","",3,"ngModel",4,"ngIf"],["nz-checkbox","","nzDisabled","",3,"ngModel"]],template:function(e,t){1&e&&(m.Xb(0,"h2",0),m.Xc(1),m.jc(2,"translate"),m.Wb(),m.Vc(3,Zt,3,5,"ng-container",1),m.Xb(4,"button",2),m.ec("click",function(){return t.close()}),m.Xc(5),m.jc(6,"translate"),m.Wb()),2&e&&(m.Db(1),m.Yc(m.kc(2,3,"CONSENT.CONSENT_DENIED_BECAUSE")),m.Db(2),m.rc("ngIf",t.consentDeniedReasons),m.Db(2),m.Zc(" ",m.kc(6,5,"COMMON.CLOSE")," "))},directives:[T.a,s.q,mt.a,Ct.a,A.a,s.p,N.b,N.a,c.d,c.u,c.x,ve.a],pipes:[Q.a],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;justify-content:center;line-height:2;border-radius:20px;padding:20px;height:100%}label[_ngcontent-%COMP%] + label[_ngcontent-%COMP%]{margin-left:0}textarea[_ngcontent-%COMP%]{margin-top:20px;margin-bottom:30px;background-color:#f6f6f6}.ant-checkbox-wrapper-checked[_ngcontent-%COMP%]{font-weight:700}button[_ngcontent-%COMP%]{display:block;margin:4% auto 2%}[_ngcontent-%COMP%]::-webkit-input-placeholder{color:#949494;float:inline-start}"]}),e})();function Kt(e,t){if(1&e&&(m.Xb(0,"h4"),m.Xc(1),m.Wb()),2&e){const e=m.ic().$implicit;m.Db(1),m.Yc(e)}}function Qt(e,t){if(1&e&&(m.Vb(0),m.Vc(1,Kt,2,1,"h4",4),m.Ub()),2&e){const e=t.$implicit;m.Db(1),m.rc("ngIf",e)}}function Jt(e,t){if(1&e&&(m.Xb(0,"div"),m.Xc(1),m.jc(2,"date"),m.Vc(3,Qt,2,1,"ng-container",2),m.Xc(4),m.Sb(5,"br"),m.Wb()),2&e){const e=t.$implicit;m.Db(1),m.Zc(" ",m.lc(2,3,e.createdOn,"mediumDate")," "),m.Db(2),m.rc("ngForOf",e.checkboxReasons),m.Db(1),m.Zc(" ",e.additionalReason," ")}}let en=(()=>{class e{constructor(e,t){this._patientsService=e,this._modalRef=t}ngOnInit(){this._patientsService.fetchConsentNotesForPatient(this.patientId).subscribe(e=>{this.populateCallHistory(e)})}populateCallHistory(e){this.callFailedReasonHistory=[];for(const t of e){let e={createdOn:t.createdOn,checkboxReasons:[],additionalReason:""};const n=t.content.split(";");e.checkboxReasons=n[0].split(","),e.additionalReason=n[1],this.callFailedReasonHistory.push(e)}}close(){this._modalRef.close()}}return e.\u0275fac=function(t){return new(t||e)(m.Rb(p.a),m.Rb(We.e))},e.\u0275cmp=m.Lb({type:e,selectors:[["app-view-consent-in-progress-details"]],inputs:{patientId:"patientId"},decls:8,vars:7,consts:[["nz-typography",""],[1,"call-history-container"],[4,"ngFor","ngForOf"],["nz-button","","nzType","primary","nzSize","large",3,"click"],[4,"ngIf"]],template:function(e,t){1&e&&(m.Xb(0,"h2",0),m.Xc(1),m.jc(2,"translate"),m.Wb(),m.Xb(3,"div",1),m.Vc(4,Jt,6,6,"div",2),m.Wb(),m.Xb(5,"button",3),m.ec("click",function(){return t.close()}),m.Xc(6),m.jc(7,"translate"),m.Wb()),2&e&&(m.Db(1),m.Yc(m.kc(2,3,"CONSENT.CALL_HISTORY")),m.Db(3),m.rc("ngForOf",t.callFailedReasonHistory),m.Db(2),m.Zc(" ",m.kc(7,5,"COMMON.CLOSE"),"\n"))},directives:[T.a,s.p,mt.a,Ct.a,A.a,s.q],pipes:[Q.a,s.e],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;justify-content:center;line-height:2;border-radius:20px;padding:20px;height:100%}button[_ngcontent-%COMP%]{display:block;margin:4% auto 2%}.call-history-container[_ngcontent-%COMP%]{overflow-y:scroll;height:200px}.call-history-container[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{margin-bottom:5px}.call-history-container[_ngcontent-%COMP%] h4{margin-top:5px;line-height:1;font-weight:600}h4[_ngcontent-%COMP%]{margin-bottom:0}"]}),e})();var tn=n("Z93s");const nn=function(){return{minRows:5,maxRows:5}};let sn=(()=>{class e{constructor(e,t,n){this._patientsService=e,this._modalRef=t,this.translationService=n,this.note=new tn.a,this.strings=["CONSENT.PATIENT_WASNT_INTERESTED","CONSENT.PATIENT_SWITCHED_TO_ANOTHER_PROVIDER","CONSENT.CONSENT_OTHER"],this.otherReasons=""}ngOnInit(){this.initTranslationStrings()}initTranslationStrings(){this.$translationSubscription=this.translationService.getMultiple(...this.strings).subscribe(e=>{this.translatedStrings=e})}saveNote(){this.note.type="CONSENT",this.note.userId=this.patientId,this.note.caretakerIds=new Array,this.note.content=(this.patientNotInterested?this.translatedStrings.get("CONSENT.PATIENT_WASNT_INTERESTED"):"")+(this.switchedProvider?","+this.translatedStrings.get("CONSENT.PATIENT_SWITCHED_TO_ANOTHER_PROVIDER"):"")+(this.othersCheckbox?","+this.translatedStrings.get("CONSENT.CONSENT_OTHER"):"")+";"+this.otherReasons,""!=this.note.content&&(null==localStorage.getItem("loggedInUser")?this.submitNoteWithId():this.submitNote())}submitNote(){this._patientsService.addNoteForPatient(this.note).subscribe(e=>{e.assignerId=localStorage.getItem("loggedInUser"),e.archived=!1,e.reason=this.note.content,this._modalRef.close(e)})}submitNoteWithId(){this._patientsService.addNoteForPatientWithId(this.patientId,this.note).subscribe(e=>{e.archived=!1,e.reason=this.note.content,this._modalRef.close(e)})}}return e.\u0275fac=function(t){return new(t||e)(m.Rb(p.a),m.Rb(We.e),m.Rb(G.a))},e.\u0275cmp=m.Lb({type:e,selectors:[["app-add-consent-denied-details-feedback"]],inputs:{patientId:"patientId"},decls:17,vars:25,consts:[["nz-typography",""],["nz-checkbox","","nzValue","Patient wasn't interested",3,"ngModel","ngModelChange"],["nz-checkbox","","nzValue","The patient has switched to another provider",3,"ngModel","ngModelChange"],["nz-checkbox","","nzValue","Other",3,"ngModel","ngModelChange"],["nz-input","",3,"nzAutosize","placeholder","ngModel","ngModelChange"],["nz-button","","nzType","primary","nzSize","large",3,"disabled","click"]],template:function(e,t){1&e&&(m.Xb(0,"h2",0),m.Xc(1),m.jc(2,"translate"),m.Wb(),m.Xb(3,"label",1),m.ec("ngModelChange",function(e){return t.patientNotInterested=e}),m.Xc(4),m.jc(5,"translate"),m.Wb(),m.Xb(6,"label",2),m.ec("ngModelChange",function(e){return t.switchedProvider=e}),m.Xc(7),m.jc(8,"translate"),m.Wb(),m.Xb(9,"label",3),m.ec("ngModelChange",function(e){return t.othersCheckbox=e}),m.Xc(10),m.jc(11,"translate"),m.Wb(),m.Xb(12,"textarea",4),m.ec("ngModelChange",function(e){return t.otherReasons=e}),m.jc(13,"translate"),m.Wb(),m.Xb(14,"button",5),m.ec("click",function(){return t.saveNote()}),m.Xc(15),m.jc(16,"translate"),m.Wb()),2&e&&(m.Db(1),m.Zc("",m.kc(2,12,"CONSENT.CONSENT_NOT_OBTAINED_BECAUSE")," "),m.Db(2),m.rc("ngModel",t.patientNotInterested),m.Db(1),m.Yc(m.kc(5,14,"CONSENT.PATIENT_WASNT_INTERESTED")),m.Db(2),m.rc("ngModel",t.switchedProvider),m.Db(1),m.Yc(m.kc(8,16,"CONSENT.PATIENT_SWITCHED_TO_ANOTHER_PROVIDER")),m.Db(2),m.rc("ngModel",t.othersCheckbox),m.Db(1),m.Yc(m.kc(11,18,"CONSENT.CONSENT_OTHER")),m.Db(2),m.sc("placeholder",m.kc(13,20,"CONSENT.ADD_ADDITIONAL_NOTES")),m.rc("nzAutosize",m.xc(24,nn))("ngModel",t.otherReasons),m.Db(2),m.rc("disabled",!(t.patientNotInterested||t.switchedProvider||t.othersCheckbox&&t.otherReasons)),m.Db(1),m.Yc(m.kc(16,22,"CONSENT.SUSPEND_EPISODE")))},directives:[T.a,ve.a,c.u,c.x,N.b,N.a,c.d,mt.a,Ct.a,A.a],pipes:[Q.a],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;justify-content:center;line-height:2;border-radius:20px;padding:20px;height:100%}label[_ngcontent-%COMP%] + label[_ngcontent-%COMP%]{margin-left:0}textarea[_ngcontent-%COMP%]{margin-top:20px;margin-bottom:30px;background-color:#f6f6f6}.ant-checkbox-wrapper-checked[_ngcontent-%COMP%]{font-weight:700}button[_ngcontent-%COMP%]{display:block;margin:4% auto 2%}[_ngcontent-%COMP%]::-webkit-input-placeholder{color:#949494;float:inline-start}"]}),e})();const an=function(){return{minRows:5,maxRows:5}};let on=(()=>{class e{constructor(e,t,n){this._patientsService=e,this._modalRef=t,this.translationService=n,this.note=new tn.a,this.otherReasons="",this.strings=["CONSENT.PATIENT_WAS_NOT_AVAILABLE","CONSENT.CALL_WENT_TO_VOICEMAIL","CONSENT.CALL_ANOTHER_DAY","CONSENT.PATIENT_WASNT_INTERESTED","CONSENT.PATIENT_SWITCHED_TO_ANOTHER_PROVIDER","CONSENT.CONSENT_OTHER"]}ngOnInit(){this.initTranslationStrings()}initTranslationStrings(){this.$translationSubscription=this.translationService.getMultiple(...this.strings).subscribe(e=>{this.translatedStrings=e})}saveNote(){this.note.type="CONSENT",this.note.userId=this.patientId,this.note.caretakerIds=new Array,this.note.content=(this.patientUnavailable?this.translatedStrings.get("CONSENT.PATIENT_WAS_NOT_AVAILABLE"):"")+(this.callToVoicemail?","+this.translatedStrings.get("CONSENT.CALL_WENT_TO_VOICEMAIL"):"")+(this.callAnotherDay?","+this.translatedStrings.get("CONSENT.CALL_ANOTHER_DAY"):"")+(this.othersCheckbox?","+this.translatedStrings.get("CONSENT.CONSENT_OTHER"):"")+";"+this.otherReasons,""!=this.note.content&&this._patientsService.addNoteForPatient(this.note).subscribe(e=>{e.assignerId=localStorage.getItem("loggedInUser"),e.archived=!1,e.reason=this.note.content,this._modalRef.close(e)})}}return e.\u0275fac=function(t){return new(t||e)(m.Rb(p.a),m.Rb(We.e),m.Rb(G.a))},e.\u0275cmp=m.Lb({type:e,selectors:[["app-add-in-progress-details-feedback"]],inputs:{patientId:"patientId"},decls:21,vars:29,consts:[["nz-typography",""],["nz-checkbox","","nzValue","Patient wasn't available",3,"ngModel","ngModelChange"],["nz-checkbox","","nzValue","Call went to voicemail",3,"ngModel","ngModelChange"],["nz-checkbox","","nzValue","Asked to call another day",3,"ngModel","ngModelChange"],["nz-checkbox","","nzValue","Other",3,"ngModel","ngModelChange"],["nz-input","",3,"nzAutosize","placeholder","ngModel","ngModelChange"],["nzType","primary","nz-button","",3,"disabled","click"]],template:function(e,t){1&e&&(m.Xb(0,"h2",0),m.Xc(1),m.jc(2,"translate"),m.Wb(),m.Xb(3,"label",1),m.ec("ngModelChange",function(e){return t.patientUnavailable=e}),m.Xc(4),m.jc(5,"translate"),m.Wb(),m.Xb(6,"label",2),m.ec("ngModelChange",function(e){return t.callToVoicemail=e}),m.Xc(7),m.jc(8,"translate"),m.Wb(),m.Xb(9,"label",3),m.ec("ngModelChange",function(e){return t.callAnotherDay=e}),m.Xc(10),m.jc(11,"translate"),m.Wb(),m.Xb(12,"label",4),m.ec("ngModelChange",function(e){return t.othersCheckbox=e}),m.Xc(13),m.jc(14,"translate"),m.Wb(),m.Xb(15,"textarea",5),m.ec("ngModelChange",function(e){return t.otherReasons=e}),m.jc(16,"translate"),m.Xc(17,"    "),m.Wb(),m.Xb(18,"button",6),m.ec("click",function(){return t.saveNote()}),m.Xc(19),m.jc(20,"translate"),m.Wb()),2&e&&(m.Db(1),m.Zc("",m.kc(2,14,"CONSENT.CONSENT_NOT_OBTAINED_BECAUSE")," "),m.Db(2),m.rc("ngModel",t.patientUnavailable),m.Db(1),m.Yc(m.kc(5,16,"CONSENT.PATIENT_WAS_NOT_AVAILABLE")),m.Db(2),m.rc("ngModel",t.callToVoicemail),m.Db(1),m.Yc(m.kc(8,18,"CONSENT.CALL_WENT_TO_VOICEMAIL")),m.Db(2),m.rc("ngModel",t.callAnotherDay),m.Db(1),m.Yc(m.kc(11,20,"CONSENT.CALL_ANOTHER_DAY")),m.Db(2),m.rc("ngModel",t.othersCheckbox),m.Db(1),m.Yc(m.kc(14,22,"CONSENT.CONSENT_OTHER")),m.Db(2),m.sc("placeholder",m.kc(16,24,"CONSENT.ADD_ADDITIONAL_NOTES")),m.rc("nzAutosize",m.xc(28,an))("ngModel",t.otherReasons),m.Db(3),m.rc("disabled",!(t.patientUnavailable||t.callToVoicemail||t.callAnotherDay||t.othersCheckbox&&t.otherReasons)),m.Db(1),m.Yc(m.kc(20,26,"CONSENT.SAVE_NOTE")))},directives:[T.a,ve.a,c.u,c.x,N.b,N.a,c.d,mt.a,Ct.a,A.a],pipes:[Q.a],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;justify-content:center;line-height:2;border-radius:20px;padding:20px;height:100%}label[_ngcontent-%COMP%] + label[_ngcontent-%COMP%]{margin-left:0}textarea[_ngcontent-%COMP%]{margin-top:20px;margin-bottom:30px;background-color:#f6f6f6}.ant-checkbox-wrapper-checked[_ngcontent-%COMP%]{font-weight:700}button[_ngcontent-%COMP%]{display:block;margin:4% auto 2%}[_ngcontent-%COMP%]::-webkit-input-placeholder{color:#949494;float:inline-start}"]}),e})();var ln=n("VGjC");class rn{constructor(){this.showInstructions=!0}}const cn=function(){return{minRows:5,maxRows:5}};let dn=(()=>{class e{constructor(e,t){this._modalRef=e,this.translationService=t,this.strings=["CONSENT.PATIENT_DONT_HAVE_ACCESS","CONSENT.TECH_ISSUE","CONSENT.OTHER"]}ngOnInit(){this.initTranslationStrings()}initTranslationStrings(){this.$translationSubscription=this.translationService.getMultiple(...this.strings).subscribe(e=>{this.translatedStrings=e})}submitReason(){let e=[];this.patientNotUsingApp&&e.push(this.translatedStrings.get("CONSENT.PATIENT_DONT_HAVE_ACCESS")),this.techIssue&&e.push(this.translatedStrings.get("CONSENT.TECH_ISSUE")),this.othersCheckbox&&e.push(this.translatedStrings.get("CONSENT.OTHER")),this.otherReasons&&e.push(this.otherReasons),0!==e.length&&this._modalRef.close(e)}}return e.\u0275fac=function(t){return new(t||e)(m.Rb(We.e),m.Rb(G.a))},e.\u0275cmp=m.Lb({type:e,selectors:[["app-revoke-reason"]],decls:23,vars:37,consts:[["nz-typography",""],["nz-checkbox","",3,"nzValue","ngModel","ngModelChange"],["nz-input","",3,"nzAutosize","placeholder","ngModel","ngModelChange"],["nz-button","","nzType","primary","nzSize","large",3,"disabled","click"]],template:function(e,t){1&e&&(m.Xb(0,"h3",0),m.Xc(1),m.jc(2,"translate"),m.Wb(),m.Xb(3,"label",1),m.ec("ngModelChange",function(e){return t.patientNotUsingApp=e}),m.jc(4,"translate"),m.Xc(5),m.jc(6,"translate"),m.Wb(),m.Xb(7,"label",1),m.ec("ngModelChange",function(e){return t.techIssue=e}),m.jc(8,"translate"),m.Xc(9),m.jc(10,"translate"),m.Wb(),m.Xb(11,"label",1),m.ec("ngModelChange",function(e){return t.othersCheckbox=e}),m.jc(12,"translate"),m.Xc(13),m.jc(14,"translate"),m.Wb(),m.Xb(15,"textarea",2),m.ec("ngModelChange",function(e){return t.otherReasons=e}),m.jc(16,"translate"),m.Wb(),m.Xb(17,"p",0),m.Xc(18),m.jc(19,"translate"),m.Wb(),m.Xb(20,"button",3),m.ec("click",function(){return t.submitReason()}),m.Xc(21),m.jc(22,"translate"),m.Wb()),2&e&&(m.Db(1),m.Zc(" ",m.kc(2,16,"CONSENT.REVOKE_MODAL_TITLE"),"\n"),m.Db(2),m.sc("nzValue",m.kc(4,18,"CONSENT.PATIENT_DONT_HAVE_ACCESS")),m.rc("ngModel",t.patientNotUsingApp),m.Db(2),m.Yc(m.kc(6,20,"CONSENT.PATIENT_DONT_HAVE_ACCESS")),m.Db(2),m.sc("nzValue",m.kc(8,22,"CONSENT.TECH_ISSUE")),m.rc("ngModel",t.techIssue),m.Db(2),m.Yc(m.kc(10,24,"CONSENT.TECH_ISSUE")),m.Db(2),m.sc("nzValue",m.kc(12,26,"CONSENT.OTHER")),m.rc("ngModel",t.othersCheckbox),m.Db(2),m.Yc(m.kc(14,28,"CONSENT.OTHER")),m.Db(2),m.sc("placeholder",m.kc(16,30,"ADDITIONAL_NOTE")),m.rc("nzAutosize",m.xc(36,cn))("ngModel",t.otherReasons),m.Db(3),m.Zc(" ",m.kc(19,32,"CONSENT.REVOKE_MODAL_FOOTER_NOTE"),"\n"),m.Db(2),m.rc("disabled",!(t.patientNotUsingApp||t.techIssue||t.othersCheckbox&&t.otherReasons)),m.Db(1),m.Zc(" ",m.kc(22,34,"CONSENT.REVOKE_BUTTON")," "))},directives:[T.a,ve.a,c.u,c.x,N.b,N.a,c.d,mt.a,Ct.a,A.a],pipes:[Q.a],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;justify-content:center;padding:24px}[nz-checkbox][_ngcontent-%COMP%]{margin:4px 0;height:20px}textarea[_ngcontent-%COMP%]{margin:10px auto;background-color:#f6f6f6}p[_ngcontent-%COMP%]{font-size:9px;margin-bottom:15px}button[_ngcontent-%COMP%]{margin:10px auto;width:200px}.ant-checkbox-wrapper-checked[_ngcontent-%COMP%]{font-weight:700}"]}),e})();var bn=n("azu5"),pn=n("V1/G"),un=n("IOC6"),hn=function(e){return e.SMS="SMS",e.MMS="MMS",e}({});class gn{constructor(){this.messageType=hn.SMS}}var fn=n("0EQZ"),vn=n("7RJT"),mn=n("zB/H");class Cn extends fn.b{constructor(e){super(),this.http=e,this.length=10,this.pageSize=7,this.cachedData=Array.from({length:this.length}),this.fetchedPages=new Set,this.dataStream=new vn.BehaviorSubject(this.cachedData),this.subscription=new mn.Subscription,this.rootUrl=gt.g.url}connect(e){return this.subscription.add(e.viewChange.subscribe(e=>{const t=this.getPageForIndex(e.start),n=this.getPageForIndex(e.end-1);for(let i=t;i<=n;i++)this.fetchPage(i)})),this.dataStream}disconnect(){this.dataStream.unsubscribe(),this.subscription.unsubscribe()}getPageForIndex(e){return Math.ceil(e/this.pageSize)}fetchPage(e){this.fetchedPages.has(e)||(this.fetchedPages.add(e),this.endPoint=this.rootUrl+"/v3/sms-template/?limit="+this.pageSize+"&offset="+e,this.http.get(this.endPoint).subscribe(t=>{this.cachedData.splice(e*this.pageSize,this.pageSize,...t.result),this.cachedData=this.cachedData.filter(e=>null!=e),this.length=t.totalCount,this.dataStream.next(this.cachedData)}))}}var Dn=n("tk/3");let Sn=(()=>{class e{constructor(e){this._http=e,this.rootUrl=gt.g.url}sendSms(e){return this.endPoint=this.rootUrl+"/v3/conversation/messages",this._http.post(this.endPoint,e)}getConversations(e,t,n){return this._http.get(this.rootUrl+"/v3/conversation/messages/users/"+e+"?skip="+t+"&limit="+n)}markAsRead(e){return this._http.post(this.rootUrl+"/v3/conversation/messages/read-state",e)}}return e.\u0275fac=function(t){return new(t||e)(m.bc(Dn.c))},e.\u0275prov=m.Nb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var En=n("5+WD"),On=n("vxfF"),In=n("Ff2k"),_n=n("Beax"),Xn=n("OtHt");function Tn(e,t){1&e&&(m.Xb(0,"p"),m.Xc(1),m.jc(2,"translate"),m.Wb()),2&e&&(m.Db(1),m.Zc(" ",m.kc(2,1,"NO_FILTERS_APPLIED")," "))}function Nn(e,t){if(1&e&&(m.Xb(0,"div",3),m.Xb(1,"div",13),m.Xb(2,"nz-card",14),m.Xb(3,"div",13),m.Xb(4,"span",15),m.Sb(5,"app-icons",16),m.Wb(),m.Xb(6,"span",17),m.Xb(7,"strong"),m.Xc(8),m.jc(9,"translate"),m.Wb(),m.Wb(),m.Sb(10,"br"),m.Wb(),m.Xb(11,"div",18),m.Sb(12,"app-filter-desc",19),m.Vc(13,Tn,3,3,"p",7),m.Wb(),m.Wb(),m.Wb(),m.Wb()),2&e){const e=m.ic();m.Db(8),m.Yc(m.kc(9,3,"SMS.APPLIED_FILTERS")),m.Db(4),m.rc("smsScreen",e.smsScreen),m.Db(1),m.rc("ngIf",0===e.noOfFiltersApplied)}}function zn(e,t){1&e&&(m.Xb(0,"div"),m.Xb(1,"div",20),m.Xc(2),m.jc(3,"translate"),m.Wb(),m.Wb()),2&e&&(m.Db(2),m.Zc("*",m.kc(3,1,"COMMON.REQUIRED"),""))}const Mn=function(){return{rows:1}};function yn(e,t){1&e&&m.Sb(0,"nz-skeleton",23),2&e&&m.rc("nzParagraph",m.xc(1,Mn))}function An(e,t){if(1&e){const e=m.Yb();m.Xb(0,"a",27),m.ec("click",function(){m.Lc(e);const t=m.ic(3).$implicit;return m.ic().selectTemplate(t.template)}),m.Xc(1),m.Wb()}if(2&e){const e=m.ic(3).$implicit;m.Db(1),m.Zc(" ",e.template," ")}}function Pn(e,t){if(1&e){const e=m.Yb();m.Xb(0,"a",27),m.ec("click",function(){m.Lc(e);const t=m.ic(3).$implicit;return m.ic().selectTemplate(t.template)}),m.Xc(1),m.Wb()}if(2&e){const e=m.ic(3).$implicit;m.Db(1),m.Zc(" ",e.title," ")}}function Wn(e,t){if(1&e&&(m.Vc(0,An,2,1,"a",26),m.Vc(1,Pn,2,1,"a",26)),2&e){const e=m.ic(2).$implicit;m.rc("ngIf",null==e.title),m.Db(1),m.rc("ngIf",null!=e.title)}}function Rn(e,t){if(1&e&&(m.Xb(0,"nz-list-item-meta",24),m.Vc(1,Wn,2,2,"ng-template",null,25,m.Wc),m.Wb()),2&e){const e=m.Ic(2);m.rc("nzTitle",e)}}function wn(e,t){if(1&e&&(m.Xb(0,"nz-list-item"),m.Vc(1,yn,1,2,"nz-skeleton",21),m.Vc(2,Rn,3,1,"nz-list-item-meta",22),m.Wb()),2&e){const e=t.$implicit;m.Db(1),m.rc("ngIf",!e),m.Db(1),m.rc("ngIf",e)}}const Ln=function(e){return{border:e}};let xn=(()=>{class e{constructor(e,t,n,i,s,a,o){this.http=e,this.smsService=t,this.staffService=n,this._modalRef=i,this.smsTemplateService=s,this.notificationService=a,this.translationService=o,this.dateRange=[],this.smsLink="",this.patientId="",this.assignerName="",this.showFilter=!0,this.noOfFiltersApplied=0,this.usePrimaryNumber=!0,this.smsScreen=!0,this.message="",this.isValidMessage=!0,this.listOfOption=[],this.listOfSelectedValue=[],this.saveTemplateBtnLoading=!1,this.sendMessageBtnLoading=!1,this.allPatientIds=new Array,this.strings=["SMS.SMS_TEMPLATE","SMS.MESSAGE","SMS.MESSAGE_SENT","SMS.PLEASE_ENTER_TEXT","SMS.TEMPLATE_ALREADY_PRESENT","SMS.SMS_TEMPLATE_SAVED","SMS.MESSAGE_SENT_SUCCESSFULLY","TABLEHEADER.RESIDENT","SMS.PLEASE_ADD_RECEPIENT","SMS.MESSAGE_SENT_SUCCESSFULLY_TO_MULTIPLE"],this.$translationSubscription=this.translationService.getMultiple(...this.strings).subscribe(e=>{this.translatedStrings=e})}ngOnDestroy(){this.$translationSubscription.unsubscribe(),this.templates.disconnect(),this.close()}ngOnInit(){this.radioValue="ALL",this.initTemplates(),this.initPatients(),this.initAllPatientsAsRecepients(),this.getPhysiciansForPatient()}initAllPatientsAsRecepients(){this.listOfSelectedValue=this.allPatientIds}initTemplates(){this.templates=new Cn(this.http)}initPatients(){const e=[];this.patientList.forEach(t=>{e.push({label:t.patientName,value:t.patientId}),this.allPatientIds.push(t.patientId)}),this.listOfOption=[...e]}selectTemplate(e){this.saveTemplateBtnLoading=!1,this.sendMessageBtnLoading=!1,null==this.physicianName&&(this.physicianName=this.assignerName),e=e.replace("PHYSICIAN_NAME",this.physicianName),this.message=e+"\n"+this.smsLink}validateSms(){let e=!0;return 0===this.message.length&&(e=!1),0==this.listOfSelectedValue.length&&(e=!1),this.isValidMessage=e,e}sendSms(){if(this.sendMessageBtnLoading=!0,!this.validateSms())return void(this.sendMessageBtnLoading=!1);const e=new gn;e.message=this.message,e.toUsers=this.listOfSelectedValue,e.fromUser=localStorage.getItem("loggedInUser"),e.usePrimaryNumber=this.usePrimaryNumber,this.smsService.sendSms(e).subscribe(e=>{let t;this.sendMessageBtnLoading=!1,t=1==this.listOfSelectedValue.length?this.translatedStrings.get("SMS.MESSAGE_SENT_SUCCESSFULLY"):this.translatedStrings.get("SMS.MESSAGE_SENT_SUCCESSFULLY_TO_MULTIPLE").replace("{COUNT}",this.listOfSelectedValue.length.toString()),this.notificationService.success(this.translatedStrings.get("SMS.MESSAGE_SENT"),t),this.message="SUCCESS",this.close()})}getPhysiciansForPatient(){this.staffService.fetchStaffMemberById(this.patientId).subscribe(e=>{this.physicians=null==e?void 0:e.assignedUsers.PHYSICIAN,this.physicians.length>0&&(this.physicianName=this.physicians[0].fullName)})}saveTemplate(){this.saveTemplateBtnLoading=!0;const e=new pn.a;e.template=this.message,this.smsTemplateService.validateTemplate(e).subscribe(t=>{this.smsTemplateService.saveTemplate(e).subscribe(()=>{this.initTemplates(),this.saveTemplateBtnLoading=!1,this.notificationService.success(this.translatedStrings.get("SMS.SMS_TEMPLATE"),this.translatedStrings.get("SMS.SMS_TEMPLATE_SAVED"))})},e=>this.notificationService.error(this.translatedStrings.get("SMS.SMS_TEMPLATE"),this.translatedStrings.get("SMS.TEMPLATE_ALREADY_PRESENT")))}onRadioChange(e){"ALL"==e?this.initAllPatientsAsRecepients():this.listOfSelectedValue=[]}onChange(){this.saveTemplateBtnLoading=!1,this.sendMessageBtnLoading=!1}close(e=!0){this._modalRef.close(e)}}return e.\u0275fac=function(t){return new(t||e)(m.Rb(Dn.c),m.Rb(Sn),m.Rb(l.a),m.Rb(We.e),m.Rb(un.a),m.Rb(D.b),m.Rb(G.a))},e.\u0275cmp=m.Lb({type:e,selectors:[["app-sms"]],inputs:{episodeType:"episodeType",dateRange:"dateRange",smsLink:"smsLink",patientId:"patientId",assignerName:"assignerName",patientList:"patientList",showFilter:"showFilter",noOfFiltersApplied:"noOfFiltersApplied",usePrimaryNumber:"usePrimaryNumber"},decls:36,vars:25,consts:[["cdkDrag","","cdkDragRootElement",".ant-modal-content","cdkDragHandle",""],["id","title"],["nz-row","","nzGutter","16",4,"ngIf"],["nz-row","","nzGutter","16"],["nz-col","","nzSpan","12"],[1,"header"],["rows","2","nz-input","","placeholder","Type here...",1,"message-textarea",3,"ngStyle","ngModel","ngModelChange"],[4,"ngIf"],[1,"message-count"],["itemSize","73",1,"demo-infinite-container"],[4,"cdkVirtualFor","cdkVirtualForOf"],["nz-col","","nzSpan","24",1,"centerize"],["nz-button","","nzType","primary",3,"nzSize","disabled","click"],["nz-col","","nzSpan","24"],[1,"filter-card"],[1,"info-icon-applied-filter"],["name","infoCircle"],[1,"filter-header"],["nz-col","","nzSpan","24",1,"filter-tag-div"],[3,"smsScreen"],[1,"required-text"],[3,"nzParagraph",4,"ngIf"],[3,"nzTitle",4,"ngIf"],[3,"nzParagraph"],[3,"nzTitle"],["nzTitle",""],["class","template",3,"click",4,"ngIf"],[1,"template",3,"click"]],template:function(e,t){1&e&&(m.Xb(0,"div",0),m.Xb(1,"strong",1),m.Xc(2),m.jc(3,"translate"),m.Wb(),m.Sb(4,"br"),m.Sb(5,"br"),m.Vc(6,Nn,14,5,"div",2),m.Sb(7,"br"),m.Xb(8,"nz-card"),m.Xb(9,"div",3),m.Xb(10,"div",4),m.Xb(11,"strong",5),m.Xc(12),m.jc(13,"translate"),m.Wb(),m.Sb(14,"br"),m.Xb(15,"textarea",6),m.ec("ngModelChange",function(e){return t.message=e})("ngModelChange",function(){return t.onChange()}),m.Wb(),m.Vc(16,zn,4,3,"div",7),m.Xb(17,"label",8),m.Xb(18,"em"),m.Xc(19),m.jc(20,"translate"),m.Wb(),m.Wb(),m.Wb(),m.Xb(21,"div",4),m.Xb(22,"strong",5),m.Xc(23),m.jc(24,"translate"),m.Wb(),m.Sb(25,"br"),m.Sb(26,"br"),m.Xb(27,"cdk-virtual-scroll-viewport",9),m.Xb(28,"nz-list"),m.Vc(29,wn,3,2,"nz-list-item",10),m.Wb(),m.Wb(),m.Wb(),m.Wb(),m.Wb(),m.Sb(30,"br"),m.Xb(31,"div",3),m.Xb(32,"div",11),m.Xb(33,"button",12),m.ec("click",function(){return t.sendSms()}),m.Xc(34),m.jc(35,"translate"),m.Wb(),m.Wb(),m.Wb(),m.Wb()),2&e&&(m.Db(2),m.Zc(" ",m.kc(3,13,"SMS.SEND_SMS")," "),m.Db(4),m.rc("ngIf",t.showFilter),m.Db(6),m.Yc(m.kc(13,15,"COMMON.MESSAGE")),m.Db(3),m.rc("ngStyle",m.yc(23,Ln,t.isValidMessage||0!==(null==t.message?null:t.message.length)?"":"1px solid red"))("ngModel",t.message),m.Db(1),m.rc("ngIf",!t.isValidMessage&&0==(null==t.message?null:t.message.length)),m.Db(3),m.ad("",t.message.length," ",m.kc(20,17,"SMS.CHARACTERS"),""),m.Db(4),m.Zc(" ",m.kc(24,19,"SMS.CHOOSE_FROM_TEMPLATE")," "),m.Db(6),m.rc("cdkVirtualForOf",t.templates),m.Db(4),m.rc("nzSize","medium")("disabled",0==(null==t.listOfSelectedValue?null:t.listOfSelectedValue.length)||t.sendMessageBtnLoading),m.Db(1),m.Zc(" ",m.kc(35,21,"SMS.SEND_SMS")," "))},directives:[En.a,En.b,s.q,I.a,O.c,O.a,N.b,c.d,s.r,c.u,c.x,On.d,On.a,In.a,On.c,mt.a,Ct.a,A.a,oe.a,_n.a,In.e,Xn.a,In.f],pipes:[Q.a],styles:["[_nghost-%COMP%]     .ant-modal-content{background-color:#eff2f0 0 0 no-repeat padding-box}#title[_ngcontent-%COMP%]{padding-left:1%;font-size:14px;font-weight:600;border-left:3px solid var(--primary-color)}.centerize[_ngcontent-%COMP%]{text-align:center}.info-icon-applied-filter[_ngcontent-%COMP%]{font-size:17px;color:var(--primary-color);margin-right:20px}.filter-card[_ngcontent-%COMP%]{margin:15px;border-radius:10px}.required-text[_ngcontent-%COMP%]{color:#ff2e2e;float:left;position:absolute}.ant-tag[_ngcontent-%COMP%]{font-size:10px}.filter-tag-div[_ngcontent-%COMP%]{margin-top:10px}.filter-header[_ngcontent-%COMP%]{text-align:left;font:normal normal normal 12px/21px Nunito;letter-spacing:0;color:var(--primary-color);opacity:1}.message-textarea[_ngcontent-%COMP%]{background:#fbfbfb 0 0 no-repeat padding-box;border:1px solid var(--grey);border-radius:5px;opacity:1;width:100%;min-height:132px;max-height:132px;padding:10px;resize:none}.demo-infinite-container[_ngcontent-%COMP%]{height:300px;border:1px solid var(--grey);border-radius:4px}nz-list[_ngcontent-%COMP%]{padding:14px 20px}.template[_ngcontent-%COMP%]{text-align:justify;font:normal normal normal 11px/15px Nunito;letter-spacing:0;color:var(--light-black);opacity:1}.message-count[_ngcontent-%COMP%]{float:right;margin-top:4px}.header[_ngcontent-%COMP%]{color:var(--primary-color);font:normal normal normal 12px/21px Nunito}#patient-select[_ngcontent-%COMP%]{width:100%;background:#fbfbfb 0 0 no-repeat padding-box;border:1px solid var(--grey);border-radius:5px;opacity:1}[_nghost-%COMP%]     .cdk-virtual-scroll-spacer{height:-webkit-fit-content!important;height:-moz-fit-content!important;height:fit-content!important}"]}),e})();const kn=function(){return{minRows:5,maxRows:5}};let Vn=(()=>{class e{constructor(e,t){this._modalRef=e,this.translationService=t,this.strings=["CONSENT.TECH_ISSUE","CONSENT.OTHER"]}ngOnInit(){this.initTranslationStrings()}initTranslationStrings(){this.$translationSubscription=this.translationService.getMultiple(...this.strings).subscribe(e=>{this.translatedStrings=e})}submitReason(){let e=[];this.techIssue&&e.push(this.translatedStrings.get("CONSENT.TECH_ISSUE")),this.othersCheckbox&&e.push(this.translatedStrings.get("CONSENT.OTHER")),this.otherReasons&&e.push(this.otherReasons),0!==e.length&&(console.log(e),this._modalRef.close(e))}}return e.\u0275fac=function(t){return new(t||e)(m.Rb(We.e),m.Rb(G.a))},e.\u0275cmp=m.Lb({type:e,selectors:[["app-revoke-reason-sms"]],decls:19,vars:30,consts:[["nz-typography",""],["nz-checkbox","",3,"nzValue","ngModel","ngModelChange"],["nz-input","",3,"nzAutosize","placeholder","ngModel","ngModelChange"],["nz-button","","nzType","primary","nzSize","large",3,"disabled","click"]],template:function(e,t){1&e&&(m.Xb(0,"h3",0),m.Xc(1),m.jc(2,"translate"),m.Wb(),m.Xb(3,"label",1),m.ec("ngModelChange",function(e){return t.techIssue=e}),m.jc(4,"translate"),m.Xc(5),m.jc(6,"translate"),m.Wb(),m.Xb(7,"label",1),m.ec("ngModelChange",function(e){return t.othersCheckbox=e}),m.jc(8,"translate"),m.Xc(9),m.jc(10,"translate"),m.Wb(),m.Xb(11,"textarea",2),m.ec("ngModelChange",function(e){return t.otherReasons=e}),m.jc(12,"translate"),m.Wb(),m.Xb(13,"p",0),m.Xc(14),m.jc(15,"translate"),m.Wb(),m.Xb(16,"button",3),m.ec("click",function(){return t.submitReason()}),m.Xc(17),m.jc(18,"translate"),m.Wb()),2&e&&(m.Db(1),m.Zc(" ",m.kc(2,13,"CONSENT.REVOKE_SMS_MODAL_TITLE"),"\n"),m.Db(2),m.sc("nzValue",m.kc(4,15,"CONSENT.TECH_ISSUE")),m.rc("ngModel",t.techIssue),m.Db(2),m.Yc(m.kc(6,17,"CONSENT.TECH_ISSUE")),m.Db(2),m.sc("nzValue",m.kc(8,19,"CONSENT.OTHER")),m.rc("ngModel",t.othersCheckbox),m.Db(2),m.Yc(m.kc(10,21,"CONSENT.OTHER")),m.Db(2),m.sc("placeholder",m.kc(12,23,"ADDITIONAL_NOTE")),m.rc("nzAutosize",m.xc(29,kn))("ngModel",t.otherReasons),m.Db(3),m.Zc(" ",m.kc(15,25,"CONSENT.REVOKE_SMS_MODAL_FOOTER_NOTE"),"\n"),m.Db(2),m.rc("disabled",!(t.patientNotUsingApp||t.techIssue||t.othersCheckbox&&t.otherReasons)),m.Db(1),m.Zc(" ",m.kc(18,27,"CONSENT.REVOKE_BUTTON")," "))},directives:[T.a,ve.a,c.u,c.x,N.b,N.a,c.d,mt.a,Ct.a,A.a],pipes:[Q.a],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;justify-content:center;padding:24px}[nz-checkbox][_ngcontent-%COMP%]{margin:4px 0;height:20px}textarea[_ngcontent-%COMP%]{margin:10px auto;background-color:#f6f6f6}p[_ngcontent-%COMP%]{font-size:9px;margin-bottom:15px}button[_ngcontent-%COMP%]{margin:10px auto;width:200px}.ant-checkbox-wrapper-checked[_ngcontent-%COMP%]{font-weight:700}"]}),e})();var Un=n("F6ss"),Fn=n("zM63");function jn(e,t){1&e&&m.Sb(0,"nz-spin",3)}function Yn(e,t){1&e&&(m.Vb(0),m.Xc(1," | Preferred"),m.Ub())}function Gn(e,t){if(1&e){const e=m.Yb();m.Xb(0,"li",19),m.ec("click",function(){m.Lc(e);const t=m.ic().$implicit;return m.ic(4).onVerbalCallInitiate(null==t?null:t.number)}),m.Xb(1,"label",20),m.Xc(2),m.jc(3,"titlecase"),m.Vc(4,Yn,2,0,"ng-container",2),m.Wb(),m.Sb(5,"br"),m.Xb(6,"span",21),m.Xc(7),m.Wb(),m.Xc(8,": "),m.Xb(9,"span",22),m.Xc(10),m.Wb(),m.Wb()}if(2&e){const e=m.ic().$implicit;m.Db(2),m.Zc(" ",m.kc(3,5,(null==e?null:e.label)||"Phone Number")," "),m.Db(2),m.rc("ngIf",null==e?null:e.preferred),m.Db(3),m.Zc(" ","MOBILE"===(null==e?null:e.type)?"M":"L"," "),m.Db(3),m.ad("",null==e?null:e.countryCode," ",null==e?null:e.number,"")}}function Bn(e,t){if(1&e&&(m.Vb(0),m.Vc(1,Gn,11,7,"li",18),m.Ub()),2&e){const e=t.$implicit;m.Db(1),m.rc("ngIf",!(null==e||null==e.number||!e.number.length)&&(null==e||null==e.notificationConfig.CALL?null:e.notificationConfig.CALL.enabled))}}function Hn(e,t){if(1&e){const e=m.Yb();m.Xb(0,"div"),m.Xb(1,"button",11),m.Sb(2,"app-icons",12),m.Wb(),m.Xb(3,"nz-dropdown-menu",null,13),m.Xb(5,"ul",14),m.Vc(6,Bn,2,1,"ng-container",15),m.Wb(),m.Wb(),m.Xb(7,"button",16),m.ec("click",function(){return m.Lc(e),m.ic(3).showScript()}),m.jc(8,"translate"),m.Sb(9,"app-icons",17),m.Wb(),m.Wb()}if(2&e){const e=m.Ic(4),t=m.ic(3);m.Db(1),m.rc("disabled",!(null!=t.episodeDetails&&null!=t.episodeDetails.patientPhoneNumbers&&t.episodeDetails.patientPhoneNumbers.length))("nzDropdownMenu",e),m.Db(5),m.rc("ngForOf",null==t.episodeDetails?null:t.episodeDetails.patientPhoneNumbers),m.Db(1),m.sc("nzTooltipTitle",m.kc(8,4,"CONSENT.CONSENT_SCRIPT_TOOLTIP"))}}function $n(e,t){if(1&e){const e=m.Yb();m.Xb(0,"div"),m.Xb(1,"div",23),m.Xb(2,"article",0),m.Xb(3,"p",0),m.Xc(4),m.Wb(),m.Wb(),m.Wb(),m.Xb(5,"button",16),m.ec("click",function(){return m.Lc(e),m.ic(3).getPatientConsentViaApp()}),m.jc(6,"translate"),m.Sb(7,"app-icons",24),m.Wb(),m.Wb()}if(2&e){const e=m.ic(3);m.Db(4),m.Zc(" ",e.viaAppDesc," "),m.Db(1),m.sc("nzTooltipTitle",m.kc(6,2,"CONSENT.SEND_CONSENT_TOOLTIP"))}}function Zn(e,t){1&e&&(m.Vb(0),m.Xc(1," | Preferred"),m.Ub())}function qn(e,t){if(1&e){const e=m.Yb();m.Xb(0,"li",19),m.ec("click",function(){m.Lc(e);const t=m.ic().$implicit;return m.ic(4).getPatientConsentViaSMS(null==t?null:t.preferred)}),m.Xb(1,"label",20),m.Xc(2),m.jc(3,"titlecase"),m.Vc(4,Zn,2,0,"ng-container",2),m.Wb(),m.Sb(5,"br"),m.Xb(6,"span",21),m.Xc(7),m.Wb(),m.Xc(8,": "),m.Xb(9,"span",22),m.Xc(10),m.Wb(),m.Wb()}if(2&e){const e=m.ic().$implicit;m.Db(2),m.Zc(" ",m.kc(3,5,(null==e?null:e.label)||"Phone Number")," "),m.Db(2),m.rc("ngIf",null==e?null:e.preferred),m.Db(3),m.Zc(" ","MOBILE"===(null==e?null:e.type)?"M":"L"," "),m.Db(3),m.ad("",null==e?null:e.countryCode," ",null==e?null:e.number,"")}}function Kn(e,t){if(1&e&&(m.Vb(0),m.Vc(1,qn,11,7,"li",18),m.Ub()),2&e){const e=t.$implicit;m.Db(1),m.rc("ngIf",!(null==e||null==e.number||!e.number.length)&&(null==e||null==e.notificationConfig.SMS?null:e.notificationConfig.SMS.enabled))}}function Qn(e,t){if(1&e&&(m.Xb(0,"div"),m.Xb(1,"div",23),m.Xb(2,"article",0),m.Xb(3,"p",0),m.Xc(4),m.Wb(),m.Wb(),m.Wb(),m.Xb(5,"button",25),m.jc(6,"translate"),m.Sb(7,"app-icons",24),m.Wb(),m.Xb(8,"nz-dropdown-menu",null,26),m.Xb(10,"ul",14),m.Vc(11,Kn,2,1,"ng-container",15),m.Wb(),m.Wb(),m.Wb()),2&e){const e=m.Ic(9),t=m.ic(3);m.Db(4),m.Zc(" ",t.viaSMSDesc," "),m.Db(1),m.sc("nzTooltipTitle",m.kc(6,4,"CONSENT.SEND_CONSENT_TOOLTIP")),m.rc("nzDropdownMenu",e),m.Db(6),m.rc("ngForOf",null==t.episodeDetails?null:t.episodeDetails.patientPhoneNumbers)}}function Jn(e,t){if(1&e&&(m.Xb(0,"div"),m.Xb(1,"div",23),m.Xb(2,"article",0),m.Xb(3,"p",0),m.Xc(4),m.jc(5,"translate"),m.Wb(),m.Wb(),m.Wb(),m.Xb(6,"nz-upload",27),m.Xb(7,"button",28),m.Xc(8),m.jc(9,"translate"),m.Wb(),m.Wb(),m.Wb()),2&e){const e=m.ic(3);m.Db(4),m.Zc(" ",m.kc(5,6,"CONSENT.VIA_MANUAL_UPLOAD_DESCRIPTION")," "),m.Db(2),m.rc("nzShowButton",e.fileList.length<5)("nzCustomRequest",e.handleUpload)("nzShowUploadList",!1)("nzBeforeUpload",e.nzBeforeUpload),m.Db(2),m.Zc(" ",m.kc(9,8,"COMMON.UPLOAD")," ")}}function ei(e,t){if(1&e){const e=m.Yb();m.Xb(0,"div",29),m.Xb(1,"button",30),m.ec("click",function(){m.Lc(e);const t=m.ic(3);return t.revokeConsent(t.lastConsentAvailable)}),m.jc(2,"translate"),m.Xc(3),m.jc(4,"translate"),m.Wb(),m.Xb(5,"h3"),m.Xc(6),m.jc(7,"translate"),m.Wb(),m.Xb(8,"p",31),m.Xc(9),m.jc(10,"translate"),m.Wb(),m.Wb()}2&e&&(m.Db(1),m.sc("nzTooltipTitle",m.kc(2,4,"CONSENT.REVOKE_TOOLTIP")),m.Db(2),m.Zc(" ",m.kc(4,6,"CONSENT.REVOKE_BUTTON")," "),m.Db(3),m.Zc("",m.kc(7,8,"CONSENT.CONSENT_FORM_SENT")," "),m.Db(3),m.Yc(m.kc(10,10,"CONSENT.AWAITING_RESPONSE")))}function ti(e,t){if(1&e){const e=m.Yb();m.Xb(0,"div",29),m.Xb(1,"h3"),m.Xc(2),m.jc(3,"translate"),m.Wb(),m.Xb(4,"a",32),m.ec("click",function(){return m.Lc(e),m.ic(3).viewConsentInProgressDetails()}),m.Xc(5),m.jc(6,"translate"),m.Wb(),m.Sb(7,"span",33),m.Wb()}2&e&&(m.Db(2),m.Yc(m.kc(3,2,"CONSENT.CONSENT_PENDING")),m.Db(3),m.Zc(" ",m.kc(6,4,"CONSENT.VIEW_DETAILS")," "))}function ni(e,t){if(1&e){const e=m.Yb();m.Vb(0),m.Xb(1,"label"),m.Xc(2),m.jc(3,"translate"),m.Wb(),m.Xb(4,"nz-radio-group",4),m.ec("ngModelChange",function(t){return m.Lc(e),m.ic(2).consentMedium=t}),m.Xb(5,"label",5),m.Xb(6,"b"),m.Xc(7),m.jc(8,"translate"),m.Wb(),m.Wb(),m.Xb(9,"label",6),m.Xb(10,"b"),m.Xc(11),m.jc(12,"translate"),m.Wb(),m.Wb(),m.Xb(13,"label",7),m.Xb(14,"b"),m.Xc(15),m.jc(16,"translate"),m.Wb(),m.Wb(),m.Xb(17,"label",8),m.Xb(18,"b"),m.Xc(19),m.jc(20,"translate"),m.Wb(),m.Wb(),m.Xb(21,"label",9),m.Xb(22,"b"),m.Xc(23),m.jc(24,"translate"),m.Wb(),m.Wb(),m.Wb(),m.Vc(25,Hn,10,6,"div",2),m.Vc(26,$n,8,4,"div",2),m.Vc(27,Qn,12,6,"div",2),m.Vc(28,Jn,10,10,"div",2),m.Vc(29,ei,11,12,"div",10),m.Vc(30,ti,8,6,"div",10),m.Ub()}if(2&e){const e=m.ic(2);m.Db(2),m.Zc("",m.kc(3,18,"CONSENT.OBTAIN_CONSENT"),": "),m.Db(2),m.rc("ngModel",e.consentMedium),m.Db(1),m.rc("nzDisabled","IN_PROGRESS"!=(null==e.episodeDetails?null:e.episodeDetails.status)&&"SCHEDULED"!=(null==e.episodeDetails?null:e.episodeDetails.status)||"SMS_CONSENT"==(null==e.lastConsentAvailable?null:e.lastConsentAvailable.type)&&"IN_PROGRESS"==(null==e.lastConsentAvailable?null:e.lastConsentAvailable.consentStatus)||e.consentCallInProgress),m.Db(2),m.Yc(m.kc(8,20,"CONSENT.VIA_APP")),m.Db(2),m.rc("nzDisabled",!e.consentSMSEnabled||"IN_PROGRESS"!=(null==e.episodeDetails?null:e.episodeDetails.status)&&"SCHEDULED"!=(null==e.episodeDetails?null:e.episodeDetails.status)||"APP_CONSENT"==(null==e.lastConsentAvailable?null:e.lastConsentAvailable.type)&&"IN_PROGRESS"==(null==e.lastConsentAvailable?null:e.lastConsentAvailable.consentStatus)||e.consentCallInProgress),m.Db(2),m.Yc(m.kc(12,22,"CONSENT.VIA_SMS")),m.Db(2),m.rc("nzDisabled",!e.verbalConsentEnabled||"IN_PROGRESS"!=(null==e.episodeDetails?null:e.episodeDetails.status)&&"SCHEDULED"!=(null==e.episodeDetails?null:e.episodeDetails.status)||("APP_CONSENT"==(null==e.lastConsentAvailable?null:e.lastConsentAvailable.type)||"SMS_CONSENT"==(null==e.lastConsentAvailable?null:e.lastConsentAvailable.type))&&"IN_PROGRESS"==(null==e.lastConsentAvailable?null:e.lastConsentAvailable.consentStatus)),m.Db(2),m.Yc(m.kc(16,24,"CONSENT.VERBALLY_OVER_CALL")),m.Db(2),m.rc("nzDisabled","IN_PROGRESS"!=(null==e.episodeDetails?null:e.episodeDetails.status)&&"SCHEDULED"!=(null==e.episodeDetails?null:e.episodeDetails.status)||("APP_CONSENT"==(null==e.lastConsentAvailable?null:e.lastConsentAvailable.type)||"SMS_CONSENT"==(null==e.lastConsentAvailable?null:e.lastConsentAvailable.type))&&"IN_PROGRESS"==(null==e.lastConsentAvailable?null:e.lastConsentAvailable.consentStatus)),m.Db(2),m.Yc(m.kc(20,26,"CONSENT.MANUAL_UPLOAD")),m.Db(2),m.rc("nzDisabled","IN_PROGRESS"!=(null==e.episodeDetails?null:e.episodeDetails.status)&&"SCHEDULED"!=(null==e.episodeDetails?null:e.episodeDetails.status)||("APP_CONSENT"==(null==e.lastConsentAvailable?null:e.lastConsentAvailable.type)||"SMS_CONSENT"==(null==e.lastConsentAvailable?null:e.lastConsentAvailable.type))&&"IN_PROGRESS"==(null==e.lastConsentAvailable?null:e.lastConsentAvailable.consentStatus)),m.Db(2),m.Yc(m.kc(24,28,"CONSENT.DIGITAL_CONSENT")),m.Db(2),m.rc("ngIf","VERBAL_CONSENT"===e.consentMedium&&(null==e.lastConsentAvailable||"VERBAL_CONSENT"==(null==e.lastConsentAvailable?null:e.lastConsentAvailable.type)&&"IN_PROGRESS"==(null==e.lastConsentAvailable?null:e.lastConsentAvailable.consentStatus)&&!("APP_CONSENT"==(null==e.lastConsentAvailable?null:e.lastConsentAvailable.type)&&"IN_PROGRESS"==(null==e.lastConsentAvailable?null:e.lastConsentAvailable.consentStatus)))),m.Db(1),m.rc("ngIf","APP_CONSENT"===e.consentMedium&&(null==e.lastConsentAvailable||"VERBAL_CONSENT"==(null==e.lastConsentAvailable?null:e.lastConsentAvailable.type)&&"IN_PROGRESS"==(null==e.lastConsentAvailable?null:e.lastConsentAvailable.consentStatus))&&!("APP_CONSENT"==(null==e.lastConsentAvailable?null:e.lastConsentAvailable.type)&&"IN_PROGRESS"==(null==e.lastConsentAvailable?null:e.lastConsentAvailable.consentStatus))),m.Db(1),m.rc("ngIf","SMS_CONSENT"===e.consentMedium&&(null==e.lastConsentAvailable||"VERBAL_CONSENT"==(null==e.lastConsentAvailable?null:e.lastConsentAvailable.type)&&"IN_PROGRESS"==(null==e.lastConsentAvailable?null:e.lastConsentAvailable.consentStatus))&&!("APP_CONSENT"==(null==e.lastConsentAvailable?null:e.lastConsentAvailable.type)&&"IN_PROGRESS"==(null==e.lastConsentAvailable?null:e.lastConsentAvailable.consentStatus))),m.Db(1),m.rc("ngIf","MANUAL_CONSENT"===e.consentMedium&&(null==e.lastConsentAvailable||"VERBAL_CONSENT"==(null==e.lastConsentAvailable?null:e.lastConsentAvailable.type)&&"IN_PROGRESS"==(null==e.lastConsentAvailable?null:e.lastConsentAvailable.consentStatus))&&!("APP_CONSENT"==(null==e.lastConsentAvailable?null:e.lastConsentAvailable.type)&&"IN_PROGRESS"==(null==e.lastConsentAvailable?null:e.lastConsentAvailable.consentStatus))),m.Db(1),m.rc("ngIf",("APP_CONSENT"==(null==e.lastConsentAvailable?null:e.lastConsentAvailable.type)||"SMS_CONSENT"==(null==e.lastConsentAvailable?null:e.lastConsentAvailable.type))&&"IN_PROGRESS"==(null==e.lastConsentAvailable?null:e.lastConsentAvailable.consentStatus)),m.Db(1),m.rc("ngIf","VERBAL_CONSENT"==e.consentMedium&&"VERBAL_CONSENT"==(null==e.lastConsentAvailable?null:e.lastConsentAvailable.type)&&"IN_PROGRESS"==(null==e.lastConsentAvailable?null:e.lastConsentAvailable.consentStatus))}}function ii(e,t){if(1&e){const e=m.Yb();m.Vb(0),m.Xb(1,"div",23),m.Xb(2,"article",0),m.Xb(3,"p",0),m.Xc(4),m.Wb(),m.Wb(),m.Wb(),m.Xb(5,"div",23),m.Xb(6,"button",34),m.ec("click",function(){return m.Lc(e),m.ic(2).getDigitalConsent()}),m.Xc(7),m.jc(8,"translate"),m.Wb(),m.Wb(),m.Ub()}if(2&e){const e=m.ic(2);m.Db(4),m.Zc(" ",e.viaDigitalConsentDesc," "),m.Db(3),m.Zc(" ",m.kc(8,2,"CONSENT.SUBMIT_CONSENT")," ")}}function si(e,t){if(1&e&&(m.Vb(0),m.Xb(1,"h4",35),m.Xc(2),m.jc(3,"translate"),m.Wb(),m.Xb(4,"p",31),m.Xc(5),m.jc(6,"date"),m.Wb(),m.Ub()),2&e){const e=m.ic(2);m.Db(2),m.Yc(m.kc(3,2,"CONSENT.VERBAL_CONSENT_DENIED")),m.Db(3),m.Yc(m.lc(6,4,null==e.lastConsentAvailable?null:e.lastConsentAvailable.obtainedOn,"d MMMM, y"))}}function ai(e,t){if(1&e&&(m.Vb(0),m.Xb(1,"h4",35),m.Xc(2),m.jc(3,"translate"),m.Wb(),m.Xb(4,"p",31),m.Xc(5),m.jc(6,"date"),m.Wb(),m.Ub()),2&e){const e=m.ic(2);m.Db(2),m.Yc(m.kc(3,2,"CONSENT.VERBAL_CONSENT_DENIED")),m.Db(3),m.Yc(m.lc(6,4,null==e.lastConsentAvailable?null:e.lastConsentAvailable.obtainedOn,"d MMMM, y"))}}function oi(e,t){if(1&e){const e=m.Yb();m.Vb(0),m.Xb(1,"h4",35),m.Xc(2),m.jc(3,"translate"),m.Wb(),m.Xb(4,"p",31),m.Xc(5),m.jc(6,"date"),m.Wb(),m.Xb(7,"a",36),m.ec("click",function(){return m.Lc(e),m.ic(2).viewConsentDeniedDetails()}),m.Xc(8),m.jc(9,"translate"),m.Sb(10,"span",33),m.Wb(),m.Ub()}if(2&e){const e=m.ic(2);m.Db(2),m.Yc(m.kc(3,3,"CONSENT.VERBAL_CONSENT_DENIED")),m.Db(3),m.Yc(m.lc(6,5,null==e.lastConsentAvailable?null:e.lastConsentAvailable.obtainedOn,"d MMMM, y")),m.Db(3),m.Zc(" ",m.kc(9,8,"CONSENT.VIEW_DETAILS")," ")}}function li(e,t){if(1&e&&(m.Xb(0,"span",49),m.Sb(1,"app-icons",50),m.Xc(2),m.jc(3,"translate"),m.Wb()),2&e){const e=m.ic(4);m.Db(1),m.rc("altColorScheme","VERBAL_CONSENT"===(null==e.lastConsentAvailable?null:e.lastConsentAvailable.type)),m.Db(1),m.Zc(" ",m.kc(3,2,"CONSENT.PLAY")," ")}}function ri(e,t){if(1&e&&(m.Xb(0,"span",49),m.Sb(1,"app-icons",51),m.Xc(2),m.jc(3,"translate"),m.Wb()),2&e){const e=m.ic(4);m.Db(1),m.rc("altColorScheme","VERBAL_CONSENT"===(null==e.lastConsentAvailable?null:e.lastConsentAvailable.type)),m.Db(1),m.Zc(" ",m.kc(3,2,"CONSENT.PAUSE")," ")}}const ci=function(e){return{"consent-disabled":e}};function di(e,t){if(1&e){const e=m.Yb();m.Xb(0,"div",38),m.Xb(1,"div",41),m.Xb(2,"label"),m.Xc(3),m.jc(4,"translate"),m.Wb(),m.Xb(5,"p",45),m.ec("click",function(){m.Lc(e);const t=m.ic(3);return t.paused?t.playVoiceRecording():t.pause()}),m.Vc(6,li,4,4,"span",46),m.Vc(7,ri,4,4,"span",46),m.Xc(8," \xa0\xa0 "),m.Xb(9,"span",47),m.ec("click",function(){m.Lc(e);const t=m.ic(3);return t.openConsentCertificate(t.lastConsentAvailable)}),m.Sb(10,"app-icons",48),m.Xc(11),m.jc(12,"translate"),m.Wb(),m.Wb(),m.Wb(),m.Wb()}if(2&e){const e=m.ic(3);m.Db(1),m.rc("ngClass",m.yc(11,ci,"VERBAL_CONSENT"!==(null==e.lastConsentAvailable?null:e.lastConsentAvailable.type))),m.Db(2),m.Yc(m.kc(4,7,"CONSENT.AUDIO_CALL_RECORDING")),m.Db(2),m.rc("nzType","VERBAL_CONSENT"===(null==e.lastConsentAvailable?null:e.lastConsentAvailable.type)?"success":"-"),m.Db(1),m.rc("ngIf",e.paused),m.Db(1),m.rc("ngIf",!e.paused),m.Db(3),m.rc("altColorScheme","VERBAL_CONSENT"===(null==e.lastConsentAvailable?null:e.lastConsentAvailable.type)),m.Db(1),m.Zc(" ",m.kc(12,9,"CONSENT.VIEW")," ")}}function bi(e,t){if(1&e){const e=m.Yb();m.Vb(0),m.Sb(1,"br"),m.Xb(2,"div",37),m.Xb(3,"div",38),m.Xb(4,"h4",39),m.Xc(5),m.Wb(),m.Xb(6,"label"),m.Xc(7),m.jc(8,"date"),m.Wb(),m.Wb(),m.Vc(9,di,13,13,"div",40),m.Xb(10,"div",38),m.Xb(11,"div",41),m.Xb(12,"label"),m.Xc(13),m.jc(14,"translate"),m.Wb(),m.Xb(15,"p",42),m.ec("click",function(){m.Lc(e);const t=m.ic(2);return t.view(t.lastConsentAvailable.consent)}),m.Sb(16,"app-icons",43),m.Xc(17),m.jc(18,"translate"),m.Wb(),m.Wb(),m.Wb(),m.Wb(),m.Xb(19,"label",44),m.Xc(20),m.jc(21,"translate"),m.jc(22,"date"),m.Wb(),m.Ub()}if(2&e){const e=m.ic(2);m.Db(5),m.Zc("",e.consentType[null==e.lastConsentAvailable?null:e.lastConsentAvailable.type]," obtained"),m.Db(2),m.Zc("on ",m.lc(8,10,null==e.lastConsentAvailable?null:e.lastConsentAvailable.obtainedOn,"mediumDate"),""),m.Db(2),m.rc("ngIf","VERBAL_CONSENT"===(null==e.lastConsentAvailable?null:e.lastConsentAvailable.type)),m.Db(2),m.rc("ngClass",m.yc(22,ci,"VERBAL_CONSENT"===(null==e.lastConsentAvailable?null:e.lastConsentAvailable.type))),m.Db(2),m.Yc(m.kc(14,13,"CONSENT.CONSENT_FORM_CERTIFICATE")),m.Db(2),m.rc("nzType","VERBAL_CONSENT"!==(null==e.lastConsentAvailable?null:e.lastConsentAvailable.type)?"success":"-"),m.Db(1),m.rc("altColorScheme","VERBAL_CONSENT"!==(null==e.lastConsentAvailable?null:e.lastConsentAvailable.type)),m.Db(1),m.Zc(" ",m.kc(18,15,"CONSENT.VIEW")," "),m.Db(3),m.ad(" ",m.kc(21,17,"CONSENT.VALID_TILL")," ",m.lc(22,19,null==e.lastConsentAvailable?null:e.lastConsentAvailable.validTill,"mediumDate")," ")}}function pi(e,t){if(1&e&&(m.Vb(0),m.Vc(1,ni,31,30,"ng-container",2),m.Vc(2,ii,9,4,"ng-container",2),m.Vc(3,si,7,7,"ng-container",2),m.Vc(4,ai,7,7,"ng-container",2),m.Vc(5,oi,11,10,"ng-container",2),m.Vc(6,bi,23,24,"ng-container",2),m.Ub()),2&e){const e=m.ic();m.Db(1),m.rc("ngIf",null==e.lastConsentAvailable||"IN_PROGRESS"==(null==e.lastConsentAvailable?null:e.lastConsentAvailable.consentStatus)||"REVOKED"==(null==e.lastConsentAvailable?null:e.lastConsentAvailable.consentStatus)),m.Db(1),m.rc("ngIf","DIGITAL_CONSENT"===e.consentMedium&&!("OBTAINED"==(null==e.lastConsentAvailable?null:e.lastConsentAvailable.consentStatus)||"DENIED"==(null==e.lastConsentAvailable?null:e.lastConsentAvailable.consentStatus))),m.Db(1),m.rc("ngIf","DIGITAL_CONSENT"===e.consentMedium&&"DENIED"==(null==e.lastConsentAvailable?null:e.lastConsentAvailable.consentStatus)),m.Db(1),m.rc("ngIf","SMS_CONSENT"===e.consentMedium&&"DENIED"==(null==e.lastConsentAvailable?null:e.lastConsentAvailable.consentStatus)),m.Db(1),m.rc("ngIf","VERBAL_CONSENT"==(null==e.lastConsentAvailable?null:e.lastConsentAvailable.type)&&"DENIED"==(null==e.lastConsentAvailable?null:e.lastConsentAvailable.consentStatus)),m.Db(1),m.rc("ngIf","OBTAINED"==(null==e.lastConsentAvailable?null:e.lastConsentAvailable.consentStatus))}}let ui=(()=>{class e{constructor(e,t,n,i,s,a,o,l,r,c,d,b,p,u){this._drawerService=e,this._modalService=t,this.episodeService=n,this._patientsService=i,this._userService=s,this._dataSharingService=a,this.router=o,this._notificationsService=l,this._episodesService=r,this.translationService=c,this.consentService=d,this.consentScriptService=b,this._episodesEventLogger=p,this._ngProgress=u,this.episodeChange=new m.n,this.rootUrl=gt.g.url,this.consentFormRequest=new Yt,this.episodeBlueprint=new Ft.b,this.paused=!0,this.fileList=[],this.viaAppDesc="",this.viaSMSDesc="",this.viaDigitalConsentDesc="",this.strings=["CONSENT.CONFIGURE_CONSENT_SCRIPT","CONSENT.DIGITAL_CONSENT","CONSENT.UNABLE_TO_UPLOAD_FILE","CONSENT.PATIENT_CONSENT_ADDED","CONSENT.PATIENT_CONSENT_REMOVED","CONSENT.ARE_YOU_SURE","CONSENT.RECORDING_NOT_FOUND","CONSENT.RECORDING_REQUIRED","CONSENT.REVOKE_SUCCESSFUL_TITLE","CONSENT.SAVE_SUCCESSFUL","CONSENT.UPDATE_FAILED","CONSENT.REVOKE_BUTTON","CONSENT.REVOKE_SUCCESSFUL_MESSAGE","CONSENT.DENY_SUCCESSFUL_MESSAGE","CONSENT.DENY_CONSENT","CONSENT.REVOKED_SUCCESS","CONSENT.VIA_DIGITAL_SIGNATURE_DESCRIPTION","CONSENT.VIA_APP_DESCRIPTION","CONSENT.VIA_SMS_DESCRIPTION","CONSENT.VIA_DIGITAL_SIGNATURE_DESCRIPTION","DOCTORS_ORDER.INVALID_ADDRESS_NOT_ASSIGNED_MESSAGE","DOCTORS_ORDER.MR_NUMBER_NOT_ASSIGNED_MESSAGE","CONSENT.ACCEPT_CONSENT","CONSENT.ACCEPT_SUCCESSFUL_MESSAGE","COMMON.PHYSICIAN"],this.availableConsentMap=new Map,this.consentType={VERBAL_CONSENT:"Verbal consent",APP_CONSENT:"App consent",SMS_CONSENT:"SMS Consent",MANUAL_CONSENT:"Manual consent",DIGITAL_CONSENT:"Digital consent"},this.nzBeforeUpload=(e,t)=>{this.file=e},this.handleUpload=e=>{this._episodesEventLogger.episodeConsentActionEvent(this.episodeId,this.patientId,"consent_upload_triggered","MANUAL_CONSENT"),this.loading=!0,this._episodesService.uploadConsent(e.file.name,e.file,this.patientId,"PATIENT_CONSENTS").subscribe(e=>{const t=e.filename;this._episodesEventLogger.episodeConsentActionEvent(this.episodeId,this.patientId,"consent_upload_success","MANUAL_CONSENT",t),this.saveManualConsent(t)},()=>{this._notificationsService.error("Episode","Unable to upload file!"),this._episodesEventLogger.episodeConsentActionEvent(this.episodeId,this.patientId,"consent_upload_failure","MANUAL_CONSENT")},()=>{this.loading=!1})}}set episodeSetter(e){this.episodeDetails=e,this.patientId=this.episodeDetails.patientId,this.episodeId=this.episodeDetails.id,this.episodeType=this.episodeDetails.type,this.setConsentForms(this.episodeDetails.availableConsents),this.checkIfConsentEnabled()}ngOnInit(){this.initTranslationStrings(),this.getTenantConfig(),this.consentScriptSubscription$=this.consentScriptService.getShowConsentScriptObservable().subscribe(e=>e?this.showConsentScript():this.hideConsentScript()),this._dataSharingService.getLoggedInUserName().subscribe(e=>{this.assignerName=e||this.translatedStrings.get("COMMON.PHYSICIAN")})}ngOnDestroy(){this.audio&&(this.audio.pause(),this.audio=null),this.consentScriptSubscription$.unsubscribe()}initTranslationStrings(){this.$translationSubscription=this.translationService.getMultiple(...this.strings).subscribe(e=>{var t,n;this.translatedStrings=e,this.viaAppDesc=null===(t=this.translatedStrings.get("CONSENT.VIA_APP_DESCRIPTION"))||void 0===t?void 0:t.replace("{EPISODE_NAME}",this.episodeType),this.viaSMSDesc=null===(n=this.translatedStrings.get("CONSENT.VIA_SMS_DESCRIPTION"))||void 0===n?void 0:n.replace("{EPISODE_NAME}",this.episodeType),this.viaDigitalConsentDesc=this.translatedStrings.get("CONSENT.VIA_DIGITAL_SIGNATURE_DESCRIPTION").replace("{EPISODE_NAME}",this.episodeType)})}play(){this._episodesEventLogger.episodeConsentActionEvent(this.episodeId,this.patientId,"play_consent_audio"),null==this.audio?(this.audio=new Audio(this.consentSrc),this.audio.addEventListener("ended",e=>{this.paused=!0})):this.paused||(this.audio.src=this.consentSrc),this.paused=!1,this.audio.play()}pause(){this.paused=!0,this.audio.pause()}populateConsentFiles(){null!=this.episodeDetails.availableConsents&&this.episodeDetails.availableConsents.length>0&&this.setConsentForms(this.episodeDetails.availableConsents)}getTenantConfig(){this._dataSharingService.tenantSettings.subscribe(e=>{if(null!=e)for(let t of e.episodeBlueprints)t.type===this.episodeDetails.type&&(this.episodeBlueprint=t)})}checkIfConsentEnabled(){var e,t;null===(t=null===(e=this.episodeDetails)||void 0===e?void 0:e.patientPhoneNumbers)||void 0===t||t.forEach(e=>{var t,n;(null==e?void 0:e.preferred)&&((null===(t=null==e?void 0:e.notificationConfig.SMS)||void 0===t?void 0:t.enabled)&&"MOBILE"===(null==e?void 0:e.type)&&(this.consentSMSEnabled=!0),(null===(n=null==e?void 0:e.notificationConfig.CALL)||void 0===n?void 0:n.enabled)&&(this.verbalConsentEnabled=!0))})}showScript(){this.consentScriptService.setShowConsentScriptObservable(!0)}setConsentForms(e){var t;if(null!=e){let t=e.filter(e=>e.consentStatus===kt.b.OBTAINED);this.lastConsentAvailable=(null==t||0==t.length?e:t).filter(e=>e.consentStatus!=kt.b.REVOKED).reduce((e,t)=>(null==e?void 0:e.createdOn)>t.createdOn?e:t,null)}if(this.consentMedium=null===(t=this.lastConsentAvailable)||void 0===t?void 0:t.type,this.consentMedium==kt.a.APP_CONSENT||this.consentMedium==kt.a.SMS_CONSENT||this.consentMedium==kt.a.MANUAL_CONSENT&&this.lastConsentAvailable.consentStatus===kt.b.OBTAINED&&this.lastConsentAvailable.consent){let e=this.lastConsentAvailable.consent;this.lastConsentAvailable.fileName=(null==e?void 0:e.startsWith("http"))?null==e?void 0:e.split(":")[2]:null==e?void 0:e.substring((null==e?void 0:e.lastIndexOf(":"))+1,null==e?void 0:e.length)}}showConsentScript(){let e="";this.drawer||null!=this.episodeBlueprint&&(this._episodesEventLogger.episodeConsentActionEvent(this.episodeId,this.patientId,"show_consentScript"),this.episodeBlueprint.consentComponent&&this.episodeBlueprint.consentComponent.consentScriptHtml?e=this.episodeBlueprint.consentComponent.consentScriptHtml:(this.episodeBlueprint.consentComponent=new Ft.a,e=this.translatedStrings.get("CONSENT.CONFIGURE_CONSENT_SCRIPT"),this.episodeBlueprint.consentComponent.consentScriptHtml=this.translatedStrings.get("CONSENT.CONFIGURE_CONSENT_SCRIPT")),this.drawer=this._drawerService.create({nzContent:Lt,nzContentParams:{htmlContent:e},nzWidth:400,nzMask:!0,nzMaskClosable:!1,nzZIndex:1e3}),this.drawer.afterClose.subscribe(e=>{this.drawer=null}))}hideConsentScript(){null!=this.drawer&&this.drawer.close()}onVerbalCallInitiate(e){this.drawer&&this.drawer.close(null),this._userService.getCallSettings(localStorage.getItem("loggedInUser")).subscribe(t=>{this._episodesEventLogger.episodeConsentActionEvent(this.episodeId,this.patientId,this.consentMedium.toLowerCase()),null==t||t.showInstructions?this.showAudioInfoAndProceedToCallPopupModal(e):this.launchVoiceCall(e)},t=>{this.showAudioInfoAndProceedToCallPopupModal(e)})}showAudioInfoAndProceedToCallPopupModal(e){this._modalService.create({nzTitle:null,nzContent:xt,nzFooter:null,nzBodyStyle:{height:"430px",padding:"50px"},nzWidth:630,nzZIndex:1e3}).afterClose.subscribe(t=>{(null==t?void 0:t.hidePopup)&&this.hideCallInformationForThisUser(),(null==t?void 0:t.continueToCall)&&this.launchVoiceCall(e)})}hideCallInformationForThisUser(){let e=new rn;e.showInstructions=!1,this._userService.updateCallSettings(localStorage.getItem("loggedInUser"),e).subscribe(()=>{})}launchVoiceCall(e){this.consentCallInProgress=!0,this.consentService.createConsentCallSubject(),this._patientsService.getSpecificUser(this.patientId).subscribe(t=>{let n={patient:t,toNumber:e,enableRecording:!0,context:Gt.a.PATIENT_CONSENT};this._episodesEventLogger.episodeConsentActionEvent(this.episodeId,this.patientId,"launch_voiceCall"),this._dataSharingService.setVoiceCallInitiated(n)}),this.consentService.onConsentCallDisconnect().subscribe(e=>{e&&(this.consentFormRequest.type=kt.a.VERBAL_CONSENT,this.consentFormRequest.sourceId=e.voicecallSessionId,this.consentFormRequest.consent=e.callRecordingUri,this._episodesEventLogger.episodeConsentActionEvent(this.episodeId,this.patientId,"disconnect_voiceCall"),this.onVoiceCallEnd())},e=>console.log("Error getting voice call details : ",e))}onVoiceCallEnd(){this.consentService.unsubscribeFromConsentCallSubject(),this._dataSharingService.setVoiceCallInitiated(null),this._dataSharingService.setVoicecallDisconnectTrigger(!0),this.drawer&&this.drawer.close(null),this.consentCallInProgress=!1,this._modalService.create({nzContent:Vt,nzComponentParams:{episodeType:this.episodeDetails.type},nzBodyStyle:{height:"150px",padding:"50px"},nzStyle:{top:"40%"},nzFooter:null,nzWidth:600}).afterClose.subscribe(e=>{e&&(this.consentFormRequest.consentStatus=kt.b[e],this.consentFormRequest.consentStatus==kt.b.OBTAINED?(this._episodesEventLogger.episodeConsentActionEvent(this.episodeId,this.patientId,"consent_obtained"),this.saveVerbalConsent(null)):this.consentFormRequest.consentStatus==kt.b.DENIED?(this._episodesEventLogger.episodeConsentActionEvent(this.episodeId,this.patientId,"consent_denied"),this.addConsentDeniedDetails()):this.consentFormRequest.consentStatus==kt.b.IN_PROGRESS&&(this._episodesEventLogger.episodeConsentActionEvent(this.episodeId,this.patientId,"consent_in_progress"),this.addConsentInProgressDetails()))})}addConsentDeniedDetails(){this._modalService.create({nzContent:sn,nzComponentParams:{patientId:this.patientId},nzBodyStyle:{height:"400px"},nzWidth:470,nzFooter:null,nzClosable:!1,nzMaskClosable:!1}).afterClose.subscribe(e=>{this.saveVerbalConsent(e)})}addConsentInProgressDetails(){this._modalService.create({nzContent:on,nzComponentParams:{patientId:this.patientId},nzBodyStyle:{height:"400px"},nzWidth:470,nzFooter:null,nzClosable:!1,nzMaskClosable:!1}).afterClose.subscribe(e=>{this.saveVerbalConsent(e)})}viewConsentDeniedDetails(){this._modalService.create({nzContent:qt,nzComponentParams:{noteId:this.lastConsentAvailable.noteId},nzBodyStyle:{height:"400px"},nzWidth:470,nzFooter:null,nzClosable:!1,nzMaskClosable:!1})}viewConsentInProgressDetails(){this._modalService.create({nzContent:en,nzComponentParams:{patientId:this.patientId},nzBodyStyle:{height:"400px"},nzWidth:470,nzFooter:null,nzClosable:!1,nzMaskClosable:!1})}playVoiceRecording(){if(this.consentSrc)this.play();else{let e=this.lastConsentAvailable.consent;if(null==e||""===e)return void this._notificationsService.error("Patient Consent",this.translatedStrings.get("CONSENT.RECORDING_NOT_FOUND"));let t="https://api.twilio.com/"+e;t=t.replace(".json",".mp3"),this.consentSrc=t,this.play()}}saveVerbalConsent(e){this.consentFormRequest.consentStatus!==kt.b.OBTAINED||null!=this.consentFormRequest.consent?(this.consentFormRequest.episodeType=this.episodeDetails.type,this.consentFormRequest.consentee=this.episodeDetails.patientId,this.consentFormRequest.noteId=null==e?void 0:e.id,this.episodeService.saveConsentDetails(this.consentFormRequest).subscribe(t=>{this.consentFormRequest.consentStatus===kt.b.DENIED?this.episodeService.suspendEpisode(this.episodeId,{assignerId:e.assignerId,archived:e.archived,reason:e.reason}).subscribe(e=>{this.episodeChange.emit(!0)}):this.episodeChange.emit(!0),this._notificationsService.create("success",this.translatedStrings.get("CONSENT.SAVE_SUCCESSFUL"),null)},e=>{this._notificationsService.error(this.translatedStrings.get("CONSENT.UPDATE_FAILED"),e)})):this._notificationsService.error("Patient Consent",this.translatedStrings.get("CONSENT.RECORDING_REQUIRED"))}saveManualConsent(e){this.consentFormRequest.episodeType=this.episodeDetails.type,this.consentFormRequest.consentee=this.episodeDetails.patientId,this.consentFormRequest.type=kt.a.MANUAL_CONSENT,this.consentFormRequest.consent=e,this.episodeService.saveConsentDetails(this.consentFormRequest).subscribe(e=>{this.episodeChange.emit(!0),this._notificationsService.create("success",this.translatedStrings.get("CONSENT.SAVE_SUCCESSFUL"),null)},e=>{this._notificationsService.error(this.translatedStrings.get("CONSENT.UPDATE_FAILED"),e)})}openConsentCertificate(e){this._episodesEventLogger.episodeConsentActionEvent(this.episodeId,this.patientId,"open_consent_certificate"),this.router.navigate(["episodes/consentCertificate/",this.episodeId],{queryParams:{consentId:e.id}})}revokeType(e){return"SMS_CONSENT"==e.type?Vn:dn}revokeConsent(e){this._episodesEventLogger.episodeConsentActionEvent(this.episodeId,this.patientId,"consent_revoke_triggered",e.type),this._modalService.create({nzContent:this.revokeType(e),nzWidth:500,nzBodyStyle:{height:"462px",padding:"20px",borderRadius:"20px"},nzFooter:null,nzKeyboard:!1,nzClosable:!0,nzMaskClosable:!1}).afterClose.subscribe(t=>{const n={reason:t.toString()};this._episodesService.revokeConsent(e.id,n).subscribe(t=>{this._episodesEventLogger.episodeConsentActionEvent(this.episodeId,this.patientId,"consent_revoked",e.type),this.episodeChange.emit(!0),this.populateConsentFiles(),this._notificationsService.create("success",this.translatedStrings.get("CONSENT.REVOKE_SUCCESSFUL_TITLE"),this.translatedStrings.get("CONSENT.REVOKE_SUCCESSFUL_MESSAGE"))})})}getConsentFormDateOfSubmission(e){let t;return this.patientConsents.forEach(n=>{n.url.includes(e)&&(t=n.dateOfSubmission)}),t}view(e){this._episodesEventLogger.episodeConsentActionEvent(this.episodeId,this.patientId,"download_consent");let t="";t=e.startsWith("http")?`filename=${e.substring(e.lastIndexOf("/")+1,e.length)}`:`filename=${e}&asset-type=PATIENT_CONSENTS`;let n=`${this.rootUrl}/v1/assets/view?${t}`;this._episodesEventLogger.downloadSuccessReportEvent(this.patientId,e,"patients_consent","patients_consent"),window.open(n,"_blank")}getPatientConsentViaApp(){this._episodesService.assignConsentTaskViaApp(this.episodeId).subscribe(e=>{this._episodesEventLogger.episodeConsentActionEvent(this.episodeId,this.patientId,this.consentMedium.toLowerCase()),this._notificationsService.info("Patient Consent",e.message),this.episodeChange.emit(!0)},e=>console.log("Assigning Consent Via App failed : ",e))}getPatientConsentViaSMS(e=!0){this._episodesService.assignConsentTaskViaSMS(this.episodeId).subscribe(t=>{this._patientsService.getSpecificUser(this.patientId).subscribe(n=>{this.sendSMS(t.message,this.patientId,n.fullName,e)})},e=>console.log("Assigning Consent Via SMS failed : ",e))}sendSMS(e,t,n,i=!0){const s=this._modalService.create({nzContent:xn,nzComponentParams:{patientList:[this.convertUserToPatientModel(t,n)],smsLink:e,patientId:this.patientId,assignerName:this.assignerName,showFilter:!1,usePrimaryNumber:i},nzStyle:{width:"800px"},nzFooter:null,nzKeyboard:!1,nzClosable:!0,nzMaskClosable:!0});s.afterClose.subscribe(e=>{null!=e&&"SUCCESS"==s.componentInstance.message&&(this._episodesEventLogger.episodeConsentActionEvent(this.episodeId,this.patientId,this.consentMedium.toLowerCase()),this.episodeChange.emit(!0))})}convertUserToPatientModel(e,t){let n=new bn.a;return n.patientId=e,n.patientName=t,n}getDigitalConsent(){this._modalService.create({nzContent:Tt,nzComponentParams:{patientId:this.patientId,episodeType:this.episodeType},nzFooter:null,nzWidth:1e3,nzClosable:!0,nzMaskClosable:!1}).afterClose.subscribe(e=>{"AGREE"==e&&this.acceptConsent(),"DENY"==e&&this.denyConsent()})}acceptConsent(){this._episodesService.submitConsent({consentType:"DIGITAL_CONSENT",episodeId:this.episodeId,patientId:this.patientId}).subscribe(e=>{this._episodesEventLogger.episodeConsentActionEvent(this.episodeId,this.patientId,"consent_accepted","DIGITAL_CONSENT"),this.episodeChange.emit(!0),this._dataSharingService.triggerAlertRefresh(),this.populateConsentFiles(),this._notificationsService.create("success",this.translatedStrings.get("CONSENT.DIGITAL_CONSENT"),this.translatedStrings.get("CONSENT.PATIENT_CONSENT_ADDED"))})}denyConsent(){this._modalService.create({nzContent:sn,nzComponentParams:{patientId:this.patientId},nzWidth:470,nzFooter:null,nzClosable:!1,nzMaskClosable:!1}).afterClose.subscribe(e=>{var t,n;let i={reason:e.reason,consentType:"DIGITAL_CONSENT",episodeId:this.episodeId,consentId:null};null===(n=null===(t=this._ngProgress)||void 0===t?void 0:t.ref())||void 0===n||n.start(),this._episodesService.denyConsent(i).subscribe(e=>{var t,n;this._episodesEventLogger.episodeConsentActionEvent(this.episodeId,this.patientId,"consent_denied","DIGITAL_CONSENT"),null===(n=null===(t=this._ngProgress)||void 0===t?void 0:t.ref())||void 0===n||n.complete(),this._dataSharingService.triggerAlertRefresh(),this._notificationsService.create("success",this.translatedStrings.get("CONSENT.DENY_CONSENT"),this.translatedStrings.get("CONSENT.DENY_SUCCESSFUL_MESSAGE")),this.router.navigate(["patient/view/"+this.patientId],{queryParams:{tab:"episodes"}})})})}}return e.\u0275fac=function(t){return new(t||e)(m.Rb(Un.d),m.Rb(We.f),m.Rb(Ut.a),m.Rb(p.a),m.Rb(ln.a),m.Rb(H.a),m.Rb(C.g),m.Rb(D.b),m.Rb(u.a),m.Rb(G.a),m.Rb(jt.a),m.Rb(wt.a),m.Rb(ye.a),m.Rb(Fn.a))},e.\u0275cmp=m.Lb({type:e,selectors:[["app-patient-consent"]],inputs:{episodeSetter:["episodeDetails","episodeSetter"]},outputs:{episodeChange:"episodeChange"},decls:7,vars:5,consts:[["nz-typography",""],["nzSimple","",4,"ngIf"],[4,"ngIf"],["nzSimple",""],[3,"ngModel","ngModelChange"],["nz-radio","","nzValue","APP_CONSENT",3,"nzDisabled"],["nz-radio","","nzValue","SMS_CONSENT",3,"nzDisabled"],["nz-radio","","nzValue","VERBAL_CONSENT",3,"nzDisabled"],["nz-radio","","nzValue","MANUAL_CONSENT",3,"nzDisabled"],["nz-radio","","nzValue","DIGITAL_CONSENT",3,"nzDisabled"],["class","in-progress-box",4,"ngIf"],["nz-dropdown","","nzSize","large","nz-button","","nzShape","circle",1,"consent-round-btn",3,"disabled","nzDropdownMenu"],["size","23px","color","#A7C853","altColor","#a7c853","name","phone"],["menu","nzDropdownMenu"],["nz-menu","","nzSelectable",""],[4,"ngFor","ngForOf"],["nzSize","large","nz-button","","nzShape","circle","nz-tooltip","","nzTooltipPlacement","right",1,"consent-round-btn",3,"nzTooltipTitle","click"],["size","23px","color","#a7c853","altColor","#a7c853","name","formFilled"],["nz-menu-item","",3,"click",4,"ngIf"],["nz-menu-item","",3,"click"],["nz-typography","","nzType","secondary",1,"phone-label"],["nz-typography","","nzType","success",1,"phone-span"],[1,"phone-span"],[2,"margin-top","10px"],["size","23px","color","#a7c853","strokeColor","#a7c853","name","direct"],["nzSize","large","nz-button","","nzShape","circle","nz-tooltip","","nzTooltipPlacement","right","nz-dropdown","",1,"consent-round-btn",3,"nzTooltipTitle","nzDropdownMenu"],["menuSMS","nzDropdownMenu"],[3,"nzShowButton","nzCustomRequest","nzShowUploadList","nzBeforeUpload"],["nz-button","","nzType","primary",2,"min-width","160px","min-height","40px"],[1,"in-progress-box"],["nzSize","small","nzDanger","","nzType","default","nz-button","","nz-tooltip","","nzTooltipPlacement","top",1,"revoke-btn",3,"nzTooltipTitle","click"],[1,"greyed-text"],["nz-button","","nzType","link",3,"click"],[1,"dot"],["nz-button","","nzType","primary",3,"click"],["nz-typography","",1,"consent-status","denied-text"],[1,"view-details",3,"click"],["nz-row","","nzGutter","32"],["nz-col","","nzXs","24","nzSm","12","nzMd","6"],["nz-typography","","nzType","success"],["nz-col","","nzXs","24","nzSm","12","nzMd","6",4,"ngIf"],[1,"consent-container",3,"ngClass"],["actionable","","nz-typography","",3,"nzType","click"],["size","14px","color","#a7c853","strokeColor","#a7c853","name","view",3,"altColorScheme"],["id","validTill"],["nz-typography","",3,"nzType","click"],["actionable","",4,"ngIf"],["actionable","",3,"click"],["size","12px","color","#a7c853","strokeColor","#a7c853","name","view",3,"altColorScheme"],["actionable",""],["size","12px","color","#a7c853","strokeColor","#a7c853","name","play",3,"altColorScheme"],["size","12px","color","#a7c853","strokeColor","#a7c853","name","pauseCircle",3,"altColorScheme"]],template:function(e,t){1&e&&(m.Xb(0,"nz-card"),m.Xb(1,"h3",0),m.Xc(2),m.jc(3,"translate"),m.Wb(),m.Vc(4,jn,1,0,"nz-spin",1),m.Vc(5,pi,7,6,"ng-container",2),m.Wb(),m.Sb(6,"br")),2&e&&(m.Db(2),m.Yc(m.kc(3,3,"CONSENT.PATIENT_CONSENT")),m.Db(2),m.rc("ngIf",t.loading),m.Db(1),m.rc("ngIf",!t.loading))},directives:[I.a,T.a,s.q,ae.a,M.c,c.u,c.x,M.b,mt.a,Ct.a,S.b,A.a,S.d,oe.a,S.e,E.c,s.p,je.d,E.e,Mt.a,O.c,O.a,s.o,Fe.a],pipes:[Q.a,s.A,s.e],styles:["nz-card[_ngcontent-%COMP%]{padding:10px;text-align:left}h3[_ngcontent-%COMP%]{margin-bottom:0}nz-spin[_ngcontent-%COMP%]{text-align:center}nz-radio-group[_ngcontent-%COMP%]{width:100%;margin-top:20px;display:flex;flex-direction:row;flex-wrap:wrap;align-content:space-between;row-gap:20px}nz-radio-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{width:30%}.consent-round-btn[_ngcontent-%COMP%]{margin:25px 25px 25px 0;text-align:center;width:50px;height:50px;padding:11px}.consent-round-btn[_ngcontent-%COMP%], button[_ngcontent-%COMP%]:hover{border:2px solid var(--primary-color)}td[_ngcontent-%COMP%] > app-icons[_ngcontent-%COMP%]{cursor:pointer}td[_ngcontent-%COMP%] > app-icons[_ngcontent-%COMP%] + app-icons[_ngcontent-%COMP%]{margin-left:20px}.ant-modal-content[_ngcontent-%COMP%]{border-radius:20px}.consent-status[_ngcontent-%COMP%]{margin-top:30px;margin-bottom:0;font-weight:400}.denied-text[_ngcontent-%COMP%]{color:#ff3939}.obtained-text[_ngcontent-%COMP%]{color:var(--primary-color)}.in-progress-box[_ngcontent-%COMP%]{border-radius:10px;background:#f6f6f6 0 0 no-repeat padding-box;height:70px;max-width:100%;margin-top:10px;padding:25px;text-align:left;line-height:1px}.in-progress-box[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#000;text-align:left;padding:0}.in-progress-box[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:20px}.dot[_ngcontent-%COMP%]{height:7px;width:7px;margin-left:3px;margin-bottom:2px}div[_ngcontent-%COMP%] > nz-card[_ngcontent-%COMP%]{display:inline-block;min-width:-webkit-fit-content;min-width:-moz-fit-content;min-width:fit-content;width:90%;height:110px;border:1px solid #dcdcdc;border-radius:10px;background-color:#f5f5f5;padding:4px;margin-left:5%}div[_ngcontent-%COMP%] > nz-card[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#8a8a8a}div[_ngcontent-%COMP%] > nz-card[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-weight:600}div[_ngcontent-%COMP%] > nz-card[_ngcontent-%COMP%] .ant-card-body{padding:10px}div[_ngcontent-%COMP%] > nz-card[_ngcontent-%COMP%]:hover{background:var(--neutral-color);border:1px solid var(--primary-color)}div[_ngcontent-%COMP%] > nz-card[_ngcontent-%COMP%]:hover   a[_ngcontent-%COMP%]{color:var(--primary-color)}div[_ngcontent-%COMP%] > nz-card[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{line-height:1.2}.consent-pending-text[_ngcontent-%COMP%]{text-align:left;font:normal normal normal 14px/20px Nunito;letter-spacing:0;color:#0f2015;opacity:1}.date[_ngcontent-%COMP%]{color:#888}.view-details[_ngcontent-%COMP%]{margin-top:20px;color:#0f2015}.dot[_ngcontent-%COMP%]{height:5px;width:5px;background-color:#0080ff;border-radius:50%;display:inline-block}.revoke-btn[_ngcontent-%COMP%]{float:right;position:relative;color:#ff3939;border-color:#ff3939}.revoke-btn[_ngcontent-%COMP%]:hover{color:#ff3939;border-color:#ff3939!important} .ant-drawer-right.ant-drawer-open.no-mask{width:0}.manual-consent-col[_ngcontent-%COMP%]{text-align:center!important}.revoke-btn[_ngcontent-%COMP%]{margin:0;height:auto;top:-12px;width:auto!important;height:42px!important}.consent-container[_ngcontent-%COMP%]{width:100%;border-radius:10px;border:1px solid #dcdcdc;padding:30px 15px 15px!important}.consent-container[_ngcontent-%COMP%]:hover{box-shadow:0 3px 6px #00000029;border:1px solid #8bc34a}.consent-container[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600}.consent-disabled[_ngcontent-%COMP%]{background:#f5f5f5 0 0 no-repeat padding-box;pointer-events:none}#validTill[_ngcontent-%COMP%]{display:block;margin-top:-25px}app-icons[_ngcontent-%COMP%]{vertical-align:text-top}.phone-label[_ngcontent-%COMP%]{font-size:11px}.phone-span[_ngcontent-%COMP%]{font-size:12px}"]}),e})();var hi=function(e){return e.INITIAL_SMS="INITIAL_SMS",e.CONTACT_ATTEMPT="CONTACT_ATTEMPT",e}({});const gi=function(){return{minRows:6,maxRows:10}};let fi=(()=>{class e{constructor(e){this._modalRef=e}save(){this._modalRef.close({startDateTime:this.dateTime,message:this.message,type:hi.INITIAL_SMS,successful:!0})}}return e.\u0275fac=function(t){return new(t||e)(m.Rb(We.e))},e.\u0275cmp=m.Lb({type:e,selectors:[["app-initial-sms-event"]],decls:24,vars:4,consts:[["id","heading"],["nz-row","","nzGutter","16"],["nz-col","","nzSpan","24"],["nz-col","","nzSpan","12"],["nzPlaceHolder","Select Date/Time","nzShowTime","",3,"ngModel","ngModelChange"],["nz-input","","placeholder","SMS content",3,"ngModel","nzAutosize","ngModelChange"],["nz-col","","nzOffset","21","nzSpan","3"],["nz-button","","nzType","primary",3,"click"]],template:function(e,t){1&e&&(m.Xb(0,"strong",0),m.Xc(1,"Log Initial SMS"),m.Wb(),m.Sb(2,"br"),m.Sb(3,"br"),m.Xb(4,"div",1),m.Xb(5,"div",2),m.Xb(6,"strong"),m.Xc(7,"Select SMS date/time:"),m.Wb(),m.Wb(),m.Wb(),m.Xb(8,"div",1),m.Xb(9,"div",3),m.Xb(10,"nz-date-picker",4),m.ec("ngModelChange",function(e){return t.dateTime=e}),m.Wb(),m.Wb(),m.Wb(),m.Sb(11,"br"),m.Xb(12,"div",1),m.Xb(13,"div",2),m.Xb(14,"strong"),m.Xc(15,"Enter message:"),m.Wb(),m.Wb(),m.Wb(),m.Xb(16,"div",1),m.Xb(17,"div",2),m.Xb(18,"textarea",5),m.ec("ngModelChange",function(e){return t.message=e}),m.Wb(),m.Wb(),m.Wb(),m.Sb(19,"br"),m.Xb(20,"div",1),m.Xb(21,"div",6),m.Xb(22,"button",7),m.ec("click",function(){return t.save()}),m.Xc(23,"Save"),m.Wb(),m.Wb(),m.Wb()),2&e&&(m.Db(10),m.rc("ngModel",t.dateTime),m.Db(8),m.rc("ngModel",t.message)("nzAutosize",m.xc(3,gi)))},directives:[O.c,O.a,K.a,c.u,c.x,N.b,c.d,N.a,mt.a,Ct.a,A.a],styles:["#heading[_ngcontent-%COMP%]{padding-left:1%;font-size:14px;font-weight:600;border-left:3px solid var(--primary-color)}button[_ngcontent-%COMP%]{width:100%}"]}),e})();const vi=function(){return{minRows:6,maxRows:10}};let mi=(()=>{class e{constructor(e){this._modalRef=e}save(){this._modalRef.close({startDateTime:this.dateTime,message:this.message,type:hi.CONTACT_ATTEMPT,successful:this.successful})}}return e.\u0275fac=function(t){return new(t||e)(m.Rb(We.e))},e.\u0275cmp=m.Lb({type:e,selectors:[["app-contact-attempt-event"]],decls:30,vars:7,consts:[["id","heading"],["nz-row","","nzGutter","16"],["nz-col","","nzSpan","12"],["nzPlaceHolder","Select Date/Time","nzShowTime","",3,"ngModel","ngModelChange"],[3,"ngModel","ngModelChange"],["nz-radio-button","",3,"nzValue"],["nz-col","","nzSpan","24"],["nz-input","","placeholder","Contact attempt notes...",3,"ngModel","nzAutosize","ngModelChange"],["nz-col","","nzOffset","21","nzSpan","3"],["nz-button","","nzType","primary",3,"click"]],template:function(e,t){1&e&&(m.Xb(0,"strong",0),m.Xc(1,"Log Contact Attempt"),m.Wb(),m.Sb(2,"br"),m.Sb(3,"br"),m.Xb(4,"div",1),m.Xb(5,"div",2),m.Xb(6,"strong"),m.Xc(7,"Select Attempt date/time:"),m.Wb(),m.Wb(),m.Wb(),m.Xb(8,"div",1),m.Xb(9,"div",2),m.Xb(10,"nz-date-picker",3),m.ec("ngModelChange",function(e){return t.dateTime=e}),m.Wb(),m.Wb(),m.Xb(11,"div",2),m.Xb(12,"nz-radio-group",4),m.ec("ngModelChange",function(e){return t.successful=e}),m.Xb(13,"label",5),m.Xc(14,"Successful"),m.Wb(),m.Xb(15,"label",5),m.Xc(16,"Failed"),m.Wb(),m.Wb(),m.Wb(),m.Wb(),m.Sb(17,"br"),m.Xb(18,"div",1),m.Xb(19,"div",6),m.Xb(20,"strong"),m.Xc(21,"Enter message:"),m.Wb(),m.Wb(),m.Wb(),m.Xb(22,"div",1),m.Xb(23,"div",6),m.Xb(24,"textarea",7),m.ec("ngModelChange",function(e){return t.message=e}),m.Wb(),m.Wb(),m.Wb(),m.Sb(25,"br"),m.Xb(26,"div",1),m.Xb(27,"div",8),m.Xb(28,"button",9),m.ec("click",function(){return t.save()}),m.Xc(29,"Save"),m.Wb(),m.Wb(),m.Wb()),2&e&&(m.Db(10),m.rc("ngModel",t.dateTime),m.Db(2),m.rc("ngModel",t.successful),m.Db(1),m.rc("nzValue",!0),m.Db(2),m.rc("nzValue",!1),m.Db(9),m.rc("ngModel",t.message)("nzAutosize",m.xc(6,vi)))},directives:[O.c,O.a,K.a,c.u,c.x,M.c,M.b,M.a,N.b,c.d,N.a,mt.a,Ct.a,A.a],styles:["#heading[_ngcontent-%COMP%]{padding-left:1%;font-size:14px;font-weight:600;border-left:3px solid var(--primary-color)}button[_ngcontent-%COMP%]{width:100%}"]}),e})();var Ci=n("ncdi"),Di=n("fhRi");function Si(e,t){1&e&&(m.Xb(0,"label"),m.Xc(1," No episode events have been logged yet "),m.Wb())}function Ei(e,t){if(1&e&&(m.Vb(0),m.Sb(1,"br"),m.Xb(2,"p"),m.Xb(3,"strong"),m.Xc(4,"Message: "),m.Wb(),m.Xc(5),m.Wb(),m.Ub()),2&e){const e=m.ic(3);m.Db(5),m.Yc(null==e.attempt?null:e.attempt.message)}}function Oi(e,t){if(1&e&&(m.Xb(0,"nz-timeline-item",13),m.Xc(1," Initial SMS was sent at "),m.Xb(2,"strong"),m.Xc(3),m.jc(4,"utcToLocalTime"),m.jc(5,"utcToLocalTime"),m.Wb(),m.Vc(6,Ei,6,1,"ng-container",9),m.Wb()),2&e){const e=m.ic().$implicit,t=m.ic();m.Db(3),m.Zc(" ",m.kc(4,2,null==e||null==e.value[0]?null:e.value[0].startDateTime)||m.kc(5,4,null==e||null==e.value[0]?null:e.value[0].createdAt)," "),m.Db(3),m.rc("ngIf",null==t.attempt||null==t.attempt.message?null:t.attempt.message.length)}}function Ii(e,t){if(1&e&&(m.Vb(0),m.Sb(1,"br"),m.Xb(2,"p"),m.Xb(3,"strong"),m.Xc(4,"Message: "),m.Wb(),m.Xc(5),m.Wb(),m.Ub()),2&e){const e=m.ic(2).$implicit;m.Db(5),m.Yc(null==e?null:e.message)}}function _i(e,t){if(1&e&&(m.Vb(0),m.Xc(1," Patient contacted successfully at "),m.Xb(2,"strong"),m.Xc(3),m.jc(4,"utcToLocalTime"),m.jc(5,"utcToLocalTime"),m.Wb(),m.Vc(6,Ii,6,1,"ng-container",9),m.Ub()),2&e){const e=m.ic().$implicit;m.Db(3),m.Zc(" ",m.kc(4,2,null==e?null:e.startDateTime)||m.kc(5,4,null==e?null:e.createdAt)," "),m.Db(3),m.rc("ngIf",null==e||null==e.message?null:e.message.length)}}function Xi(e,t){if(1&e&&(m.Vb(0),m.Sb(1,"br"),m.Xb(2,"p"),m.Xb(3,"strong"),m.Xc(4,"Message: "),m.Wb(),m.Xc(5),m.Wb(),m.Ub()),2&e){const e=m.ic(2).$implicit;m.Db(5),m.Yc(null==e?null:e.message)}}function Ti(e,t){if(1&e&&(m.Vb(0),m.Xc(1," Failed to contact patient at "),m.Xb(2,"strong"),m.Xc(3),m.jc(4,"utcToLocalTime"),m.jc(5,"utcToLocalTime"),m.Wb(),m.Vc(6,Xi,6,1,"ng-container",9),m.Ub()),2&e){const e=m.ic().$implicit;m.Db(3),m.Zc(" ",m.kc(4,2,null==e?null:e.startDateTime)||m.kc(5,4,null==e?null:e.createdAt)," "),m.Db(3),m.rc("ngIf",null==e||null==e.message?null:e.message.length)}}function Ni(e,t){if(1&e&&(m.Xb(0,"nz-timeline-item",15),m.Vc(1,_i,7,6,"ng-container",9),m.Vc(2,Ti,7,6,"ng-container",9),m.Wb()),2&e){const e=t.$implicit;m.rc("nzColor",e.successful?"blue":"red"),m.Db(1),m.rc("ngIf",e.successful),m.Db(1),m.rc("ngIf",!e.successful)}}function zi(e,t){if(1&e&&(m.Vb(0),m.Vc(1,Ni,3,3,"nz-timeline-item",14),m.Ub()),2&e){const e=m.ic().$implicit;let t=null;m.Db(1),m.rc("ngForOf",null==e||null==e.value||null==(t=e.value.slice())?null:t.reverse())}}function Mi(e,t){if(1&e&&(m.Vb(0),m.Vc(1,Oi,7,6,"nz-timeline-item",12),m.Vc(2,zi,2,1,"ng-container",9),m.Ub()),2&e){const e=t.$implicit;m.Db(1),m.rc("ngIf","INITIAL_SMS"===(null==e?null:e.key)),m.Db(1),m.rc("ngIf","CONTACT_ATTEMPT"===(null==e?null:e.key))}}const yi=function(e){return{disabled:e}};let Ai=(()=>{class e{constructor(e,t,n){this._modalService=e,this._episodeService=t,this._notificationsService=n,this.objectKeys=Object.keys,this.refreshEpisode=new m.n,this.eventsMap=new Map}ngOnInit(){this._episodeService.fetchEpisodeEvents(this.episodeDetails.id).subscribe(e=>{this.eventsMap=e})}logInitialSMS(){this._modalService.create({nzContent:fi,nzWidth:"700px",nzFooter:null}).afterClose.subscribe(e=>{var t;e&&this._episodeService.postEpisodeEvent(this.episodeDetails.id,null===(t=this.episodeDetails)||void 0===t?void 0:t.patientId,e).subscribe(()=>{this._notificationsService.success("Episode Event","SMS logged successfully!"),this.refreshEpisodeState()})})}logContactAttempt(){this._modalService.create({nzContent:mi,nzComponentParams:{},nzWidth:"700px",nzFooter:null}).afterClose.subscribe(e=>{if(!e)return;const t=this.eventsMap.CONTACT_ATTEMPT;2<=(null==t?void 0:t.length)&&!(null==e?void 0:e.successful)?this._modalService.confirm({nzTitle:"Confirm",nzContent:"A 'Trying to contact you' letter will be sent to the patient once this failed contact attempt is logged, Are you sure you want to continue?",nzOkText:"Ok",nzCancelText:"Cancel",nzOnOk:()=>this.postContactAttempt(e)}):this.postContactAttempt(e)})}postContactAttempt(e){var t;this._episodeService.postEpisodeEvent(this.episodeDetails.id,null===(t=this.episodeDetails)||void 0===t?void 0:t.patientId,e).subscribe(()=>{this._notificationsService.success("Episode Event","Contact attempt logged successfully!"),this.refreshEpisodeState()})}refreshEpisodeState(){this.refreshEpisode.emit(!0)}}return e.\u0275fac=function(t){return new(t||e)(m.Rb(We.f),m.Rb(u.a),m.Rb(D.b))},e.\u0275cmp=m.Lb({type:e,selectors:[["app-toc-events"]],inputs:{episodeDetails:"episodeDetails"},outputs:{refreshEpisode:"refreshEpisode"},decls:24,vars:13,consts:[["nz-row",""],["nz-col","","nzXs","24","nzSm","18","nzMd","18"],["nz-typography",""],["nz-col","","nzSpan","6","id","actions"],["nz-button","","nzType","primary","nz-dropdown","",3,"nzDropdownMenu","nzPlacement"],["menu","nzDropdownMenu"],["nz-menu",""],["nz-menu-item","",3,"ngClass","click"],["nz-col","","nzXs","24","nzSm","18","nzMd","21"],[4,"ngIf"],[3,"nzReverse"],[4,"ngFor","ngForOf"],["nzColor","green",4,"ngIf"],["nzColor","green"],[3,"nzColor",4,"ngFor","ngForOf"],[3,"nzColor"]],template:function(e,t){if(1&e&&(m.Xb(0,"nz-card"),m.Xb(1,"div",0),m.Xb(2,"div",1),m.Xb(3,"h3",2),m.Xc(4,"Episode events"),m.Wb(),m.Wb(),m.Xb(5,"div",3),m.Xb(6,"button",4),m.Xc(7," Log Event "),m.Wb(),m.Xb(8,"nz-dropdown-menu",null,5),m.Xb(10,"ul",6),m.Xb(11,"li",7),m.ec("click",function(){return t.logInitialSMS()}),m.Xc(12," Log Initial SMS "),m.Wb(),m.Xb(13,"li",7),m.ec("click",function(){return t.logContactAttempt()}),m.Xc(14," Log Contact Attempt "),m.Wb(),m.Wb(),m.Wb(),m.Wb(),m.Wb(),m.Vb(15),m.Sb(16,"br"),m.Xb(17,"div",0),m.Xb(18,"div",8),m.Vc(19,Si,2,0,"label",9),m.Xb(20,"nz-timeline",10),m.Vc(21,Mi,3,2,"ng-container",11),m.jc(22,"keyvalue"),m.Wb(),m.Wb(),m.Wb(),m.Ub(),m.Wb(),m.Sb(23,"br")),2&e){const e=m.Ic(9);let n=null;m.Db(6),m.rc("nzDropdownMenu",e)("nzPlacement","bottomRight"),m.Db(5),m.rc("ngClass",m.yc(9,yi,!!t.eventsMap.INITIAL_SMS)),m.Db(2),m.rc("ngClass",m.yc(11,yi,!t.eventsMap.INITIAL_SMS||3<=(null==t.eventsMap.CONTACT_ATTEMPT?null:t.eventsMap.CONTACT_ATTEMPT.length))),m.Db(6),m.rc("ngIf",!t.eventsMap||!(null!=(n=t.objectKeys(t.eventsMap))&&n.length)),m.Db(1),m.rc("nzReverse",!0),m.Db(1),m.rc("ngForOf",m.kc(22,7,t.eventsMap))}},directives:[I.a,O.c,O.a,T.a,mt.a,Ct.a,A.a,S.d,S.b,S.e,E.c,E.e,s.o,s.q,Ci.a,s.p,Ci.b],pipes:[s.j,Di.a],styles:[".ant-card[_ngcontent-%COMP%]{padding:10px}h3[_ngcontent-%COMP%]{margin-bottom:0}#actions[_ngcontent-%COMP%]{text-align:right}.disabled[_ngcontent-%COMP%]{color:gray;pointer-events:none}label[_ngcontent-%COMP%]{font:normal normal normal 13px/16px Nunito;color:var(--tertiary-color);margin-bottom:5px;display:block}"]}),e})();var Pi=n("vDSh"),Wi=n("OE57"),Ri=n("SKKP"),wi=n("KupA"),Li=n("Edj7"),xi=n("Ujc4");function ki(e,t){1&e&&m.Sb(0,"nz-ribbon",11)}function Vi(e,t){if(1&e){const e=m.Yb();m.Xb(0,"a",13),m.ec("nzOnConfirm",function(){return m.Lc(e),m.ic(2).deleteAppointment()}),m.jc(1,"translate"),m.Sb(2,"app-icons",14),m.Wb()}2&e&&m.sc("nzPopconfirmTitle",m.kc(1,1,"APPOINTMENT.REMOVE_APPOINTMENT"))}function Ui(e,t){if(1&e&&m.Vc(0,Vi,3,3,"a",12),2&e){const e=m.ic();m.rc("ngIf","FINISHED"==!(null!=e.appointment&&e.appointment.overallStatus))}}function Fi(e,t){if(1&e&&m.Sb(0,"app-icons",15),2&e){const e=m.ic();m.tc("routerLink","/appointments/details/",null==e.appointment?null:e.appointment.id,"")}}function ji(e,t){if(1&e){const e=m.Yb();m.Vb(0),m.Xb(1,"app-video-call-widget",17),m.ec("click",function(){m.Lc(e);const t=m.ic(2);return t.logAction("video_call",t.patientId)}),m.Wb(),m.Ub()}if(2&e){const e=m.ic(2);m.Db(1),m.rc("userId",e.patientId)("appointmentId",null==e.appointment?null:e.appointment.id)}}function Yi(e,t){if(1&e){const e=m.Yb();m.Vb(0),m.Xb(1,"app-audio-call-widget",18),m.ec("click",function(){m.Lc(e);const t=m.ic(2);return t.logAction("audio_call",null==t.appointment?null:t.appointment.attendeeId)}),m.Wb(),m.Ub()}if(2&e){const e=m.ic(2);m.Db(1),m.rc("userId",e.patientId)("phoneNumbers",e.phoneNumbers)("disabled","FINISHED"==(null==e.appointment?null:e.appointment.overallStatus))("renderVital",!1)("appointmentId",null==e.appointment?null:e.appointment.id)("appointmentSessionId",null==e.appointment?null:e.appointment.videoCallSessionId)}}function Gi(e,t){if(1&e&&(m.Vc(0,ji,2,2,"ng-container",16),m.Vc(1,Yi,2,6,"ng-container",16)),2&e){const e=m.ic();m.rc("ngIf","VIDEO_CALL"==(null==e.appointment?null:e.appointment.appointmentType)),m.Db(1),m.rc("ngIf","AUDIO_CALL"==(null==e.appointment?null:e.appointment.appointmentType))}}const Bi=function(e,t){return[e,t]};let Hi=(()=>{class e{constructor(e,t,n,i){this._appointmentsService=e,this._notificationsService=t,this._translationService=n,this._episodesEventLogger=i,this.bodyStyle={height:"82px"},this.deleteEvent=new m.n}deleteAppointment(){var e;this._appointmentsService.setAppointmentAsDeleted(null===(e=this.appointment)||void 0===e?void 0:e.id).subscribe(()=>{this._episodesEventLogger.episodeAppointmentsEvent(this.episodeId,this.patientId,this.appointment.id,"episode_delete_appointment"),this._translationService.getMultiple("FORM.APPOINTMENT","APPOINTMENT.APPOINTMENT_DELETE").subscribe(e=>{this._notificationsService.success(e.get("FORM.APPOINTMENT"),e.get("APPOINTMENT.APPOINTMENT_DELETE"))}),this.emitDeleteSuccessfullEvent()})}emitDeleteSuccessfullEvent(){this.deleteEvent.emit()}}return e.\u0275fac=function(t){return new(t||e)(m.Rb(Wi.a),m.Rb(D.b),m.Rb(G.a),m.Rb(ye.a))},e.\u0275cmp=m.Lb({type:e,selectors:[["app-upcoming-episode-appointment"]],inputs:{episodeId:"episodeId",patientId:"patientId",staffMap:"staffMap",appointment:"appointment",phoneNumbers:"phoneNumbers"},outputs:{deleteEvent:"deleteEvent"},decls:22,vars:17,consts:[["nzText","Completed","nzStandalone","",4,"ngIf"],[1,"appointment-container",3,"nzTitle","nzHoverable","nzActions","nzExtra","nzSize","nzBodyStyle"],["nz-row",""],["nz-col","","nzSpan","12"],["nz-typography","","nzType","secondary"],["nz-col","","nzSpan","12",2,"text-align","right"],[1,"time"],["nz-col","","nzSpan","24"],["delete",""],["view",""],["call",""],["nzText","Completed","nzStandalone",""],["nz-popconfirm","",3,"nzPopconfirmTitle","nzOnConfirm",4,"ngIf"],["nz-popconfirm","",3,"nzPopconfirmTitle","nzOnConfirm"],["size","16px","name","delete"],["size","16px","name","view",3,"routerLink"],[4,"ngIf"],[3,"userId","appointmentId","click"],[3,"userId","phoneNumbers","disabled","renderVital","appointmentId","appointmentSessionId","click"]],template:function(e,t){if(1&e&&(m.Vc(0,ki,1,0,"nz-ribbon",0),m.Xb(1,"nz-card",1),m.jc(2,"date"),m.Xb(3,"div"),m.Xb(4,"div",2),m.Xb(5,"div",3),m.Xb(6,"label",4),m.Xc(7,"Clinician"),m.Wb(),m.Wb(),m.Xb(8,"div",5),m.Xb(9,"label",6),m.Xc(10),m.jc(11,"titlecase"),m.Wb(),m.Wb(),m.Wb(),m.Xb(12,"div",2),m.Xb(13,"div",7),m.Xb(14,"strong"),m.Xc(15),m.Wb(),m.Wb(),m.Wb(),m.Wb(),m.Vc(16,Ui,1,1,"ng-template",null,8,m.Wc),m.Vc(18,Fi,1,1,"ng-template",null,9,m.Wc),m.Vc(20,Gi,2,2,"ng-template",null,10,m.Wc),m.Wb()),2&e){const e=m.Ic(17),n=m.Ic(19),i=m.Ic(21);m.rc("ngIf","FINISHED"==(null==t.appointment?null:t.appointment.overallStatus)),m.Db(1),m.sc("nzTitle",m.lc(2,9,null==t.appointment?null:t.appointment.startsOn,"d MMM y")),m.rc("nzHoverable",!0)("nzActions",m.zc(14,Bi,n,i))("nzExtra",e)("nzSize","small")("nzBodyStyle",t.bodyStyle),m.Db(9),m.Yc(m.kc(11,12,null==t.appointment?null:t.appointment.timeSlot)),m.Db(5),m.Yc(t.staffMap[null==t.appointment?null:t.appointment.attenderId])}},directives:[s.q,I.a,O.c,O.a,T.a,Ri.c,wi.a,oe.a,C.h,Li.a,xi.a],pipes:[s.e,s.A,Q.a],styles:[".appointment-container[_ngcontent-%COMP%]{border-radius:10px;border:1px solid #dcdcdc;padding:10px!important;margin:5px;height:182px}.date[_ngcontent-%COMP%]{font-weight:600;color:var(--primary-color)}.date[_ngcontent-%COMP%], .time[_ngcontent-%COMP%]{display:unset}.time[_ngcontent-%COMP%]{font-size:12.5px;border-radius:2px;padding:2px 10px;background:#f5f5f5 0 0 no-repeat padding-box}label[_ngcontent-%COMP%]{font:normal normal normal 13px/16px Nunito;color:var(--tertiary-color);margin-bottom:5px;display:block}[_nghost-%COMP%]     .ant-ribbon.ant-ribbon-placement-end{right:-3px;color:var(--neutral-color);z-index:100}[_nghost-%COMP%]     .ant-card-hoverable:hover{box-shadow:3px 5px 5px #00000036}"]}),e})(),$i=(()=>{class e{transform(e,t){var n,i;let s=!1;return(null===(n=Object.keys(null==e?void 0:e.serviceCodes))||void 0===n?void 0:n.length)||(s=!0),null===(i=null==e?void 0:e.availableConsents)||void 0===i||i.forEach(n=>{kt.b.OBTAINED===(null==n?void 0:n.consentStatus)&&(null==n?void 0:n.episodeType)===(null==e?void 0:e.type)?s=!0:"DST"!==t||kt.b.IN_PROGRESS!==(null==n?void 0:n.consentStatus)||"APP_CONSENT"!==(null==n?void 0:n.type)&&"SMS_CONSENT"!==(null==n?void 0:n.type)||(s=!0)}),s}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=m.Qb({name:"validConsent",type:e,pure:!0}),e})();function Zi(e,t){if(1&e){const e=m.Yb();m.Vb(0),m.Xb(1,"div",8),m.Xb(2,"button",9),m.ec("click",function(){return m.Lc(e),m.ic().addAppointment()}),m.jc(3,"validConsent"),m.Xc(4," Create Appointment "),m.Wb(),m.Wb(),m.Ub()}if(2&e){const e=m.ic();m.Db(2),m.rc("disabled","CCM"!==(null==e.episodeDetails?null:e.episodeDetails.type)&&!m.lc(3,1,e.episodeDetails,"DST"))}}function qi(e,t){1&e&&(m.Xb(0,"label"),m.Xc(1),m.jc(2,"translate"),m.Wb()),2&e&&(m.Db(1),m.Yc(m.kc(2,1,"APPOINTMENTS.NOUPCOMING")))}function Ki(e,t){if(1&e){const e=m.Yb();m.Xb(0,"div",10),m.Xb(1,"app-upcoming-episode-appointment",11),m.ec("deleteEvent",function(){return m.Lc(e),m.ic().refreshEpisodeState()}),m.Wb(),m.Wb()}if(2&e){const e=t.$implicit,n=m.ic();m.Db(1),m.rc("appointment",e)("episodeId",null==n.episodeDetails?null:n.episodeDetails.id)("patientId",null==n.episodeDetails?null:n.episodeDetails.patientId)("staffMap",null==n.episodeDetails?null:n.episodeDetails.monitoringStaff)("phoneNumbers",null==n.user?null:n.user.phoneNumbers)}}const Qi=function(){return["ADD_APPOINTMENT"]};let Ji=(()=>{class e{constructor(e,t,n){this._dateComparePipe=e,this._notificationsService=t,this._router=n,this.refreshEpisode=new m.n}ngOnInit(){this.appointments=new Array,this.episodeDetails.appointments.forEach(e=>{"FINISHED"!=e.overallStatus&&this.appointments.push(e)}),this.episodeDetails.appointments.forEach(e=>{"FINISHED"==e.overallStatus&&this.appointments.push(e)})}addAppointment(){var e,t,n;!this._dateComparePipe.transform(this.episodeDetails.endDate)||"IN_PROGRESS"!==this.episodeDetails.status&&"SCHEDULED"!==this.episodeDetails.status?this._notificationsService.error("Episode Suspended","This episode has been suspended and no further activities can be assigned."):this._router.navigate(["appointments/create",null===(e=this.episodeDetails)||void 0===e?void 0:e.patientId],{queryParams:{episodeId:(null===(t=this.episodeDetails)||void 0===t?void 0:t.id)||"",episodeType:(null===(n=this.episodeDetails)||void 0===n?void 0:n.type)||"",fromEpisode:!0}})}}return e.\u0275fac=function(t){return new(t||e)(m.Rb(Pi.a),m.Rb(D.b),m.Rb(C.g))},e.\u0275cmp=m.Lb({type:e,selectors:[["app-appointment"]],inputs:{episodeDetails:"episodeDetails",user:"user"},outputs:{refreshEpisode:"refreshEpisode"},features:[m.Cb([Pi.a])],decls:14,vars:7,consts:[["nz-row",""],["nz-col","","nzSpan","21"],["nz-typography",""],[4,"isFeaturePermitted"],["nz-col","","nzSpan","24"],[4,"ngIf"],["nz-row","","nzGutter","8"],["nz-col","","nzSpan","6",4,"ngFor","ngForOf"],["nz-col","","nzSpan","3","id","actions"],["nz-button","","nzType","primary","nzSize","large",3,"disabled","click"],["nz-col","","nzSpan","6"],[3,"appointment","episodeId","patientId","staffMap","phoneNumbers","deleteEvent"]],template:function(e,t){1&e&&(m.Xb(0,"nz-card"),m.Xb(1,"div",0),m.Xb(2,"div",1),m.Xb(3,"h3",2),m.Xc(4),m.jc(5,"translate"),m.Wb(),m.Wb(),m.Vc(6,Zi,5,4,"ng-container",3),m.Wb(),m.Xb(7,"div",0),m.Xb(8,"div",4),m.Sb(9,"br"),m.Vc(10,qi,3,3,"label",5),m.Xb(11,"div",6),m.Vc(12,Ki,2,5,"div",7),m.Wb(),m.Wb(),m.Wb(),m.Wb(),m.Sb(13,"br")),2&e&&(m.Db(4),m.Yc(m.kc(5,4,"MENU.APPOINTMENT")),m.Db(2),m.rc("isFeaturePermitted",m.xc(6,Qi)),m.Db(4),m.rc("ngIf",!(null!=t.episodeDetails&&null!=t.episodeDetails.appointments&&t.episodeDetails.appointments.length)),m.Db(2),m.rc("ngForOf",t.appointments))},directives:[I.a,O.c,O.a,T.a,ot.a,s.q,s.p,mt.a,Ct.a,A.a,Hi],pipes:[Q.a,$i],styles:[".ant-card[_ngcontent-%COMP%]{padding:10px}h3[_ngcontent-%COMP%]{margin-bottom:0}label[_ngcontent-%COMP%]{font:normal normal normal 13px/16px Nunito;color:var(--tertiary-color);margin-bottom:5px;display:block}#actions[_ngcontent-%COMP%]{text-align:right}"]}),e})();var es=n("gDH+"),ts=n("rMZv");function ns(e,t){1&e&&(m.Xb(0,"label"),m.Xc(1," No device has been setup yet "),m.Wb())}function is(e,t){if(1&e){const e=m.Yb();m.Vb(0),m.Xb(1,"button",7),m.ec("click",function(){return m.Lc(e),m.ic().showDeviceSetupModal()}),m.jc(2,"validConsent"),m.Xc(3),m.jc(4,"translate"),m.Wb(),m.Xc(5," \xa0 "),m.Ub()}if(2&e){const e=m.ic();m.Db(1),m.rc("disabled",!m.lc(2,2,e.episodeDetails,"DST")||"SCHEDULED"!==(null==e.episodeDetails?null:e.episodeDetails.status)&&"IN_PROGRESS"!==(null==e.episodeDetails?null:e.episodeDetails.status)),m.Db(2),m.Zc(" ",m.kc(4,5,"EPISODE.EDU_TASK")," ")}}function ss(e,t){if(1&e){const e=m.Yb();m.Vb(0),m.Xc(1," \xa0 "),m.Xb(2,"button",9),m.ec("click",function(){return m.Lc(e),m.ic(2).showDeviceSetupModal(!0)}),m.jc(3,"validConsent"),m.Xc(4),m.jc(5,"translate"),m.Wb(),m.Ub()}if(2&e){const e=m.ic(2);m.Db(2),m.rc("disabled",!m.lc(3,2,e.episodeDetails,"DST")||"SCHEDULED"!==(null==e.episodeDetails?null:e.episodeDetails.status)&&"IN_PROGRESS"!==(null==e.episodeDetails?null:e.episodeDetails.status)),m.Db(2),m.Zc(" ",m.kc(5,5,"APPOINTMENT.RESCHEDULE")," ")}}function as(e,t){if(1&e&&(m.Vb(0),m.Vc(1,ss,6,7,"ng-container",3),m.Xb(2,"button",8),m.Xc(3),m.jc(4,"translate"),m.Wb(),m.Ub()),2&e){const e=m.ic();m.Db(1),m.rc("ngIf",!1),m.Db(1),m.tc("routerLink","/appointments/details/",null==e.appointment?null:e.appointment.id,""),m.rc("disabled","SCHEDULED"!==(null==e.episodeDetails?null:e.episodeDetails.status)&&"IN_PROGRESS"!==(null==e.episodeDetails?null:e.episodeDetails.status)),m.Db(1),m.Zc(" ",m.kc(4,4,"APPOINTMENT.VIEW_APPOINTMENT")," ")}}const os=function(e){return{"shaded-row":e}};function ls(e,t){if(1&e){const e=m.Yb();m.Xb(0,"tr",13),m.Xb(1,"td"),m.Xc(2),m.Wb(),m.Xb(3,"td"),m.Xc(4),m.Wb(),m.Xb(5,"td"),m.Xc(6),m.jc(7,"date"),m.Wb(),m.Xb(8,"td"),m.Xc(9),m.Wb(),m.Xb(10,"td"),m.Xc(11),m.jc(12,"date"),m.Wb(),m.Xb(13,"td"),m.Xb(14,"a",14),m.ec("nzOnConfirm",function(){m.Lc(e);const n=t.$implicit;return m.ic(2).completeDST(null==n?null:n.id)}),m.Xb(15,"button",15),m.jc(16,"validConsent"),m.Xc(17," Mark as complete "),m.Wb(),m.Wb(),m.Wb(),m.Wb()}if(2&e){const e=t.$implicit,n=t.index,i=m.ic(2);m.rc("ngClass",m.yc(15,os,n%2!=0)),m.Db(2),m.Yc(null==e?null:e.name),m.Db(2),m.Yc(null==i.episodeDetails?null:i.episodeDetails.monitoringStaff[null==i.appointment?null:i.appointment.attenderId]),m.Db(2),m.Yc(m.lc(7,7,null==e?null:e.scheduledAt,"mediumDate")),m.Db(3),m.Yc(null!=e&&e.completed?"Completed":"Pending"),m.Db(2),m.Yc(m.lc(12,10,null==e?null:e.completedAt,"mediumDate")||"N/A"),m.Db(4),m.rc("disabled",(null==e?null:e.completed)||!m.kc(16,13,i.episodeDetails))}}const rs=function(){return{x:"1175px"}};function cs(e,t){if(1&e&&(m.Vb(0),m.Sb(1,"br"),m.Xb(2,"nz-table",10,11),m.Xb(4,"thead"),m.Xb(5,"tr"),m.Xb(6,"th"),m.Xc(7),m.jc(8,"translate"),m.Wb(),m.Xb(9,"th"),m.Xc(10,"Assigned to"),m.Wb(),m.Xb(11,"th"),m.Xc(12),m.jc(13,"translate"),m.Wb(),m.Xb(14,"th"),m.Xc(15),m.jc(16,"translate"),m.Wb(),m.Xb(17,"th"),m.Xc(18),m.jc(19,"translate"),m.Wb(),m.Sb(20,"th"),m.Wb(),m.Wb(),m.Xb(21,"tbody"),m.Vc(22,ls,18,17,"tr",12),m.Wb(),m.Wb(),m.Ub()),2&e){const e=m.Ic(3),t=m.ic();m.Db(2),m.rc("nzData",null==t.episodeDetails?null:t.episodeDetails.deviceSetupTasks)("nzScroll",m.xc(15,rs)),m.Db(5),m.Yc(m.kc(8,7,"COMMON.TITLE")),m.Db(5),m.Yc(m.kc(13,9,"PATIENT.SECHEDULED_ON")),m.Db(3),m.Yc(m.kc(16,11,"COMMON.STATUS")),m.Db(3),m.Yc(m.kc(19,13,"TABLEHEADER.COMPLETEDON")),m.Db(4),m.rc("ngForOf",e.data)}}let ds=(()=>{class e{constructor(e,t,n,i,s,a,o){this._episodesService=e,this._dataSharingService=t,this._translationsService=n,this._episodesEventLogger=i,this._notificationsService=s,this._bt105CreateModalService=a,this._episodesModalService=o,this.refreshEpisode=new m.n,this.cloudDevices=["BT105","PY802LTE","PY300LTE","BT005","BGMD1","SMCLBS","SM5000IB","SMCOX","GM291V"],this.translatedStrings=new Map,this.translations$=this._translationsService.getMultiple("EPISODE","EPISODE.DEVICE_SETUP_TASK","EPISODE.DST.NO_DEVICES_ENABLED","EPISODE.UNABLE_TO_ASSIGN_DST_NO_CLINICIAN").subscribe(e=>this.translatedStrings=e)}set episode(e){this.episodeDetails=e,this.getAppointment()}ngAfterViewInit(){this.getAppointment(),this.getDevices()}ngOnDestroy(){var e,t;null===(e=this.tenantConfig$)||void 0===e||e.unsubscribe(),null===(t=this.translations$)||void 0===t||t.unsubscribe()}getAppointment(){var e,t,n;const i=null===(e=this.episodeDetails)||void 0===e?void 0:e.deviceSetupTasks[0];i&&(this.appointment=null===(n=null===(t=this.episodeDetails)||void 0===t?void 0:t.appointments)||void 0===n?void 0:n.find(e=>e.id===(null==i?void 0:i.appointmentId)))}getDevices(){this._episodesService.fetchDeviceSpecifications().subscribe(e=>{this.tenantConfig$=this._dataSharingService.tenantSettings.subscribe(t=>{e&&t&&(this.tenantConfig=t,this.devices=e.filter(e=>-1!==t.deviceConfig.supportedDevices.findIndex(t=>t===e.model||-1!==this.cloudDevices.indexOf(e.model))))})})}validate(){var e,t,n,i,s;return(null===(n=null===(t=null===(e=this.tenantConfig)||void 0===e?void 0:e.deviceConfig)||void 0===t?void 0:t.supportedDevices)||void 0===n?void 0:n.length)?!!(null===(s=Object.keys(null===(i=this.episodeDetails)||void 0===i?void 0:i.monitoringStaff))||void 0===s?void 0:s.length)||(this._notificationsService.warning(this.translatedStrings.get("EPISODE.DEVICE_SETUP_TASK"),this.translatedStrings.get("EPISODE.UNABLE_TO_ASSIGN_DST_NO_CLINICIAN")),!1):(this._notificationsService.error(this.translatedStrings.get("EPISODE.DEVICE_SETUP_TASK"),this.translatedStrings.get("EPISODE.DST.NO_DEVICES_ENABLED")),!1)}showDeviceSetupModal(e=!1){var t,n;if(!this.validate())return;const i=localStorage.getItem("loggedInUserRole");if(d.a.MONITORING_STAFF===i){const e=localStorage.getItem("loggedInUser");Object.keys(null===(t=this.episodeDetails)||void 0===t?void 0:t.monitoringStaff).filter(t=>e!==t).forEach(e=>{var t;return null===(t=this.episodeDetails)||void 0===t||delete t.monitoringStaff[e]})}this._episodesModalService.createDeviceSetupTaskModal(null===(n=this.episodeDetails)||void 0===n?void 0:n.monitoringStaff,this.devices,this.patient).afterClose.subscribe(t=>{t&&(e?this.rescheduleAppointment(t):this.assignDST(t))})}assignDST(e){this._episodesService.assignDeviceSetupTask(this.episodeDetails.id,e).subscribe(e=>{var t,n;this.refreshEpisodeState(),this._episodesEventLogger.episodeAppointmentsEvent(this.episodeDetails.id,this.episodeDetails.patientId,null===(n=null===(t=this.episodeDetails)||void 0===t?void 0:t.appointments[this.episodeDetails.appointments.length-1])||void 0===n?void 0:n.id,"episode_add_appointment")})}rescheduleAppointment(e){var t,n,i,s;const a=null===(s=null===(t=this.episodeDetails)||void 0===t?void 0:t.appointments[(null===(i=null===(n=this.episodeDetails)||void 0===n?void 0:n.appointments)||void 0===i?void 0:i.length)-1])||void 0===s?void 0:s.id;this._episodesService.rescheduleAppointment(a,this.episodeDetails.id,e).subscribe(t=>{this._notificationsService.success(this.translatedStrings.get("EPISODE"),t.message),this.assignDST(e),this._episodesEventLogger.episodeAppointmentsEvent(this.episodeDetails.id,this.episodeDetails.patientId,a,"episode_reschedule_appointment")},e=>{this._notificationsService.error(this.translatedStrings.get("EPISODE"),e.json().message)})}completeDST(e){this._episodesService.fetchActionItemById(e).subscribe(e=>{e.completed=!0,e.completedOn=Date.now(),e.completedBy=localStorage.getItem("loggedInUser"),this._episodesService.updateActionItem(e).subscribe(()=>{this._notificationsService.success("Device Setup Task","Task marked as completed successfully!"),this.refreshEpisodeState()})})}assignDevice(){var e;this._bt105CreateModalService.showModal(null===(e=this.episodeDetails)||void 0===e?void 0:e.patientId)}refreshEpisodeState(){this.refreshEpisode.emit(!0)}}return e.\u0275fac=function(t){return new(t||e)(m.Rb(u.a),m.Rb(H.a),m.Rb(G.a),m.Rb(ye.a),m.Rb(D.b),m.Rb(es.a),m.Rb(at.a))},e.\u0275cmp=m.Lb({type:e,selectors:[["app-device-setup-tasks"]],inputs:{patient:"patient",episode:["episodeDetails","episode"]},outputs:{refreshEpisode:"refreshEpisode"},decls:16,vars:14,consts:[["nz-row",""],["nz-col","","nzXs","24","nzSm","6","nzMd","14"],["nz-typography",""],[4,"ngIf"],["nz-col","","nzXs","24","nzSm","18","nzMd","10","id","actions"],["type","button",3,"userId","phoneNumbers","disabled"],["nz-button","","nzSize","large",3,"disabled","click"],["nz-button","","nzType","primary","nzSize","large",3,"disabled","click"],["nz-button","","nzType","primary","nzSize","large",3,"disabled","routerLink"],["nz-button","","nzType","default","nzSize","large",3,"disabled","click"],["nzShowPagination","false","nzSize","small","nzBordered","false",3,"nzData","nzScroll"],["dstTable",""],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],["nz-popconfirm","","nzPopconfirmTitle","Are you sure you want to mark this task as complete ?","nzPopconfirmPlacement","left",3,"nzOnConfirm"],["nz-button","","nzType","primary","nzSize","small",3,"disabled"]],template:function(e,t){1&e&&(m.Xb(0,"nz-card"),m.Xb(1,"div",0),m.Xb(2,"div",1),m.Xb(3,"h3",2),m.Xc(4),m.jc(5,"translate"),m.Wb(),m.Vc(6,ns,2,0,"label",3),m.Wb(),m.Xb(7,"div",4),m.Vc(8,is,6,7,"ng-container",3),m.Sb(9,"app-audio-call-widget",5),m.Xb(10,"button",6),m.ec("click",function(){return t.assignDevice()}),m.Xc(11),m.jc(12,"translate"),m.Wb(),m.Vc(13,as,5,6,"ng-container",3),m.Wb(),m.Wb(),m.Vc(14,cs,23,16,"ng-container",3),m.Wb(),m.Sb(15,"br")),2&e&&(m.Db(4),m.Zc(" ",m.kc(5,10,"EPISODE.DEVICE_SETUP")," "),m.Db(2),m.rc("ngIf",!(null!=t.episodeDetails&&null!=t.episodeDetails.deviceSetupTasks&&t.episodeDetails.deviceSetupTasks.length)),m.Db(2),m.rc("ngIf",!(null!=t.episodeDetails&&null!=t.episodeDetails.deviceSetupTasks&&t.episodeDetails.deviceSetupTasks.length)),m.Db(1),m.rc("userId",null==t.episodeDetails?null:t.episodeDetails.patientId)("phoneNumbers",null==t.patient?null:t.patient.phoneNumbers)("disabled","SCHEDULED"!==(null==t.episodeDetails?null:t.episodeDetails.status)&&"IN_PROGRESS"!==(null==t.episodeDetails?null:t.episodeDetails.status)),m.Db(1),m.rc("disabled","SCHEDULED"!==(null==t.episodeDetails?null:t.episodeDetails.status)&&"IN_PROGRESS"!==(null==t.episodeDetails?null:t.episodeDetails.status)),m.Db(1),m.Zc(" ",m.kc(12,12,"DEVICES.ADD")," "),m.Db(2),m.rc("ngIf",null==t.episodeDetails||null==t.episodeDetails.deviceSetupTasks?null:t.episodeDetails.deviceSetupTasks.length),m.Db(1),m.rc("ngIf",null==t.episodeDetails||null==t.episodeDetails.deviceSetupTasks?null:t.episodeDetails.deviceSetupTasks.length))},directives:[I.a,O.c,O.a,T.a,s.q,xi.a,mt.a,Ct.a,A.a,C.h,ts.f,ts.n,ts.o,ts.e,ts.l,ts.i,s.p,s.o,wi.a],pipes:[Q.a,$i,s.e],styles:[".ant-card[_ngcontent-%COMP%]{padding:10px}h3[_ngcontent-%COMP%]{margin-bottom:0}label[_ngcontent-%COMP%]{font:normal normal normal 13px/16px Nunito;color:var(--tertiary-color);margin-bottom:5px;display:block}#actions[_ngcontent-%COMP%]{text-align:right}#actions[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{margin-left:5px}[_nghost-%COMP%]     .ant-table-thead>tr>th{height:50px!important}[_nghost-%COMP%]     .ant-table-tbody>tr>td{border-bottom:none}.shaded-row[_ngcontent-%COMP%]{background-color:var(--light-grey)}"]}),e})();var bs=n("cTUG");function ps(e,t){if(1&e){const e=m.Yb();m.Vb(0),m.Xb(1,"app-plan-of-care-details",8),m.ec("refresh",function(){return m.Lc(e),m.ic(2).getPlanOfCare()}),m.Wb(),m.Sb(2,"br"),m.Ub()}if(2&e){const e=t.$implicit;m.Db(1),m.rc("planOfCare",e)}}function us(e,t){1&e&&(m.Vb(0),m.Xb(1,"strong"),m.Xc(2,"Plan of Care has not been assigned yet!"),m.Wb(),m.Ub())}function hs(e,t){if(1&e){const e=m.Yb();m.Xb(0,"div"),m.Xb(1,"nz-card"),m.Xb(2,"div",1),m.Xb(3,"div",2),m.Xb(4,"h3",3),m.Xc(5,"Plan of Care"),m.Wb(),m.Wb(),m.Xb(6,"div",4),m.Xb(7,"button",5),m.ec("click",function(){return m.Lc(e),m.ic().viewHistory()}),m.Xc(8," History "),m.Wb(),m.Wb(),m.Xb(9,"div",4),m.Xb(10,"button",6),m.ec("click",function(){return m.Lc(e),m.ic().addPlanOfCare()}),m.Xc(11," Add New "),m.Wb(),m.Wb(),m.Wb(),m.Vc(12,ps,3,1,"ng-container",7),m.Vc(13,us,3,0,"ng-container",0),m.Wb(),m.Sb(14,"br"),m.Wb()}if(2&e){const e=m.ic();m.Db(12),m.rc("ngForOf",e.planOfCare),m.Db(1),m.rc("ngIf",e.planOfCare&&!(null!=e.planOfCare&&e.planOfCare.length))}}let gs=(()=>{class e{constructor(e,t){this._router=e,this._planOfCareService=t}ngOnInit(){this.getPlanOfCare()}getPlanOfCare(){var e;this._planOfCareService.fetchPlanOfCare(null===(e=this.patient)||void 0===e?void 0:e.id).subscribe(e=>{this.planOfCare=e})}viewHistory(){var e,t,n;this._router.navigate([`episodes/plan-of-care/details/${null===(e=this.patient)||void 0===e?void 0:e.id}/${null===(t=this.episodeDetails)||void 0===t?void 0:t.id}`],{queryParams:{tab:"history",patientName:null===(n=this.patient)||void 0===n?void 0:n.fullName}})}addPlanOfCare(){var e,t;this._router.navigate([`episodes/plan-of-care/${null===(e=this.patient)||void 0===e?void 0:e.id}/${null===(t=this.episodeDetails)||void 0===t?void 0:t.id}`])}}return e.\u0275fac=function(t){return new(t||e)(m.Rb(C.g),m.Rb(a.a))},e.\u0275cmp=m.Lb({type:e,selectors:[["app-plan-of-care"]],inputs:{episodeDetails:"episodeDetails",patient:"patient"},outputs:{refresh:"refresh"},decls:1,vars:1,consts:[[4,"ngIf"],["nz-row","","nzGutter","16"],["nz-col","","nzXs","24","nzSm","20","nzMd","20"],["nz-typography",""],["nz-col","","nzXs","24","nzSm","24","nzMd","2"],["nz-button","","id","full-width-button","nzSize","large",3,"click"],["nz-button","","id","full-width-button","nzType","primary","nzSize","large",3,"click"],[4,"ngFor","ngForOf"],[3,"planOfCare","refresh"]],template:function(e,t){1&e&&m.Vc(0,hs,15,2,"div",0),2&e&&m.rc("ngIf",t.episodeDetails&&"CCM"!==t.episodeDetails.type)},directives:[s.q,I.a,O.c,O.a,T.a,mt.a,Ct.a,A.a,s.p,bs.a],styles:["[_nghost-%COMP%]     .ant-card{padding:10px}[_nghost-%COMP%]     .ant-card-body{max-height:165px;overflow:hidden}h3[_ngcontent-%COMP%]{margin-bottom:0}#full-width-button[_ngcontent-%COMP%]{width:100%}#actions[_ngcontent-%COMP%]{text-align:right}"]}),e})();var fs=n("OG+h");let vs=(()=>{class e{constructor(e,t,n,i){this._cdRef=e,this._element=t,this._dateComparePipe=n,this._dataSharingService=i}ngOnInit(){this.getTenantSettings()}ngOnChanges(e){this.checkStatus()}ngOnDestroy(){this.$tenantSettings.unsubscribe()}getTenantSettings(){this.$tenantSettings=this._dataSharingService.assignedTenantSettings.subscribe(e=>{var t;e.forEach((e,n)=>{e.episodeBlueprints.findIndex(e=>e.id===this.episodeDetails.blueprintId)>=0&&(t=e)}),t&&!this.tenantSettings&&(this.tenantSettings=t,this.checkStatus())})}getEpisodeBlueprint(){var e;const t=null===(e=this.tenantSettings)||void 0===e?void 0:e.episodeBlueprints;return null==t?void 0:t.find(e=>this.episodeDetails.blueprintId===e.id&&!e.archived)}getActiveCarePlan(){var e,t,n,i,s;(null===(t=null===(e=this.episodeDetails)||void 0===e?void 0:e.activeCarePlans)||void 0===t?void 0:t.length)&&(this.careplan=null===(n=this.episodeDetails)||void 0===n?void 0:n.activeCarePlans[(null===(s=null===(i=this.episodeDetails)||void 0===i?void 0:i.activeCarePlans)||void 0===s?void 0:s.length)-1])}checkStatus(){switch(this.getActiveCarePlan(),this.isCarePlanEntityEnabled){case"AUTO_ASSIGN_CARE_PLAN":this.isAutoAssignCarePlanEnabled();break;case"ASSIGN_CARE_PLAN":this.isAssignCarePlanEnabled();break;case"EDIT_CARE_PLAN":this.isEditCarePlanEnabled();break;case"VIEW_CARE_PLAN":this.isViewCarePlanEnabled();break;case"CARE_PLAN_AUTO_ASSIGNED":this.isCarePlanAutoAssigned();break;case"CARE_PLAN_SUSPENDED":this.isCarePlanSuspended();break;case"CARE_PLAN_COMPLETED":this.isCarePlanCompleted();break;default:this.disableFeature()}}enableFeature(){this._element.nativeElement.style.display="unset",this._cdRef.detectChanges()}disableFeature(){this._element.nativeElement.style.display="none",this._cdRef.detectChanges()}isEpisodeExpired(){var e,t,n;return((new Date).getMonth()+1>new Date(null===(e=this.episodeDetails)||void 0===e?void 0:e.endDate).getMonth()+1||"IN_PROGRESS"!==(null===(t=this.episodeDetails)||void 0===t?void 0:t.status)&&"SCHEDULED"!==(null===(n=this.episodeDetails)||void 0===n?void 0:n.status))&&(this.disableFeature(),!0)}isAutoAssignCarePlanEnabled(){var e,t,n,i,s,a,o,l,r,c;if(this.isEpisodeExpired())return;const d=this.getEpisodeBlueprint();return(null===(e=null==d?void 0:d.episodeComponent)||void 0===e?void 0:e.enableConsentForm)?ge.a.RPM===(null==d?void 0:d.type)&&this.isDeviceSetupComplete()||ge.a.RPM===(null==d?void 0:d.type)&&(null===(n=null===(t=this.episodeDetails)||void 0===t?void 0:t.availableConsents)||void 0===n?void 0:n.length)&&!this.consentObtained()&&this.isDeviceSetupComplete()||ge.a.GENERAL===(null==d?void 0:d.type)&&(null===(s=null===(i=this.episodeDetails)||void 0===i?void 0:i.availableConsents)||void 0===s?void 0:s.length)&&this.consentObtained()||ge.a.CCM===(null==d?void 0:d.type)&&(null===(o=null===(a=this.episodeDetails)||void 0===a?void 0:a.availableConsents)||void 0===o?void 0:o.length)&&this.consentObtained()||(null===(l=this.careplan)||void 0===l?void 0:l.id)||(null===(c=null===(r=this.episodeDetails)||void 0===r?void 0:r.inActiveCarePlans)||void 0===c?void 0:c.length)?this.disableFeature():void this.enableFeature():this.disableFeature()}isAssignCarePlanEnabled(){var e,t,n,i;if(this.isEpisodeExpired())return;const s=this.getEpisodeBlueprint();if(null===(t=null===(e=this.episodeDetails)||void 0===e?void 0:e.activeCarePlans)||void 0===t?void 0:t.length)return this.disableFeature();(null===(n=null==s?void 0:s.episodeComponent)||void 0===n?void 0:n.enableConsentForm)&&(this.consentObtained()&&this.isDeviceSetupComplete()&&!(null===(i=this.careplan)||void 0===i?void 0:i.id)||this.disableFeature())}isEditCarePlanEnabled(){var e,t,n,i,s;if(this.isEpisodeExpired())return;if(!(null===(t=null===(e=this.episodeDetails)||void 0===e?void 0:e.activeCarePlans)||void 0===t?void 0:t.length))return this.disableFeature();const a=null===(n=this.episodeDetails)||void 0===n?void 0:n.activeCarePlans[(null===(s=null===(i=this.episodeDetails)||void 0===i?void 0:i.activeCarePlans)||void 0===s?void 0:s.length)-1];if("SUSPENDED"===(null==a?void 0:a.status))return this.disableFeature();this._dateComparePipe.transform(null==a?void 0:a.endDate)&&"COMPLETED"!==(null==a?void 0:a.status)||this.disableFeature()}isViewCarePlanEnabled(){var e,t,n,i;if(this.isEpisodeExpired())return;const s=this.getEpisodeBlueprint();return"CCM"!==(null===(e=this.episodeDetails)||void 0===e?void 0:e.type)||(null===(t=null==s?void 0:s.episodeComponent)||void 0===t?void 0:t.enableCarePlan)?(null===(i=null===(n=this.episodeDetails)||void 0===n?void 0:n.activeCarePlans)||void 0===i?void 0:i.length)?void this.enableFeature():this.disableFeature():this.enableFeature()}isCarePlanAutoAssigned(){var e,t,n,i;if((null===(t=null===(e=this.episodeDetails)||void 0===e?void 0:e.activeCarePlans)||void 0===t?void 0:t.length)||!(null===(n=this.careplan)||void 0===n?void 0:n.id)||"IN_PROGRESS"!==(null===(i=this.episodeDetails)||void 0===i?void 0:i.status))return this.disableFeature()}isCarePlanSuspended(){var e,t,n,i,s;if(!(null===(t=null===(e=this.episodeDetails)||void 0===e?void 0:e.activeCarePlans)||void 0===t?void 0:t.length))return this.disableFeature();const a=null===(n=this.episodeDetails)||void 0===n?void 0:n.activeCarePlans[(null===(s=null===(i=this.episodeDetails)||void 0===i?void 0:i.activeCarePlans)||void 0===s?void 0:s.length)-1];return"SUSPENDED"!==(null==a?void 0:a.status)?this.disableFeature():void 0}isCarePlanCompleted(){var e,t,n,i,s;if(!(null===(t=null===(e=this.episodeDetails)||void 0===e?void 0:e.activeCarePlans)||void 0===t?void 0:t.length))return this.disableFeature();const a=null===(n=this.episodeDetails)||void 0===n?void 0:n.activeCarePlans[(null===(s=null===(i=this.episodeDetails)||void 0===i?void 0:i.activeCarePlans)||void 0===s?void 0:s.length)-1];return"SUSPENDED"===(null==a?void 0:a.status)||this._dateComparePipe.transform(null==a?void 0:a.endDate)||"COMPLETED"!==(null==a?void 0:a.status)?this.disableFeature():void 0}consentObtained(){var e,t,n,i;let s=!1;return(null===(t=Object.keys(null===(e=this.episodeDetails)||void 0===e?void 0:e.serviceCodes))||void 0===t?void 0:t.length)||(s=!0),null===(i=null===(n=this.episodeDetails)||void 0===n?void 0:n.availableConsents)||void 0===i||i.forEach(e=>{var t;kt.b.OBTAINED===(null==e?void 0:e.consentStatus)&&(null==e?void 0:e.episodeType)===(null===(t=this.episodeDetails)||void 0===t?void 0:t.type)&&(s=!0)}),s}isDeviceSetupComplete(){var e,t,n,i,s;const a=this.getEpisodeBlueprint(),o=null===(e=null==a?void 0:a.enabledServiceCodes)||void 0===e?void 0:e.find(e=>"99453"===e);if(!o)return!0;const l=null===(n=null===(t=this.episodeDetails)||void 0===t?void 0:t.deviceSetupTasks)||void 0===n?void 0:n.filter(e=>e.completed);return!(o&&!(null==l?void 0:l.length))&&l.length===(null===(s=null===(i=this.episodeDetails)||void 0===i?void 0:i.deviceSetupTasks)||void 0===s?void 0:s.length)}}return e.\u0275fac=function(t){return new(t||e)(m.Rb(m.h),m.Rb(m.l),m.Rb(Pi.a),m.Rb(H.a))},e.\u0275dir=m.Mb({type:e,selectors:[["","isCarePlanEntityEnabled",""]],inputs:{isCarePlanEntityEnabled:"isCarePlanEntityEnabled",episodeDetails:"episodeDetails"},features:[m.Cb([Pi.a]),m.Bb]}),e})();function ms(e,t){if(1&e&&(m.Xb(0,"span",9),m.jc(1,"translate"),m.Xc(2),m.Wb()),2&e){const e=m.ic(2);m.uc("nzTooltipTitle","",null==e.careplan?null:e.careplan.name," ",m.kc(1,3,"CAREPLAN.ASSIGNED.INFO"),""),m.Db(2),m.Zc("\xa0 | \xa0 ",null==e.careplan?null:e.careplan.name," ")}}function Cs(e,t){if(1&e&&(m.Xb(0,"strong"),m.Xc(1),m.Wb()),2&e){const e=m.ic(4);m.Db(1),m.Zc(" ",16-(null==e.episodeDetails?null:e.episodeDetails.patientComplianceCount[99454])," days ")}}function Ds(e,t){1&e&&(m.Xb(0,"strong"),m.Xc(1," 0 days "),m.Wb())}function Ss(e,t){if(1&e&&(m.Vb(0),m.Xb(1,"label",10),m.Xc(2," As per RPM guidelines, a minimum of one vital needs to be measured for the next : "),m.Vc(3,Cs,2,1,"strong",0),m.Vc(4,Ds,2,0,"strong",0),m.Wb(),m.Ub()),2&e){const e=m.ic(3);m.Db(1),m.rc("isCarePlanEntityEnabled","VIEW_CARE_PLAN")("episodeDetails",e.episodeDetails),m.Db(2),m.rc("ngIf",(null==e.episodeDetails?null:e.episodeDetails.patientComplianceCount[99454])<16),m.Db(1),m.rc("ngIf",(null==e.episodeDetails?null:e.episodeDetails.patientComplianceCount[99454])>=16)}}function Es(e,t){1&e&&(m.Vb(0),m.Xc(1),m.jc(2,"translate"),m.Ub()),2&e&&(m.Db(1),m.Zc(" ",m.kc(2,1,"CAREPLAN.ASSIGNED.INFO")," "))}function Os(e,t){if(1&e&&(m.Xb(0,"label"),m.Xb(1,"strong"),m.Xc(2),m.Wb(),m.Xc(3),m.jc(4,"translate"),m.Wb()),2&e){const e=m.ic(3);m.Db(2),m.Yc(null==e.episodeDetails||null==e.episodeDetails.inActiveCarePlans[0]?null:e.episodeDetails.inActiveCarePlans[0].name),m.Db(1),m.Zc(" ",m.kc(4,2,"CAREPLAN.ASSIGNED")," ")}}function Is(e,t){if(1&e&&(m.Xb(0,"label"),m.Xb(1,"strong"),m.Xc(2),m.Wb(),m.Xc(3),m.jc(4,"translate"),m.Wb()),2&e){const e=m.ic(3);m.Db(2),m.Yc(null==e.episodeDetails||null==e.episodeDetails.inActiveCarePlans[0]?null:e.episodeDetails.inActiveCarePlans[0].name),m.Db(1),m.Zc(" ",m.kc(4,2,"CAREPLAN.ASSIGNED_DST")," ")}}function _s(e,t){if(1&e&&(m.Vb(0),m.Xb(1,"label",10),m.Xc(2),m.jc(3,"translate"),m.Wb(),m.Xb(4,"label",10),m.Xc(5),m.jc(6,"translate"),m.Wb(),m.Vc(7,Ss,5,4,"ng-container",0),m.Vc(8,Es,3,3,"ng-container",0),m.Vc(9,Os,5,4,"label",0),m.Vc(10,Is,5,4,"label",0),m.Ub()),2&e){const e=m.ic(2);m.Db(1),m.rc("isCarePlanEntityEnabled","AUTO_ASSIGN_CARE_PLAN")("episodeDetails",e.episodeDetails),m.Db(1),m.Zc(" ",m.kc(3,10,"CAREPLAN.ACTIVATION.INFO")," "),m.Db(2),m.rc("isCarePlanEntityEnabled","ASSIGN_CARE_PLAN")("episodeDetails",e.episodeDetails),m.Db(1),m.Zc(" ",m.kc(6,12,"CAREPLAN.ACTIVATION.INFO")," "),m.Db(2),m.rc("ngIf",e.isRPMEpisode),m.Db(1),m.rc("ngIf",!e.isRPMEpisode&&(null==e.episodeDetails||null==e.episodeDetails.activeCarePlans?null:e.episodeDetails.activeCarePlans.length)),m.Db(1),m.rc("ngIf",(null==e.episodeDetails||null==e.episodeDetails.inActiveCarePlans?null:e.episodeDetails.inActiveCarePlans.length)&&!e.isConsentAvailable),m.Db(1),m.rc("ngIf",e.isRPMEpisode&&(null==e.episodeDetails||null==e.episodeDetails.inActiveCarePlans?null:e.episodeDetails.inActiveCarePlans.length)&&(!(null!=e.episodeDetails&&null!=e.episodeDetails.deviceSetupTasks&&e.episodeDetails.deviceSetupTasks.length)||!e.isDSTComplete))}}function Xs(e,t){1&e&&(m.Vb(0),m.Xc(1),m.jc(2,"translate"),m.Ub()),2&e&&(m.Db(1),m.Zc(" ",m.kc(2,1,"CAREPLAN.ASSIGNED.INFO")," "))}function Ts(e,t){if(1&e){const e=m.Yb();m.Xb(0,"button",11),m.ec("click",function(){return m.Lc(e),m.ic(2).viewCareplanTemplates("auto-assign")}),m.Xc(1),m.jc(2,"translate"),m.Wb()}if(2&e){const e=m.ic(2);m.rc("isCarePlanEntityEnabled","AUTO_ASSIGN_CARE_PLAN")("episodeDetails",e.episodeDetails),m.Db(1),m.Zc(" ",m.kc(2,3,"CAREPLAN.AUTO_ASSIGN")," ")}}function Ns(e,t){if(1&e){const e=m.Yb();m.Xb(0,"button",11),m.ec("click",function(){return m.Lc(e),m.ic(2).viewCareplanTemplates("assign")}),m.Xc(1),m.jc(2,"translate"),m.Wb()}if(2&e){const e=m.ic(2);m.rc("isCarePlanEntityEnabled","ASSIGN_CARE_PLAN")("episodeDetails",e.episodeDetails),m.Db(1),m.Zc(" ",m.kc(2,3,"CAREPLAN.ASSIGN_CAREPLAN")," ")}}function zs(e,t){if(1&e){const e=m.Yb();m.Xb(0,"span",10),m.Xb(1,"button",12),m.Sb(2,"app-icons",13),m.Wb(),m.Xb(3,"nz-dropdown-menu",null,14),m.Xb(5,"ul",15),m.Xb(6,"li",16),m.ec("click",function(){return m.Lc(e),m.ic(2).editCarePlan()}),m.Xc(7),m.jc(8,"translate"),m.Wb(),m.Wb(),m.Wb(),m.Wb()}if(2&e){const e=m.Ic(4),t=m.ic(2);m.rc("isCarePlanEntityEnabled","EDIT_CARE_PLAN")("episodeDetails",t.episodeDetails),m.Db(1),m.rc("nzDropdownMenu",e),m.Db(6),m.Yc(m.kc(8,4,"COMMON.EDIT_CAREPLAN"))}}function Ms(e,t){if(1&e){const e=m.Yb();m.Xb(0,"nz-card"),m.Xb(1,"div",1),m.Xb(2,"div",2),m.Xb(3,"h3",3),m.Xc(4),m.jc(5,"translate"),m.Vc(6,ms,3,5,"span",4),m.Wb(),m.Vc(7,_s,11,14,"ng-container",0),m.Vc(8,Xs,3,3,"ng-container",0),m.Wb(),m.Xb(9,"div",5),m.Xb(10,"button",6),m.ec("click",function(){return m.Lc(e),m.ic().viewCarePlan()}),m.Xc(11),m.jc(12,"translate"),m.Wb(),m.Vc(13,Ts,3,5,"button",7),m.Vc(14,Ns,3,5,"button",7),m.Vc(15,zs,9,6,"span",8),m.Wb(),m.Wb(),m.Wb()}if(2&e){const e=m.ic();m.Db(4),m.Zc(" ",m.kc(5,10,"EPISODE.CAREPLAN")," "),m.Db(2),m.rc("ngIf",null==e.careplan?null:e.careplan.name),m.Db(1),m.rc("ngIf",!e.isCCMNonCareplanEpisode),m.Db(1),m.rc("ngIf",e.isCCMNonCareplanEpisode),m.Db(2),m.rc("isCarePlanEntityEnabled","VIEW_CARE_PLAN")("episodeDetails",e.episodeDetails),m.Db(1),m.Zc(" ",m.kc(12,12,"COMMON.VIEW_CAREPLAN")," "),m.Db(2),m.rc("ngIf",!e.isCCMNonCareplanEpisode),m.Db(1),m.rc("ngIf",!e.isCCMNonCareplanEpisode),m.Db(1),m.rc("ngIf",!e.isCCMNonCareplanEpisode)}}let ys=(()=>{class e{constructor(e,t,n,i,s,a){this._router=e,this._modalService=t,this.translationService=n,this._notificationsService=i,this._episodesEventLogger=s,this._dataSharingService=a,this.strings=["CAREPLAN.CHOOSE_CAREPLAN_TEMPLATE","COMMON.CAREPLAN","CAREPLAN.ACTIVE_ON_CONSENT"],this.isRPMEpisode=!0,this.isCCMNonCareplanEpisode=!1,this.$translationSubscription=this.translationService.getMultiple(...this.strings).subscribe(e=>{this.translatedStrings=e}),this.refresh=new m.n}ngOnInit(){this.getTenantConfig(),this.getActiveCarePlan(),this.checkForConsent(),this.checkForDST()}ngOnDestroy(){var e;null===(e=this.$translationSubscription)||void 0===e||e.unsubscribe()}getTenantConfig(){this._dataSharingService.assignedTenantSettings.subscribe(e=>{var t,n,i,s,a,o,l,r;const c=e.get(null===(t=this.episodeDetails)||void 0===t?void 0:t.tenantId);this.isRPMEpisode=-1!==(null===(s=null===(i=null===(n=null==c?void 0:c.episodeBlueprints)||void 0===n?void 0:n.find(e=>this.episodeDetails.blueprintId===e.id&&!e.archived))||void 0===i?void 0:i.enabledServiceCodes)||void 0===s?void 0:s.findIndex(e=>"99454"===e)),this.isCCMNonCareplanEpisode="CCM"==(null===(a=this.episodeDetails)||void 0===a?void 0:a.type)&&!1===(null===(r=null===(l=null===(o=null==c?void 0:c.episodeBlueprints)||void 0===o?void 0:o.find(e=>this.episodeDetails.blueprintId===e.id&&!e.archived))||void 0===l?void 0:l.episodeComponent)||void 0===r?void 0:r.enableCarePlan)})}checkForConsent(){this.isConsentAvailable=-1!==this.episodeDetails.availableConsents.findIndex(e=>"OBTAINED"===e.consentStatus)}checkForDST(){this.isDSTComplete=this.episodeDetails.deviceSetupTasks.every(e=>e.completed)}getActiveCarePlan(){var e,t,n,i,s;(null===(t=null===(e=this.episodeDetails)||void 0===e?void 0:e.activeCarePlans)||void 0===t?void 0:t.length)&&(this.careplan=null===(n=this.episodeDetails)||void 0===n?void 0:n.activeCarePlans[(null===(s=null===(i=this.episodeDetails)||void 0===i?void 0:i.activeCarePlans)||void 0===s?void 0:s.length)-1])}viewCarePlan(){var e,t,n,i,s,a,o,l;this._episodesEventLogger.episodeCareplanActionEvent(null===(e=this.episodeDetails)||void 0===e?void 0:e.id,null===(t=this.episodeDetails)||void 0===t?void 0:t.patientId,"episode_view_careplan"),"CCM"==(null===(n=this.episodeDetails)||void 0===n?void 0:n.type)?this._router.navigate([`episodes/ccm/careplan/${null===(i=this.episodeDetails)||void 0===i?void 0:i.patientId}/${null===(s=this.episodeDetails)||void 0===s?void 0:s.id}/${null===(a=this.episodeDetails)||void 0===a?void 0:a.blueprintId}`]):this._router.navigate(["careplanassignments/patient/"+(null===(o=this.episodeDetails)||void 0===o?void 0:o.patientId)+"/actionitems"],{queryParams:{careplanId:null===(l=this.careplan)||void 0===l?void 0:l.id}})}editCarePlan(){var e,t,n,i;this._episodesEventLogger.episodeCareplanActionEvent(null===(e=this.episodeDetails)||void 0===e?void 0:e.id,null===(t=this.episodeDetails)||void 0===t?void 0:t.patientId,"episode_edit_careplan"),this._router.navigate(["course/edit-assigned-careplan/"+(null===(n=this.careplan)||void 0===n?void 0:n.id)],{queryParams:{episodeStartDate:this.careplan.startDate,episodeEndDate:null===(i=this.episodeDetails)||void 0===i?void 0:i.endDate}})}viewCareplanTemplates(e){var t,n,i,s;this._episodesEventLogger.episodeCareplanActionEvent(null===(t=this.episodeDetails)||void 0===t?void 0:t.id,null===(n=this.episodeDetails)||void 0===n?void 0:n.patientId,"episode_choose_careplan"),this._modalService.create({nzTitle:this.translatedStrings.get("CAREPLAN.CHOOSE_CAREPLAN_TEMPLATE"),nzContent:fs.a,nzComponentParams:{tenantId:null===(i=this.episodeDetails)||void 0===i?void 0:i.tenantId,patientId:null===(s=this.episodeDetails)||void 0===s?void 0:s.patientId,episodeDetails:this.episodeDetails,mode:e},nzFooter:null}).afterClose.subscribe(t=>{t&&"auto-assign"==e&&(this._notificationsService.info(this.translatedStrings.get("COMMON.CAREPLAN"),this.translatedStrings.get("CAREPLAN.ACTIVE_ON_CONSENT")),this.refreshEpisodeDetails())})}refreshEpisodeDetails(){this.refresh.emit()}}return e.\u0275fac=function(t){return new(t||e)(m.Rb(C.g),m.Rb(We.f),m.Rb(G.a),m.Rb(D.b),m.Rb(ye.a),m.Rb(H.a))},e.\u0275cmp=m.Lb({type:e,selectors:[["app-careplan"]],inputs:{episodeDetails:"episodeDetails"},outputs:{refresh:"refresh"},decls:2,vars:1,consts:[[4,"ngIf"],["nz-row",""],["nz-col","","nzXs","24","nzSm","20","nzMd","18"],["nz-typography",""],["nz-typography","","nz-tooltip","",3,"nzTooltipTitle",4,"ngIf"],["nz-col","","nzXs","24","nzSm","24","nzMd","6","id","actions"],["nz-button","","nzSize","large",3,"isCarePlanEntityEnabled","episodeDetails","click"],["nz-button","","nzType","primary","nzSize","large",3,"isCarePlanEntityEnabled","episodeDetails","click",4,"ngIf"],[3,"isCarePlanEntityEnabled","episodeDetails",4,"ngIf"],["nz-typography","","nz-tooltip","",3,"nzTooltipTitle"],[3,"isCarePlanEntityEnabled","episodeDetails"],["nz-button","","nzType","primary","nzSize","large",3,"isCarePlanEntityEnabled","episodeDetails","click"],["nz-button","","nzType","primary","nzSize","large","nz-dropdown","","nzPlacement","bottomRight","id","more",3,"nzDropdownMenu"],["color","white","name","moreFilled","size","16px"],["menu","nzDropdownMenu"],["nz-menu",""],["nz-menu-item","",3,"click"]],template:function(e,t){1&e&&(m.Vc(0,Ms,16,14,"nz-card",0),m.Sb(1,"br")),2&e&&m.rc("ngIf",t.episodeDetails)},directives:[s.q,I.a,O.c,O.a,T.a,mt.a,Ct.a,A.a,vs,je.d,S.d,S.b,oe.a,S.e,E.c,E.e],pipes:[Q.a],styles:[".ant-card[_ngcontent-%COMP%]{padding:10px}h3[_ngcontent-%COMP%]{margin-bottom:0}button[_ngcontent-%COMP%]{margin-top:25px}label[_ngcontent-%COMP%]{font:normal normal normal 13px/16px Nunito;color:var(--tertiary-color);margin-bottom:5px;display:block}#actions[_ngcontent-%COMP%]{text-align:right}#more[_ngcontent-%COMP%]{font-size:14px;margin-left:10px}app-icons[_ngcontent-%COMP%]{vertical-align:sub}"]}),e})();var As=n("OTIt"),Ps=n("c/Vb");function Ws(e,t){1&e&&(m.Vb(0),m.Xc(1," 0 "),m.Ub())}function Rs(e,t){if(1&e&&(m.Vb(0),m.Xc(1),m.Ub()),2&e){const e=m.ic();m.Db(1),m.Zc(" ",20-(null==e.episodeDetails?null:e.episodeDetails.patientComplianceCount[99484])," ")}}function ws(e,t){1&e&&(m.Xb(0,"label"),m.Xc(1," No call activity yet "),m.Wb())}const Ls=function(e){return{"shaded-row":e}};function xs(e,t){if(1&e){const e=m.Yb();m.Xb(0,"tr",10),m.Xb(1,"td"),m.Xc(2),m.jc(3,"date"),m.Wb(),m.Xb(4,"td"),m.Xc(5),m.Wb(),m.Xb(6,"td"),m.Xc(7),m.Wb(),m.Xb(8,"td",11),m.Xc(9),m.Wb(),m.Xb(10,"td"),m.Xc(11),m.Wb(),m.Xb(12,"td"),m.Xb(13,"app-icons",12),m.ec("click",function(){m.Lc(e);const n=t.$implicit,i=m.ic(2);return i.showLogDetails(n,null==i.episodeDetails?null:i.episodeDetails.monitoringStaff[null==n?null:n.staffId])}),m.Wb(),m.Xc(14," \xa0 "),m.Xb(15,"app-icons",13),m.ec("click",function(){m.Lc(e);const n=t.$implicit;return m.ic(2).showCMTModal(n)}),m.Wb(),m.Xc(16," \xa0 "),m.Xb(17,"a",14),m.ec("nzOnConfirm",function(){m.Lc(e);const n=t.$implicit;return m.ic(2).delete(null==n?null:n.id)}),m.Sb(18,"app-icons",15),m.Wb(),m.Wb(),m.Wb()}if(2&e){const e=t.$implicit,n=t.index,i=m.ic(2);m.rc("ngClass",m.yc(10,Ls,n%2!=0)),m.Db(2),m.Yc(m.lc(3,7,null==e?null:e.startTime,"MMM dd yyyy hh:mm")),m.Db(3),m.Yc(((null==e?null:e.endTime)-(null==e?null:e.startTime))/6e4),m.Db(2),m.Yc(i.mode.get(null==e?null:e.mode)),m.Db(1),m.rc("nzTooltipTitle",null==e?null:e.notes),m.Db(1),m.Yc(null==e?null:e.activity),m.Db(2),m.Yc(null==i.episodeDetails?null:i.episodeDetails.monitoringStaff[null==e?null:e.staffId])}}const ks=function(){return{x:"1175px"}};function Vs(e,t){if(1&e&&(m.Vb(0),m.Sb(1,"br"),m.Xb(2,"nz-table",7,8),m.Xb(4,"thead"),m.Xb(5,"tr"),m.Xb(6,"th"),m.Xc(7),m.jc(8,"translate"),m.Wb(),m.Xb(9,"th"),m.Xc(10),m.jc(11,"translate"),m.Wb(),m.Xb(12,"th"),m.Xc(13),m.jc(14,"translate"),m.Wb(),m.Xb(15,"th"),m.Xc(16),m.jc(17,"translate"),m.Wb(),m.Xb(18,"th"),m.Xc(19),m.jc(20,"translate"),m.Wb(),m.Sb(21,"th"),m.Wb(),m.Wb(),m.Xb(22,"tbody"),m.Vc(23,xs,19,12,"tr",9),m.Wb(),m.Wb(),m.Ub()),2&e){const e=m.Ic(3),t=m.ic();m.Db(2),m.rc("nzData",null==t.episodeDetails?null:t.episodeDetails.patientCommunications[99484])("nzScroll",m.xc(18,ks)),m.Db(5),m.Yc(m.kc(8,8,"COMMON.DATE_TIME")),m.Db(3),m.Zc("",m.kc(11,10,"COMMON.DURATION")," (mins)"),m.Db(3),m.Yc(m.kc(14,12,"TMS.COMMUNICATION_MODE")),m.Db(3),m.Yc(m.kc(17,14,"HEADER.ACTIVITY")),m.Db(3),m.Yc(m.kc(20,16,"PATIENT.MONITORING_STAFF")),m.Db(4),m.rc("ngForOf",e.data)}}let Us=(()=>{class e{constructor(e,t,n,i,s){this._dateComparePipe=e,this._notificationsService=t,this._patientCommunicationModalService=n,this._episodesEventLogger=i,this._episodesService=s,this.mode=new Map([["VIDEO_CALL","Video Call"],["CALL","Audio Call"],["HOME_VISIT","Home Visit"],["CLINIC_VISIT","In Clinic"],["OTHER","Other"]]),this.refreshEpisode=new m.n}validate(){var e,t;return!this._dateComparePipe.transform(this.episodeDetails.endDate)||"IN_PROGRESS"!==this.episodeDetails.status&&"SCHEDULED"!==this.episodeDetails.status?(this._notificationsService.error("Episode Suspended","This episode has been suspended and no further activities can be assigned."),!1):!!(null===(t=null===(e=this.episodeDetails)||void 0===e?void 0:e.availableConsents)||void 0===t?void 0:t.length)}showCMTModal(e){var t,n;this.validate()&&(this._episodesEventLogger.episodeCMTActionEvent(this.episodeDetails.id,this.episodeDetails.patientId,"episode_add_cmt"),this._patientCommunicationModalService.createCMTModal("",null===(t=this.episodeDetails)||void 0===t?void 0:t.patientId,null===(n=this.episodeDetails)||void 0===n?void 0:n.id,Ps.a.CARE_MANAGEMENT_TIME,void 0,void 0,this.episodeDetails.endDate,void 0,void 0,e).afterClose.subscribe(e=>{e&&this.refreshEpisodeState()}))}showLogDetails(e,t){this._patientCommunicationModalService.createLogDetailsModal(e,t)}delete(e){this.validate()&&this._episodesService.archivePatientCommunication(e).subscribe(()=>{this._notificationsService.success("Patient Communication","Note deleted successfully!"),this.refreshEpisodeState()})}refreshEpisodeState(){this.refreshEpisode.emit(!0)}}return e.\u0275fac=function(t){return new(t||e)(m.Rb(Pi.a),m.Rb(D.b),m.Rb(As.a),m.Rb(ye.a),m.Rb(Ut.a))},e.\u0275cmp=m.Lb({type:e,selectors:[["app-care-management-time"]],inputs:{episodeDetails:"episodeDetails"},outputs:{refreshEpisode:"refreshEpisode"},features:[m.Cb([Pi.a])],decls:17,vars:14,consts:[["nz-row",""],["nz-col","","nzXs","24","nzSm","18","nzMd","21"],["nz-typography",""],["nz-typography","",3,"nzType"],[4,"ngIf"],["nz-col","","nzXs","24","nzSm","6","nzMd","3","id","actions"],["nz-button","","nzType","primary","nzSize","large",3,"disabled","click"],["nzShowPagination","false","nzSize","small","nzBordered","false",3,"nzData","nzScroll"],["cmtTable",""],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],["nz-tooltip","",3,"nzTooltipTitle"],["size","16px","name","view","nz-tooltip","","nzTooltipTitle","View",3,"click"],["size","16px","name","profileEdit","nz-tooltip","","nzTooltipTitle","Edit",3,"click"],["nz-popconfirm","","nzPopconfirmTitle","Are you sure you want to delete this record ?","nzPopconfirmPlacement","bottom",3,"nzOnConfirm"],["name","delete","size","16px","color","#c81c1c"]],template:function(e,t){1&e&&(m.Xb(0,"nz-card"),m.Xb(1,"div",0),m.Xb(2,"div",1),m.Xb(3,"h3",2),m.Xb(4,"span",3),m.Vc(5,Ws,2,0,"ng-container",4),m.Vc(6,Rs,2,1,"ng-container",4),m.Wb(),m.Xc(7),m.jc(8,"translate"),m.Wb(),m.Vc(9,ws,2,0,"label",4),m.Wb(),m.Xb(10,"div",5),m.Xb(11,"button",6),m.ec("click",function(){return t.showCMTModal()}),m.jc(12,"validConsent"),m.Xc(13),m.jc(14,"translate"),m.Wb(),m.Wb(),m.Wb(),m.Vc(15,Vs,24,19,"ng-container",4),m.Wb(),m.Sb(16,"br")),2&e&&(m.Db(4),m.rc("nzType",0===(null==t.episodeDetails?null:t.episodeDetails.patientComplianceCount[99484])?"-":"success"),m.Db(1),m.rc("ngIf",20<=(null==t.episodeDetails?null:t.episodeDetails.patientComplianceCount[99484])),m.Db(1),m.rc("ngIf",20>(null==t.episodeDetails?null:t.episodeDetails.patientComplianceCount[99484])),m.Db(1),m.Zc(" ",m.kc(8,8,"CMT.MINUTES_REMAINING")," "),m.Db(2),m.rc("ngIf",!(null!=t.episodeDetails&&t.episodeDetails.patientCommunications&&null!=t.episodeDetails&&null!=t.episodeDetails.patientCommunications[99484]&&t.episodeDetails.patientCommunications[99484].length)),m.Db(2),m.rc("disabled",!m.kc(12,10,t.episodeDetails)),m.Db(2),m.Zc(" ",m.kc(14,12,"CMT.ADD")," "),m.Db(2),m.rc("ngIf",(null==t.episodeDetails?null:t.episodeDetails.patientCommunications)&&(null==t.episodeDetails||null==t.episodeDetails.patientCommunications[99484]?null:t.episodeDetails.patientCommunications[99484].length)))},directives:[I.a,O.c,O.a,T.a,s.q,mt.a,Ct.a,A.a,ts.f,ts.n,ts.o,ts.e,ts.l,ts.i,s.p,s.o,je.d,oe.a,wi.a],pipes:[Q.a,$i,s.e],styles:[".ant-card[_ngcontent-%COMP%]{padding:10px}h3[_ngcontent-%COMP%]{margin-bottom:0}label[_ngcontent-%COMP%]{font:normal normal normal 13px/16px Nunito;color:var(--tertiary-color);margin-bottom:5px;display:block}#actions[_ngcontent-%COMP%]{text-align:right}[_nghost-%COMP%]     .ant-table-thead>tr>th{height:50px!important}[_nghost-%COMP%]     .ant-table-tbody>tr>td{border-bottom:none}.shaded-row[_ngcontent-%COMP%]{background-color:var(--light-grey)}"]}),e})();function Fs(e,t){1&e&&(m.Vb(0),m.Xc(1," 0 "),m.Ub())}function js(e,t){if(1&e&&(m.Vb(0),m.Xc(1),m.Ub()),2&e){const e=m.ic(2);m.Db(1),m.Zc(" ",e.serviceCodeTotal.get(e.cptCode)-(null==e.episodeDetails?null:e.episodeDetails.patientComplianceCount[e.serviceCodes.get(e.cptCode)])," ")}}function Ys(e,t){if(1&e&&(m.Xb(0,"span",4),m.Vc(1,Fs,2,0,"ng-container",5),m.Vc(2,js,2,1,"ng-container",5),m.Wb()),2&e){const e=m.ic();m.rc("nzType",0===(null==e.episodeDetails?null:e.episodeDetails.patientComplianceCount[e.serviceCodes.get(e.cptCode)])?"-":"success"),m.Db(1),m.rc("ngIf",20<=(null==e.episodeDetails?null:e.episodeDetails.patientComplianceCount[e.serviceCodes.get(e.cptCode)])),m.Db(1),m.rc("ngIf",20>(null==e.episodeDetails?null:e.episodeDetails.patientComplianceCount[e.serviceCodes.get(e.cptCode)]))}}function Gs(e,t){1&e&&(m.Xb(0,"label"),m.Xc(1," No call activity yet "),m.Wb())}function Bs(e,t){1&e&&(m.Vb(0),m.Xc(1),m.jc(2,"translate"),m.Ub()),2&e&&(m.Db(1),m.Yc(m.kc(2,1,"TMS.ADD")))}function Hs(e,t){1&e&&(m.Vb(0),m.Xc(1),m.jc(2,"translate"),m.Ub()),2&e&&(m.Db(1),m.Yc(m.kc(2,1,"ADDITIONAL_TMS.ADD")))}function $s(e,t){1&e&&(m.Vb(0),m.Xc(1),m.jc(2,"translate"),m.Ub()),2&e&&(m.Db(1),m.Yc(m.kc(2,1,"ADDITIONAL_TMS.ADD_B")))}const Zs=function(e){return{"shaded-row":e}};function qs(e,t){if(1&e){const e=m.Yb();m.Xb(0,"tr",11),m.Xb(1,"td"),m.Xc(2),m.jc(3,"date"),m.Wb(),m.Xb(4,"td"),m.Xc(5),m.Wb(),m.Xb(6,"td"),m.Xc(7),m.Wb(),m.Xb(8,"td",12),m.Xc(9),m.Wb(),m.Xb(10,"td"),m.Xc(11),m.Wb(),m.Xb(12,"td"),m.Xb(13,"app-icons",13),m.ec("click",function(){m.Lc(e);const n=t.$implicit,i=m.ic(2);return i.showLogDetails(n,null==i.episodeDetails?null:i.episodeDetails.monitoringStaff[null==n?null:n.staffId])}),m.Wb(),m.Xc(14," \xa0 "),m.Xb(15,"app-icons",14),m.ec("click",function(){m.Lc(e);const n=t.$implicit;return m.ic(2).showTMSModal(n)}),m.Wb(),m.Xc(16," \xa0 "),m.Xb(17,"a",15),m.ec("nzOnConfirm",function(){m.Lc(e);const n=t.$implicit;return m.ic(2).delete(null==n?null:n.id)}),m.Sb(18,"app-icons",16),m.Wb(),m.Wb(),m.Wb()}if(2&e){const e=t.$implicit,n=t.index,i=m.ic(2);m.rc("ngClass",m.yc(10,Zs,n%2!=0)),m.Db(2),m.Yc(m.lc(3,7,null==e?null:e.startTime,"MMM dd yyyy hh:mm")),m.Db(3),m.Yc(((null==e?null:e.endTime)-(null==e?null:e.startTime))/6e4),m.Db(2),m.Yc(i.mode.get(null==e?null:e.mode)),m.Db(1),m.rc("nzTooltipTitle",null==e?null:e.notes),m.Db(1),m.Yc(null==e?null:e.activity),m.Db(2),m.Yc(null==i.episodeDetails?null:i.episodeDetails.monitoringStaff[null==e?null:e.staffId])}}const Ks=function(){return{x:"1175px"}};function Qs(e,t){if(1&e&&(m.Vb(0),m.Sb(1,"br"),m.Xb(2,"nz-table",8,9),m.Xb(4,"thead"),m.Xb(5,"tr"),m.Xb(6,"th"),m.Xc(7),m.jc(8,"translate"),m.Wb(),m.Xb(9,"th"),m.Xc(10),m.jc(11,"translate"),m.Wb(),m.Xb(12,"th"),m.Xc(13),m.jc(14,"translate"),m.Wb(),m.Xb(15,"th"),m.Xc(16),m.jc(17,"translate"),m.Wb(),m.Xb(18,"th"),m.Xc(19),m.jc(20,"translate"),m.Wb(),m.Sb(21,"th"),m.Wb(),m.Wb(),m.Xb(22,"tbody"),m.Vc(23,qs,19,12,"tr",10),m.Wb(),m.Wb(),m.Ub()),2&e){const e=m.Ic(3),t=m.ic();m.Db(2),m.rc("nzData",null==t.episodeDetails?null:t.episodeDetails.patientCommunications[t.cpt])("nzScroll",m.xc(18,Ks)),m.Db(5),m.Yc(m.kc(8,8,"COMMON.DATE_TIME")),m.Db(3),m.Zc("",m.kc(11,10,"COMMON.DURATION")," (mins)"),m.Db(3),m.Yc(m.kc(14,12,"TMS.COMMUNICATION_MODE")),m.Db(3),m.Yc(m.kc(17,14,"HEADER.ACTIVITY")),m.Db(3),m.Yc(m.kc(20,16,"PATIENT.MONITORING_STAFF")),m.Db(4),m.rc("ngForOf",e.data)}}let Js=(()=>{class e{constructor(e,t,n,i,s){this._dateComparePipe=e,this._notificationsService=t,this._patientCommunicationModalService=n,this._episodesEventLogger=i,this._episodesService=s,this.tmsType="TMS",this.mode=new Map([["VIDEO_CALL","Video Call"],["CALL","Audio Call"],["HOME_VISIT","Home Visit"],["CLINIC_VISIT","In Clinic"],["OTHER","Other"]]),this.serviceCodes=new Map([["TREATMENT_MANAGEMENT_SERVICE","99457"],["ADDITIONAL_TREATMENT_MANAGEMENT_SERVICE","99458"],["ADDITIONAL_TREATMENT_MANAGEMENT_SERVICE_B","99458B"]]),this.serviceCodeTotal=new Map([["TREATMENT_MANAGEMENT_SERVICE",20],["ADDITIONAL_TREATMENT_MANAGEMENT_SERVICE",20],["ADDITIONAL_TREATMENT_MANAGEMENT_SERVICE_B",20]]),this.refreshEpisode=new m.n}set cptCodeSetter(e){this.cptCode=e,Ps.a.TREATMENT_MANAGEMENT_SERVICE===e?this.cpt="99457":Ps.a.ADDITIONAL_TREATMENT_MANAGEMENT_SERVICE===e?this.cpt="99458":Ps.a.ADDITIONAL_TREATMENT_MANAGEMENT_SERVICE_B===e&&(this.cpt="99458B"),this.checkIfTMSAdditionPossible()}ngOnChanges(e){this.checkIfTMSAdditionPossible()}checkIfTMSAdditionPossible(){var e,t,n,i,s,a;let o=!1;o=!!(null===(t=null===(e=this.episodeDetails)||void 0===e?void 0:e.activeCarePlans)||void 0===t?void 0:t.length),(null===(i=null===(n=this.episodeDetails)||void 0===n?void 0:n.activeCarePlans)||void 0===i?void 0:i.length)&&"99458B"===this.cpt&&(o=!0),Ps.a.TREATMENT_MANAGEMENT_SERVICE===this.cptCode?this.canAddTMS=o:Ps.a.ADDITIONAL_TREATMENT_MANAGEMENT_SERVICE===this.cptCode?(null===(s=this.episodeDetails)||void 0===s?void 0:s.patientComplianceCount[99457])>=20&&o&&(this.canAddTMS=!0):Ps.a.ADDITIONAL_TREATMENT_MANAGEMENT_SERVICE_B===this.cptCode&&(null===(a=this.episodeDetails)||void 0===a?void 0:a.patientComplianceCount[99458])>=20&&o&&(this.canAddTMS=!0)}validate(){var e,t;return this._dateComparePipe.transform(this.episodeDetails.endDate)&&"IN_PROGRESS"===this.episodeDetails.status?!!(null===(t=null===(e=this.episodeDetails)||void 0===e?void 0:e.availableConsents)||void 0===t?void 0:t.length):(this._notificationsService.error("Episode Suspended","This episode has been suspended and no further activities can be assigned."),!1)}showTMSModal(e){var t,n,i,s;if(!this.validate())return;this._episodesEventLogger.episodeTMSActionEvent(this.episodeDetails.id,this.episodeDetails.patientId,"episode_add_tms");const a=null===(t=this.episodeDetails)||void 0===t?void 0:t.activeCarePlans[(null===(i=null===(n=this.episodeDetails)||void 0===n?void 0:n.activeCarePlans)||void 0===i?void 0:i.length)-1];switch(this.cptCode){case Ps.a.TREATMENT_MANAGEMENT_SERVICE:this.tmsType="TMS",this.episodeTMSProgress=this.episodeDetails.episodeProgress;break;case Ps.a.ADDITIONAL_TREATMENT_MANAGEMENT_SERVICE:this.tmsType="ADDITIONAL_TMS",this.episodeTMSProgress=this.episodeDetails.episodeAdditionalTmsProgress;break;case Ps.a.ADDITIONAL_TREATMENT_MANAGEMENT_SERVICE_B:this.tmsType="ADDITIONAL_TMS_B",this.episodeTMSProgress=this.episodeDetails.episodeAdditionalTmsProgress}this._patientCommunicationModalService.createTMSModal(this.patient,null===(s=this.episodeDetails)||void 0===s?void 0:s.id,this.tmsType,this.cptCode,new Date(null==a?void 0:a.startDate),void 0,void 0,void 0,"OTHER",e).afterClose.subscribe(e=>{e&&this.refreshEpisodeState()})}showLogDetails(e,t){this._patientCommunicationModalService.createLogDetailsModal(e,t)}delete(e){this.validate()&&this._episodesService.archivePatientCommunication(e).subscribe(()=>{this._notificationsService.success("Patient Communication","Note deleted successfully!"),this.refreshEpisodeState()})}refreshEpisodeState(){this.refreshEpisode.emit(!0)}}return e.\u0275fac=function(t){return new(t||e)(m.Rb(Pi.a),m.Rb(D.b),m.Rb(As.a),m.Rb(ye.a),m.Rb(Ut.a))},e.\u0275cmp=m.Lb({type:e,selectors:[["app-treatment-management-service"]],inputs:{episodeDetails:"episodeDetails",patient:"patient",cptCodeSetter:["cptCode","cptCodeSetter"]},outputs:{refreshEpisode:"refreshEpisode"},features:[m.Cb([Pi.a]),m.Bb],decls:19,vars:14,consts:[["nz-row",""],["nz-col","","nzXs","24","nzSm","24","nzMd","21"],["nz-typography",""],["nz-typography","",3,"nzType",4,"ngIf"],["nz-typography","",3,"nzType"],[4,"ngIf"],["nz-col","","nzXs","24","nzSm","24","nzMd","3","id","actions"],["nz-button","","nzType","primary","nzSize","large",3,"disabled","click"],["nzShowPagination","false","nzSize","small","nzBordered","false",3,"nzData","nzScroll"],["tmsTable",""],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],["nz-tooltip","",3,"nzTooltipTitle"],["size","16px","name","view","nz-tooltip","","nzTooltipTitle","View",3,"click"],["size","16px","name","profileEdit","nz-tooltip","","nzTooltipTitle","Edit",3,"click"],["nz-popconfirm","","nzPopconfirmTitle","Are you sure you want to delete this record ?","nzPopconfirmPlacement","bottom",3,"nzOnConfirm"],["name","delete","size","16px","color","#c81c1c"]],template:function(e,t){1&e&&(m.Xb(0,"nz-card"),m.Xb(1,"div",0),m.Xb(2,"div",1),m.Xb(3,"h3",2),m.Vc(4,Ys,3,3,"span",3),m.Xb(5,"span",4),m.Xc(6),m.Wb(),m.Vb(7),m.Xc(8),m.jc(9,"translate"),m.Ub(),m.Wb(),m.Vc(10,Gs,2,0,"label",5),m.Wb(),m.Xb(11,"div",6),m.Xb(12,"button",7),m.ec("click",function(){return t.showTMSModal()}),m.jc(13,"validConsent"),m.Vc(14,Bs,3,3,"ng-container",5),m.Vc(15,Hs,3,3,"ng-container",5),m.Vc(16,$s,3,3,"ng-container",5),m.Wb(),m.Wb(),m.Wb(),m.Vc(17,Qs,24,19,"ng-container",5),m.Wb(),m.Sb(18,"br")),2&e&&(m.Db(4),m.rc("ngIf",!1),m.Db(1),m.rc("nzType",0===(null==t.episodeDetails?null:t.episodeDetails.patientComplianceCount[t.serviceCodes.get(t.cptCode)])?"-":"success"),m.Db(1),m.Zc(" ",null==t.episodeDetails?null:t.episodeDetails.patientComplianceCount[t.serviceCodes.get(t.cptCode)]," "),m.Db(2),m.Zc(" ",m.kc(9,10,t.cptCode)," "),m.Db(2),m.rc("ngIf",!(null!=t.episodeDetails&&t.episodeDetails.patientCommunications&&null!=t.episodeDetails&&null!=t.episodeDetails.patientCommunications[t.cpt]&&t.episodeDetails.patientCommunications[t.cpt].length)),m.Db(2),m.rc("disabled",!m.kc(13,12,t.episodeDetails)||!t.canAddTMS),m.Db(2),m.rc("ngIf","99457"===t.cpt),m.Db(1),m.rc("ngIf","99458"===t.cpt),m.Db(1),m.rc("ngIf","99458B"===t.cpt),m.Db(1),m.rc("ngIf",(null==t.episodeDetails?null:t.episodeDetails.patientCommunications)&&(null==t.episodeDetails||null==t.episodeDetails.patientCommunications[t.cpt]?null:t.episodeDetails.patientCommunications[t.cpt].length)))},directives:[I.a,O.c,O.a,T.a,s.q,mt.a,Ct.a,A.a,ts.f,ts.n,ts.o,ts.e,ts.l,ts.i,s.p,s.o,je.d,oe.a,wi.a],pipes:[Q.a,$i,s.e],styles:[".ant-card[_ngcontent-%COMP%]{padding:10px}h3[_ngcontent-%COMP%]{margin-bottom:0}label[_ngcontent-%COMP%]{font:normal normal normal 13px/16px Nunito;color:var(--tertiary-color);margin-bottom:5px;display:block}#actions[_ngcontent-%COMP%]{text-align:right}[_nghost-%COMP%]     .ant-table-thead>tr>th{height:50px!important}[_nghost-%COMP%]     .ant-table-tbody>tr>td{border-bottom:none}.shaded-row[_ngcontent-%COMP%]{background-color:var(--light-grey)}"]}),e})();function ea(e,t){1&e&&(m.Xb(0,"label"),m.Xc(1," No call activity yet "),m.Wb())}const ta=function(e){return{"shaded-row":e}};function na(e,t){if(1&e){const e=m.Yb();m.Xb(0,"tr",9),m.Xb(1,"td"),m.Xc(2),m.jc(3,"date"),m.Wb(),m.Xb(4,"td"),m.Xc(5),m.Wb(),m.Xb(6,"td"),m.Xc(7),m.Wb(),m.Xb(8,"td",10),m.Xc(9),m.Wb(),m.Xb(10,"td"),m.Xc(11),m.Wb(),m.Xb(12,"td"),m.Xb(13,"app-icons",11),m.ec("click",function(){m.Lc(e);const n=t.$implicit,i=m.ic(2);return i.showLogDetails(n,null==i.episodeDetails?null:i.episodeDetails.monitoringStaff[null==n?null:n.staffId])}),m.Wb(),m.Xc(14," \xa0 "),m.Xb(15,"app-icons",12),m.ec("click",function(){m.Lc(e);const n=t.$implicit;return m.ic(2).showCMTModal(n)}),m.Wb(),m.Wb(),m.Wb()}if(2&e){const e=t.$implicit,n=t.index,i=m.ic(2);m.rc("ngClass",m.yc(10,ta,n%2!=0)),m.Db(2),m.Yc(m.lc(3,7,null==e?null:e.startTime,"MMM dd yyyy hh:mm")),m.Db(3),m.Yc(((null==e?null:e.endTime)-(null==e?null:e.startTime))/6e4),m.Db(2),m.Yc(i.mode.get(null==e?null:e.mode)),m.Db(1),m.rc("nzTooltipTitle",null==e?null:e.notes),m.Db(1),m.Yc(null==e?null:e.activity),m.Db(2),m.Yc(null==i.episodeDetails?null:i.episodeDetails.monitoringStaff[null==e?null:e.staffId])}}const ia=function(){return{x:"1175px"}};function sa(e,t){if(1&e&&(m.Vb(0),m.Sb(1,"br"),m.Xb(2,"nz-table",6,7),m.Xb(4,"thead"),m.Xb(5,"tr"),m.Xb(6,"th"),m.Xc(7),m.jc(8,"translate"),m.Wb(),m.Xb(9,"th"),m.Xc(10),m.jc(11,"translate"),m.Wb(),m.Xb(12,"th"),m.Xc(13),m.jc(14,"translate"),m.Wb(),m.Xb(15,"th"),m.Xc(16),m.jc(17,"translate"),m.Wb(),m.Xb(18,"th"),m.Xc(19),m.jc(20,"translate"),m.Wb(),m.Sb(21,"th"),m.Wb(),m.Wb(),m.Xb(22,"tbody"),m.Vc(23,na,16,12,"tr",8),m.Wb(),m.Wb(),m.Ub()),2&e){const e=m.Ic(3),t=m.ic();m.Db(2),m.rc("nzData",null==t.episodeDetails?null:t.episodeDetails.patientCommunications[99484])("nzScroll",m.xc(18,ia)),m.Db(5),m.Yc(m.kc(8,8,"COMMON.DATE_TIME")),m.Db(3),m.Zc("",m.kc(11,10,"COMMON.DURATION")," (mins)"),m.Db(3),m.Yc(m.kc(14,12,"TMS.COMMUNICATION_MODE")),m.Db(3),m.Yc(m.kc(17,14,"HEADER.ACTIVITY")),m.Db(3),m.Yc(m.kc(20,16,"PATIENT.MONITORING_STAFF")),m.Db(4),m.rc("ngForOf",e.data)}}let aa=(()=>{class e{constructor(e,t,n,i){this._dateComparePipe=e,this._notificationsService=t,this._patientCommunicationModalService=n,this._episodesEventLogger=i,this.mode=new Map([["VIDEO_CALL","Video Call"],["CALL","Audio Call"],["HOME_VISIT","Home Visit"],["CLINIC_VISIT","In Clinic"],["OTHER","Other"]]),this.refreshEpisode=new m.n}set cptCodeSetter(e){this.cptCode=e}validate(){return!(!this._dateComparePipe.transform(this.episodeDetails.endDate)||"IN_PROGRESS"!==this.episodeDetails.status&&"SCHEDULED"!==this.episodeDetails.status)||(this._notificationsService.error("Episode Suspended","This episode has been suspended and no further activities can be assigned."),!1)}showCMTModal(e){var t,n;if(!this.validate())return;this._episodesEventLogger.episodeCMTActionEvent(this.episodeDetails.id,this.episodeDetails.patientId,"episode_add_cmt");const i={id:this.patient.id,name:null===(t=this.patient)||void 0===t?void 0:t.fullName,dxCodes:this.patient.healthInfo.dxCodes,episode:{id:null===(n=this.episodeDetails)||void 0===n?void 0:n.id}};this._patientCommunicationModalService.createTOCTMS(i,void 0,e).afterClose.subscribe(e=>{e&&this.refreshEpisodeState()})}showLogDetails(e,t){this._patientCommunicationModalService.createLogDetailsModal(e,t)}refreshEpisodeState(){this.refreshEpisode.emit(!0)}}return e.\u0275fac=function(t){return new(t||e)(m.Rb(Pi.a),m.Rb(D.b),m.Rb(As.a),m.Rb(ye.a))},e.\u0275cmp=m.Lb({type:e,selectors:[["app-toc-care-management-time"]],inputs:{patient:"patient",episodeDetails:"episodeDetails",cptCodeSetter:["cptCode","cptCodeSetter"]},outputs:{refreshEpisode:"refreshEpisode"},features:[m.Cb([Pi.a])],decls:13,vars:9,consts:[["nz-row",""],["nz-col","","nzXs","24","nzSm","18","nzMd","21"],["nz-typography",""],[4,"ngIf"],["nz-col","","nzXs","24","nzSm","6","nzMd","3","id","actions"],["nz-button","","nzType","primary","nzSize","large",3,"disabled","click"],["nzShowPagination","false","nzSize","small","nzBordered","false",3,"nzData","nzScroll"],["cmtTable",""],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],["nz-tooltip","",3,"nzTooltipTitle"],["size","16px","name","view","nz-tooltip","","nzTooltipTitle","View",3,"click"],["size","16px","name","profileEdit","nz-tooltip","","nzTooltipTitle","Edit",3,"click"]],template:function(e,t){1&e&&(m.Xb(0,"nz-card"),m.Xb(1,"div",0),m.Xb(2,"div",1),m.Xb(3,"h3",2),m.Xc(4),m.Wb(),m.Vc(5,ea,2,0,"label",3),m.Wb(),m.Xb(6,"div",4),m.Xb(7,"button",5),m.ec("click",function(){return t.showCMTModal()}),m.jc(8,"validConsent"),m.Xc(9),m.jc(10,"translate"),m.Wb(),m.Wb(),m.Wb(),m.Vc(11,sa,24,19,"ng-container",3),m.Wb(),m.Sb(12,"br")),2&e&&(m.Db(4),m.Zc(" ",null==t.episodeDetails?null:t.episodeDetails.patientComplianceCount[99484]," CMT minutes completed "),m.Db(1),m.rc("ngIf",!(null!=t.episodeDetails&&t.episodeDetails.patientCommunications&&null!=t.episodeDetails&&null!=t.episodeDetails.patientCommunications[99484]&&t.episodeDetails.patientCommunications[99484].length)),m.Db(2),m.rc("disabled",!m.kc(8,5,t.episodeDetails)),m.Db(2),m.Zc(" ",m.kc(10,7,"CMT.ADD")," "),m.Db(2),m.rc("ngIf",(null==t.episodeDetails?null:t.episodeDetails.patientCommunications)&&(null==t.episodeDetails||null==t.episodeDetails.patientCommunications[99484]?null:t.episodeDetails.patientCommunications[99484].length)))},directives:[I.a,O.c,O.a,T.a,s.q,mt.a,Ct.a,A.a,ts.f,ts.n,ts.o,ts.e,ts.l,ts.i,s.p,s.o,je.d,oe.a],pipes:[$i,Q.a,s.e],styles:[".ant-card[_ngcontent-%COMP%]{padding:10px}h3[_ngcontent-%COMP%]{margin-bottom:0}label[_ngcontent-%COMP%]{font:normal normal normal 13px/16px Nunito;color:var(--tertiary-color);margin-bottom:5px;display:block}#actions[_ngcontent-%COMP%]{text-align:right}[_nghost-%COMP%]     .ant-table-thead>tr>th{height:50px!important}[_nghost-%COMP%]     .ant-table-tbody>tr>td{border-bottom:none}.shaded-row[_ngcontent-%COMP%]{background-color:var(--light-grey)}"]}),e})();var oa=n("l6l4");function la(e,t){1&e&&(m.Vb(0),m.Xc(1," 0 "),m.Ub())}function ra(e,t){if(1&e&&(m.Vb(0),m.Xc(1),m.Ub()),2&e){const e=m.ic(2);m.Db(1),m.Zc(" ",e.serviceCodeTotal.get(e.cptCode)-(null==e.episodeDetails?null:e.episodeDetails.patientComplianceCount[e.serviceCodes.get(e.cptCode)])," ")}}function ca(e,t){if(1&e&&(m.Xb(0,"span",4),m.Vc(1,la,2,0,"ng-container",5),m.Vc(2,ra,2,1,"ng-container",5),m.Wb()),2&e){const e=m.ic();m.rc("nzType",0===(null==e.episodeDetails?null:e.episodeDetails.patientComplianceCount[e.serviceCodes.get(e.cptCode)])?"-":"success"),m.Db(1),m.rc("ngIf",20<=(null==e.episodeDetails?null:e.episodeDetails.patientComplianceCount[e.serviceCodes.get(e.cptCode)])),m.Db(1),m.rc("ngIf",20>(null==e.episodeDetails?null:e.episodeDetails.patientComplianceCount[e.serviceCodes.get(e.cptCode)]))}}function da(e,t){1&e&&(m.Xb(0,"label"),m.Xc(1," No call activity yet "),m.Wb())}const ba=function(e){return{"shaded-row":e}};function pa(e,t){if(1&e){const e=m.Yb();m.Xb(0,"tr",12),m.Xb(1,"td"),m.Xc(2),m.jc(3,"date"),m.Wb(),m.Xb(4,"td"),m.Xc(5),m.Wb(),m.Xb(6,"td"),m.Xc(7),m.Wb(),m.Xb(8,"td",13),m.Xc(9),m.Wb(),m.Xb(10,"td"),m.Xc(11),m.Wb(),m.Xb(12,"td"),m.Xb(13,"app-icons",14),m.ec("click",function(){m.Lc(e);const n=t.$implicit,i=m.ic(2);return i.showLogDetails(n,null==i.episodeDetails?null:i.episodeDetails.monitoringStaff[null==n?null:n.staffId])}),m.Wb(),m.Xc(14," \xa0 "),m.Xb(15,"app-icons",15),m.ec("click",function(){m.Lc(e);const n=t.$implicit;return m.ic(2).showTMSModal(n)}),m.Wb(),m.Xc(16," \xa0 "),m.Xb(17,"a",16),m.ec("nzOnConfirm",function(){m.Lc(e);const n=t.$implicit;return m.ic(2).delete(null==n?null:n.id)}),m.Sb(18,"app-icons",17),m.Wb(),m.Wb(),m.Wb()}if(2&e){const e=t.$implicit,n=t.index,i=m.ic(2);m.rc("ngClass",m.yc(11,ba,n%2!=0)),m.Db(2),m.Yc(m.lc(3,8,null==e?null:e.startTime,"MMM dd yyyy hh:mm")),m.Db(3),m.Yc(((null==e?null:e.endTime)-(null==e?null:e.startTime))/6e4),m.Db(2),m.Yc(i.mode.get(null==e?null:e.mode)),m.Db(1),m.rc("nzTooltipTitle",null==e?null:e.notes)("nzEllipsisRows",2),m.Db(1),m.Zc(" ",null==e?null:e.activity," "),m.Db(2),m.Yc(null==i.episodeDetails?null:i.episodeDetails.monitoringStaff[null==e?null:e.staffId])}}const ua=function(){return{x:"1175px"}};function ha(e,t){if(1&e&&(m.Vb(0),m.Sb(1,"br"),m.Xb(2,"nz-table",9,10),m.Xb(4,"thead"),m.Xb(5,"tr"),m.Xb(6,"th"),m.Xc(7),m.jc(8,"translate"),m.Wb(),m.Xb(9,"th"),m.Xc(10),m.jc(11,"translate"),m.Wb(),m.Xb(12,"th"),m.Xc(13),m.jc(14,"translate"),m.Wb(),m.Xb(15,"th"),m.Xc(16),m.jc(17,"translate"),m.Wb(),m.Xb(18,"th"),m.Xc(19),m.jc(20,"translate"),m.Wb(),m.Sb(21,"th"),m.Wb(),m.Wb(),m.Xb(22,"tbody"),m.Vc(23,pa,19,13,"tr",11),m.Wb(),m.Wb(),m.Ub()),2&e){const e=m.Ic(3),t=m.ic();m.Db(2),m.rc("nzData",null==t.episodeDetails?null:t.episodeDetails.patientCommunications[t.serviceCodes.get(t.cptCode)])("nzScroll",m.xc(18,ua)),m.Db(5),m.Yc(m.kc(8,8,"COMMON.DATE_TIME")),m.Db(3),m.Zc("",m.kc(11,10,"COMMON.DURATION")," (mins)"),m.Db(3),m.Yc(m.kc(14,12,"TMS.COMMUNICATION_MODE")),m.Db(3),m.Yc(m.kc(17,14,"HEADER.ACTIVITY")),m.Db(3),m.Yc(m.kc(20,16,"PATIENT.MONITORING_STAFF")),m.Db(4),m.rc("ngForOf",e.data)}}let ga=(()=>{class e{constructor(e,t,n,i,s,a){this._dateComparePipe=e,this._notificationsService=t,this._patientCommunicationModalService=n,this._episodesEventLogger=i,this._analyticsService=s,this._episodesService=a,this.mode=new Map([["VIDEO_CALL","Video Call"],["CALL","Audio Call"],["INBOUND_CALL","Inbound Call"],["OUTBOUND_CALL","Outbound Call"],["HOME_VISIT","Home Visit"],["CLINIC_VISIT","In Clinic"],["OTHER","Other"]]),this.serviceCodes=new Map([["NON_COMPLEX_TMS","99490"],["NON_COMPLEX_TMS_PHYSICIAN","99491"],["NON_COMPLEX_ADDITIONAL_TMS","99439"],["NON_COMPLEX_ADDITIONAL_TMS_B","99439B"],["COMPLEX_TMS","99487"],["COMPLEX_ADDITIONAL_TMS","99489"]]),this.serviceCodeTotal=new Map([["NON_COMPLEX_TMS",20],["NON_COMPLEX_TMS_PHYSICIAN",30],["NON_COMPLEX_ADDITIONAL_TMS",20],["NON_COMPLEX_ADDITIONAL_TMS_B",20],["COMPLEX_TMS",60],["COMPLEX_ADDITIONAL_TMS",30]]),this.refreshEpisode=new m.n}set cptCodeSetter(e){this.cptCode=e}ngOnChanges(){this.checkIfTMSAdditionPossible()}checkIfTMSAdditionPossible(){var e,t,n,i,s,a;let o=!1;Ps.a.NON_COMPLEX_TMS===this.cptCode&&(null===(e=this.episodeDetails)||void 0===e?void 0:e.patientComplianceCount[99490])<20&&(o=!0),Ps.a.NON_COMPLEX_ADDITIONAL_TMS===this.cptCode&&(null===(t=this.episodeDetails)||void 0===t?void 0:t.patientComplianceCount[99490])>=20&&(null===(n=this.episodeDetails)||void 0===n?void 0:n.patientComplianceCount[99439])<20&&(o=!0),Ps.a.NON_COMPLEX_ADDITIONAL_TMS_B===this.cptCode&&(null===(i=this.episodeDetails)||void 0===i?void 0:i.patientComplianceCount[99439])>=20&&(o=!0),Ps.a.NON_COMPLEX_TMS_PHYSICIAN===this.cptCode&&(o=!0),Ps.a.COMPLEX_TMS===this.cptCode&&(null===(s=this.episodeDetails)||void 0===s?void 0:s.patientComplianceCount[99487])<60&&(o=!0),Ps.a.COMPLEX_ADDITIONAL_TMS===this.cptCode&&(null===(a=this.episodeDetails)||void 0===a?void 0:a.patientComplianceCount[99487])>=60&&(o=!0),this.canAddTMS=o}validate(){return!!this._dateComparePipe.transform(this.episodeDetails.endDate)||(this._notificationsService.error("Episode Status","The episode is not in active state, no further activities can be assigned."),!1)}showTMSModal(e){var t,n,i;if(!this.validate())return;this._episodesEventLogger.episodeTMSActionEvent(this.episodeDetails.id,this.episodeDetails.patientId,"episode_add_tms");const s={id:this.episodeDetails.patientId,name:null===(t=this.patient)||void 0===t?void 0:t.fullName,dxCodes:null===(i=null===(n=this.patient)||void 0===n?void 0:n.healthInfo)||void 0===i?void 0:i.dxCodes,episode:{id:this.episodeDetails.id,startDate:this.episodeDetails.startDate,endDate:this.episodeDetails.endDate,blueprintId:this.episodeDetails.blueprintId,totalNonComplexTMSCompleted:this.episodeDetails.patientComplianceCount[99490],totalNonComplexTMSPhysicianCompleted:this.episodeDetails.patientComplianceCount[99491],totalComplexTMSCompleted:this.episodeDetails.patientComplianceCount[99487],totalComplexAdditionalTMSCompleted:this.episodeDetails.patientComplianceCount[99489]}};this._patientCommunicationModalService.createCCMTMS(s,this.episodeDetails.blueprintId,this.cptCode,"EPISODE_SCREEN",e).afterClose.subscribe(e=>{e&&this.refreshEpisodeState()})}showLogDetails(e,t){this._patientCommunicationModalService.createLogDetailsModal(e,t)}downloadReport(){const e=new Date,t=e.getUTCMonth()+1,n=e.getUTCFullYear(),i=t<10?n+"-0"+t:n+"-"+t;this._analyticsService.generatePatientCommunicationReport(this.episodeDetails.patientId,this.serviceCodes.get(`${this.cptCode}`),i).subscribe(e=>{window.open(`https://api.cooeyhealth.com/v1/assets/view/?filename=${e.filename}&asset-type=REPORTS`,"_blank")})}delete(e){this.validate()&&this._episodesService.archivePatientCommunication(e).subscribe(()=>{this._notificationsService.success("Patient Communication","Note deleted successfully!"),this.refreshEpisodeState()})}refreshEpisodeState(){this.refreshEpisode.emit(!0)}}return e.\u0275fac=function(t){return new(t||e)(m.Rb(Pi.a),m.Rb(D.b),m.Rb(As.a),m.Rb(ye.a),m.Rb(oa.a),m.Rb(Ut.a))},e.\u0275cmp=m.Lb({type:e,selectors:[["app-ccm-treatment-management-services"]],inputs:{episodeDetails:"episodeDetails",patient:"patient",cptCodeSetter:["cptCode","cptCodeSetter"]},outputs:{refreshEpisode:"refreshEpisode"},features:[m.Cb([Pi.a]),m.Bb],decls:22,vars:13,consts:[["nz-row",""],["nz-col","","nzXs","24","nzSm","24","nzMd","14"],["nz-typography",""],["nz-typography","",3,"nzType",4,"ngIf"],["nz-typography","",3,"nzType"],[4,"ngIf"],["nz-col","","nzXs","24","nzSm","24","nzMd","10","id","actions"],["nz-button","","nzType","primary","nzSize","large",3,"disabled","click"],["nz-button","","nzSize","large",3,"disabled","click"],["nzShowPagination","false","nzSize","small","nzBordered","false",3,"nzData","nzScroll"],["tmsTable",""],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],["nz-tooltip","","nzEllipsis","",3,"nzTooltipTitle","nzEllipsisRows"],["size","16px","name","view","nz-tooltip","","nzTooltipTitle","View",3,"click"],["size","16px","name","profileEdit","nz-tooltip","","nzTooltipTitle","Edit",3,"click"],["nz-popconfirm","","nzPopconfirmTitle","Are you sure you want to delete this record ?","nzPopconfirmPlacement","bottom",3,"nzOnConfirm"],["name","delete","size","16px","color","#c81c1c"]],template:function(e,t){1&e&&(m.Xb(0,"nz-card"),m.Xb(1,"div",0),m.Xb(2,"div",1),m.Xb(3,"h3",2),m.Vc(4,ca,3,3,"span",3),m.Xb(5,"span",4),m.Xc(6),m.Wb(),m.Vb(7),m.Xc(8),m.jc(9,"translate"),m.Ub(),m.Wb(),m.Vc(10,da,2,0,"label",5),m.Wb(),m.Xb(11,"div",6),m.Xb(12,"button",7),m.ec("click",function(){return t.showTMSModal()}),m.Vb(13),m.Xc(14),m.jc(15,"translate"),m.Ub(),m.Wb(),m.Xc(16," \xa0\xa0 "),m.Xb(17,"button",8),m.ec("click",function(){return t.downloadReport()}),m.Vb(18),m.Xc(19," Download as PDF "),m.Ub(),m.Wb(),m.Wb(),m.Wb(),m.Vc(20,ha,24,19,"ng-container",5),m.Wb(),m.Sb(21,"br")),2&e&&(m.Db(4),m.rc("ngIf",!1),m.Db(1),m.rc("nzType",0===(null==t.episodeDetails?null:t.episodeDetails.patientComplianceCount[t.serviceCodes.get(t.cptCode)])?"-":"success"),m.Db(1),m.Zc(" ",null==t.episodeDetails?null:t.episodeDetails.patientComplianceCount[t.serviceCodes.get(t.cptCode)]," "),m.Db(2),m.Zc(" ",m.kc(9,9,t.cptCode)," "),m.Db(2),m.rc("ngIf",!(null!=t.episodeDetails&&t.episodeDetails.patientCommunications&&null!=t.episodeDetails&&null!=t.episodeDetails.patientCommunications[t.serviceCodes.get(t.cptCode)]&&t.episodeDetails.patientCommunications[t.serviceCodes.get(t.cptCode)].length)),m.Db(2),m.rc("disabled","SUSPENDED"===(null==t.episodeDetails?null:t.episodeDetails.status)),m.Db(2),m.Zc(" Add ",m.kc(15,11,t.cptCode)," "),m.Db(3),m.rc("disabled","SUSPENDED"===(null==t.episodeDetails?null:t.episodeDetails.status)),m.Db(3),m.rc("ngIf",(null==t.episodeDetails?null:t.episodeDetails.patientCommunications)&&(null==t.episodeDetails||null==t.episodeDetails.patientCommunications[t.serviceCodes.get(t.cptCode)]?null:t.episodeDetails.patientCommunications[t.serviceCodes.get(t.cptCode)].length)))},directives:[I.a,O.c,O.a,T.a,s.q,mt.a,Ct.a,A.a,ts.f,ts.n,ts.o,ts.e,ts.l,ts.i,s.p,s.o,ts.c,je.d,oe.a,wi.a],pipes:[Q.a,s.e],styles:["#actions[_ngcontent-%COMP%]{text-align:right}"]}),e})();function fa(e,t){1&e&&(m.Xb(0,"label"),m.Xc(1," No call activity yet "),m.Wb())}const va=function(e){return{"shaded-row":e}};function ma(e,t){if(1&e){const e=m.Yb();m.Xb(0,"tr",7),m.Xb(1,"td"),m.Xc(2),m.jc(3,"date"),m.Wb(),m.Xb(4,"td"),m.Xc(5),m.Wb(),m.Xb(6,"td"),m.Xc(7),m.Wb(),m.Xb(8,"td",8),m.Xc(9),m.Wb(),m.Xb(10,"td"),m.Xc(11),m.Wb(),m.Xb(12,"td"),m.Xb(13,"app-icons",9),m.ec("click",function(){m.Lc(e);const n=t.$implicit,i=m.ic(2);return i.showLogDetails(n,null==i.episodeDetails?null:i.episodeDetails.monitoringStaff[null==n?null:n.staffId])}),m.Wb(),m.Xc(14," \xa0 "),m.Xb(15,"app-icons",10),m.ec("click",function(){m.Lc(e);const n=t.$implicit;return m.ic(2).showTMSModal(n)}),m.Wb(),m.Wb(),m.Wb()}if(2&e){const e=t.$implicit,n=t.index,i=m.ic(2);m.rc("ngClass",m.yc(11,va,n%2!=0)),m.Db(2),m.Yc(m.lc(3,8,null==e?null:e.startTime,"MMM dd yyyy hh:mm")),m.Db(3),m.Yc(((null==e?null:e.endTime)-(null==e?null:e.startTime))/6e4),m.Db(2),m.Yc(i.mode.get(null==e?null:e.mode)),m.Db(1),m.rc("nzTooltipTitle",null==e?null:e.notes)("nzEllipsisRows",2),m.Db(1),m.Zc(" ",null==e?null:e.activity," "),m.Db(2),m.Yc(null==i.episodeDetails?null:i.episodeDetails.monitoringStaff[null==e?null:e.staffId])}}const Ca=function(){return{x:"1175px"}};function Da(e,t){if(1&e&&(m.Vb(0),m.Sb(1,"br"),m.Xb(2,"nz-table",4,5),m.Xb(4,"thead"),m.Xb(5,"tr"),m.Xb(6,"th"),m.Xc(7),m.jc(8,"translate"),m.Wb(),m.Xb(9,"th"),m.Xc(10),m.jc(11,"translate"),m.Wb(),m.Xb(12,"th"),m.Xc(13),m.jc(14,"translate"),m.Wb(),m.Xb(15,"th"),m.Xc(16),m.jc(17,"translate"),m.Wb(),m.Xb(18,"th"),m.Xc(19),m.jc(20,"translate"),m.Wb(),m.Sb(21,"th"),m.Wb(),m.Wb(),m.Xb(22,"tbody"),m.Vc(23,ma,16,13,"tr",6),m.Wb(),m.Wb(),m.Ub()),2&e){const e=m.Ic(3),t=m.ic();m.Db(2),m.rc("nzData",null==t.episodeDetails?null:t.episodeDetails.patientCommunications[t.serviceCodes.get(t.cptCode)])("nzScroll",m.xc(18,Ca)),m.Db(5),m.Yc(m.kc(8,8,"COMMON.DATE_TIME")),m.Db(3),m.Zc("",m.kc(11,10,"COMMON.DURATION")," (mins)"),m.Db(3),m.Yc(m.kc(14,12,"TMS.COMMUNICATION_MODE")),m.Db(3),m.Yc(m.kc(17,14,"HEADER.ACTIVITY")),m.Db(3),m.Yc(m.kc(20,16,"PATIENT.MONITORING_STAFF")),m.Db(4),m.rc("ngForOf",e.data)}}let Sa=(()=>{class e{constructor(e,t,n,i){this._dateComparePipe=e,this._notificationsService=t,this._patientCommunicationModalService=n,this._episodesEventLogger=i,this.mode=new Map([["VIDEO_CALL","Video Call"],["CALL","Audio Call"],["INBOUND_CALL","Inbound Call"],["OUTBOUND_CALL","Outbound Call"],["HOME_VISIT","Home Visit"],["CLINIC_VISIT","In Clinic"],["OTHER","Other"]]),this.serviceCodes=new Map([["NON_COMPLEX_TMS","99490"],["NON_COMPLEX_TMS_PHYSICIAN","99491"],["NON_COMPLEX_ADDITIONAL_TMS","99439"],["NON_COMPLEX_ADDITIONAL_TMS_B","99439B"],["COMPLEX_TMS","99487"],["COMPLEX_ADDITIONAL_TMS","99489"],["UNKNOWN","UNKNOWN"]]),this.serviceCodeTotal=new Map([["NON_COMPLEX_TMS",20],["NON_COMPLEX_TMS_PHYSICIAN",30],["NON_COMPLEX_ADDITIONAL_TMS",20],["NON_COMPLEX_ADDITIONAL_TMS_B",20],["COMPLEX_TMS",60],["COMPLEX_ADDITIONAL_TMS",30]]),this.refreshEpisode=new m.n}set cptCodeSetter(e){this.cptCode=e}validate(){return!!this._dateComparePipe.transform(this.episodeDetails.endDate)||(this._notificationsService.error("Episode Status","The episode is not in active state, no further activities can be assigned."),!1)}showTMSModal(e){this.validate()&&(this._episodesEventLogger.episodeTMSActionEvent(this.episodeDetails.id,this.episodeDetails.patientId,"episode_add_tms"),this._patientCommunicationModalService.createCCMTMS({id:this.episodeDetails.patientId,name:this.patientName,episode:{id:this.episodeDetails.id,startDate:this.episodeDetails.startDate,endDate:this.episodeDetails.endDate,blueprintId:this.episodeDetails.blueprintId,totalNonComplexTMSCompleted:this.episodeDetails.patientComplianceCount[99490],totalNonComplexTMSPhysicianCompleted:this.episodeDetails.patientComplianceCount[99491],totalComplexTMSCompleted:this.episodeDetails.patientComplianceCount[99487],totalComplexAdditionalTMSCompleted:this.episodeDetails.patientComplianceCount[99489]}},this.episodeDetails.blueprintId,this.cptCode,"EPISODE_SCREEN",e).afterClose.subscribe(e=>{e&&this.refreshEpisodeState()}))}showLogDetails(e,t){this._patientCommunicationModalService.createLogDetailsModal(e,t)}refreshEpisodeState(){this.refreshEpisode.emit(!0)}}return e.\u0275fac=function(t){return new(t||e)(m.Rb(Pi.a),m.Rb(D.b),m.Rb(As.a),m.Rb(ye.a))},e.\u0275cmp=m.Lb({type:e,selectors:[["app-non-billed-cmt"]],inputs:{episodeDetails:"episodeDetails",patientName:"patientName",cptCodeSetter:["cptCode","cptCodeSetter"]},outputs:{refreshEpisode:"refreshEpisode"},features:[m.Cb([Pi.a])],decls:8,vars:2,consts:[["nz-row",""],["nz-col","","nzXs","24","nzSm","24","nzMd","18"],["nz-typography",""],[4,"ngIf"],["nzShowPagination","false","nzSize","small","nzBordered","false",3,"nzData","nzScroll"],["tmsTable",""],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],["nz-tooltip","","nzEllipsis","",3,"nzTooltipTitle","nzEllipsisRows"],["size","16px","name","view","nz-tooltip","","nzTooltipTitle","View",3,"click"],["size","16px","name","profileEdit","nz-tooltip","","nzTooltipTitle","Edit",3,"click"]],template:function(e,t){1&e&&(m.Xb(0,"nz-card"),m.Xb(1,"div",0),m.Xb(2,"div",1),m.Xb(3,"h3",2),m.Xc(4,"Non-Billable CMT"),m.Wb(),m.Vc(5,fa,2,0,"label",3),m.Wb(),m.Wb(),m.Vc(6,Da,24,19,"ng-container",3),m.Wb(),m.Sb(7,"br")),2&e&&(m.Db(5),m.rc("ngIf",!(null!=t.episodeDetails&&t.episodeDetails.patientCommunications&&null!=t.episodeDetails&&null!=t.episodeDetails.patientCommunications[t.serviceCodes.get(t.cptCode)]&&t.episodeDetails.patientCommunications[t.serviceCodes.get(t.cptCode)].length)),m.Db(1),m.rc("ngIf",(null==t.episodeDetails?null:t.episodeDetails.patientCommunications)&&(null==t.episodeDetails||null==t.episodeDetails.patientCommunications[t.serviceCodes.get(t.cptCode)]?null:t.episodeDetails.patientCommunications[t.serviceCodes.get(t.cptCode)].length)))},directives:[I.a,O.c,O.a,T.a,s.q,ts.f,ts.n,ts.o,ts.e,ts.l,ts.i,s.p,s.o,ts.c,je.d,oe.a],pipes:[Q.a,s.e],styles:[""]}),e})();var Ea=n("BQXE");function Oa(e,t){if(1&e){const e=m.Yb();m.Xb(0,"app-consent-forms",15),m.ec("consentChanged",function(){return m.Lc(e),m.ic(2).getEpisodeData()}),m.Wb()}if(2&e){const e=m.ic(2);m.rc("episodeDetails",e.episodeDetails)}}function Ia(e,t){if(1&e){const e=m.Yb();m.Xb(0,"app-patient-consent",16),m.ec("episodeChange",function(){return m.Lc(e),m.ic(2).getEpisodeData()}),m.Wb()}if(2&e){const e=m.ic(2);m.rc("episodeDetails",e.episodeDetails)}}function _a(e,t){if(1&e){const e=m.Yb();m.Xb(0,"app-toc-events",14),m.ec("refreshEpisode",function(t){return m.Lc(e),m.ic(2).getEpisodeData(t)}),m.Wb()}if(2&e){const e=m.ic(2);m.rc("episodeDetails",e.episodeDetails)}}function Xa(e,t){if(1&e){const e=m.Yb();m.Xb(0,"app-appointment",17),m.ec("refreshEpisode",function(){return m.Lc(e),m.ic(2).getEpisodeData()}),m.Wb()}if(2&e){const e=m.ic(2);m.rc("episodeDetails",e.episodeDetails)("user",e.patient)}}function Ta(e,t){if(1&e){const e=m.Yb();m.Xb(0,"app-device-setup-tasks",18),m.ec("refreshEpisode",function(){return m.Lc(e),m.ic(2).getEpisodeData()}),m.Wb()}if(2&e){const e=m.ic(2);m.rc("episodeDetails",e.episodeDetails)("patient",e.patient)}}function Na(e,t){if(1&e){const e=m.Yb();m.Xb(0,"app-plan-of-care",18),m.ec("refreshEpisode",function(){return m.Lc(e),m.ic(2).getEpisodeData()}),m.Wb()}if(2&e){const e=m.ic(2);m.rc("episodeDetails",e.episodeDetails)("patient",e.patient)}}function za(e,t){if(1&e){const e=m.Yb();m.Xb(0,"app-careplan",19),m.ec("refresh",function(){return m.Lc(e),m.ic(2).getEpisodeData()}),m.Wb()}if(2&e){const e=m.ic(2);m.rc("episodeDetails",e.episodeDetails)}}function Ma(e,t){if(1&e){const e=m.Yb();m.Xb(0,"app-care-management-time",14),m.ec("refreshEpisode",function(){return m.Lc(e),m.ic(2).getEpisodeData()}),m.Wb()}if(2&e){const e=m.ic(2);m.rc("episodeDetails",e.episodeDetails)}}function ya(e,t){if(1&e){const e=m.Yb();m.Xb(0,"app-treatment-management-service",20),m.ec("refreshEpisode",function(){return m.Lc(e),m.ic(2).getEpisodeData()}),m.Wb()}if(2&e){const e=m.ic(2);m.rc("episodeDetails",e.episodeDetails)("cptCode","TREATMENT_MANAGEMENT_SERVICE")("patient",e.patient)}}function Aa(e,t){if(1&e){const e=m.Yb();m.Xb(0,"app-toc-care-management-time",20),m.ec("refreshEpisode",function(){return m.Lc(e),m.ic(2).getEpisodeData()}),m.Wb()}if(2&e){const e=m.ic(2);m.rc("episodeDetails",e.episodeDetails)("cptCode","CARE_MANAGEMENT_TIME")("patient",e.patient)}}function Pa(e,t){if(1&e){const e=m.Yb();m.Xb(0,"app-ccm-treatment-management-services",20),m.ec("refreshEpisode",function(){return m.Lc(e),m.ic(2).getEpisodeData()}),m.Wb()}if(2&e){const e=m.ic(2);m.rc("episodeDetails",e.episodeDetails)("cptCode","NON_COMPLEX_TMS")("patient",e.patient)}}function Wa(e,t){if(1&e){const e=m.Yb();m.Xb(0,"app-ccm-treatment-management-services",20),m.ec("refreshEpisode",function(){return m.Lc(e),m.ic(2).getEpisodeData()}),m.Wb()}if(2&e){const e=m.ic(2);m.rc("episodeDetails",e.episodeDetails)("cptCode","COMPLEX_TMS")("patient",e.patient)}}function Ra(e,t){if(1&e){const e=m.Yb();m.Xb(0,"app-non-billed-cmt",21),m.ec("refreshEpisode",function(){return m.Lc(e),m.ic(2).getEpisodeData()}),m.Wb()}if(2&e){const e=m.ic(2);m.rc("episodeDetails",e.episodeDetails)("cptCode","UNKNOWN")("patientName",null==e.patient?null:e.patient.fullName)}}function wa(e,t){if(1&e){const e=m.Yb();m.Vb(0),m.Xb(1,"div",2),m.Sb(2,"app-basic",3),m.Sb(3,"app-codes",3),m.Vc(4,Oa,1,1,"app-consent-forms",4),m.Vc(5,Ia,1,1,"app-patient-consent",5),m.Vc(6,_a,1,1,"app-toc-events",6),m.Vc(7,Xa,1,2,"app-appointment",7),m.Vc(8,Ta,1,2,"app-device-setup-tasks",8),m.Vc(9,Na,1,2,"app-plan-of-care",8),m.Vc(10,za,1,1,"app-careplan",9),m.Vc(11,Ma,1,1,"app-care-management-time",10),m.Vc(12,ya,1,3,"app-treatment-management-service",11),m.Vc(13,Aa,1,3,"app-toc-care-management-time",12),m.Vc(14,Pa,1,3,"app-ccm-treatment-management-services",12),m.jc(15,"filterList"),m.Vc(16,Wa,1,3,"app-ccm-treatment-management-services",12),m.jc(17,"filterList"),m.Vc(18,Ra,1,3,"app-non-billed-cmt",13),m.Wb(),m.Xb(19,"app-episode-quick-actions",14),m.ec("refreshEpisode",function(){return m.Lc(e),m.ic().getEpisodeData()}),m.Wb(),m.Ub()}if(2&e){const e=m.ic();m.Db(2),m.rc("episodeDetails",e.episodeDetails),m.Db(1),m.rc("episodeDetails",e.episodeDetails),m.Db(1),m.rc("isComponentEnabled","PHYSICIAN_ORDER"),m.Db(1),m.rc("isComponentEnabled","CONSENT_FORM"),m.Db(1),m.rc("ngIf","TOC"===(null==e.episodeDetails?null:e.episodeDetails.type)),m.Db(1),m.rc("isComponentEnabled","APPOINTMENT"),m.Db(1),m.rc("isComponentEnabled","PATIENT_EDUCATION_APPOINTMENT"),m.Db(1),m.rc("isComponentEnabled","PLAN_OF_CARE"),m.Db(1),m.rc("isComponentEnabled","CARE_PLAN"),m.Db(1),m.rc("isComponentEnabled","CARE_MANAGEMENT_TIME"),m.Db(1),m.rc("isComponentEnabled","TREATMENT_MANAGEMENT_SERVICE"),m.Db(1),m.rc("ngIf","TOC"===(null==e.episodeDetails?null:e.episodeDetails.type)),m.Db(1),m.rc("ngIf",m.lc(15,16,"99490",e.serviceCodes)),m.Db(2),m.rc("ngIf",m.lc(17,19,"99487",e.serviceCodes)),m.Db(2),m.rc("ngIf",!(null==e.episodeDetails||!e.episodeDetails.patientCommunications||null==e.episodeDetails||!e.episodeDetails.patientCommunications.UNKNOWN)),m.Db(1),m.rc("episodeDetails",e.episodeDetails)}}let La=(()=>{class e extends h.a{constructor(e,t,n,i,s,a){super(),this._episodesService=e,this._activatedRoute=t,this._dataSharingService=n,this._notificationsService=i,this._patientsService=s,this._router=a}ngOnInit(){this.getDataFromURL(),this.getTenantConfig(),this.getEpisodeData(),this.getUserDetails(this.patientId)}getDataFromURL(){this.patientId=this._activatedRoute.snapshot.params.patientId,this.episodeId=this._activatedRoute.snapshot.params.episodeId}getTenantConfig(){this._dataSharingService.tenantSettings.pipe(Object(f.a)(this.unsubscribed)).subscribe(e=>{this.tenantSettings=e})}getEpisodeData(e=!1){this._episodesService.fetchEpisodeDetails(this.episodeId).subscribe(t=>{e||!this.episodeDetails||JSON.stringify(t)!==JSON.stringify(this.episodeDetails)?(this.episodeDetails=void 0,setTimeout(()=>{this.episodeDetails=t,this.processEpisodeDetails()},50)):this.processEpisodeDetails()})}processEpisodeDetails(){var e,t,n,i,s,a,o,l;if(this.serviceCodes=Object.keys(null===(e=this.episodeDetails)||void 0===e?void 0:e.serviceCodes),localStorage.setItem(v.a.REQUEST_TENANT_TEMP_IDS,this.episodeDetails.tenantId),-1!==(null===(s=null===(i=null===(n=null===(t=this.tenantSettings)||void 0===t?void 0:t.episodeBlueprints)||void 0===n?void 0:n.find(e=>{var t;return(null===(t=this.episodeDetails)||void 0===t?void 0:t.blueprintId)===(null==e?void 0:e.id)&&!(null==e?void 0:e.archived)}))||void 0===i?void 0:i.enabledServiceCodes)||void 0===s?void 0:s.findIndex(e=>"99484"===e)))return;const r=null===(o=null===(a=this.episodeDetails)||void 0===a?void 0:a.activeCarePlans)||void 0===o?void 0:o.filter(e=>"IN_PROGRESS"===(null==e?void 0:e.status));if(!(null==r?void 0:r.length))return;const c=null===(l=this.episodeDetails)||void 0===l?void 0:l.patientComplianceCount[99454];0===c?this.timeoutId=setTimeout(()=>this.getEpisodeData(),15e3):0===this.vitalDaysRemaining&&1===c&&this._notificationsService.success("Vital Measurement","Vital value transmitted successfully, the number of days remaining for the current month is 15")}getUserDetails(e){this._patientsService.fetchPatientById(e).subscribe(e=>this.patient=e)}editEpisode(){this._router.navigate([`episodes/form/edit/${this.episodeDetails.patientId}`],{queryParams:{blueprintId:this.episodeDetails.blueprintId,episodeId:this.episodeDetails.id}})}ngOnDestroy(){this.timeoutId&&clearTimeout(this.timeoutId)}}return e.\u0275fac=function(t){return new(t||e)(m.Rb(u.a),m.Rb(C.a),m.Rb(H.a),m.Rb(D.b),m.Rb(p.a),m.Rb(C.g))},e.\u0275cmp=m.Lb({type:e,selectors:[["app-episode-details"]],features:[m.Ab],decls:2,vars:5,consts:[["title","episodeForm","actionTitle","Edit Episode",3,"defaultTitle","isSearchEnabled","isActionEnabled","action"],[4,"ngIf"],[1,"container"],[3,"episodeDetails"],[3,"episodeDetails","consentChanged",4,"isComponentEnabled"],[3,"episodeDetails","episodeChange",4,"isComponentEnabled"],[3,"episodeDetails","refreshEpisode",4,"ngIf"],[3,"episodeDetails","user","refreshEpisode",4,"isComponentEnabled"],[3,"episodeDetails","patient","refreshEpisode",4,"isComponentEnabled"],[3,"episodeDetails","refresh",4,"isComponentEnabled"],[3,"episodeDetails","refreshEpisode",4,"isComponentEnabled"],[3,"episodeDetails","cptCode","patient","refreshEpisode",4,"isComponentEnabled"],[3,"episodeDetails","cptCode","patient","refreshEpisode",4,"ngIf"],[3,"episodeDetails","cptCode","patientName","refreshEpisode",4,"ngIf"],[3,"episodeDetails","refreshEpisode"],[3,"episodeDetails","consentChanged"],[3,"episodeDetails","episodeChange"],[3,"episodeDetails","user","refreshEpisode"],[3,"episodeDetails","patient","refreshEpisode"],[3,"episodeDetails","refresh"],[3,"episodeDetails","cptCode","patient","refreshEpisode"],[3,"episodeDetails","cptCode","patientName","refreshEpisode"]],template:function(e,t){1&e&&(m.Xb(0,"app-header",0),m.ec("action",function(){return t.editEpisode()}),m.Wb(),m.Vc(1,wa,20,22,"ng-container",1)),2&e&&(m.uc("defaultTitle","",null==t.patient?null:t.patient.fullName," | ",null==t.episodeDetails?null:t.episodeDetails.name,""),m.rc("isSearchEnabled",!1)("isActionEnabled",!1),m.Db(1),m.rc("ngIf",t.tenantSettings&&t.episodeDetails))},directives:[we.a,s.q,Ke,st,Le,ht,Rt,ui,Ai,Ji,ds,gs,ys,Us,Js,aa,ga,Sa],pipes:[Ea.a],styles:[""]}),e})();var xa=n("0W7X"),ka=n("T5gh"),Va=n("bA1+"),Ua=n("i680"),Fa=n("wOnQ"),ja=n.n(Fa);let Ya=(()=>{class e{constructor(e,t){this._activatedRoute=e,this.consentService=t}ngOnInit(){this.getConsentDetails()}getConsentDetails(){this.loadingCertificate=!0,this._activatedRoute.queryParams.subscribe(e=>this.consentId=e.consentId),this.consentService.getConsentDetails(this.consentId).subscribe(e=>{var t,n;this.consent=e,this.callStartTime=this.convertUTCDateToLocalDate(new Date(null===(t=null==e?void 0:e.consentDetails)||void 0===t?void 0:t.callStartTime)),this.callEndTime=this.convertUTCDateToLocalDate(new Date(null===(n=null==e?void 0:e.consentDetails)||void 0===n?void 0:n.callEndTime)),this.loadingCertificate=!1},e=>this.loadingCertificate=!1)}convertUTCDateToLocalDate(e){if(null!=e)return new Date(e.getTime()-60*e.getTimezoneOffset()*1e3)}exportCertificate(){let e=this.consent.consenteeName+"-"+this.consent.consenteeNumber+" consent-certificate.pdf";ja()(document.getElementById("formCanvas")).then(t=>{const n=t.toDataURL("image/png"),i=new Ua.default({orientation:"landscape"}),s=i.getImageProperties(n),a=i.internal.pageSize.getWidth();i.addImage(n,"PNG",0,0,a,s.height*a/s.width),i.save(e)})}}return e.\u0275fac=function(t){return new(t||e)(m.Rb(C.a),m.Rb(jt.a))},e.\u0275cmp=m.Lb({type:e,selectors:[["app-consent-certificate"]],decls:76,vars:75,consts:[["title","consentCertificate",3,"defaultTitle","isSearchEnabled","actionTitle","action"],["id","formCanvas",3,"nzLoading"],["nz-typography",""],[1,"call-details-box"],["nz-row",""],["nz-col","","nzSpan","12"]],template:function(e,t){1&e&&(m.Xb(0,"app-header",0),m.ec("action",function(){return t.exportCertificate()}),m.jc(1,"translate"),m.jc(2,"translate"),m.Wb(),m.Xb(3,"nz-card",1),m.Xb(4,"h1",2),m.Xc(5),m.jc(6,"translate"),m.Wb(),m.Xb(7,"h3",2),m.Xc(8),m.jc(9,"translate"),m.Xb(10,"B"),m.Xc(11),m.Wb(),m.Wb(),m.Xb(12,"h3",2),m.Xc(13),m.jc(14,"translate"),m.Xb(15,"B"),m.Xc(16),m.jc(17,"episodeName"),m.Wb(),m.Wb(),m.Xb(18,"h3",2),m.Xc(19),m.jc(20,"translate"),m.Wb(),m.Xb(21,"div",3),m.Xb(22,"h3"),m.Xc(23),m.jc(24,"translate"),m.Wb(),m.Xb(25,"div",4),m.Xb(26,"div",5),m.Xc(27),m.jc(28,"translate"),m.Xb(29,"h4",2),m.Xc(30),m.jc(31,"translate"),m.Wb(),m.Wb(),m.Xb(32,"div",5),m.Xc(33),m.jc(34,"translate"),m.Xb(35,"h4",2),m.Xc(36),m.jc(37,"date"),m.Wb(),m.Wb(),m.Wb(),m.Xb(38,"div",4),m.Xb(39,"div",5),m.Xc(40),m.jc(41,"translate"),m.Xb(42,"h4",2),m.Xc(43),m.Wb(),m.Wb(),m.Xb(44,"div",5),m.Xc(45),m.jc(46,"translate"),m.Xb(47,"h4",2),m.Xc(48),m.Wb(),m.Wb(),m.Wb(),m.Xb(49,"div",4),m.Xb(50,"div",5),m.Xc(51),m.jc(52,"translate"),m.Xb(53,"h4",2),m.Xc(54),m.Wb(),m.Wb(),m.Xb(55,"div",5),m.Xc(56),m.jc(57,"translate"),m.Xb(58,"h4",2),m.Xc(59),m.Wb(),m.Wb(),m.Wb(),m.Xb(60,"div",4),m.Xb(61,"div",5),m.Xc(62),m.jc(63,"translate"),m.Xb(64,"h4",2),m.Xc(65),m.jc(66,"date"),m.Wb(),m.Wb(),m.Xb(67,"div",5),m.Xc(68),m.jc(69,"translate"),m.Xb(70,"h4",2),m.Xc(71),m.jc(72,"date"),m.Wb(),m.Wb(),m.Wb(),m.Wb(),m.Xb(73,"h3",2),m.Xc(74),m.jc(75,"translate"),m.Wb(),m.Wb()),2&e&&(m.sc("defaultTitle",m.kc(1,30,"CONSENT.CONSENT_FORM_CERTIFICATE")),m.sc("actionTitle",m.kc(2,32,"CONSENT.DOWNLOAD_CERTIFICATE")),m.rc("isSearchEnabled",!1),m.Db(3),m.rc("nzLoading",t.loadingCertificate),m.Db(2),m.Yc(m.kc(6,34,"CONSENT.CONSENT_CERTI_HEADING")),m.Db(3),m.Zc("",m.kc(9,36,"CONSENT.HEALTHCARE_PROVIDER_NAME"),": "),m.Db(3),m.Yc(null==t.consent?null:t.consent.tenantName),m.Db(2),m.Zc("",m.kc(14,38,"CONSENT.NAME_OF_PROGRAM"),": "),m.Db(3),m.Yc(m.kc(17,40,null==t.consent?null:t.consent.episodeType)),m.Db(3),m.ad("",m.kc(20,42,"CONSENT.CALL_REFERENCE_ID"),": ",null==t.consent?null:t.consent.id,""),m.Db(4),m.Yc(m.kc(24,44,"CONSENT.CALL_DETAILS")),m.Db(4),m.Zc(" ",m.kc(28,46,"CONSENT.PURPOSE_OF_CALL"),": "),m.Db(3),m.Yc(m.kc(31,48,"CONSENT.CALL_PURPOSE")),m.Db(3),m.Zc(" ",m.kc(34,50,"CONSENT.DATE"),": "),m.Db(3),m.Yc(m.lc(37,52,null==t.consent?null:t.consent.obtainedOn,"mediumDate")),m.Db(4),m.Zc(" ",m.kc(41,55,"CONSENT.CALL_INITIATED_FROM"),": "),m.Db(3),m.Zc(" ",null==t.consent||null==t.consent.consentDetails?null:t.consent.consentDetails.fromNumber," "),m.Db(2),m.Zc(" ",m.kc(46,57,"CONSENT.CALL_RECEIVED_ON"),": "),m.Db(3),m.Yc(null==t.consent?null:t.consent.consenteeNumber),m.Db(3),m.Zc(" ",m.kc(52,59,"CONSENT.CALL_INITIATED_BY"),": "),m.Db(3),m.Yc(null==t.consent||null==t.consent.consentDetails?null:t.consent.consentDetails.callerName),m.Db(2),m.Zc(" ",m.kc(57,61,"CONSENT.CALL_RECEIVED_BY"),": "),m.Db(3),m.Zc("",null==t.consent?null:t.consent.consenteeName," "),m.Db(3),m.Zc(" ",m.kc(63,63,"CONSENT.START_TIME_OF_CALL"),": "),m.Db(3),m.Yc(m.lc(66,65,t.callStartTime,"fullTime")),m.Db(3),m.Zc(" ",m.kc(69,68,"CONSENT.END_TIME_OF_CALL"),": "),m.Db(3),m.Yc(m.lc(72,70,t.callEndTime,"fullTime")),m.Db(3),m.ad("",m.kc(75,73,"CONSENT.VERBAL_CONSENT_GIVEN_BY"),": ",null==t.consent?null:t.consent.consenteeName,""))},directives:[we.a,I.a,T.a,O.c,O.a],pipes:[Q.a,xe.a,s.e],styles:["nz-card[_ngcontent-%COMP%]{padding:2%;margin:5%;font-weight:700;color:#888}.call-details-box[_ngcontent-%COMP%]{height:300px;padding:25px;background:#f6f6f6 0 0 no-repeat padding-box;border-radius:10px;opacity:1}.call-details-box[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:20px}h4[_ngcontent-%COMP%]{font-weight:700;margin-top:8px}.call-details-box[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{line-height:.5;margin-bottom:10px}"]}),e})();function Ga(e,t){1&e&&(m.Vb(0),m.Xb(1,"div",1),m.Sb(2,"nz-spin",2),m.Wb(),m.Ub())}function Ba(e,t){if(1&e){const e=m.Yb();m.Vb(0),m.Sb(1,"div",3),m.jc(2,"sanitizeHtml"),m.Xb(3,"div",4),m.Xb(4,"button",5),m.ec("click",function(){return m.Lc(e),m.ic().consentSubmit("AGREE")}),m.Xc(5),m.jc(6,"translate"),m.Wb(),m.Sb(7,"br"),m.Xb(8,"button",6),m.ec("click",function(){return m.Lc(e),m.ic().consentSubmit("DENY")}),m.Xc(9),m.jc(10,"translate"),m.Wb(),m.Wb(),m.Ub()}if(2&e){const e=m.ic();m.Db(1),m.rc("innerHTML",m.kc(2,3,e.consentForm),m.Mc),m.Db(4),m.Zc(" ",m.kc(6,5,"CONSENT.SUBMIT_CONSENT")," "),m.Db(4),m.Zc(" ",m.kc(10,7,"CONSENT.DENY_CONSENT")," ")}}let Ha=(()=>{class e{constructor(e,t,n,i,s,a){this._episodesService=e,this._modalService=t,this._notificationsService=n,this._route=i,this._router=s,this._ngProgress=a,this.rootURL=gt.g.url,this.episodeChange=new m.n}ngOnInit(){this.initValues(),this.loading=!0,this._episodesService.getDigitalConsent(this.patientId,this.episodeType,"SMS_CONSENT").subscribe(e=>{this.loading=!1,this.consentForm=e},e=>{this._notificationsService.error("Consent Form","You have already submitted the response to this form.")})}initValues(){this._route.params.forEach(e=>{this.episodeType=e.episodeType.toUpperCase(),this.patientId=e.patientId,this.episodeId=e.episodeId,this.actionItemId=e.actionItemId})}consentSubmit(e){"AGREE"==e?this.acceptConsent():this.denyConsent()}acceptConsent(){this._episodesService.submitAcceptConsent({consentType:"SMS_CONSENT",episodeId:this.episodeId,patientId:this.patientId,actionItemId:this.actionItemId}).subscribe(e=>{var t,n;this.loading=!1,null===(n=null===(t=this._ngProgress)||void 0===t?void 0:t.ref())||void 0===n||n.complete(),null!=e?this._router.navigate(["episodes/consent/sms/submitted/AGREE"]):this._notificationsService.error("Consent Form","Something went wrong")})}denyConsent(){this._modalService.create({nzContent:sn,nzComponentParams:{patientId:this.patientId},nzWidth:470,nzFooter:null,nzClosable:!1,nzMaskClosable:!1}).afterClose.subscribe(e=>{var t,n;let i={reason:e.reason,consentType:"SMS_CONSENT",episodeId:this.episodeId,patientId:this.patientId,consentId:null};null===(n=null===(t=this._ngProgress)||void 0===t?void 0:t.ref())||void 0===n||n.start(),this._episodesService.submitDenyConsent(i).subscribe(e=>{var t,n;null===(n=null===(t=this._ngProgress)||void 0===t?void 0:t.ref())||void 0===n||n.complete(),this._router.navigate(["episodes/consent/sms/submitted/DENY"])})})}}return e.\u0275fac=function(t){return new(t||e)(m.Rb(u.a),m.Rb(We.f),m.Rb(D.b),m.Rb(C.a),m.Rb(C.g),m.Rb(Fn.a))},e.\u0275cmp=m.Lb({type:e,selectors:[["app-sms-consent-form"]],outputs:{episodeChange:"episodeChange"},decls:2,vars:2,consts:[[4,"ngIf"],[1,"spin-container"],["nzSimple",""],[1,"table-responsive",3,"innerHTML"],[1,"consent-actions-container"],["nz-button","","nzType","primary",3,"click"],["nz-button","","nzType","default","nzDanger","",3,"click"]],template:function(e,t){1&e&&(m.Vc(0,Ga,3,0,"ng-container",0),m.Vc(1,Ba,11,9,"ng-container",0)),2&e&&(m.rc("ngIf",t.loading),m.Db(1),m.rc("ngIf",!t.loading))},directives:[s.q,ae.a,mt.a,Ct.a,A.a],pipes:[St,Q.a],styles:[".spin-container[_ngcontent-%COMP%]{text-align:center;border-radius:4px;padding:30px 50px;margin:20px 0;height:400px}.consent-actions-container[_ngcontent-%COMP%]{text-align:center;margin-top:-100px}button[_ngcontent-%COMP%]{margin-top:10px;margin-bottom:10px;height:48px;width:240px}"]}),e})();var $a=n("yW9e");function Za(e,t){1&e&&m.Sb(0,"img",7)}function qa(e,t){1&e&&m.Sb(0,"img",8)}function Ka(e,t){1&e&&(m.Xb(0,"div"),m.Xb(1,"p"),m.Xc(2),m.jc(3,"translate"),m.Wb(),m.Wb()),2&e&&(m.Db(2),m.Zc(" ",m.kc(3,1,"CONSENT.PATIENT_SIGNED_MESSAGE"),""))}function Qa(e,t){1&e&&(m.Xb(0,"div"),m.Xb(1,"p"),m.Xc(2),m.jc(3,"translate"),m.Wb(),m.Wb()),2&e&&(m.Db(2),m.Zc(" ",m.kc(3,1,"CONSENT.PATIENT_DENIED_MESSAGE"),""))}let Ja=(()=>{class e{constructor(e,t){this._route=e,this.location=t,this.mouseY=0,this.mouseX=0,this.onMouseMove=e=>{this.mouseY=e.pageY;let t=(this.pageY/2-this.mouseY)/this.pageY*300;this.mouseX=e.pageX/-this.pageX,this.style={transform:"translate("+(100*-this.mouseX-100)+"%,-"+t+"%)"}},history.pushState(null,null,window.location.href),this.location.onPopState(()=>{history.pushState(null,null,window.location.href)})}ngOnInit(){this.getScreenSize(),window.addEventListener("mousemove",this.onMouseMove),this._route.params.subscribe(e=>this.status=e.status)}getScreenSize(){this.pageY=window.innerHeight,this.pageX=window.innerWidth,console.log(this.pageY,this.pageX)}close(){window.close()}}return e.\u0275fac=function(t){return new(t||e)(m.Rb(C.a),m.Rb(s.m))},e.\u0275cmp=m.Lb({type:e,selectors:[["app-sms-consent-submitted"]],hostBindings:function(e,t){1&e&&m.ec("resize",function(e){return t.getScreenSize(e)},!1,m.Kc)},decls:11,vars:4,consts:[[1,"overall-container"],[1,"box"],["id","submitted"],["src","../../../../assets/icons/consent-signed.svg","alt","check",4,"ngIf"],["src","../../../../assets/icons/consent-denied.svg","alt","check",4,"ngIf"],["id","thank-you"],[4,"ngIf"],["src","../../../../assets/icons/consent-signed.svg","alt","check"],["src","../../../../assets/icons/consent-denied.svg","alt","check"]],template:function(e,t){1&e&&(m.Xb(0,"div",0),m.Xb(1,"div",1),m.Xb(2,"div",2),m.Vc(3,Za,1,0,"img",3),m.Vc(4,qa,1,0,"img",4),m.Wb(),m.Xb(5,"label",5),m.Xc(6,"Thank You!"),m.Wb(),m.Xb(7,"nz-content"),m.Vc(8,Ka,4,3,"div",6),m.Vc(9,Qa,4,3,"div",6),m.Wb(),m.Sb(10,"br"),m.Wb(),m.Wb()),2&e&&(m.Db(3),m.rc("ngIf","AGREE"==t.status),m.Db(1),m.rc("ngIf","DENY"==t.status),m.Db(4),m.rc("ngIf","AGREE"==t.status),m.Db(1),m.rc("ngIf","DENY"==t.status))},directives:[s.q,$a.a],pipes:[Q.a],styles:["div[_ngcontent-%COMP%]{margin-top:10%;margin-bottom:10%;text-align:center}h1[_ngcontent-%COMP%]{margin-top:10px;font-size:28px;font-family:Nunito;font-weight:bolder;color:#ff2020}h2[_ngcontent-%COMP%]{width:70%}h2[_ngcontent-%COMP%], p[_ngcontent-%COMP%]{font-family:Nunito;font-size:14px;margin:auto}p[_ngcontent-%COMP%]{color:#0d0d0d;width:95%}button[_ngcontent-%COMP%]{background:#85ae38 0 0 no-repeat padding-box;border:1px solid #88ac34;border-radius:15px;width:80%;height:50px}#submitted[_ngcontent-%COMP%]{width:40px;height:27px;margin:auto auto 25px}#thank-you[_ngcontent-%COMP%]{font-size:20px;font-weight:bolder;margin-top:25px}"]}),e})();const eo={PlanOfCare:{header:!0,title:"Plan Of Care",searchEnabled:!1,primaryAction:{title:"Save",permissions:[],enabled:!0},secondaryAction:{},multiAction:{},showTenantToggle:!1},PlanOfCareTimeline:{header:!0,title:"Plan Of Care",searchEnabled:!1,primaryAction:{title:"Add PoC",permissions:[],enabled:!0},secondaryAction:{},multiAction:{}},EpisodeBillingRate:{header:!1,showTenantToggle:!0,subTenantToggleMode:"SINGLE"}};var to=n("pe0G"),no=n("bA60"),io=n("oyxB"),so=n("xB20");const ao=function(){return["."]},oo=function(){return{tab:"history"}};function lo(e,t){1&e&&(m.Xb(0,"a",17),m.Xc(1,"History"),m.Wb()),2&e&&m.rc("routerLink",m.xc(3,ao))("queryParams",m.xc(4,oo))("replaceUrl",!0)}function ro(e,t){if(1&e){const e=m.Yb();m.Xb(0,"nz-timeline-item"),m.Xb(1,"app-plan-of-care-details",18),m.ec("refresh",function(){return m.Lc(e),m.ic().getPlanOfCare()}),m.Wb(),m.Sb(2,"br"),m.Wb()}if(2&e){const e=t.$implicit;m.Db(1),m.rc("planOfCare",e)}}const co=function(){return{tab:"assessments"}};function bo(e,t){1&e&&(m.Xb(0,"a",17),m.Xc(1,"Assessments"),m.Wb()),2&e&&m.rc("routerLink",m.xc(3,ao))("queryParams",m.xc(4,co))("replaceUrl",!0)}function po(e,t){if(1&e&&(m.Xb(0,"nz-timeline-item"),m.Xb(1,"nz-descriptions",19),m.Xb(2,"nz-descriptions-item",20),m.Xc(3),m.Wb(),m.Xb(4,"nz-descriptions-item",20),m.Xc(5),m.Wb(),m.Xb(6,"nz-descriptions-item",20),m.Xc(7),m.jc(8,"date"),m.Wb(),m.Wb(),m.Sb(9,"br"),m.Wb()),2&e){const e=t.$implicit;m.Db(1),m.rc("nzTitle",null==e||null==e.schema?null:e.schema.title),m.Db(1),m.rc("nzTitle","Score"),m.Db(1),m.Zc(" ","SCORED_ASSESSMENT"===(null==e||null==e.schema?null:e.schema.type)?null==e?null:e.evaluatedScore:"NA"," "),m.Db(1),m.rc("nzTitle","Risk Category"),m.Db(1),m.Zc(" ","SCORED_ASSESSMENT"===(null==e||null==e.schema?null:e.schema.type)?null==e?null:e.identifiedRisk:"NA"," "),m.Db(1),m.rc("nzTitle","Date"),m.Db(1),m.Zc(" ",m.lc(8,7,null==e?null:e.assessedOn,"medium")," ")}}function uo(e,t){if(1&e&&(m.Xb(0,"nz-option",21),m.Xb(1,"strong",22),m.Xc(2),m.Wb(),m.Sb(3,"br"),m.Xb(4,"p",23),m.Xc(5),m.Wb(),m.Wb()),2&e){const e=t.$implicit,n=m.ic(2);m.rc("nzLabel",null==e?null:e.title)("nzValue",e),m.Db(2),m.Yc(null==e?null:e.title),m.Db(2),m.rc("nzType",(null==e?null:e.scheduledOn)<n.currentDate?"danger":"primary"),m.Db(1),m.Zc(" ",(null==e?null:e.scheduledOn)<n.currentDate?"Overdue":"Due Today"," ")}}function ho(e,t){if(1&e){const e=m.Yb();m.Vb(0),m.Xb(1,"h4",11),m.Xc(2,"Assigned Assessments"),m.Wb(),m.Sb(3,"nz-divider"),m.Xb(4,"div",3),m.Xb(5,"div",12),m.Xb(6,"nz-select",13),m.ec("ngModelChange",function(t){return m.Lc(e),m.ic().selectedForm=t}),m.Vc(7,uo,6,5,"nz-option",14),m.Wb(),m.Wb(),m.Xb(8,"div",15),m.Xb(9,"button",16),m.ec("click",function(){m.Lc(e);const t=m.ic();return t.showFormFiller(t.form)}),m.Xc(10," Assess "),m.Wb(),m.Wb(),m.Wb(),m.Sb(11,"br"),m.Sb(12,"br"),m.Ub()}if(2&e){const e=m.ic();m.Db(6),m.rc("ngModel",e.selectedForm),m.Db(1),m.rc("ngForOf",e.assessments),m.Db(2),m.rc("disabled",!e.selectedForm)}}function go(e,t){if(1&e&&(m.Xb(0,"nz-option",21),m.Xb(1,"strong",22),m.Xc(2),m.Wb(),m.Wb()),2&e){const e=t.$implicit;m.rc("nzLabel",null==e?null:e.title)("nzValue",e),m.Db(2),m.Yc(null==e?null:e.title)}}let fo=(()=>{class e extends h.a{constructor(e,t,n,i,s,a,o){super(),this._router=e,this._domSanitizer=t,this._formsService=n,this._activateRoute=i,this._planOfCareService=s,this._actionItemsService=a,this._dataSharingService=o,this.rootURL=gt.g.webFormRootURL;const l=this._activateRoute.snapshot.queryParamMap.get("patientName");this._routeHelperService.setTitleForRoute(`${l} | Plan of Care`),this._routeHelperService.isPrimaryActionTriggered().pipe(Object(g.a)(e=>!!e),Object(f.a)(this.unsubscribed)).subscribe(()=>{this.addPlanOfCare()})}onMessage(e){var t,n;(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.canClose)&&(null===(n=null==e?void 0:e.data)||void 0===n?void 0:n.success)&&this.closeWebForm()}ngOnInit(){this.getPlanOfCare(),this.getAssessments(),this.fetchFormBlueprints(),this.fetchFormActionItems()}getPlanOfCare(){this._planOfCareService.fetchPlanOfCare(this._activateRoute.snapshot.params.patientId).subscribe(e=>{this.planOfCare=e})}addPlanOfCare(){this._router.navigate([`episodes/plan-of-care/${this._activateRoute.snapshot.params.patientId}/${this._activateRoute.snapshot.params.episodeId}`])}getAssessments(){this._formsService.getPatientEvalForms(this._activateRoute.snapshot.params.patientId,0,999999).subscribe(e=>{var t,n;this.forms=null===(n=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.answers)||void 0===n?void 0:n.obj,this.getDirectForms()})}getDirectForms(){this._formsService.getPatientDirectForms(this._activateRoute.snapshot.params.patientId,0,10).subscribe(e=>{var t,n;this.forms=[...this.forms,...null===(n=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.answers)||void 0===n?void 0:n.obj],this.forms=this.forms.sort((e,t)=>{var n,i;return(null===(n=new Date(null==t?void 0:t.assessedOn))||void 0===n?void 0:n.getTime())-(null===(i=new Date(null==e?void 0:e.assessedOn))||void 0===i?void 0:i.getTime())})})}fetchFormBlueprints(){this._formsService.getFormsWithBody({phq9:!0,gad7:!0},0,9999999,"").subscribe(e=>{var t,n,i;(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.forms)&&(this.formBlueprints=null===(i=null===(n=null==e?void 0:e.data)||void 0===n?void 0:n.forms)||void 0===i?void 0:i.obj)})}fetchFormActionItems(){this._formsService.fetchFormActionItemsForPatient(this._activateRoute.snapshot.params.patientId).subscribe(e=>{(null==e?void 0:e.length)&&(null==e||e.forEach(e=>{e.parameters=JSON.parse(null==e?void 0:e.parameters),(null==e?void 0:e.scheduledOn)||(e.scheduledOn=new Date(null==e?void 0:e.scheduledAt).setHours(23))}),this.assessments=e)})}showFormFiller(){var e,t,n,i,s;if(!this.selectedForm)return;const a=this._activateRoute.snapshot.params.patientId,o=this._activateRoute.snapshot.queryParams.patientName,l=localStorage.getItem("sessionToken"),r=`${this.rootURL}web-form/${null===(t=null===(e=this.selectedForm)||void 0===e?void 0:e.parameters)||void 0===t?void 0:t.formBlueprintId}/${l}/${a}/${null===(n=this.selectedForm)||void 0===n?void 0:n.id}?source=portal&sourceType=${null===(s=null===(i=this.selectedForm)||void 0===i?void 0:i.parentType)||void 0===s?void 0:s.toLowerCase()}`,c=this._domSanitizer.bypassSecurityTrustResourceUrl(r);this._dataSharingService.initiatePatientTrigger({patientId:a,patientName:o,url:c})}closeWebForm(){this.forms=[],setTimeout(()=>{this.getAssessments(),this.fetchFormActionItems(),this.selectedForm=void 0,this.selectedFormBlueprint=void 0},2e3)}assignOnDemandForm(){var e;this.selectedFormBlueprint&&this._formsService.assignOnDemandForm(null===(e=this.selectedFormBlueprint)||void 0===e?void 0:e._id,this._activateRoute.snapshot.params.patientId).subscribe(e=>{var t,n,i,s;this.selectedForm=null==e?void 0:e.data,this.selectedForm.parameters=JSON.parse(null===(t=this.selectedForm)||void 0===t?void 0:t.parameters),(null===(n=this.selectedForm)||void 0===n?void 0:n.scheduledOn)||(this.selectedForm.scheduledOn=new Date(null===(i=this.selectedForm)||void 0===i?void 0:i.scheduledAt).setHours(23)),this._actionItemsService.archiveActionItem(null===(s=this.selectedForm)||void 0===s?void 0:s.id).subscribe(),this.showFormFiller()})}}return e.\u0275fac=function(t){return new(t||e)(m.Rb(C.g),m.Rb(Dt.b),m.Rb(to.a),m.Rb(C.a),m.Rb(a.a),m.Rb(no.a),m.Rb(H.a))},e.\u0275cmp=m.Lb({type:e,selectors:[["app-timeline"]],hostBindings:function(e,t){1&e&&m.ec("message",function(e){return t.onMessage(e)},!1,m.Kc)},features:[m.Ab],decls:34,vars:6,consts:[["nzLinkRouter",""],["nz-tab-link","","queryParamsHandling","merge",3,"routerLink","queryParams","replaceUrl",4,"nzTabLink"],[1,"container"],["nz-row","","nzGutter","16"],["nz-col","","nzSpan","22"],["nzBorderless","","id","timeline"],[4,"ngFor","ngForOf"],["nz-col","","nzSpan","16"],["nzBorderless",""],["nz-col","","nzSpan","8"],[4,"ngIf"],["nz-typography",""],["nz-col","","nzSpan","18"],["nzPlaceHolder","Select an assessment form","nzAllowClear","",3,"ngModel","ngModelChange"],["nzCustomContent","",3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["nz-col","","nzSpan","4"],["nz-button","","nzType","primary",3,"disabled","click"],["nz-tab-link","","queryParamsHandling","merge",3,"routerLink","queryParams","replaceUrl"],[3,"planOfCare","refresh"],["nzBordered","","nzSize","small",3,"nzTitle"],[3,"nzTitle"],["nzCustomContent","",3,"nzLabel","nzValue"],["nz-typography","","nzType","secondary"],["nz-typography","",3,"nzType"]],template:function(e,t){1&e&&(m.Xb(0,"nz-tabset",0),m.Xb(1,"nz-tab"),m.Vc(2,lo,2,5,"a",1),m.Xb(3,"div",2),m.Xb(4,"div",3),m.Xb(5,"div",4),m.Xb(6,"nz-card",5),m.Xb(7,"nz-timeline"),m.Vc(8,ro,3,1,"nz-timeline-item",6),m.Wb(),m.Wb(),m.Wb(),m.Wb(),m.Wb(),m.Wb(),m.Xb(9,"nz-tab"),m.Vc(10,bo,2,5,"a",1),m.Xb(11,"div",2),m.Xb(12,"div",3),m.Xb(13,"div",7),m.Xb(14,"nz-card",8),m.Xb(15,"h3"),m.Xc(16,"Screenings and Assessments"),m.Wb(),m.Sb(17,"nz-divider"),m.Xb(18,"nz-timeline"),m.Vc(19,po,10,10,"nz-timeline-item",6),m.Wb(),m.Wb(),m.Wb(),m.Xb(20,"div",9),m.Xb(21,"nz-card",8),m.Vc(22,ho,13,3,"ng-container",10),m.Vb(23),m.Xb(24,"h4",11),m.Xc(25,"On-Demand Assessments"),m.Wb(),m.Sb(26,"nz-divider"),m.Xb(27,"div",3),m.Xb(28,"div",12),m.Xb(29,"nz-select",13),m.ec("ngModelChange",function(e){return t.selectedFormBlueprint=e}),m.Vc(30,go,3,3,"nz-option",14),m.Wb(),m.Wb(),m.Xb(31,"div",15),m.Xb(32,"button",16),m.ec("click",function(){return t.assignOnDemandForm()}),m.Xc(33," Assess "),m.Wb(),m.Wb(),m.Wb(),m.Ub(),m.Wb(),m.Wb(),m.Wb(),m.Wb(),m.Wb(),m.Wb()),2&e&&(m.Db(8),m.rc("ngForOf",t.planOfCare),m.Db(11),m.rc("ngForOf",t.forms),m.Db(3),m.rc("ngIf",null==t.assessments?null:t.assessments.length),m.Db(7),m.rc("ngModel",t.selectedFormBlueprint),m.Db(1),m.rc("ngForOf",t.formBlueprints),m.Db(2),m.rc("disabled",!t.selectedFormBlueprint))},directives:[io.d,io.a,io.c,O.c,O.a,I.a,Ci.a,s.p,y.a,s.q,T.a,z.d,c.u,c.x,mt.a,Ct.a,A.a,io.b,C.j,Ci.b,bs.a,so.a,so.b,z.a],pipes:[s.e],styles:["nz-card[_ngcontent-%COMP%]{border-radius:5px;min-height:50vh}#timeline[_ngcontent-%COMP%]{padding-top:20px}[_nghost-%COMP%]     .ant-timeline-item-content{margin-left:40px}a[_ngcontent-%COMP%]{color:var(--light-black)}#assessments[_ngcontent-%COMP%]{background-color:var(--neutral-color)}[_nghost-%COMP%]     .ant-descriptions-item-label{font-weight:700}"]}),e})();var vo=n("Kj3r"),mo=n("/uUt"),Co=n("eIep");let Do=(()=>{class e{constructor(){this.serviceCodes=Ps.b}transform(e){const t=this.serviceCodes.find(t=>t.cptCode===e);return null==t?"N/A":`${t.label} (CPT Code - ${t.value})`}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=m.Qb({name:"cptCode",type:e,pure:!1}),e})();var So=n("b1TM"),Eo=function(e){return e.ADD="add",e.REMOVE="remove",e.REPLACE="replace",e}({});class Oo{}var Io=n("h51P"),_o=n("2sp+"),Xo=n("XNiG");const To=(e,t)=>{null==t||t.setValue({streetAddress:e.line1,streetAddress2:e.line2,city:e.city,state:e.state,zipCode:e.zipCode,country:e.country})},No=e=>{var t,n,i,s,a,o,l,r,c,d,b,p,u,h,g,f,v,m,C,D;return{line1:null===(n=null===(t=null==e?void 0:e.controls)||void 0===t?void 0:t.streetAddress)||void 0===n?void 0:n.value,line2:null===(s=null===(i=null==e?void 0:e.controls)||void 0===i?void 0:i.streetAddress2)||void 0===s?void 0:s.value,city:null===(o=null===(a=null==e?void 0:e.controls)||void 0===a?void 0:a.city)||void 0===o?void 0:o.value,state:null===(r=null===(l=null==e?void 0:e.controls)||void 0===l?void 0:l.state)||void 0===r?void 0:r.value,country:null===(d=null===(c=null==e?void 0:e.controls)||void 0===c?void 0:c.country)||void 0===d?void 0:d.value,pin:null===(p=null===(b=null==e?void 0:e.controls)||void 0===b?void 0:b.zipCode)||void 0===p?void 0:p.value,zipCode:null===(h=null===(u=null==e?void 0:e.controls)||void 0===u?void 0:u.zipCode)||void 0===h?void 0:h.value,poBox:null===(f=null===(g=null==e?void 0:e.controls)||void 0===g?void 0:g.poBox)||void 0===f?void 0:f.value,lat:null===(m=null===(v=null==e?void 0:e.controls)||void 0===v?void 0:v.lat)||void 0===m?void 0:m.value,lng:null===(D=null===(C=null==e?void 0:e.controls)||void 0===C?void 0:C.lng)||void 0===D?void 0:D.value}};class zo{constructor(){this.fromAddress=new c.l({streetAddress:new c.i(null,[c.D.required]),streetAddress2:new c.i(null),city:new c.i(null),state:new c.i(null),zipCode:new c.i(null,[c.D.required]),country:new c.i(null)}),this.toAddress=new c.l({streetAddress:new c.i(null,[c.D.required]),streetAddress2:new c.i(null),city:new c.i(null),state:new c.i(null),zipCode:new c.i(null,[c.D.required]),country:new c.i(null)}),this.terms=new c.i(null,[c.D.required]),this.website=new c.i(null,[c.D.required]),this.email=new c.i(null,[c.D.required,c.D.email]),this.fromName=new c.i(null,[c.D.required])}}var Mo=n("pxUr"),yo=n("z4wI");const Ao=["searchFromAddress"],Po=["searchToAddress"];function Wo(e,t){if(1&e){const e=m.Yb();m.Vb(0),m.Xb(1,"div",32),m.Xb(2,"label",33),m.Xc(3),m.jc(4,"cptCode"),m.Wb(),m.Xb(5,"nz-input-number",34),m.ec("ngModelChange",function(n){m.Lc(e);const i=t.$implicit,s=m.ic().$implicit;return m.ic().rateUpdated(n,i.cptCode,s.id)}),m.Wb(),m.Wb(),m.Ub()}if(2&e){const e=t.$implicit,n=m.ic(2);m.Db(1),m.rc("nzXXl",8)("nzXl",8)("nzLg",12)("nzMd",12)("nzSm",12)("nzXs",24),m.Db(2),m.Yc(m.kc(4,12,e.cptCode)),m.Db(2),m.rc("ngModel",e.billingRate)("nzMin",0)("nzStep",1)("nzFormatter",n.formatterDollar)("nzParser",n.parserDollar)}}function Ro(e,t){if(1&e&&(m.Vb(0),m.Xb(1,"div",23),m.Xb(2,"nz-card",30),m.Xb(3,"div",31),m.Vc(4,Wo,6,14,"ng-container",29),m.Wb(),m.Wb(),m.Wb(),m.Ub()),2&e){const e=t.$implicit;m.Db(2),m.rc("nzTitle",e.name),m.Db(2),m.rc("ngForOf",null==e?null:e.serviceCodeRates)}}const wo=function(){return[16,48]};let Lo=(()=>{class e extends h.a{constructor(e,t,n,i,s,a){super(),this._dataSharingService=e,this._settingsService=t,this._notificationsService=n,this.mapsAPILoader=i,this._googleLocationService=s,this._fb=a,this.loading=!0,this.serviceCodes=Ps.b,this.saving=!1,this.addressFromZipCode$=new Xo.a,this.addressToZipCode$=new Xo.a,this.fromSearchAddress=!1,this.formatterDollar=e=>""===e?"$ 0":`$ ${e}`,this.parserDollar=e=>e.replace("$ ",""),this._routeHelperService.isPrimaryActionTriggered().pipe(Object(g.a)(e=>!!e),Object(f.a)(this.unsubscribed)).subscribe(()=>this.updateBillingData())}ngOnInit(){this.billingInfoForm=this._fb.group(new zo),this.getTenantConfigMap(),this._dataSharingService.onSubTenantChange().pipe(Object(f.a)(this.unsubscribed)).subscribe(e=>{var t,n;if(this.loading=!0,null==e||null==e||0==e.length){const e=localStorage.getItem(v.a.REQUEST_TENANT_IDS).split(",")[0];this.tenantConfig=this.tenantConfigMap.get(e)}else this.tenantConfig=this.tenantConfigMap.get(e);null!=this.tenantConfig&&this._settingsService.getTenantSettings(null===(t=this.tenantConfig)||void 0===t?void 0:t.tenantName,null===(n=this.tenantConfig)||void 0===n?void 0:n.tenantId).subscribe(e=>{this.tenantConfig=e,this.episodeBlueprints=this.tenantConfig.episodeBlueprints,((e,t)=>{var n,i,s,a;null!=e&&null!=t&&(e.fromAddress&&To(e.fromAddress,t.controls.fromAddress),e.billToAddress&&To(e.billToAddress,t.controls.toAddress),null===(n=t.controls.terms)||void 0===n||n.setValue(e.terms),null===(i=t.controls.website)||void 0===i||i.setValue(e.website),null===(s=t.controls.email)||void 0===s||s.setValue(e.email),null===(a=t.controls.fromName)||void 0===a||a.setValue(e.fromName))})(this.tenantConfig.billingConfig,this.billingInfoForm),this.updateEpisodeBillingRates(),setTimeout(()=>this.searchAddress()),this.loading=!1})}),this.setupFetchLocationFromZipcode()}getTenantConfigMap(){this._dataSharingService.assignedTenantSettings.pipe(Object(f.a)(this.unsubscribed)).subscribe(e=>{this.tenantConfigMap=e})}updateEpisodeBillingRates(){var e;null===(e=this.episodeBlueprints)||void 0===e||e.forEach(e=>{var t,n;const i=new Map;null===(t=e.serviceCodeRates)||void 0===t||t.forEach(e=>i.set(e.cptCode,e.billingRate)),null===(n=e.enabledServiceCodes)||void 0===n||n.forEach(e=>{const t=this.serviceCodes.find(t=>t.value===e);t&&!i.has(t.cptCode)&&i.set(t.cptCode,0)});const s=[];i.forEach((e,t)=>s.push({cptCode:t,billingRate:e})),e.serviceCodeRates=s})}rateUpdated(e,t,n){var i;const s=this.episodeBlueprints.find(e=>e.id===n);null===(i=null==s?void 0:s.serviceCodeRates)||void 0===i||i.forEach(n=>{n.cptCode===t&&(n.billingRate=""===e?0:e)})}submit(){for(const e in this.billingInfoForm.controls){if("toAddress"===e||"fromAddress"===e)for(const t in this.billingInfoForm.controls[e].controls)this.billingInfoForm.controls[e].controls[t].markAsDirty(),this.billingInfoForm.controls[e].controls[t].updateValueAndValidity();this.billingInfoForm.controls[e].markAsDirty(),this.billingInfoForm.controls[e].updateValueAndValidity()}"VALID"===this.billingInfoForm.status&&this.updateBillingData()}updateBillingData(){this.saving=!0;const e=this.generateRequestObject(Eo.REPLACE);this._settingsService.postPatchRequest(this.tenantConfig.tenantId,e).subscribe(()=>{this.saving=!1,this._notificationsService.success("Billing data","Configuration Saved Successfully!"),this.ngOnInit()})}generateRequestObject(e){const t=new Array;return this.episodeBlueprints.forEach((n,i)=>{const s=new Oo;s.path="episode-blueprints/"+i,s.op=e.valueOf(),s.value=JSON.stringify(n),t.push(s)}),t.push(((e,t,n)=>{var i,s,a,o;const l=new Oo;return t.fromAddress=No(e.controls.fromAddress),t.billToAddress=No(e.controls.toAddress),t.email=null===(i=e.controls.email)||void 0===i?void 0:i.value,t.website=null===(s=e.controls.website)||void 0===s?void 0:s.value,t.terms=null===(a=e.controls.terms)||void 0===a?void 0:a.value,t.fromName=null===(o=e.controls.fromName)||void 0===o?void 0:o.value,l.path="billing-config",l.op=n.valueOf(),l.value=JSON.stringify(t),l})(this.billingInfoForm,this.tenantConfig.billingConfig,e)),t}setupFetchLocationFromZipcode(){this.addressFromZipCode$.pipe(Object(vo.a)(500),Object(mo.a)(),Object(g.a)(e=>(null==e?void 0:e.length)>4),Object(Co.a)(e=>this._googleLocationService.fetchLocationFromZipCode(e))).pipe(Object(f.a)(this.unsubscribed)).subscribe(e=>{var t,n;let i,s,a;0!=(null===(t=null==e?void 0:e.results)||void 0===t?void 0:t.length)&&(null===(n=null==e?void 0:e.results)||void 0===n||n.forEach(e=>{var t;null===(t=null==e?void 0:e.address_components)||void 0===t||t.forEach(e=>{var t,n,o;-1!==(null===(t=null==e?void 0:e.types)||void 0===t?void 0:t.findIndex(e=>"country"===e))&&(i=e.long_name),-1!==(null===(n=null==e?void 0:e.types)||void 0===n?void 0:n.findIndex(e=>"administrative_area_level_1"===e))&&(s=e.long_name),-1!==(null===(o=null==e?void 0:e.types)||void 0===o?void 0:o.findIndex(e=>"locality"===e))&&(a=e.long_name)})}),this.billingInfoForm.patchValue({fromAddress:{city:a,country:i,state:s}}))}),this.addressToZipCode$.pipe(Object(vo.a)(500),Object(mo.a)(),Object(g.a)(e=>(null==e?void 0:e.length)>4),Object(Co.a)(e=>this._googleLocationService.fetchLocationFromZipCode(e))).pipe(Object(f.a)(this.unsubscribed)).subscribe(e=>{var t,n;let i,s,a;0!=(null===(t=null==e?void 0:e.results)||void 0===t?void 0:t.length)&&(null===(n=null==e?void 0:e.results)||void 0===n||n.forEach(e=>{var t;null===(t=null==e?void 0:e.address_components)||void 0===t||t.forEach(e=>{var t,n,o;-1!==(null===(t=null==e?void 0:e.types)||void 0===t?void 0:t.findIndex(e=>"country"===e))&&(i=e.long_name),-1!==(null===(n=null==e?void 0:e.types)||void 0===n?void 0:n.findIndex(e=>"administrative_area_level_1"===e))&&(s=e.long_name),-1!==(null===(o=null==e?void 0:e.types)||void 0===o?void 0:o.findIndex(e=>"locality"===e))&&(a=e.long_name)})}),this.billingInfoForm.patchValue({toAddress:{city:a,country:i,state:s}}))})}searchFromZipCode(e){this.addressFromZipCode$.next(e)}searchToZipCode(e){this.addressToZipCode$.next(e)}searchAddress(){this.mapsAPILoader.load().then(()=>{var e,t;const n=new google.maps.places.Autocomplete(null===(e=this.searchToElementRef)||void 0===e?void 0:e.nativeElement),i=new google.maps.places.Autocomplete(null===(t=this.searchFromElementRef)||void 0===t?void 0:t.nativeElement);n.addListener("place_changed",()=>{const e=_o.a.mapAddress(n);this.fromSearchAddress=!0,["streetAddress","streetAddress2","city","state","country","zipCode","lat","lng"].forEach(t=>{var n,i,s;null===(s=null===(i=null===(n=this.billingInfoForm)||void 0===n?void 0:n.controls.toAddress)||void 0===i?void 0:i.controls[t])||void 0===s||s.patchValue(e[t],{emitEvent:!1})})}),i.addListener("place_changed",()=>{const e=_o.a.mapAddress(i);["streetAddress","streetAddress2","city","state","country","zipCode","lat","lng"].forEach(t=>{var n,i,s;null===(s=null===(i=null===(n=this.billingInfoForm)||void 0===n?void 0:n.controls.fromAddress)||void 0===i?void 0:i.controls[t])||void 0===s||s.patchValue(e[t],{emitEvent:!1})})})})}}return e.\u0275fac=function(t){return new(t||e)(m.Rb(H.a),m.Rb(So.a),m.Rb(D.b),m.Rb(Mo.b),m.Rb(Io.a),m.Rb(c.h))},e.\u0275cmp=m.Lb({type:e,selectors:[["app-episode-billing-rate"]],viewQuery:function(e,t){if(1&e&&(m.ed(Ao,1),m.ed(Po,1)),2&e){let e;m.Hc(e=m.fc())&&(t.searchFromElementRef=e.first),m.Hc(e=m.fc())&&(t.searchToElementRef=e.first)}},features:[m.Cb([Do]),m.Ab],decls:166,vars:93,consts:[["defaultTitle","Episode Billing Rate",3,"isSearchEnabled","isActionEnabled"],["nz-button","","nzType","primary","form","billingForm",3,"disabled"],[1,"container"],["nzTip","Loading data ...",3,"nzSpinning"],["id","billingForm","nz-form","","appScrollToFirstInvalid","",3,"formGroup","ngSubmit","keydown.enter"],["formGroupName","fromAddress",2,"margin-bottom","24px"],["nzTitle","From Address"],["nz-row","",3,"nzGutter"],["nz-col","","nzSpan","12"],["nz-row","","nzGutter","16"],[3,"nzErrorTip"],["formControlName","streetAddress","nz-input","","readonly","","onfocus","this.removeAttribute('readonly')"],["searchFromAddress",""],["formControlName","streetAddress2","nz-input","","readonly","","onfocus","this.removeAttribute('readonly')"],[1,"divider"],["nz-col","","nzSpan","6"],["formControlName","zipCode","nz-input","","readonly","","onfocus","this.removeAttribute('readonly')",3,"ngModelChange"],["formControlName","country","nz-input","","readonly",""],["formControlName","state","nz-input","","readonly",""],["formControlName","city","nz-input","","readonly",""],["formGroupName","toAddress",2,"margin-bottom","24px"],["nzTitle","Bill To Address"],["searchToAddress",""],[2,"margin-bottom","24px"],["nzTitle","Others"],["formControlName","terms","nz-input","","readonly","","onfocus","this.removeAttribute('readonly')"],["formControlName","fromName","nz-input","","readonly","","onfocus","this.removeAttribute('readonly')"],["formControlName","email","nz-input","","readonly","","onfocus","this.removeAttribute('readonly')"],["formControlName","website","nz-input","","readonly","","onfocus","this.removeAttribute('readonly')"],[4,"ngFor","ngForOf"],[3,"nzTitle"],["nz-row","","nzSpan","24","nzGutter","32"],["nz-col","",2,"margin-bottom","16px",3,"nzXXl","nzXl","nzLg","nzMd","nzSm","nzXs"],[1,"cpt-label"],[3,"ngModel","nzMin","nzStep","nzFormatter","nzParser","ngModelChange"]],template:function(e,t){1&e&&(m.Xb(0,"app-header",0),m.Xb(1,"button",1),m.Xc(2),m.jc(3,"translate"),m.Wb(),m.Wb(),m.Xb(4,"div",2),m.Xb(5,"nz-spin",3),m.Xb(6,"form",4),m.ec("ngSubmit",function(){return t.submit()})("keydown.enter",function(e){return e.preventDefault()}),m.Xb(7,"div",5),m.Xb(8,"nz-card",6),m.Xb(9,"div",7),m.Xb(10,"div",8),m.Xb(11,"label"),m.Xc(12),m.jc(13,"translate"),m.Wb(),m.Wb(),m.Xb(14,"div",8),m.Xb(15,"label"),m.Xc(16),m.jc(17,"translate"),m.Wb(),m.Wb(),m.Wb(),m.Xb(18,"div",9),m.Xb(19,"div",8),m.Xb(20,"nz-form-item"),m.Xb(21,"nz-form-control",10),m.jc(22,"translate"),m.Sb(23,"input",11,12),m.Wb(),m.Wb(),m.Wb(),m.Xb(25,"div",8),m.Xb(26,"nz-form-item"),m.Xb(27,"nz-form-control"),m.Sb(28,"input",13),m.Wb(),m.Wb(),m.Wb(),m.Wb(),m.Sb(29,"div",14),m.Xb(30,"div",9),m.Xb(31,"div",15),m.Xb(32,"label"),m.Xc(33),m.jc(34,"translate"),m.Wb(),m.Wb(),m.Xb(35,"div",15),m.Xb(36,"label"),m.Xc(37),m.jc(38,"translate"),m.Wb(),m.Wb(),m.Xb(39,"div",15),m.Xb(40,"label"),m.Xc(41),m.jc(42,"translate"),m.Wb(),m.Wb(),m.Xb(43,"div",15),m.Xb(44,"label"),m.Xc(45),m.jc(46,"translate"),m.Wb(),m.Wb(),m.Wb(),m.Xb(47,"div",9),m.Xb(48,"div",15),m.Xb(49,"nz-form-item"),m.Xb(50,"nz-form-control",10),m.jc(51,"translate"),m.Xb(52,"input",16),m.ec("ngModelChange",function(e){return t.searchFromZipCode(e)}),m.Wb(),m.Wb(),m.Wb(),m.Wb(),m.Xb(53,"div",15),m.Xb(54,"nz-form-item"),m.Xb(55,"nz-form-control",10),m.jc(56,"translate"),m.Sb(57,"input",17),m.Wb(),m.Wb(),m.Wb(),m.Xb(58,"div",15),m.Xb(59,"nz-form-item"),m.Xb(60,"nz-form-control",10),m.jc(61,"translate"),m.Sb(62,"input",18),m.Wb(),m.Wb(),m.Wb(),m.Xb(63,"div",15),m.Xb(64,"nz-form-item"),m.Xb(65,"nz-form-control",10),m.jc(66,"translate"),m.Sb(67,"input",19),m.Wb(),m.Wb(),m.Wb(),m.Wb(),m.Wb(),m.Wb(),m.Xb(68,"div",20),m.Xb(69,"nz-card",21),m.Xb(70,"div",7),m.Xb(71,"div",8),m.Xb(72,"label"),m.Xc(73),m.jc(74,"translate"),m.Wb(),m.Wb(),m.Xb(75,"div",8),m.Xb(76,"label"),m.Xc(77),m.jc(78,"translate"),m.Wb(),m.Wb(),m.Wb(),m.Xb(79,"div",9),m.Xb(80,"div",8),m.Xb(81,"nz-form-item"),m.Xb(82,"nz-form-control",10),m.jc(83,"translate"),m.Sb(84,"input",11,22),m.Wb(),m.Wb(),m.Wb(),m.Xb(86,"div",8),m.Xb(87,"nz-form-item"),m.Xb(88,"nz-form-control"),m.Sb(89,"input",13),m.Wb(),m.Wb(),m.Wb(),m.Wb(),m.Sb(90,"div",14),m.Xb(91,"div",9),m.Xb(92,"div",15),m.Xb(93,"label"),m.Xc(94),m.jc(95,"translate"),m.Wb(),m.Wb(),m.Xb(96,"div",15),m.Xb(97,"label"),m.Xc(98),m.jc(99,"translate"),m.Wb(),m.Wb(),m.Xb(100,"div",15),m.Xb(101,"label"),m.Xc(102),m.jc(103,"translate"),m.Wb(),m.Wb(),m.Xb(104,"div",15),m.Xb(105,"label"),m.Xc(106),m.jc(107,"translate"),m.Wb(),m.Wb(),m.Wb(),m.Xb(108,"div",9),m.Xb(109,"div",15),m.Xb(110,"nz-form-item"),m.Xb(111,"nz-form-control",10),m.jc(112,"translate"),m.Xb(113,"input",16),m.ec("ngModelChange",function(e){return t.searchToZipCode(e)}),m.Wb(),m.Wb(),m.Wb(),m.Wb(),m.Xb(114,"div",15),m.Xb(115,"nz-form-item"),m.Xb(116,"nz-form-control",10),m.jc(117,"translate"),m.Sb(118,"input",17),m.Wb(),m.Wb(),m.Wb(),m.Xb(119,"div",15),m.Xb(120,"nz-form-item"),m.Xb(121,"nz-form-control",10),m.jc(122,"translate"),m.Sb(123,"input",18),m.Wb(),m.Wb(),m.Wb(),m.Xb(124,"div",15),m.Xb(125,"nz-form-item"),m.Xb(126,"nz-form-control",10),m.jc(127,"translate"),m.Sb(128,"input",19),m.Wb(),m.Wb(),m.Wb(),m.Wb(),m.Wb(),m.Wb(),m.Xb(129,"div",23),m.Xb(130,"nz-card",24),m.Xb(131,"div",7),m.Xb(132,"div",15),m.Xb(133,"label"),m.Xc(134,"Terms*"),m.Wb(),m.Wb(),m.Xb(135,"div",15),m.Xb(136,"label"),m.Xc(137,"From Name*"),m.Wb(),m.Wb(),m.Xb(138,"div",15),m.Xb(139,"label"),m.Xc(140,"From Email*"),m.Wb(),m.Wb(),m.Xb(141,"div",15),m.Xb(142,"label"),m.Xc(143,"From Website*"),m.Wb(),m.Wb(),m.Wb(),m.Xb(144,"div",9),m.Xb(145,"div",15),m.Xb(146,"nz-form-item"),m.Xb(147,"nz-form-control",10),m.jc(148,"translate"),m.Sb(149,"input",25),m.Wb(),m.Wb(),m.Wb(),m.Xb(150,"div",15),m.Xb(151,"nz-form-item"),m.Xb(152,"nz-form-control",10),m.jc(153,"translate"),m.Sb(154,"input",26),m.Wb(),m.Wb(),m.Wb(),m.Xb(155,"div",15),m.Xb(156,"nz-form-item"),m.Xb(157,"nz-form-control",10),m.jc(158,"translate"),m.Sb(159,"input",27),m.Wb(),m.Wb(),m.Wb(),m.Xb(160,"div",15),m.Xb(161,"nz-form-item"),m.Xb(162,"nz-form-control",10),m.jc(163,"translate"),m.Sb(164,"input",28),m.Wb(),m.Wb(),m.Wb(),m.Wb(),m.Wb(),m.Wb(),m.Wb(),m.Vc(165,Ro,5,2,"ng-container",29),m.Wb(),m.Wb()),2&e&&(m.rc("isSearchEnabled",!1)("isActionEnabled",!1),m.Db(1),m.rc("disabled","PENDING"===(null==t.billingInfoForm?null:t.billingInfoForm.status)),m.Db(1),m.Zc(" ",m.kc(3,36,"COMMON.SAVE")," "),m.Db(3),m.rc("nzSpinning",t.loading),m.Db(1),m.rc("formGroup",t.billingInfoForm),m.Db(3),m.rc("nzGutter",m.xc(90,wo)),m.Db(3),m.Zc("",m.kc(13,38,"SITE.ADDRESS_LINE_1")," *"),m.Db(4),m.Yc(m.kc(17,40,"COMMON.LINE_2")),m.Db(5),m.sc("nzErrorTip",m.kc(22,42,"COMMON.REQUIRED")),m.Db(12),m.Zc("",m.kc(34,44,"ZIP_CODE")," *"),m.Db(4),m.Yc(m.kc(38,46,"COMMON.COUNTRY")),m.Db(4),m.Yc(m.kc(42,48,"COMMON.STATE")),m.Db(4),m.Yc(m.kc(46,50,"COMMON.CITY")),m.Db(5),m.sc("nzErrorTip",m.kc(51,52,"COMMON.REQUIRED")),m.Db(5),m.sc("nzErrorTip",m.kc(56,54,"COMMON.REQUIRED")),m.Db(5),m.sc("nzErrorTip",m.kc(61,56,"COMMON.REQUIRED")),m.Db(5),m.sc("nzErrorTip",m.kc(66,58,"COMMON.REQUIRED")),m.Db(5),m.rc("nzGutter",m.xc(91,wo)),m.Db(3),m.Zc("",m.kc(74,60,"SITE.ADDRESS_LINE_1")," *"),m.Db(4),m.Yc(m.kc(78,62,"COMMON.LINE_2")),m.Db(5),m.sc("nzErrorTip",m.kc(83,64,"COMMON.REQUIRED")),m.Db(12),m.Zc("",m.kc(95,66,"ZIP_CODE")," *"),m.Db(4),m.Yc(m.kc(99,68,"COMMON.COUNTRY")),m.Db(4),m.Yc(m.kc(103,70,"COMMON.STATE")),m.Db(4),m.Yc(m.kc(107,72,"COMMON.CITY")),m.Db(5),m.sc("nzErrorTip",m.kc(112,74,"COMMON.REQUIRED")),m.Db(5),m.sc("nzErrorTip",m.kc(117,76,"COMMON.REQUIRED")),m.Db(5),m.sc("nzErrorTip",m.kc(122,78,"COMMON.REQUIRED")),m.Db(5),m.sc("nzErrorTip",m.kc(127,80,"COMMON.REQUIRED")),m.Db(5),m.rc("nzGutter",m.xc(92,wo)),m.Db(16),m.sc("nzErrorTip",m.kc(148,82,"COMMON.REQUIRED")),m.Db(5),m.sc("nzErrorTip",m.kc(153,84,"COMMON.REQUIRED")),m.Db(5),m.sc("nzErrorTip",m.kc(158,86,"COMMON.REQUIRED")),m.Db(5),m.sc("nzErrorTip",m.kc(163,88,"COMMON.REQUIRED")),m.Db(3),m.rc("ngForOf",t.episodeBlueprints))},directives:[we.a,mt.a,Ct.a,A.a,ae.a,c.F,c.v,X.b,_.a,c.m,c.n,I.a,O.c,O.a,X.c,X.a,c.d,N.b,c.u,c.k,s.p,yo.a,c.x],pipes:[Q.a,Do],styles:["label[_ngcontent-%COMP%]{font-size:12px;font-weight:900}.cpt-label[_ngcontent-%COMP%]{line-height:1.2em;display:block;max-height:2.4em;min-height:2.4em;overflow:hidden}nz-input-number[_ngcontent-%COMP%]{width:100%;text-align:left}"]}),e})();var xo=n("isHH"),ko=n("iSMj"),Vo=n("g9KO"),Uo=n("/Tr7");function Fo(e,t){if(null==e)throw new TypeError("assign requires that input parameter not be null or undefined");for(var n in t=t||{})t.hasOwnProperty(n)&&(e[n]=t[n]);return e}var jo=n("Ib5w"),Yo=n("JCDJ"),Go=n("3REe"),Bo=n("/h9T"),Ho=n("Szzx"),$o=n("jIYg");function Zo(e,t,n){Object($o.a)(2,arguments);var i=n||{},s=i.locale,a=s&&s.options&&s.options.weekStartsOn,o=null==a?0:Object(Bo.a)(a),l=null==i.weekStartsOn?o:Object(Bo.a)(i.weekStartsOn);if(!(l>=0&&l<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var r=Object(Uo.a)(e),c=Object(Bo.a)(t),d=r.getUTCDay(),b=c%7,p=(b+7)%7,u=(p<l?7:0)+c-d;return r.setUTCDate(r.getUTCDate()+u),r}var qo=n("lgZR"),Ko=n("ErpD"),Qo=n("tpup"),Jo=n("1vjI"),el=/^(1[0-2]|0?\d)/,tl=/^(3[0-1]|[0-2]?\d)/,nl=/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,il=/^(5[0-3]|[0-4]?\d)/,sl=/^(2[0-3]|[0-1]?\d)/,al=/^(2[0-4]|[0-1]?\d)/,ol=/^(1[0-1]|0?\d)/,ll=/^(1[0-2]|0?\d)/,rl=/^[0-5]?\d/,cl=/^[0-5]?\d/,dl=/^\d/,bl=/^\d{1,2}/,pl=/^\d{1,3}/,ul=/^\d{1,4}/,hl=/^-?\d+/,gl=/^-?\d/,fl=/^-?\d{1,2}/,vl=/^-?\d{1,3}/,ml=/^-?\d{1,4}/,Cl=/^([+-])(\d{2})(\d{2})?|Z/,Dl=/^([+-])(\d{2})(\d{2})|Z/,Sl=/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,El=/^([+-])(\d{2}):(\d{2})|Z/,Ol=/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/;function Il(e,t,n){var i=t.match(e);if(!i)return null;var s=parseInt(i[0],10);return{value:n?n(s):s,rest:t.slice(i[0].length)}}function _l(e,t){var n=t.match(e);return n?"Z"===n[0]?{value:0,rest:t.slice(1)}:{value:("+"===n[1]?1:-1)*(36e5*(n[2]?parseInt(n[2],10):0)+6e4*(n[3]?parseInt(n[3],10):0)+1e3*(n[5]?parseInt(n[5],10):0)),rest:t.slice(n[0].length)}:null}function Xl(e,t){return Il(hl,e,t)}function Tl(e,t,n){switch(e){case 1:return Il(dl,t,n);case 2:return Il(bl,t,n);case 3:return Il(pl,t,n);case 4:return Il(ul,t,n);default:return Il(new RegExp("^\\d{1,"+e+"}"),t,n)}}function Nl(e,t,n){switch(e){case 1:return Il(gl,t,n);case 2:return Il(fl,t,n);case 3:return Il(vl,t,n);case 4:return Il(ml,t,n);default:return Il(new RegExp("^-?\\d{1,"+e+"}"),t,n)}}function zl(e){switch(e){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function Ml(e,t){var n,i=t>0,s=i?t:1-t;if(s<=50)n=e||100;else{var a=s+50;n=e+100*Math.floor(a/100)-(e>=a%100?100:0)}return i?n:1-n}var yl=[31,28,31,30,31,30,31,31,30,31,30,31],Al=[31,29,31,30,31,30,31,31,30,31,30,31];function Pl(e){return e%400==0||e%4==0&&e%100!=0}var Wl={G:{priority:140,parse:function(e,t,n,i){switch(t){case"G":case"GG":case"GGG":return n.era(e,{width:"abbreviated"})||n.era(e,{width:"narrow"});case"GGGGG":return n.era(e,{width:"narrow"});case"GGGG":default:return n.era(e,{width:"wide"})||n.era(e,{width:"abbreviated"})||n.era(e,{width:"narrow"})}},set:function(e,t,n,i){return t.era=n,e.setUTCFullYear(n,0,1),e.setUTCHours(0,0,0,0),e},incompatibleTokens:["R","u","t","T"]},y:{priority:130,parse:function(e,t,n,i){var s=function(e){return{year:e,isTwoDigitYear:"yy"===t}};switch(t){case"y":return Tl(4,e,s);case"yo":return n.ordinalNumber(e,{unit:"year",valueCallback:s});default:return Tl(t.length,e,s)}},validate:function(e,t,n){return t.isTwoDigitYear||t.year>0},set:function(e,t,n,i){var s=e.getUTCFullYear();if(n.isTwoDigitYear){var a=Ml(n.year,s);return e.setUTCFullYear(a,0,1),e.setUTCHours(0,0,0,0),e}return e.setUTCFullYear("era"in t&&1!==t.era?1-n.year:n.year,0,1),e.setUTCHours(0,0,0,0),e},incompatibleTokens:["Y","R","u","w","I","i","e","c","t","T"]},Y:{priority:130,parse:function(e,t,n,i){var s=function(e){return{year:e,isTwoDigitYear:"YY"===t}};switch(t){case"Y":return Tl(4,e,s);case"Yo":return n.ordinalNumber(e,{unit:"year",valueCallback:s});default:return Tl(t.length,e,s)}},validate:function(e,t,n){return t.isTwoDigitYear||t.year>0},set:function(e,t,n,i){var s=Object(Ho.a)(e,i);if(n.isTwoDigitYear){var a=Ml(n.year,s);return e.setUTCFullYear(a,0,i.firstWeekContainsDate),e.setUTCHours(0,0,0,0),Object(Jo.a)(e,i)}return e.setUTCFullYear("era"in t&&1!==t.era?1-n.year:n.year,0,i.firstWeekContainsDate),e.setUTCHours(0,0,0,0),Object(Jo.a)(e,i)},incompatibleTokens:["y","R","u","Q","q","M","L","I","d","D","i","t","T"]},R:{priority:130,parse:function(e,t,n,i){return Nl("R"===t?4:t.length,e)},set:function(e,t,n,i){var s=new Date(0);return s.setUTCFullYear(n,0,4),s.setUTCHours(0,0,0,0),Object(Qo.a)(s)},incompatibleTokens:["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]},u:{priority:130,parse:function(e,t,n,i){return Nl("u"===t?4:t.length,e)},set:function(e,t,n,i){return e.setUTCFullYear(n,0,1),e.setUTCHours(0,0,0,0),e},incompatibleTokens:["G","y","Y","R","w","I","i","e","c","t","T"]},Q:{priority:120,parse:function(e,t,n,i){switch(t){case"Q":case"QQ":return Tl(t.length,e);case"Qo":return n.ordinalNumber(e,{unit:"quarter"});case"QQQ":return n.quarter(e,{width:"abbreviated",context:"formatting"})||n.quarter(e,{width:"narrow",context:"formatting"});case"QQQQQ":return n.quarter(e,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(e,{width:"wide",context:"formatting"})||n.quarter(e,{width:"abbreviated",context:"formatting"})||n.quarter(e,{width:"narrow",context:"formatting"})}},validate:function(e,t,n){return t>=1&&t<=4},set:function(e,t,n,i){return e.setUTCMonth(3*(n-1),1),e.setUTCHours(0,0,0,0),e},incompatibleTokens:["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]},q:{priority:120,parse:function(e,t,n,i){switch(t){case"q":case"qq":return Tl(t.length,e);case"qo":return n.ordinalNumber(e,{unit:"quarter"});case"qqq":return n.quarter(e,{width:"abbreviated",context:"standalone"})||n.quarter(e,{width:"narrow",context:"standalone"});case"qqqqq":return n.quarter(e,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(e,{width:"wide",context:"standalone"})||n.quarter(e,{width:"abbreviated",context:"standalone"})||n.quarter(e,{width:"narrow",context:"standalone"})}},validate:function(e,t,n){return t>=1&&t<=4},set:function(e,t,n,i){return e.setUTCMonth(3*(n-1),1),e.setUTCHours(0,0,0,0),e},incompatibleTokens:["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]},M:{priority:110,parse:function(e,t,n,i){var s=function(e){return e-1};switch(t){case"M":return Il(el,e,s);case"MM":return Tl(2,e,s);case"Mo":return n.ordinalNumber(e,{unit:"month",valueCallback:s});case"MMM":return n.month(e,{width:"abbreviated",context:"formatting"})||n.month(e,{width:"narrow",context:"formatting"});case"MMMMM":return n.month(e,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(e,{width:"wide",context:"formatting"})||n.month(e,{width:"abbreviated",context:"formatting"})||n.month(e,{width:"narrow",context:"formatting"})}},validate:function(e,t,n){return t>=0&&t<=11},set:function(e,t,n,i){return e.setUTCMonth(n,1),e.setUTCHours(0,0,0,0),e},incompatibleTokens:["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]},L:{priority:110,parse:function(e,t,n,i){var s=function(e){return e-1};switch(t){case"L":return Il(el,e,s);case"LL":return Tl(2,e,s);case"Lo":return n.ordinalNumber(e,{unit:"month",valueCallback:s});case"LLL":return n.month(e,{width:"abbreviated",context:"standalone"})||n.month(e,{width:"narrow",context:"standalone"});case"LLLLL":return n.month(e,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(e,{width:"wide",context:"standalone"})||n.month(e,{width:"abbreviated",context:"standalone"})||n.month(e,{width:"narrow",context:"standalone"})}},validate:function(e,t,n){return t>=0&&t<=11},set:function(e,t,n,i){return e.setUTCMonth(n,1),e.setUTCHours(0,0,0,0),e},incompatibleTokens:["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]},w:{priority:100,parse:function(e,t,n,i){switch(t){case"w":return Il(il,e);case"wo":return n.ordinalNumber(e,{unit:"week"});default:return Tl(t.length,e)}},validate:function(e,t,n){return t>=1&&t<=53},set:function(e,t,n,i){return Object(Jo.a)(function(e,t,n){Object($o.a)(2,arguments);var i=Object(Uo.a)(e),s=Object(Bo.a)(t),a=Object(Ko.a)(i,n)-s;return i.setUTCDate(i.getUTCDate()-7*a),i}(e,n,i),i)},incompatibleTokens:["y","R","u","q","Q","M","L","I","d","D","i","t","T"]},I:{priority:100,parse:function(e,t,n,i){switch(t){case"I":return Il(il,e);case"Io":return n.ordinalNumber(e,{unit:"week"});default:return Tl(t.length,e)}},validate:function(e,t,n){return t>=1&&t<=53},set:function(e,t,n,i){return Object(Qo.a)(function(e,t){Object($o.a)(2,arguments);var n=Object(Uo.a)(e),i=Object(Bo.a)(t),s=Object(qo.a)(n)-i;return n.setUTCDate(n.getUTCDate()-7*s),n}(e,n,i),i)},incompatibleTokens:["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]},d:{priority:90,subPriority:1,parse:function(e,t,n,i){switch(t){case"d":return Il(tl,e);case"do":return n.ordinalNumber(e,{unit:"date"});default:return Tl(t.length,e)}},validate:function(e,t,n){var i=Pl(e.getUTCFullYear()),s=e.getUTCMonth();return i?t>=1&&t<=Al[s]:t>=1&&t<=yl[s]},set:function(e,t,n,i){return e.setUTCDate(n),e.setUTCHours(0,0,0,0),e},incompatibleTokens:["Y","R","q","Q","w","I","D","i","e","c","t","T"]},D:{priority:90,subPriority:1,parse:function(e,t,n,i){switch(t){case"D":case"DD":return Il(nl,e);case"Do":return n.ordinalNumber(e,{unit:"date"});default:return Tl(t.length,e)}},validate:function(e,t,n){return Pl(e.getUTCFullYear())?t>=1&&t<=366:t>=1&&t<=365},set:function(e,t,n,i){return e.setUTCMonth(0,n),e.setUTCHours(0,0,0,0),e},incompatibleTokens:["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]},E:{priority:90,parse:function(e,t,n,i){switch(t){case"E":case"EE":case"EEE":return n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});case"EEEEE":return n.day(e,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});case"EEEE":default:return n.day(e,{width:"wide",context:"formatting"})||n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"})}},validate:function(e,t,n){return t>=0&&t<=6},set:function(e,t,n,i){return(e=Zo(e,n,i)).setUTCHours(0,0,0,0),e},incompatibleTokens:["D","i","e","c","t","T"]},e:{priority:90,parse:function(e,t,n,i){var s=function(e){var t=7*Math.floor((e-1)/7);return(e+i.weekStartsOn+6)%7+t};switch(t){case"e":case"ee":return Tl(t.length,e,s);case"eo":return n.ordinalNumber(e,{unit:"day",valueCallback:s});case"eee":return n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});case"eeeee":return n.day(e,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});case"eeee":default:return n.day(e,{width:"wide",context:"formatting"})||n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"})}},validate:function(e,t,n){return t>=0&&t<=6},set:function(e,t,n,i){return(e=Zo(e,n,i)).setUTCHours(0,0,0,0),e},incompatibleTokens:["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]},c:{priority:90,parse:function(e,t,n,i){var s=function(e){var t=7*Math.floor((e-1)/7);return(e+i.weekStartsOn+6)%7+t};switch(t){case"c":case"cc":return Tl(t.length,e,s);case"co":return n.ordinalNumber(e,{unit:"day",valueCallback:s});case"ccc":return n.day(e,{width:"abbreviated",context:"standalone"})||n.day(e,{width:"short",context:"standalone"})||n.day(e,{width:"narrow",context:"standalone"});case"ccccc":return n.day(e,{width:"narrow",context:"standalone"});case"cccccc":return n.day(e,{width:"short",context:"standalone"})||n.day(e,{width:"narrow",context:"standalone"});case"cccc":default:return n.day(e,{width:"wide",context:"standalone"})||n.day(e,{width:"abbreviated",context:"standalone"})||n.day(e,{width:"short",context:"standalone"})||n.day(e,{width:"narrow",context:"standalone"})}},validate:function(e,t,n){return t>=0&&t<=6},set:function(e,t,n,i){return(e=Zo(e,n,i)).setUTCHours(0,0,0,0),e},incompatibleTokens:["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]},i:{priority:90,parse:function(e,t,n,i){var s=function(e){return 0===e?7:e};switch(t){case"i":case"ii":return Tl(t.length,e);case"io":return n.ordinalNumber(e,{unit:"day"});case"iii":return n.day(e,{width:"abbreviated",context:"formatting",valueCallback:s})||n.day(e,{width:"short",context:"formatting",valueCallback:s})||n.day(e,{width:"narrow",context:"formatting",valueCallback:s});case"iiiii":return n.day(e,{width:"narrow",context:"formatting",valueCallback:s});case"iiiiii":return n.day(e,{width:"short",context:"formatting",valueCallback:s})||n.day(e,{width:"narrow",context:"formatting",valueCallback:s});case"iiii":default:return n.day(e,{width:"wide",context:"formatting",valueCallback:s})||n.day(e,{width:"abbreviated",context:"formatting",valueCallback:s})||n.day(e,{width:"short",context:"formatting",valueCallback:s})||n.day(e,{width:"narrow",context:"formatting",valueCallback:s})}},validate:function(e,t,n){return t>=1&&t<=7},set:function(e,t,n,i){return(e=function(e,t){Object($o.a)(2,arguments);var n=Object(Bo.a)(t);n%7==0&&(n-=7);var i=1,s=Object(Uo.a)(e),a=s.getUTCDay(),o=((n%7+7)%7<i?7:0)+n-a;return s.setUTCDate(s.getUTCDate()+o),s}(e,n,i)).setUTCHours(0,0,0,0),e},incompatibleTokens:["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]},a:{priority:80,parse:function(e,t,n,i){switch(t){case"a":case"aa":case"aaa":return n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"});case"aaaaa":return n.dayPeriod(e,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(e,{width:"wide",context:"formatting"})||n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"})}},set:function(e,t,n,i){return e.setUTCHours(zl(n),0,0,0),e},incompatibleTokens:["b","B","H","K","k","t","T"]},b:{priority:80,parse:function(e,t,n,i){switch(t){case"b":case"bb":case"bbb":return n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"});case"bbbbb":return n.dayPeriod(e,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(e,{width:"wide",context:"formatting"})||n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"})}},set:function(e,t,n,i){return e.setUTCHours(zl(n),0,0,0),e},incompatibleTokens:["a","B","H","K","k","t","T"]},B:{priority:80,parse:function(e,t,n,i){switch(t){case"B":case"BB":case"BBB":return n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"});case"BBBBB":return n.dayPeriod(e,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(e,{width:"wide",context:"formatting"})||n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"})}},set:function(e,t,n,i){return e.setUTCHours(zl(n),0,0,0),e},incompatibleTokens:["a","b","t","T"]},h:{priority:70,parse:function(e,t,n,i){switch(t){case"h":return Il(ll,e);case"ho":return n.ordinalNumber(e,{unit:"hour"});default:return Tl(t.length,e)}},validate:function(e,t,n){return t>=1&&t<=12},set:function(e,t,n,i){var s=e.getUTCHours()>=12;return e.setUTCHours(s&&n<12?n+12:s||12!==n?n:0,0,0,0),e},incompatibleTokens:["H","K","k","t","T"]},H:{priority:70,parse:function(e,t,n,i){switch(t){case"H":return Il(sl,e);case"Ho":return n.ordinalNumber(e,{unit:"hour"});default:return Tl(t.length,e)}},validate:function(e,t,n){return t>=0&&t<=23},set:function(e,t,n,i){return e.setUTCHours(n,0,0,0),e},incompatibleTokens:["a","b","h","K","k","t","T"]},K:{priority:70,parse:function(e,t,n,i){switch(t){case"K":return Il(ol,e);case"Ko":return n.ordinalNumber(e,{unit:"hour"});default:return Tl(t.length,e)}},validate:function(e,t,n){return t>=0&&t<=11},set:function(e,t,n,i){var s=e.getUTCHours()>=12;return e.setUTCHours(s&&n<12?n+12:n,0,0,0),e},incompatibleTokens:["a","b","h","H","k","t","T"]},k:{priority:70,parse:function(e,t,n,i){switch(t){case"k":return Il(al,e);case"ko":return n.ordinalNumber(e,{unit:"hour"});default:return Tl(t.length,e)}},validate:function(e,t,n){return t>=1&&t<=24},set:function(e,t,n,i){return e.setUTCHours(n<=24?n%24:n,0,0,0),e},incompatibleTokens:["a","b","h","H","K","t","T"]},m:{priority:60,parse:function(e,t,n,i){switch(t){case"m":return Il(rl,e);case"mo":return n.ordinalNumber(e,{unit:"minute"});default:return Tl(t.length,e)}},validate:function(e,t,n){return t>=0&&t<=59},set:function(e,t,n,i){return e.setUTCMinutes(n,0,0),e},incompatibleTokens:["t","T"]},s:{priority:50,parse:function(e,t,n,i){switch(t){case"s":return Il(cl,e);case"so":return n.ordinalNumber(e,{unit:"second"});default:return Tl(t.length,e)}},validate:function(e,t,n){return t>=0&&t<=59},set:function(e,t,n,i){return e.setUTCSeconds(n,0),e},incompatibleTokens:["t","T"]},S:{priority:30,parse:function(e,t,n,i){return Tl(t.length,e,function(e){return Math.floor(e*Math.pow(10,3-t.length))})},set:function(e,t,n,i){return e.setUTCMilliseconds(n),e},incompatibleTokens:["t","T"]},X:{priority:10,parse:function(e,t,n,i){switch(t){case"X":return _l(Cl,e);case"XX":return _l(Dl,e);case"XXXX":return _l(Sl,e);case"XXXXX":return _l(Ol,e);case"XXX":default:return _l(El,e)}},set:function(e,t,n,i){return t.timestampIsSet?e:new Date(e.getTime()-n)},incompatibleTokens:["t","T","x"]},x:{priority:10,parse:function(e,t,n,i){switch(t){case"x":return _l(Cl,e);case"xx":return _l(Dl,e);case"xxxx":return _l(Sl,e);case"xxxxx":return _l(Ol,e);case"xxx":default:return _l(El,e)}},set:function(e,t,n,i){return t.timestampIsSet?e:new Date(e.getTime()-n)},incompatibleTokens:["t","T","X"]},t:{priority:40,parse:function(e,t,n,i){return Xl(e)},set:function(e,t,n,i){return[new Date(1e3*n),{timestampIsSet:!0}]},incompatibleTokens:"*"},T:{priority:20,parse:function(e,t,n,i){return Xl(e)},set:function(e,t,n,i){return[new Date(n),{timestampIsSet:!0}]},incompatibleTokens:"*"}},Rl=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,wl=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Ll=/^'([^]*?)'?$/,xl=/''/g,kl=/\S/,Vl=/[a-zA-Z]/;function Ul(e,t){if(t.timestampIsSet)return e;var n=new Date(0);return n.setFullYear(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()),n.setHours(e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()),n}function Fl(e){return e.match(Ll)[1].replace(xl,"'")}function jl(e,t){Object($o.a)(2,arguments);var n=Object(Uo.a)(e),i=Object(Uo.a)(t);return n.getFullYear()-i.getFullYear()}function Yl(e,t){Object($o.a)(2,arguments);var n=Object(Uo.a)(e),i=Object(Uo.a)(t),s=n.getTime()-i.getTime();return s<0?-1:s>0?1:s}function Gl(e,t){if(1&e&&(m.Xb(0,"span"),m.Xc(1),m.Wb()),2&e){const e=m.ic().$implicit;m.Db(1),m.Yc((null==e?null:e.sourceId)||"N/A")}}function Bl(e,t){if(1&e&&(m.Xb(0,"h4"),m.Xb(1,"strong"),m.Xb(2,"span",5),m.Vc(3,Gl,2,1,"span",6),m.Wb(),m.Wb(),m.Wb()),2&e){const e=t.$implicit;m.Db(2),m.rc("ngSwitch",null==e?null:e.source),m.Db(1),m.rc("ngSwitchCase","HOSPITAL_INTERNAL_ID")}}function Hl(e,t){1&e&&(m.Vb(0),m.Xb(1,"h4"),m.Xb(2,"strong"),m.Xc(3,"N/A"),m.Wb(),m.Wb(),m.Ub())}const $l=function(){return[32,32]};let Zl=(()=>{class e{set _patientDetails(e){if(e){this.patientDetails=e;const t=function(e,t,n,i){Object($o.a)(3,arguments);var s=String(e),a=String(t),o=i||{},l=o.locale||ko.a;if(!l.match)throw new RangeError("locale must contain match property");var r=l.options&&l.options.firstWeekContainsDate,c=null==r?1:Object(Bo.a)(r),d=null==o.firstWeekContainsDate?c:Object(Bo.a)(o.firstWeekContainsDate);if(!(d>=1&&d<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var b=l.options&&l.options.weekStartsOn,p=null==b?0:Object(Bo.a)(b),u=null==o.weekStartsOn?p:Object(Bo.a)(o.weekStartsOn);if(!(u>=0&&u<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(""===a)return""===s?Object(Uo.a)(n):new Date(NaN);var h,g={firstWeekContainsDate:d,weekStartsOn:u,locale:l},f=[{priority:10,subPriority:-1,set:Ul,index:0}],v=a.match(wl).map(function(e){var t=e[0];return"p"===t||"P"===t?(0,jo.a[t])(e,l.formatLong,g):e}).join("").match(Rl),m=[];for(h=0;h<v.length;h++){var C=v[h];!o.useAdditionalWeekYearTokens&&Object(Go.b)(C)&&Object(Go.c)(C,a,e),!o.useAdditionalDayOfYearTokens&&Object(Go.a)(C)&&Object(Go.c)(C,a,e);var D=C[0],S=Wl[D];if(S){var E=S.incompatibleTokens;if(Array.isArray(E)){for(var O=void 0,I=0;I<m.length;I++){var _=m[I].token;if(-1!==E.indexOf(_)||_===D){O=m[I];break}}if(O)throw new RangeError("The format string mustn't contain `".concat(O.fullToken,"` and `").concat(C,"` at the same time"))}else if("*"===S.incompatibleTokens&&m.length)throw new RangeError("The format string mustn't contain `".concat(C,"` and any other token at the same time"));m.push({token:D,fullToken:C});var X=S.parse(s,C,l.match,g);if(!X)return new Date(NaN);f.push({priority:S.priority,subPriority:S.subPriority||0,set:S.set,validate:S.validate,value:X.value,index:f.length}),s=X.rest}else{if(D.match(Vl))throw new RangeError("Format string contains an unescaped latin alphabet character `"+D+"`");if("''"===C?C="'":"'"===D&&(C=Fl(C)),0!==s.indexOf(C))return new Date(NaN);s=s.slice(C.length)}}if(s.length>0&&kl.test(s))return new Date(NaN);var T=f.map(function(e){return e.priority}).sort(function(e,t){return t-e}).filter(function(e,t,n){return n.indexOf(e)===t}).map(function(e){return f.filter(function(t){return t.priority===e}).sort(function(e,t){return t.subPriority-e.subPriority})}).map(function(e){return e[0]}),N=Object(Uo.a)(n);if(isNaN(N))return new Date(NaN);var z=Object(Vo.a)(N,Object(Yo.a)(N)),M={};for(h=0;h<T.length;h++){var y=T[h];if(y.validate&&!y.validate(z,y.value,g))return new Date(NaN);var A=y.set(z,M,y.value,g);A[0]?(z=A[0],Fo(M,A[1])):z=A}return z}(e.dateOfBirth,"yyyy-MM-dd",new Date);this.age=function(e,t){Object($o.a)(2,arguments);var n=Object(Uo.a)(e),i=Object(Uo.a)(t),s=Yl(n,i),a=Math.abs(jl(n,i));n.setFullYear("1584"),i.setFullYear("1584");var o=Yl(n,i)===-s,l=s*(a-o);return 0===l?0:l}(new Date,t)}}set episode(e){var t,n;e&&(this.episodeDetails=e,this.duration=Object($.a)(new Date(null===(t=this.episodeDetails)||void 0===t?void 0:t.endDate),new Date(null===(n=this.episodeDetails)||void 0===n?void 0:n.startDate)))}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=m.Lb({type:e,selectors:[["app-patient-details"]],inputs:{_patientDetails:["patientDetails","_patientDetails"],episode:["episodeDetails","episode"],careplan:"careplan"},decls:26,vars:10,consts:[[1,"container"],["nz-row","",3,"nzGutter"],["nz-col","","nzXs","24","nzSm","12","nzMd","6"],[4,"ngFor","ngForOf"],[4,"ngIf"],[3,"ngSwitch"],[4,"ngSwitchCase"]],template:function(e,t){1&e&&(m.Xb(0,"div",0),m.Xb(1,"div",1),m.Xb(2,"div",2),m.Xb(3,"label"),m.Xc(4,"Patient Name"),m.Wb(),m.Xb(5,"h4"),m.Xb(6,"strong"),m.Xc(7),m.Wb(),m.Wb(),m.Wb(),m.Xb(8,"div",2),m.Xb(9,"label"),m.Xc(10,"Age"),m.Wb(),m.Xb(11,"h4"),m.Xb(12,"strong"),m.Xc(13),m.Wb(),m.Wb(),m.Wb(),m.Xb(14,"div",2),m.Xb(15,"label"),m.Xc(16,"Date of Birth"),m.Wb(),m.Xb(17,"h4"),m.Xb(18,"strong"),m.Xc(19),m.jc(20,"date"),m.Wb(),m.Wb(),m.Wb(),m.Xb(21,"div",2),m.Xb(22,"label"),m.Xc(23,"Patient MRN"),m.Wb(),m.Vc(24,Bl,4,2,"h4",3),m.Vc(25,Hl,4,0,"ng-container",4),m.Wb(),m.Wb(),m.Wb()),2&e&&(m.Db(1),m.rc("nzGutter",m.xc(9,$l)),m.Db(6),m.Yc(null==t.patientDetails?null:t.patientDetails.fullName),m.Db(6),m.Yc(null==t.patientDetails?null:t.patientDetails.age),m.Db(6),m.Yc(m.lc(20,6,null==t.patientDetails?null:t.patientDetails.dateOfBirth,"longDate")),m.Db(5),m.rc("ngForOf",null==t.patientDetails?null:t.patientDetails.externalSources),m.Db(1),m.rc("ngIf",!(null!=t.patientDetails&&null!=t.patientDetails.externalSources&&t.patientDetails.externalSources.length)))},directives:[O.c,O.a,s.p,s.q,s.s,s.t],pipes:[s.e],styles:[".container[_ngcontent-%COMP%]{padding:30px 20px 10px!important}.ant-row[_ngcontent-%COMP%]{margin-bottom:20px!important}label[_ngcontent-%COMP%]{font:normal normal normal 13px/16px Nunito;color:var(--tertiary-color);margin-bottom:5px;display:block}#status[_ngcontent-%COMP%]{padding:0!important}#status[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:90%;border-radius:5px;padding:16px 0 16px 16px}#status[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > h4[_ngcontent-%COMP%]{display:unset}.scheduled-status[_ngcontent-%COMP%]{background:#ffe58f 0 0 no-repeat padding-box}.active-status[_ngcontent-%COMP%]{background:var(--primary-color) 0 0 no-repeat padding-box}.suspended-status[_ngcontent-%COMP%]{background:#ffe07b 0 0 no-repeat padding-box}.completed-status[_ngcontent-%COMP%]{background:#dfdfdf 0 0 no-repeat padding-box}app-icons[_ngcontent-%COMP%]{float:right;margin-right:15px;line-height:2}.no-hover[_ngcontent-%COMP%]{pointer-events:none!important}"]}),e})();function ql(e,t){if(1&e&&(m.Xb(0,"tr"),m.Xb(1,"td"),m.Xc(2),m.Wb(),m.Xb(3,"td"),m.Xc(4),m.Wb(),m.Xb(5,"td"),m.Xc(6),m.Wb(),m.Xb(7,"td"),m.Xc(8),m.jc(9,"date"),m.Wb(),m.Xb(10,"td"),m.Xc(11),m.Wb(),m.Xb(12,"td"),m.Xc(13,"EMR"),m.Wb(),m.Wb()),2&e){const e=t.$implicit;m.Db(2),m.Yc(e.description),m.Db(2),m.Yc(e.status),m.Db(2),m.Yc(e.code),m.Db(2),m.Yc(e.startDateTime?m.lc(9,5,e.startDateTime,"MM/dd/yyyy"):"N/A"),m.Db(3),m.Yc("CHRONIC"==e.type?"Yes":"No")}}let Kl=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=m.Lb({type:e,selectors:[["app-problem-list"]],inputs:{icdCodes:"icdCodes"},decls:23,vars:6,consts:[["nz-typography",""],[1,"no-hover",3,"nzData","nzShowPagination"],["basicTable",""],[4,"ngFor","ngForOf"]],template:function(e,t){if(1&e&&(m.Xb(0,"nz-card"),m.Xb(1,"h3",0),m.Xc(2),m.jc(3,"translate"),m.Wb(),m.Xb(4,"nz-table",1,2),m.Xb(6,"thead"),m.Xb(7,"tr"),m.Xb(8,"th"),m.Xc(9,"Name"),m.Wb(),m.Xb(10,"th"),m.Xc(11,"Status"),m.Wb(),m.Xb(12,"th"),m.Xc(13,"Code"),m.Wb(),m.Xb(14,"th"),m.Xc(15,"Diagnosed"),m.Wb(),m.Xb(16,"th"),m.Xc(17,"Is Chronic"),m.Wb(),m.Xb(18,"th"),m.Xc(19,"Source"),m.Wb(),m.Wb(),m.Wb(),m.Xb(20,"tbody"),m.Vc(21,ql,14,8,"tr",3),m.Wb(),m.Wb(),m.Wb(),m.Sb(22,"br")),2&e){const e=m.Ic(5);m.Db(2),m.Yc(m.kc(3,4,"COMMON.PROBLEM_LIST")),m.Db(2),m.rc("nzData",t.icdCodes)("nzShowPagination",!1),m.Db(17),m.rc("ngForOf",e.data)}},directives:[I.a,T.a,ts.f,ts.n,ts.o,ts.e,ts.l,ts.i,s.p],pipes:[Q.a,s.e],styles:[".no-hover[_ngcontent-%COMP%]{pointer-events:none!important}"]}),e})();var Ql=n("cp0P"),Jl=n("YRM7");function er(e,t){1&e&&m.Tb(0)}const tr=function(e){return{address:e}};function nr(e,t){if(1&e&&(m.Xb(0,"tr"),m.Xb(1,"td"),m.Xc(2),m.Wb(),m.Xb(3,"td"),m.Xc(4),m.Wb(),m.Xb(5,"td"),m.Xc(6),m.Wb(),m.Xb(7,"td"),m.Vc(8,er,1,0,"ng-container",13),m.Wb(),m.Xb(9,"td"),m.Xc(10),m.Wb(),m.Wb()),2&e){const e=t.$implicit;m.ic();const n=m.Ic(39);m.Db(2),m.Yc(null==e?null:e.name),m.Db(2),m.Yc((null==e?null:e.role)||"N/A"),m.Db(2),m.Yc((null==e?null:e.number)||"N/A"),m.Db(2),m.rc("ngTemplateOutlet",n)("ngTemplateOutletContext",m.yc(6,tr,null==e?null:e.address)),m.Db(2),m.Yc((null==e?null:e.note)||"N/A")}}function ir(e,t){if(1&e&&(m.Vb(0),m.Xc(1),m.Ub()),2&e){const e=m.ic().address;m.Db(1),m.Zc(" ",null==e?null:e.line1,",\xa0 ")}}function sr(e,t){if(1&e&&(m.Vb(0),m.Xc(1),m.Ub()),2&e){const e=m.ic().address;m.Db(1),m.Zc(" ",null==e?null:e.line2,",\xa0 ")}}function ar(e,t){if(1&e&&(m.Vb(0),m.Xc(1),m.Ub()),2&e){const e=m.ic().address;m.Db(1),m.Zc(" ",null==e?null:e.city,",\xa0 ")}}function or(e,t){if(1&e&&(m.Vb(0),m.Xc(1),m.Ub()),2&e){const e=m.ic().address;m.Db(1),m.Zc(" ",null==e?null:e.state,"\xa0 ")}}function lr(e,t){if(1&e&&(m.Vb(0),m.Xc(1),m.Ub()),2&e){const e=m.ic().address;m.Db(1),m.Zc(" -\xa0",null==e?null:e.country," ")}}function rr(e,t){if(1&e&&(m.Vb(0),m.Xc(1),m.Ub()),2&e){const e=m.ic().address;m.Db(1),m.Zc(" -\xa0",null==e?null:e.pin," ")}}function cr(e,t){1&e&&(m.Xb(0,"span"),m.Xc(1," N/A "),m.Wb())}function dr(e,t){if(1&e&&(m.Xb(0,"span",14),m.Vc(1,ir,2,1,"ng-container",15),m.Vc(2,sr,2,1,"ng-container",15),m.Vc(3,ar,2,1,"ng-container",15),m.Vc(4,or,2,1,"ng-container",15),m.Vc(5,lr,2,1,"ng-container",15),m.Vc(6,rr,2,1,"ng-container",15),m.Wb(),m.Vc(7,cr,2,0,"span",15)),2&e){const e=t.address;m.wc("nzTooltipTitle","",null==e?null:e.line1,"\n                                         ",null==e?null:e.line2," ",null==e?null:e.city,"\n                                         ",null==e?null:e.state," ",null==e?null:e.country,"\n                                         ",null==e?null:e.pin,""),m.Db(1),m.rc("ngIf",null==e?null:e.line1),m.Db(1),m.rc("ngIf",null==e?null:e.line2),m.Db(1),m.rc("ngIf",null==e?null:e.city),m.Db(1),m.rc("ngIf",null==e?null:e.state),m.Db(1),m.rc("ngIf",null==e?null:e.country),m.Db(1),m.rc("ngIf",null==e?null:e.pin),m.Db(1),m.rc("ngIf",!(null!=e&&e.line1||null!=e&&e.line2||null!=e&&e.city||null!=e&&e.state||null!=e&&e.country||null!=e&&e.pin))}}const br=function(){return["15%","15%","15%","35%","20%"]};let pr=(()=>{class e extends h.a{constructor(e,t){super(),this._patientService=e,this._patientsViewService=t,this.contactDetails=[]}ngOnInit(){this.patientId?this.updateContactDetails():this.addStaff()}addStaff(){this.staffs&&this.staffs.forEach(e=>{var t,n,i;this.contactDetails.push({name:e.fullName,role:(this.primaryIds.includes(null==e?void 0:e.id)?"Primary ":"")+(null===(t=null==e?void 0:e.defaultRole)||void 0===t?void 0:t.name),number:null===(n=null==e?void 0:e.preferredNumber)||void 0===n?void 0:n.number,address:null==e?void 0:e.address,note:null===(i=null==e?void 0:e.quickNote)||void 0===i?void 0:i.content})})}updateContactDetails(){Object(Ql.a)([this._patientService.fetchGuardiansForPatient(this.patientId),this._patientService.fetchEmergencyContactsForPatient(this.patientId)]).subscribe(e=>{this.contactDetails=[],this.addStaff(),this.guardians=e[0],this.guardians.forEach(e=>{this.contactDetails.push({name:e.fullName,role:"Guardian",number:null==e?void 0:e.mobile,address:null==e?void 0:e.address,note:null==e?void 0:e.relationship})}),this.contacts=e[1],this.contacts.forEach(e=>{this.contactDetails.push({name:e.name,role:null==e?void 0:e.type,number:null==e?void 0:e.mobile,address:null==e?void 0:e.address,note:null==e?void 0:e.relationship})}),this.contactDetails=[...this.contactDetails]})}addGuardian(){this._patientsViewService.showGuardianModal(this.patientId).afterClose.pipe(Object(f.a)(this.unsubscribed)).subscribe(e=>{e&&this.updateContactDetails()})}addContact(){this._patientsViewService.showContactModal(this.patientId).afterClose.pipe(Object(f.a)(this.unsubscribed)).subscribe(e=>{e&&this.updateContactDetails()})}}return e.\u0275fac=function(t){return new(t||e)(m.Rb(p.a),m.Rb(Jl.a))},e.\u0275cmp=m.Lb({type:e,selectors:[["app-staff-details"]],inputs:{staffs:"staffs",primaryIds:"primaryIds",patientId:"patientId"},features:[m.Ab],decls:40,vars:19,consts:[["nz-row","","nzJustify","space-between"],["nz-col",""],["nz-typography",""],["nz-button","","nzType","primary","nz-dropdown","",3,"nzDropdownMenu"],["color","#ffffff","stroke","2px","size","10px","altColor","#ffffff","name","down"],["addNewMenu","nzDropdownMenu"],["nz-menu",""],["nz-menu-item","",3,"click"],["nz-menu-divider","",1,"menu-divider"],[3,"nzData","nzShowPagination","nzPageSize","nzWidthConfig"],["basicTable",""],[4,"ngFor","ngForOf"],["addressTemplate",""],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["nz-tooltip","",3,"nzTooltipTitle"],[4,"ngIf"]],template:function(e,t){if(1&e&&(m.Xb(0,"nz-card"),m.Xb(1,"div",0),m.Xb(2,"div",1),m.Xb(3,"h3",2),m.Xc(4),m.jc(5,"translate"),m.Wb(),m.Wb(),m.Xb(6,"div",1),m.Xb(7,"button",3),m.Xc(8),m.jc(9,"translate"),m.Sb(10,"app-icons",4),m.Wb(),m.Xb(11,"nz-dropdown-menu",null,5),m.Xb(13,"ul",6),m.Xb(14,"li",7),m.ec("click",function(){return t.addGuardian()}),m.Xc(15),m.jc(16,"translate"),m.Wb(),m.Sb(17,"li",8),m.Xb(18,"li",7),m.ec("click",function(){return t.addContact()}),m.Xc(19),m.jc(20,"translate"),m.Wb(),m.Wb(),m.Wb(),m.Wb(),m.Wb(),m.Xb(21,"nz-table",9,10),m.Xb(23,"thead"),m.Xb(24,"tr"),m.Xb(25,"th"),m.Xc(26,"Name"),m.Wb(),m.Xb(27,"th"),m.Xc(28,"Role"),m.Wb(),m.Xb(29,"th"),m.Xc(30,"Contact Number"),m.Wb(),m.Xb(31,"th"),m.Xc(32,"Address"),m.Wb(),m.Xb(33,"th"),m.Xc(34,"Notes"),m.Wb(),m.Wb(),m.Wb(),m.Xb(35,"tbody"),m.Vc(36,nr,11,8,"tr",11),m.Wb(),m.Wb(),m.Wb(),m.Sb(37,"br"),m.Vc(38,dr,8,13,"ng-template",null,12,m.Wc)),2&e){const e=m.Ic(12),n=m.Ic(22);m.Db(4),m.Yc(m.kc(5,10,"COMMON.PATIENT_CARE_TEAM")),m.Db(3),m.rc("nzDropdownMenu",e),m.Db(1),m.Zc(" ",m.kc(9,12,"COMMON.ADD_NEW")," \xa0"),m.Db(7),m.Yc(m.kc(16,14,"PATIENT.ADD_GUARDIAN")),m.Db(4),m.Yc(m.kc(20,16,"COMMON.ADD_CONTACT")),m.Db(2),m.rc("nzData",t.contactDetails)("nzShowPagination",!0)("nzPageSize",5)("nzWidthConfig",m.xc(18,br)),m.Db(15),m.rc("ngForOf",n.data)}},directives:[I.a,O.c,O.a,T.a,mt.a,Ct.a,A.a,S.d,S.b,oe.a,S.e,E.c,E.e,E.d,ts.f,ts.n,ts.o,ts.e,ts.l,ts.i,s.p,s.v,je.d,s.q],pipes:[Q.a],styles:[".no-hover[_ngcontent-%COMP%]{pointer-events:none!important}"]}),e})();var ur=n("mrSG"),hr=n("/KA4"),gr=n("vDMs");function fr(e,t){if(1&e){const e=m.Yb();m.Xb(0,"div",5),m.Xb(1,"button",6),m.ec("click",function(){return m.Lc(e),m.ic().saveGoal()}),m.Xc(2,"Add Patient Goal"),m.Wb(),m.Wb()}}function vr(e,t){1&e&&(m.Xb(0,"strong"),m.Xc(1," No notes have been added yet. "),m.Wb())}function mr(e,t){if(1&e&&(m.Xb(0,"nz-timeline-item"),m.Xc(1),m.jc(2,"titlecase"),m.Sb(3,"br"),m.Xb(4,"em",11),m.Xc(5),m.jc(6,"date"),m.Wb(),m.Wb()),2&e){const e=t.$implicit,n=m.ic(2).$implicit;m.Db(1),m.Zc(" ",m.kc(2,4,null==e?null:e.note)," "),m.Db(4),m.bd(" ",(null==e?null:e.note)==(null==n||null==n.notes[0]?null:n.notes[0].note)?"Added ":"Edited ","",null!=e&&e.context?"by "+(null==e?null:e.context):""," on ",m.lc(6,6,null==e?null:e.createdAt,"mediumDate")," ")}}function Cr(e,t){if(1&e&&(m.Vb(0),m.Xb(1,"strong"),m.Xc(2,"Notes:"),m.Wb(),m.Sb(3,"br"),m.Sb(4,"br"),m.Xb(5,"nz-timeline"),m.Vc(6,mr,7,9,"nz-timeline-item",4),m.Wb(),m.Ub()),2&e){const e=m.ic().$implicit;m.Db(6),m.rc("ngForOf",null==e?null:e.notes)}}function Dr(e,t){if(1&e){const e=m.Yb();m.Vb(0),m.Xb(1,"tr"),m.Xb(2,"td",7),m.ec("nzExpandChange",function(n){m.Lc(e);const i=t.$implicit;return m.ic().onExpandChange(i.id,n)}),m.Wb(),m.Xb(3,"td"),m.Xc(4),m.Wb(),m.Xb(5,"td"),m.Xc(6),m.Wb(),m.Xb(7,"td"),m.Xc(8),m.Wb(),m.Xb(9,"td"),m.Xc(10),m.Wb(),m.Xb(11,"td"),m.Xc(12),m.jc(13,"date"),m.Wb(),m.Xb(14,"td"),m.Xb(15,"app-icons",8),m.ec("click",function(){m.Lc(e);const n=t.$implicit;return m.ic().addResource(n)}),m.Wb(),m.Wb(),m.Wb(),m.Xb(16,"tr",9),m.Vc(17,vr,2,0,"strong",10),m.Vc(18,Cr,7,1,"ng-container",10),m.Wb(),m.Ub()}if(2&e){const e=t.$implicit,n=m.ic();m.Db(2),m.rc("nzExpand",n.expandSet.has(e.id)),m.Db(2),m.Yc(null==e?null:e.name),m.Db(2),m.Yc((null==e?null:e.resourceType)||"N/A"),m.Db(2),m.Yc((null==e?null:e.contactNumber)||"N/A"),m.Db(2),m.Yc((null==e?null:e.status)||"N/A"),m.Db(2),m.Yc(null!=e&&e.dateRequested?m.lc(13,9,null==e?null:e.dateRequested,"MM/dd/yyyy"):"N/A"),m.Db(4),m.rc("nzExpand",n.expandSet.has(e.id)),m.Db(1),m.rc("ngIf",!(null!=e&&null!=e.notes&&e.notes.length)),m.Db(1),m.rc("ngIf",null==e||null==e.notes?null:e.notes.length)}}let Sr=(()=>{class e extends h.a{constructor(e,t){super(),this._homeCommunityResourceService=e,this._patientViewModalService=t,this.resources=[],this.hideAction=!1,this.expandSet=new Set}ngOnInit(){this.getData()}getData(){this._homeCommunityResourceService.fetchHomeCommunityResources(this.patientId).subscribe(e=>this.resources=e)}onExpandChange(e,t){t?this.expandSet.add(e):this.expandSet.delete(e)}addResource(e){this._patientViewModalService.showResourceModal(this.patientId,e).afterClose.pipe(Object(f.a)(this.unsubscribed)).subscribe(e=>{this.getData()})}}return e.\u0275fac=function(t){return new(t||e)(m.Rb(gr.a),m.Rb(Jl.a))},e.\u0275cmp=m.Lb({type:e,selectors:[["app-home-community-resources"]],inputs:{patientId:"patientId",hideAction:"hideAction"},features:[m.Ab],decls:22,vars:4,consts:[["id","actions",4,"ngIf"],[3,"nzData","nzShowPagination"],["basicTable",""],["nzWidth","60px"],[4,"ngFor","ngForOf"],["id","actions"],["nz-button","","nzType","primary",3,"click"],[3,"nzExpand","nzExpandChange"],["name","edit",3,"click"],[3,"nzExpand"],[4,"ngIf"],["nz-typography","","nzType","secondary"]],template:function(e,t){if(1&e&&(m.Xb(0,"div"),m.Vc(1,fr,3,0,"div",0),m.Xb(2,"nz-table",1,2),m.Xb(4,"thead"),m.Xb(5,"tr"),m.Sb(6,"th",3),m.Xb(7,"th"),m.Xc(8,"Name"),m.Wb(),m.Xb(9,"th"),m.Xc(10,"Resource Type"),m.Wb(),m.Xb(11,"th"),m.Xc(12,"Contact Number"),m.Wb(),m.Xb(13,"th"),m.Xc(14,"Status"),m.Wb(),m.Xb(15,"th"),m.Xc(16,"Date Requested"),m.Wb(),m.Xb(17,"th"),m.Xc(18,"Action"),m.Wb(),m.Wb(),m.Wb(),m.Xb(19,"tbody"),m.Vc(20,Dr,19,12,"ng-container",4),m.Wb(),m.Wb(),m.Wb(),m.Sb(21,"br")),2&e){const e=m.Ic(3);m.Db(1),m.rc("ngIf",!t.hideAction),m.Db(1),m.rc("nzData",t.resources)("nzShowPagination",!1),m.Db(18),m.rc("ngForOf",null==e?null:e.data)}},directives:[s.q,ts.f,ts.n,ts.o,ts.e,ts.l,ts.i,s.p,mt.a,Ct.a,A.a,ts.j,oe.a,ts.p,ts.g,Ci.a,Ci.b,T.a],pipes:[s.e,s.A],styles:[".no-hover[_ngcontent-%COMP%]{pointer-events:none!important}#actions[_ngcontent-%COMP%]{display:block;width:100%;text-align:right}"]}),Object(ur.b)([Object(hr.a)(),Object(ur.c)("design:type",Boolean)],e.prototype,"hideAction",void 0),e})(),Er=(()=>{class e{constructor(){}ngOnInit(){}addResource(){var e;null===(e=this.community)||void 0===e||e.addResource()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=m.Lb({type:e,selectors:[["app-careplan-home-community"]],viewQuery:function(e,t){if(1&e&&m.ed(Sr,1),2&e){let e;m.Hc(e=m.fc())&&(t.community=e.first)}},inputs:{patientId:"patientId",blueprintId:"blueprintId"},decls:12,vars:7,consts:[["nz-row","","nzJustify","space-between"],["nz-col",""],["nz-typography",""],["nz-button","","nzType","primary",3,"click"],["hideAction","",3,"patientId"]],template:function(e,t){1&e&&(m.Xb(0,"nz-card"),m.Xb(1,"div",0),m.Xb(2,"div",1),m.Xb(3,"h3",2),m.Xc(4),m.jc(5,"translate"),m.Wb(),m.Wb(),m.Xb(6,"div",1),m.Xb(7,"button",3),m.ec("click",function(){return t.addResource()}),m.Xc(8),m.jc(9,"translate"),m.Wb(),m.Wb(),m.Wb(),m.Sb(10,"app-home-community-resources",4),m.Wb(),m.Sb(11,"br")),2&e&&(m.Db(4),m.Yc(m.kc(5,3,"COMMON.HOME_COMMUNITY_RESOURCE")),m.Db(4),m.Zc(" ",m.kc(9,5,"COMMON.ADD_NEW")," "),m.Db(2),m.rc("patientId",t.patientId))},directives:[I.a,O.c,O.a,T.a,mt.a,Ct.a,A.a,Sr],pipes:[Q.a],styles:[""]}),e})();var Or=n("lyZ/");function Ir(e,t){1&e&&(m.Xb(0,"strong"),m.Xc(1," No notes have been added yet. "),m.Wb())}function _r(e,t){if(1&e&&(m.Xb(0,"nz-timeline-item"),m.Xc(1),m.jc(2,"titlecase"),m.Sb(3,"br"),m.Xb(4,"em",12),m.Xc(5),m.jc(6,"date"),m.Wb(),m.Wb()),2&e){const e=t.$implicit,n=m.ic(2).$implicit;m.Db(1),m.Zc(" ",m.kc(2,4,null==e?null:e.note)," "),m.Db(4),m.bd(" ",(null==e?null:e.note)==(null==n||null==n.notes[0]?null:n.notes[0].note)?"Added ":"Edited ","",null!=e&&e.context?"by "+(null==e?null:e.context):""," on ",m.lc(6,6,null==e?null:e.createdAt,"mediumDate")," ")}}function Xr(e,t){if(1&e&&(m.Vb(0),m.Xb(1,"strong"),m.Xc(2,"Notes:"),m.Wb(),m.Sb(3,"br"),m.Sb(4,"br"),m.Xb(5,"nz-timeline"),m.Vc(6,_r,7,9,"nz-timeline-item",7),m.Wb(),m.Ub()),2&e){const e=m.ic().$implicit;m.Db(6),m.rc("ngForOf",null==e?null:e.notes)}}function Tr(e,t){if(1&e){const e=m.Yb();m.Vb(0),m.Xb(1,"tr"),m.Xb(2,"td",8),m.ec("nzExpandChange",function(n){m.Lc(e);const i=t.$implicit;return m.ic().onExpandChange(i.id,n)}),m.Wb(),m.Xb(3,"td"),m.Xc(4),m.Wb(),m.Xb(5,"td"),m.Xc(6),m.Wb(),m.Xb(7,"td"),m.Xc(8),m.jc(9,"date"),m.Wb(),m.Xb(10,"td"),m.Xc(11),m.jc(12,"date"),m.Wb(),m.Xb(13,"td"),m.Xb(14,"app-icons",9),m.ec("click",function(){m.Lc(e);const n=t.$implicit;return m.ic().addHealthScreening(n)}),m.Wb(),m.Wb(),m.Wb(),m.Xb(15,"tr",10),m.Vc(16,Ir,2,0,"strong",11),m.Vc(17,Xr,7,1,"ng-container",11),m.Wb(),m.Ub()}if(2&e){const e=t.$implicit,n=m.ic();m.Db(2),m.rc("nzExpand",n.expandSet.has(e.id)),m.Db(2),m.Yc((null==e?null:e.name)||"N/A"),m.Db(2),m.Yc((null==e?null:e.status)||"N/A"),m.Db(2),m.Yc(null!=e&&e.dueDate?m.lc(9,8,null==e?null:e.dueDate,"MM/dd/yyyy"):"N/A"),m.Db(3),m.Yc(null!=e&&e.lastCompleted?m.lc(12,11,null==e?null:e.lastCompleted,"MM/dd/yyyy"):"N/A"),m.Db(4),m.rc("nzExpand",n.expandSet.has(e.id)),m.Db(1),m.rc("ngIf",!(null!=e&&null!=e.notes&&e.notes.length)),m.Db(1),m.rc("ngIf",null==e||null==e.notes?null:e.notes.length)}}let Nr=(()=>{class e extends h.a{constructor(e,t){super(),this._healthScreeningService=e,this._patientViewModalService=t,this.expandSet=new Set}ngOnInit(){this.getData()}getData(){this._healthScreeningService.fetchHealthScreenings(this.patientId,this.blueprintId).subscribe(e=>this.healthScreenings=e)}onExpandChange(e,t){t?this.expandSet.add(e):this.expandSet.delete(e)}addHealthScreening(e){this._patientViewModalService.showHealthScreeningModal(this.patientId,this.blueprintId,e).afterClose.pipe(Object(f.a)(this.unsubscribed)).subscribe(e=>{this.getData()})}}return e.\u0275fac=function(t){return new(t||e)(m.Rb(Or.a),m.Rb(Jl.a))},e.\u0275cmp=m.Lb({type:e,selectors:[["app-health-screenings"]],inputs:{patientId:"patientId",blueprintId:"blueprintId"},features:[m.Ab],decls:30,vars:15,consts:[["nz-row","","nzJustify","space-between"],["nz-col",""],["nz-typography",""],["nz-button","","nzType","primary",3,"click"],[3,"nzData","nzPageSize"],["screeningsTable",""],["nzWidth","60px"],[4,"ngFor","ngForOf"],[3,"nzExpand","nzExpandChange"],["name","edit",3,"click"],[3,"nzExpand"],[4,"ngIf"],["nz-typography","","nzType","secondary"]],template:function(e,t){if(1&e&&(m.Xb(0,"nz-card"),m.Xb(1,"div",0),m.Xb(2,"div",1),m.Xb(3,"h3",2),m.Xc(4),m.jc(5,"translate"),m.Wb(),m.Wb(),m.Xb(6,"div",1),m.Xb(7,"button",3),m.ec("click",function(){return t.addHealthScreening()}),m.Xc(8),m.jc(9,"translate"),m.Wb(),m.Wb(),m.Wb(),m.Xb(10,"nz-table",4,5),m.Xb(12,"thead"),m.Xb(13,"tr"),m.Sb(14,"th",6),m.Xb(15,"th"),m.Xc(16),m.jc(17,"translate"),m.Wb(),m.Xb(18,"th"),m.Xc(19),m.jc(20,"translate"),m.Wb(),m.Xb(21,"th"),m.Xc(22,"Due Date"),m.Wb(),m.Xb(23,"th"),m.Xc(24,"Last Completed"),m.Wb(),m.Xb(25,"th"),m.Xc(26,"Action"),m.Wb(),m.Wb(),m.Wb(),m.Xb(27,"tbody"),m.Vc(28,Tr,18,14,"ng-container",7),m.Wb(),m.Wb(),m.Wb(),m.Sb(29,"br")),2&e){const e=m.Ic(11);m.Db(4),m.Yc(m.kc(5,7,"COMMON.HEALTH_SCREENING")),m.Db(4),m.Zc(" ",m.kc(9,9,"COMMON.ADD_NEW")," "),m.Db(2),m.rc("nzData",t.healthScreenings)("nzPageSize",10),m.Db(6),m.Yc(m.kc(17,11,"COMMON.NAME")),m.Db(3),m.Yc(m.kc(20,13,"COMMON.STATUS")),m.Db(9),m.rc("ngForOf",null==e?null:e.data)}},directives:[I.a,O.c,O.a,T.a,mt.a,Ct.a,A.a,ts.f,ts.n,ts.o,ts.e,ts.l,ts.i,s.p,ts.j,oe.a,ts.p,ts.g,s.q,Ci.a,Ci.b],pipes:[Q.a,s.e,s.A],styles:[""]}),e})();var zr=n("s3hQ"),Mr=n("xn8p");function yr(e,t){1&e&&(m.Vb(0),m.Xb(1,"nz-tag",12),m.Xc(2,"Low"),m.Wb(),m.Ub())}function Ar(e,t){1&e&&(m.Vb(0),m.Xb(1,"nz-tag",13),m.Xc(2,"Medium"),m.Wb(),m.Ub())}function Pr(e,t){1&e&&(m.Vb(0),m.Xb(1,"nz-tag",14),m.Xc(2,"High"),m.Wb(),m.Ub())}function Wr(e,t){1&e&&(m.Vb(0),m.Xb(1,"nz-tag"),m.Xc(2,"New"),m.Wb(),m.Ub())}function Rr(e,t){1&e&&(m.Vb(0),m.Xb(1,"nz-tag",15),m.Xc(2,"Ongoing"),m.Wb(),m.Ub())}function wr(e,t){1&e&&(m.Vb(0),m.Xb(1,"nz-tag",12),m.Xc(2,"Improved"),m.Wb(),m.Ub())}function Lr(e,t){1&e&&(m.Vb(0),m.Xb(1,"nz-tag",14),m.Xc(2,"Worsening"),m.Wb(),m.Ub())}function xr(e,t){1&e&&(m.Vb(0),m.Xb(1,"nz-tag",12),m.Xc(2,"Resolved"),m.Wb(),m.Ub())}function kr(e,t){if(1&e&&(m.Xb(0,"nz-tag"),m.Xc(1),m.Wb()),2&e){const e=t.$implicit;m.Db(1),m.Yc(e)}}const Vr=function(){return[16,24]};let Ur=(()=>{class e{constructor(){this.categoriesMap={}}ngOnInit(){this.categoriesMap=new Map,r.a.forEach(e=>this.categoriesMap[null==e?void 0:e.type]=e.label)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=m.Lb({type:e,selectors:[["app-plan-of-care-details-modal"]],inputs:{planOfCare:"planOfCare"},decls:79,vars:46,consts:[[1,"container"],["nz-typography",""],[3,"ngSwitch"],[4,"ngSwitchCase"],["nz-row",""],["nz-typography","","nzType","secondary"],["nz-row","",3,"nzGutter"],["nz-col","","nzSpan","4"],["nz-col","","nzSpan","20"],[4,"ngFor","ngForOf"],["nz-col","","nzSpan","16"],[3,"innerHTML"],["nzColor","#a7c853"],["nzColor","gold"],["nzColor","#c81c1c"],["nzColor","gainsboro"]],template:function(e,t){1&e&&(m.Xb(0,"div",0),m.Xb(1,"h4",1),m.Xc(2),m.Vb(3,2),m.Vc(4,yr,3,0,"ng-container",3),m.Vc(5,Ar,3,0,"ng-container",3),m.Vc(6,Pr,3,0,"ng-container",3),m.Ub(),m.Xc(7," \xa0 "),m.Vb(8,2),m.Vc(9,Wr,3,0,"ng-container",3),m.Vc(10,Rr,3,0,"ng-container",3),m.Vc(11,wr,3,0,"ng-container",3),m.Vc(12,Lr,3,0,"ng-container",3),m.Vc(13,xr,3,0,"ng-container",3),m.Ub(),m.Wb(),m.Xb(14,"div",4),m.Xb(15,"label",5),m.Xc(16," Created by "),m.Xb(17,"strong"),m.Xc(18),m.jc(19,"titlecase"),m.Wb(),m.Xc(20," at "),m.Xb(21,"strong"),m.Xc(22),m.jc(23,"utcToLocalTime"),m.Wb(),m.Wb(),m.Wb(),m.Xb(24,"div",4),m.Xb(25,"label",5),m.Xc(26," Last updated by "),m.Xb(27,"strong"),m.Xc(28),m.jc(29,"titlecase"),m.Wb(),m.Xc(30," at "),m.Xb(31,"strong"),m.Xc(32),m.jc(33,"utcToLocalTime"),m.Wb(),m.Wb(),m.Wb(),m.Sb(34,"nz-divider"),m.Xb(35,"div",6),m.Xb(36,"div",7),m.Xb(37,"strong",1),m.Xc(38,"Category: "),m.Wb(),m.Wb(),m.Xb(39,"div",8),m.Xc(40),m.Wb(),m.Wb(),m.Xb(41,"div",6),m.Xb(42,"div",7),m.Xb(43,"strong",1),m.Xc(44,"Relative Problems: "),m.Wb(),m.Wb(),m.Xb(45,"div",8),m.Vc(46,kr,2,1,"nz-tag",9),m.Wb(),m.Wb(),m.Xb(47,"div",6),m.Xb(48,"div",7),m.Xb(49,"strong",1),m.Xc(50,"Prescribed By: "),m.Wb(),m.Wb(),m.Xb(51,"div",8),m.Xc(52),m.jc(53,"titlecase"),m.Wb(),m.Wb(),m.Sb(54,"nz-divider"),m.Xb(55,"div",6),m.Xb(56,"div",7),m.Xb(57,"strong",1),m.Xc(58,"Provider Plan of Care: "),m.Wb(),m.Wb(),m.Xb(59,"div",10),m.Sb(60,"span",11),m.Wb(),m.Wb(),m.Xb(61,"div",6),m.Xb(62,"div",7),m.Xb(63,"strong",1),m.Xc(64,"Nursing Interventions: "),m.Wb(),m.Wb(),m.Xb(65,"div",10),m.Sb(66,"span",11),m.Wb(),m.Wb(),m.Xb(67,"div",6),m.Xb(68,"div",7),m.Xb(69,"strong",1),m.Xc(70,"Nursing Education: "),m.Wb(),m.Wb(),m.Xb(71,"div",10),m.Sb(72,"span",11),m.Wb(),m.Wb(),m.Xb(73,"div",6),m.Xb(74,"div",7),m.Xb(75,"strong",1),m.Xc(76,"Goals: "),m.Wb(),m.Wb(),m.Xb(77,"div",10),m.Sb(78,"span",11),m.Wb(),m.Wb(),m.Wb()),2&e&&(m.Db(2),m.Zc(" ",null==t.planOfCare?null:t.planOfCare.title," \xa0 "),m.Db(1),m.rc("ngSwitch",null==t.planOfCare||null==t.planOfCare.events[(null==t.planOfCare||null==t.planOfCare.events?null:t.planOfCare.events.length)-1]?null:t.planOfCare.events[(null==t.planOfCare||null==t.planOfCare.events?null:t.planOfCare.events.length)-1].priority),m.Db(1),m.rc("ngSwitchCase","LOW"),m.Db(1),m.rc("ngSwitchCase","MEDIUM"),m.Db(1),m.rc("ngSwitchCase","HIGH"),m.Db(2),m.rc("ngSwitch",null==t.planOfCare||null==t.planOfCare.events[(null==t.planOfCare||null==t.planOfCare.events?null:t.planOfCare.events.length)-1]?null:t.planOfCare.events[(null==t.planOfCare||null==t.planOfCare.events?null:t.planOfCare.events.length)-1].outcome),m.Db(1),m.rc("ngSwitchCase","NEW"),m.Db(1),m.rc("ngSwitchCase","ONGOING"),m.Db(1),m.rc("ngSwitchCase","IMPROVED"),m.Db(1),m.rc("ngSwitchCase","WORSENING"),m.Db(1),m.rc("ngSwitchCase","RESOLVED"),m.Db(5),m.Yc(m.kc(19,29,null==t.planOfCare?null:t.planOfCare.staffMap[null==t.planOfCare?null:t.planOfCare.createdBy])),m.Db(4),m.Yc(m.kc(23,31,null==t.planOfCare?null:t.planOfCare.createdAt)),m.Db(6),m.Yc(m.kc(29,33,null==t.planOfCare?null:t.planOfCare.staffMap[null==t.planOfCare?null:t.planOfCare.changedBy])),m.Db(4),m.Yc(m.kc(33,35,null==t.planOfCare?null:t.planOfCare.updatedAt)),m.Db(3),m.rc("nzGutter",m.xc(39,Vr)),m.Db(5),m.Zc(" ",t.categoriesMap[null==t.planOfCare?null:t.planOfCare.category]," "),m.Db(1),m.rc("nzGutter",m.xc(40,Vr)),m.Db(5),m.rc("ngForOf",null==t.planOfCare?null:t.planOfCare.icdCodes),m.Db(1),m.rc("nzGutter",m.xc(41,Vr)),m.Db(5),m.Zc(" ",m.kc(53,37,null==t.planOfCare?null:t.planOfCare.staffMap[null==t.planOfCare?null:t.planOfCare.provider])," "),m.Db(3),m.rc("nzGutter",m.xc(42,Vr)),m.Db(5),m.rc("innerHTML",null==t.planOfCare?null:t.planOfCare.providerPlanOfCare,m.Mc),m.Db(1),m.rc("nzGutter",m.xc(43,Vr)),m.Db(5),m.rc("innerHTML",null==t.planOfCare?null:t.planOfCare.nursingInterventions,m.Mc),m.Db(1),m.rc("nzGutter",m.xc(44,Vr)),m.Db(5),m.rc("innerHTML",null==t.planOfCare?null:t.planOfCare.nursingEducation,m.Mc),m.Db(1),m.rc("nzGutter",m.xc(45,Vr)),m.Db(5),m.rc("innerHTML",null==t.planOfCare?null:t.planOfCare.goals,m.Mc))},directives:[T.a,s.s,s.t,O.c,y.a,O.a,s.p,me.a],pipes:[s.A,Di.a],styles:[".container[_ngcontent-%COMP%]{padding:0 20px!important;max-height:75vh!important;overflow-y:scroll}"]}),e})();function Fr(e,t){1&e&&(m.Vb(0),m.Xb(1,"nz-tag",20),m.Xc(2,"Low"),m.Wb(),m.Ub())}function jr(e,t){1&e&&(m.Vb(0),m.Xb(1,"nz-tag",21),m.Xc(2,"Medium"),m.Wb(),m.Ub())}function Yr(e,t){1&e&&(m.Vb(0),m.Xb(1,"nz-tag",22),m.Xc(2,"High"),m.Wb(),m.Ub())}function Gr(e,t){1&e&&(m.Vb(0),m.Xb(1,"nz-tag"),m.Xc(2,"New"),m.Wb(),m.Ub())}function Br(e,t){1&e&&(m.Vb(0),m.Xb(1,"nz-tag",23),m.Xc(2,"Ongoing"),m.Wb(),m.Ub())}function Hr(e,t){1&e&&(m.Vb(0),m.Xb(1,"nz-tag",20),m.Xc(2,"Improved"),m.Wb(),m.Ub())}function $r(e,t){1&e&&(m.Vb(0),m.Xb(1,"nz-tag",22),m.Xc(2,"Worsening"),m.Wb(),m.Ub())}function Zr(e,t){1&e&&(m.Vb(0),m.Xb(1,"nz-tag",20),m.Xc(2,"Resolved"),m.Wb(),m.Ub())}function qr(e,t){if(1&e){const e=m.Yb();m.Xb(0,"tr"),m.Xb(1,"td"),m.Xc(2),m.Wb(),m.Xb(3,"td"),m.Vb(4,11),m.Vc(5,Fr,3,0,"ng-container",12),m.Vc(6,jr,3,0,"ng-container",12),m.Vc(7,Yr,3,0,"ng-container",12),m.Ub(),m.Wb(),m.Xb(8,"td"),m.Vb(9,11),m.Vc(10,Gr,3,0,"ng-container",12),m.Vc(11,Br,3,0,"ng-container",12),m.Vc(12,Hr,3,0,"ng-container",12),m.Vc(13,$r,3,0,"ng-container",12),m.Vc(14,Zr,3,0,"ng-container",12),m.Ub(),m.Wb(),m.Xb(15,"td"),m.Xb(16,"div",13),m.Xb(17,"div",3),m.Xb(18,"app-icons",14),m.ec("click",function(){m.Lc(e);const n=t.$implicit;return m.ic(2).logEvent(null==n?null:n.id,n)}),m.Wb(),m.Sb(19,"nz-divider",15),m.Wb(),m.Xb(20,"div",3),m.Xb(21,"app-icons",16),m.ec("click",function(){m.Lc(e);const n=t.$implicit;return m.ic(2).viewEventHistory(n)}),m.Wb(),m.Sb(22,"nz-divider",15),m.Wb(),m.Xb(23,"div",3),m.Xb(24,"app-icons",17),m.ec("click",function(){m.Lc(e);const n=t.$implicit;return m.ic(2).edit(null==n?null:n.id)}),m.Wb(),m.Sb(25,"nz-divider",15),m.Wb(),m.Xb(26,"div",3),m.Xb(27,"app-icons",18),m.ec("click",function(){m.Lc(e);const n=t.$implicit;return m.ic(2).show(n)}),m.Wb(),m.Sb(28,"nz-divider",15),m.Wb(),m.Xb(29,"div",3),m.Xb(30,"app-icons",19),m.ec("nzOnConfirm",function(){m.Lc(e);const n=t.$implicit;return m.ic(2).delete(null==n?null:n.id)}),m.Wb(),m.Wb(),m.Wb(),m.Wb(),m.Wb()}if(2&e){const e=t.$implicit;m.Db(2),m.Yc(null==e?null:e.title),m.Db(2),m.rc("ngSwitch",null==e||null==e.events[(null==e||null==e.events?null:e.events.length)-1]?null:e.events[(null==e||null==e.events?null:e.events.length)-1].priority),m.Db(1),m.rc("ngSwitchCase","LOW"),m.Db(1),m.rc("ngSwitchCase","MEDIUM"),m.Db(1),m.rc("ngSwitchCase","HIGH"),m.Db(2),m.rc("ngSwitch",null==e||null==e.events[(null==e||null==e.events?null:e.events.length)-1]?null:e.events[(null==e||null==e.events?null:e.events.length)-1].outcome),m.Db(1),m.rc("ngSwitchCase","NEW"),m.Db(1),m.rc("ngSwitchCase","ONGOING"),m.Db(1),m.rc("ngSwitchCase","IMPROVED"),m.Db(1),m.rc("ngSwitchCase","WORSENING"),m.Db(1),m.rc("ngSwitchCase","RESOLVED")}}function Kr(e,t){if(1&e&&(m.Xb(0,"nz-table",8,9),m.Xb(2,"thead"),m.Xb(3,"tr"),m.Xb(4,"th"),m.Xc(5,"Name"),m.Wb(),m.Xb(6,"th"),m.Xc(7,"Priority"),m.Wb(),m.Xb(8,"th"),m.Xc(9,"Outcome"),m.Wb(),m.Sb(10,"th"),m.Wb(),m.Wb(),m.Xb(11,"tbody"),m.Vc(12,qr,31,11,"tr",10),m.Wb(),m.Wb()),2&e){const e=m.Ic(1),t=m.ic();m.rc("nzData",t.planOfCares)("nzShowPagination",!1),m.Db(12),m.rc("ngForOf",e.data)}}function Qr(e,t){1&e&&(m.Vb(0),m.Xb(1,"strong"),m.Xc(2),m.jc(3,"translate"),m.Wb(),m.Ub()),2&e&&(m.Db(2),m.Zc("",m.kc(3,1,"COMMON.CONDITION_MANAGEMENT")," has not been assigned yet!"))}let Jr=(()=>{class e{constructor(e,t,n,i,s,a){this._router=e,this._activatedRoute=t,this._planOfCareService=n,this._notificationsService=i,this._modalService=s,this._analyticsService=a,this.refresh=new m.n}ngOnInit(){this.getPlanOfCare()}getPlanOfCare(){this._planOfCareService.fetchPlanOfCare(this.patientId).subscribe(e=>{this.planOfCares=e})}viewHistory(){var e,t;this._router.navigate([`episodes/plan-of-care/details/${this.patientId}/${null===(e=this.episodeDetails)||void 0===e?void 0:e.id}`],{queryParams:{tab:"history",patientName:null===(t=this.patient)||void 0===t?void 0:t.fullName}})}addPlanOfCare(){var e;this._router.navigate([`episodes/plan-of-care/${this.patientId}/${null===(e=this.episodeDetails)||void 0===e?void 0:e.id}`])}edit(e){this._router.navigate([`episodes/plan-of-care/edit/${e}/${this.patientId}/${this._activatedRoute.snapshot.params.episodeId}`])}delete(e){this._planOfCareService.archivePlanOfCare(e).subscribe(()=>{this._notificationsService.success("Plan Of Care","Provider's plan of care removed successfully"),this.getPlanOfCare(),this.refresh.emit()})}logEvent(e,t){this._modalService.create({nzTitle:"Log Event",nzContent:zr.a,nzComponentParams:{planOfCareId:e,planOfCare:t},nzBodyStyle:{paddingTop:"0"},nzStyle:{top:"20px"},nzWidth:"800px",nzFooter:null,nzMaskClosable:!1,nzKeyboard:!1}).afterClose.subscribe(e=>{e&&(this.getPlanOfCare(),this.refresh.emit())})}viewEventHistory(e){this._modalService.create({nzTitle:"Event History",nzContent:Mr.a,nzComponentParams:{events:null==e?void 0:e.events,staffMap:null==e?void 0:e.staffMap},nzBodyStyle:{paddingTop:"0"},nzStyle:{top:"20px"},nzWidth:"800px",nzFooter:null})}show(e){this._modalService.create({nzTitle:"Plan Of Care Details",nzContent:Ur,nzComponentParams:{planOfCare:e},nzBodyStyle:{paddingTop:"0"},nzStyle:{top:"20px"},nzWidth:"800px",nzFooter:null})}downloadReport(){const e=new Date,t=e.getUTCMonth()+1,n=e.getUTCFullYear();this._analyticsService.generatePlanOfCareReport(this.episodeDetails.patientId,t<10?n+"-0"+t:n+"-"+t).subscribe(e=>{window.open(`https://api.cooeyhealth.com/v1/assets/view/?filename=${e.filename}&asset-type=REPORTS`,"_blank")})}}return e.\u0275fac=function(t){return new(t||e)(m.Rb(C.g),m.Rb(C.a),m.Rb(a.a),m.Rb(D.b),m.Rb(We.f),m.Rb(oa.a))},e.\u0275cmp=m.Lb({type:e,selectors:[["app-conditions-management"]],inputs:{episodeDetails:"episodeDetails",patient:"patient",patientId:"patientId"},outputs:{refresh:"refresh"},decls:18,vars:5,consts:[["nz-row","","nzGutter","16"],["nz-col","","nzFlex","1"],["nz-typography",""],["nz-col",""],["nz-button","","id","full-width-button","nzSize","large",3,"click"],["nz-button","","id","full-width-button","nzType","primary","nzSize","large",3,"click"],[3,"nzData","nzShowPagination",4,"ngIf"],[4,"ngIf"],[3,"nzData","nzShowPagination"],["basicTable",""],[4,"ngFor","ngForOf"],[3,"ngSwitch"],[4,"ngSwitchCase"],["nz-row","","nzJustify","end"],["nz-tooltip","","nzTooltipTitle","Log Event","name","plusCircle",3,"click"],["nzType","vertical"],["nz-tooltip","","nzTooltipTitle","View Event History","name","history",3,"click"],["nz-tooltip","","nzTooltipTitle","Edit","name","edit",3,"click"],["nz-tooltip","","nzTooltipTitle","View","name","view",3,"click"],["nz-tooltip","","nzTooltipTitle","Delete","name","delete","nz-popconfirm","","nzPopconfirmTitle","Are you sure you want to delete this plan of care?","nzPopconfirmPlacement","bottom",3,"nzOnConfirm"],["nzColor","#a7c853"],["nzColor","gold"],["nzColor","#c81c1c"],["nzColor","gainsboro"]],template:function(e,t){1&e&&(m.Xb(0,"nz-card"),m.Xb(1,"div",0),m.Xb(2,"div",1),m.Xb(3,"h3",2),m.Xc(4),m.jc(5,"translate"),m.Wb(),m.Wb(),m.Xb(6,"div",3),m.Xb(7,"button",4),m.ec("click",function(){return t.viewHistory()}),m.Xc(8," History "),m.Wb(),m.Wb(),m.Xb(9,"div",3),m.Xb(10,"button",5),m.ec("click",function(){return t.addPlanOfCare()}),m.Xc(11," Add New "),m.Wb(),m.Wb(),m.Xb(12,"div",3),m.Xb(13,"button",5),m.ec("click",function(){return t.downloadReport()}),m.Xc(14," Download as PDF "),m.Wb(),m.Wb(),m.Wb(),m.Vc(15,Kr,13,3,"nz-table",6),m.Vc(16,Qr,4,3,"ng-container",7),m.Wb(),m.Sb(17,"br")),2&e&&(m.Db(4),m.Yc(m.kc(5,3,"COMMON.CONDITION_MANAGEMENT")),m.Db(11),m.rc("ngIf",t.planOfCares&&(null==t.planOfCares?null:t.planOfCares.length)),m.Db(1),m.rc("ngIf",t.planOfCares&&!(null!=t.planOfCares&&t.planOfCares.length)))},directives:[I.a,O.c,O.a,T.a,mt.a,Ct.a,A.a,s.q,ts.f,ts.n,ts.o,ts.e,ts.l,ts.i,s.p,s.s,s.t,oe.a,je.d,y.a,wi.a,me.a],pipes:[Q.a],styles:[".no-hover[_ngcontent-%COMP%]{pointer-events:none!important}[_nghost-%COMP%]     .ant-table-row:hover{box-shadow:none!important}"]}),e})();class ec{constructor(){this.startDate=new Date,this.status=tc.PENDING}}var tc=function(e){return e.MET="MET",e.UNMET="UNMET",e.PENDING="PENDING",e}({});class nc{}let ic=(()=>{class e{constructor(e){this._http=e,this.rootURL=gt.g.url+"/v3/patient-goals"}savePatientGoal(e){return this._http.post(`${this.rootURL}`,JSON.stringify(e))}updatePatientGoal(e){return this._http.put(`${this.rootURL}`,JSON.stringify(e))}fetchPatientGoals(e,t){return this._http.get(`${this.rootURL}/${e}/${t}`)}}return e.\u0275fac=function(t){return new(t||e)(m.bc(Dn.c))},e.\u0275prov=m.Nb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var sc=n("r0o6");const ac=function(){return{minRows:6,maxRows:9}};let oc=(()=>{class e{constructor(e,t,n,i){this._datePipe=e,this._modalRef=t,this._patientGoalsService=n,this._notificationsService=i,this.disabledDate=e=>Object($.a)(e,this.startDate)<0,this.newNote=new nc}set goal(e){if(!e)return this.patientGoal=new ec,void(this.startDate=new Date);this.patientGoal=JSON.parse(JSON.stringify(e)),this.startDate=JSON.parse(JSON.stringify(null==e?void 0:e.startDate)),this.targetEndDate=JSON.parse(JSON.stringify(null==e?void 0:e.targetEndDate))}ngOnInit(){var e,t,n,i;this.newNote.note=null===(t=null===(e=this.patientGoal)||void 0===e?void 0:e.notes)||void 0===t?void 0:t[(null===(i=null===(n=this.patientGoal)||void 0===n?void 0:n.notes)||void 0===i?void 0:i.length)-1].note}save(){var e,t,n,i,s,a,o,l,r,c;(null===(t=null===(e=this.patientGoal)||void 0===e?void 0:e.patientId)||void 0===t?void 0:t.length)||(this.patientGoal.patientId=this.patientId),(null===(i=null===(n=this.patientGoal)||void 0===n?void 0:n.blueprintId)||void 0===i?void 0:i.length)||(this.patientGoal.blueprintId=this.blueprintId),this.newNote&&(null===(a=null===(s=this.newNote)||void 0===s?void 0:s.note)||void 0===a?void 0:a.length)&&((null===(l=null===(o=this.patientGoal)||void 0===o?void 0:o.notes)||void 0===l?void 0:l.length)||(this.patientGoal.notes=[]),this.newNote.createdBy=localStorage.getItem("loggedInUser"),this.patientGoal.notes.push(this.newNote)),(null===(c=null===(r=this.patientGoal)||void 0===r?void 0:r.id)||void 0===c?void 0:c.length)||(this.patientGoal.startDate=this._datePipe.transform(this.startDate,"yyyy-MM-dd")),this.targetEndDate&&(this.patientGoal.targetEndDate=this._datePipe.transform(this.targetEndDate,"yyyy-MM-dd"));const d=this._patientGoalsService.savePatientGoal(this.patientGoal),b=this._patientGoalsService.updatePatientGoal(this.patientGoal);Object(sc.a)(()=>{var e,t;return!!(null===(t=null===(e=this.patientGoal)||void 0===e?void 0:e.id)||void 0===t?void 0:t.length)},b,d).subscribe(e=>{this._notificationsService.success("Patient Goals","Goal saved successfully!"),this._modalRef.close(e)})}}return e.\u0275fac=function(t){return new(t||e)(m.Rb(s.e),m.Rb(We.e),m.Rb(ic),m.Rb(D.b))},e.\u0275cmp=m.Lb({type:e,selectors:[["app-patient-goals-form"]],inputs:{goal:"goal",patientId:"patientId",blueprintId:"blueprintId"},features:[m.Cb([s.e])],decls:42,vars:17,consts:[[1,"container"],["nz-typography",""],["nz-row","","nzGutter","16"],["nz-col","","nzSpan","24"],["nz-typography","","nzType","danger"],["nz-input","","placeholder","Enter goal name",3,"ngModel","ngModelChange"],["nz-col","","nzSpan","8"],[3,"ngModel","nzDisabled","ngModelChange"],[3,"ngModel","nzDisabledDate","nzDisabled","ngModelChange"],[3,"nzValue","nzLabel"],["nz-input","","placeholder","Enter note...",3,"nzAutosize","ngModel","ngModelChange"],["id","actions"],["nz-button","","nzType","primary",3,"click"]],template:function(e,t){1&e&&(m.Xb(0,"div",0),m.Xb(1,"h3",1),m.Xc(2,"Patient Goal"),m.Wb(),m.Sb(3,"nz-divider"),m.Xb(4,"div",2),m.Xb(5,"div",3),m.Xb(6,"span",4),m.Xc(7,"* "),m.Wb(),m.Xb(8,"strong"),m.Xc(9,"Patient Centered Goal: "),m.Wb(),m.Xb(10,"input",5),m.ec("ngModelChange",function(e){return t.patientGoal.name=e}),m.Wb(),m.Wb(),m.Wb(),m.Sb(11,"br"),m.Xb(12,"div",2),m.Xb(13,"div",6),m.Xb(14,"span",4),m.Xc(15,"* "),m.Wb(),m.Xb(16,"strong"),m.Xc(17,"Start Date: "),m.Wb(),m.Xb(18,"nz-date-picker",7),m.ec("ngModelChange",function(e){return t.startDate=e})("ngModelChange",function(){return t.targetEndDate=null}),m.Wb(),m.Wb(),m.Xb(19,"div",6),m.Xb(20,"strong"),m.Xc(21,"Target End Date: "),m.Wb(),m.Xb(22,"nz-date-picker",8),m.ec("ngModelChange",function(e){return t.targetEndDate=e}),m.Wb(),m.Wb(),m.Xb(23,"div",6),m.Xb(24,"span",4),m.Xc(25,"* "),m.Wb(),m.Xb(26,"strong"),m.Xc(27,"Status: "),m.Wb(),m.Xb(28,"nz-select",7),m.ec("ngModelChange",function(e){return t.patientGoal.status=e}),m.Sb(29,"nz-option",9),m.Sb(30,"nz-option",9),m.Sb(31,"nz-option",9),m.Wb(),m.Wb(),m.Wb(),m.Sb(32,"br"),m.Xb(33,"div",2),m.Xb(34,"div",3),m.Xb(35,"strong"),m.Xc(36,"Progress Notes: "),m.Wb(),m.Xb(37,"textarea",10),m.ec("ngModelChange",function(e){return t.newNote.note=e}),m.Wb(),m.Wb(),m.Wb(),m.Sb(38,"br"),m.Xb(39,"div",11),m.Xb(40,"button",12),m.ec("click",function(){return t.save()}),m.Xc(41,"Save"),m.Wb(),m.Wb(),m.Wb()),2&e&&(m.Db(10),m.rc("ngModel",t.patientGoal.name),m.Db(8),m.rc("ngModel",t.startDate)("nzDisabled",!(null==t.patientGoal||null==t.patientGoal.id||!t.patientGoal.id.length)),m.Db(4),m.rc("ngModel",t.targetEndDate)("nzDisabledDate",t.disabledDate)("nzDisabled","MET"===(null==t.patientGoal?null:t.patientGoal.status)),m.Db(6),m.rc("ngModel",t.patientGoal.status)("nzDisabled","MET"===(null==t.patientGoal?null:t.patientGoal.status)),m.Db(1),m.rc("nzValue","PENDING")("nzLabel","Pending"),m.Db(1),m.rc("nzValue","UNMET")("nzLabel","Unmet"),m.Db(1),m.rc("nzValue","MET")("nzLabel","Met"),m.Db(6),m.rc("nzAutosize",m.xc(16,ac))("ngModel",t.newNote.note))},directives:[T.a,y.a,O.c,O.a,N.b,c.d,c.u,c.x,K.a,z.d,z.a,N.a,mt.a,Ct.a,A.a],styles:["h3[_ngcontent-%COMP%]{font-size:18px}#actions[_ngcontent-%COMP%]{display:block;width:100%;text-align:right}"]}),e})();function lc(e,t){if(1&e){const e=m.Yb();m.Xb(0,"div",5),m.Xb(1,"button",6),m.ec("click",function(){return m.Lc(e),m.ic().saveGoal()}),m.Xc(2,"Add Patient Goal"),m.Wb(),m.Wb()}}function rc(e,t){1&e&&(m.Xb(0,"nz-tag",12),m.Xc(1,"Pending"),m.Wb()),2&e&&m.rc("nzColor","blue")}function cc(e,t){1&e&&(m.Xb(0,"nz-tag",12),m.Xc(1,"Unmet"),m.Wb()),2&e&&m.rc("nzColor","orange")}function dc(e,t){1&e&&(m.Xb(0,"nz-tag",12),m.Xc(1,"Met"),m.Wb()),2&e&&m.rc("nzColor","green")}function bc(e,t){1&e&&(m.Xb(0,"strong"),m.Xc(1," No notes have been added yet. "),m.Wb())}function pc(e,t){if(1&e&&(m.Xb(0,"nz-timeline-item"),m.Xc(1),m.jc(2,"titlecase"),m.Sb(3,"br"),m.Xb(4,"em",13),m.Xc(5),m.jc(6,"date"),m.Wb(),m.Wb()),2&e){const e=t.$implicit,n=m.ic(2).$implicit;m.Db(1),m.Zc(" ",m.kc(2,4,null==e?null:e.note)," "),m.Db(4),m.bd(" ",(null==e?null:e.note)==(null==n||null==n.notes[0]?null:n.notes[0].note)?"Added ":"Edited ","",null!=e&&e.context?"by "+(null==e?null:e.context):""," on ",m.lc(6,6,null==e?null:e.createdAt,"mediumDate")," ")}}function uc(e,t){if(1&e&&(m.Vb(0),m.Xb(1,"strong"),m.Xc(2,"Notes:"),m.Wb(),m.Sb(3,"br"),m.Sb(4,"br"),m.Xb(5,"nz-timeline"),m.Vc(6,pc,7,9,"nz-timeline-item",4),m.Wb(),m.Ub()),2&e){const e=m.ic().$implicit;m.Db(6),m.rc("ngForOf",null==e?null:e.notes)}}function hc(e,t){if(1&e){const e=m.Yb();m.Vb(0),m.Xb(1,"tr"),m.Xb(2,"td",7),m.ec("nzExpandChange",function(n){m.Lc(e);const i=t.$implicit;return m.ic().onExpandChange(i.id,n)}),m.Wb(),m.Xb(3,"td"),m.Xc(4),m.Wb(),m.Xb(5,"td"),m.Xc(6),m.jc(7,"date"),m.Wb(),m.Xb(8,"td"),m.Xc(9),m.jc(10,"date"),m.Wb(),m.Xb(11,"td"),m.Xc(12),m.jc(13,"date"),m.Wb(),m.Xb(14,"td"),m.Vc(15,rc,2,1,"nz-tag",8),m.Vc(16,cc,2,1,"nz-tag",8),m.Vc(17,dc,2,1,"nz-tag",8),m.Wb(),m.Xb(18,"td"),m.Xb(19,"app-icons",9),m.ec("click",function(){m.Lc(e);const n=t.$implicit;return m.ic().saveGoal(n)}),m.Wb(),m.Wb(),m.Wb(),m.Xb(20,"tr",10),m.Vc(21,bc,2,0,"strong",11),m.Vc(22,uc,7,1,"ng-container",11),m.Wb(),m.Ub()}if(2&e){const e=t.$implicit,n=m.ic();m.Db(2),m.rc("nzExpand",n.expandSet.has(e.id)),m.Db(2),m.Yc(e.name),m.Db(2),m.Yc(m.lc(7,11,e.startDate,"mediumDate")||"N/A"),m.Db(3),m.Yc(m.lc(10,14,e.targetEndDate,"mediumDate")||"N/A"),m.Db(3),m.Yc(m.lc(13,17,e.endDate,"mediumDate")||"N/A"),m.Db(3),m.rc("ngIf","PENDING"===e.status),m.Db(1),m.rc("ngIf","UNMET"===e.status),m.Db(1),m.rc("ngIf","MET"===e.status),m.Db(3),m.rc("nzExpand",n.expandSet.has(e.id)),m.Db(1),m.rc("ngIf",!(null!=e&&null!=e.notes&&e.notes.length)),m.Db(1),m.rc("ngIf",null==e||null==e.notes?null:e.notes.length)}}let gc=(()=>{class e{constructor(e,t,n){this._patientGoalsService=e,this._activatedRoute=t,this._modalService=n,this.expandSet=new Set}ngOnInit(){this.getAllGoals()}getAllGoals(){this._patientGoalsService.fetchPatientGoals(this.patientId,this.blueprintId).subscribe(e=>{this.patientGoals=e})}onExpandChange(e,t){t?this.expandSet.add(e):this.expandSet.delete(e)}saveGoal(e){this._modalService.create({nzContent:oc,nzComponentParams:{goal:e,patientId:this.patientId,blueprintId:this.blueprintId},nzWidth:700,nzFooter:null}).afterClose.subscribe(e=>{(null==e?void 0:e.id)&&this.getAllGoals()})}}return e.\u0275fac=function(t){return new(t||e)(m.Rb(ic),m.Rb(C.a),m.Rb(We.f))},e.\u0275cmp=m.Lb({type:e,selectors:[["app-patient-goals"]],inputs:{patientId:"patientId",blueprintId:"blueprintId",hideAction:"hideAction"},decls:21,vars:3,consts:[["id","actions",4,"ngIf"],["nzTableLayout","fixed",3,"nzData"],["patientGoalsTable",""],["nzWidth","60px"],[4,"ngFor","ngForOf"],["id","actions"],["nz-button","","nzType","primary",3,"click"],[3,"nzExpand","nzExpandChange"],[3,"nzColor",4,"ngIf"],["name","edit",3,"click"],[3,"nzExpand"],[4,"ngIf"],[3,"nzColor"],["nz-typography","","nzType","secondary"]],template:function(e,t){if(1&e&&(m.Xb(0,"div"),m.Vc(1,lc,3,0,"div",0),m.Xb(2,"nz-table",1,2),m.Xb(4,"thead"),m.Xb(5,"tr"),m.Sb(6,"th",3),m.Xb(7,"th"),m.Xc(8,"Name"),m.Wb(),m.Xb(9,"th"),m.Xc(10,"Start Date"),m.Wb(),m.Xb(11,"th"),m.Xc(12,"Target Date"),m.Wb(),m.Xb(13,"th"),m.Xc(14,"End Date"),m.Wb(),m.Xb(15,"th"),m.Xc(16,"Status"),m.Wb(),m.Xb(17,"th"),m.Xc(18,"Actions"),m.Wb(),m.Wb(),m.Wb(),m.Xb(19,"tbody"),m.Vc(20,hc,23,20,"ng-container",4),m.Wb(),m.Wb(),m.Wb()),2&e){const e=m.Ic(3);m.Db(1),m.rc("ngIf",!t.hideAction),m.Db(1),m.rc("nzData",t.patientGoals),m.Db(18),m.rc("ngForOf",null==e?null:e.data)}},directives:[s.q,ts.f,ts.n,ts.o,ts.e,ts.l,ts.i,s.p,mt.a,Ct.a,A.a,ts.j,oe.a,ts.p,ts.g,me.a,Ci.a,Ci.b,T.a],pipes:[s.e,s.A],styles:["#actions[_ngcontent-%COMP%]{display:block;width:100%;text-align:right}"]}),Object(ur.b)([Object(hr.a)(),Object(ur.c)("design:type",Boolean)],e.prototype,"hideAction",void 0),e})(),fc=(()=>{class e{constructor(){}ngOnInit(){}addGoal(){var e;null===(e=this.patientGoals)||void 0===e||e.saveGoal()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=m.Lb({type:e,selectors:[["app-careplan-patient-goals"]],viewQuery:function(e,t){if(1&e&&m.ed(gc,1),2&e){let e;m.Hc(e=m.fc())&&(t.patientGoals=e.first)}},inputs:{patientId:"patientId",blueprintId:"blueprintId"},decls:12,vars:8,consts:[["nz-row","","nzJustify","space-between"],["nz-col",""],["nz-typography",""],["nz-button","","nzType","primary",3,"click"],["hideAction","",3,"patientId","blueprintId"]],template:function(e,t){1&e&&(m.Xb(0,"nz-card"),m.Xb(1,"div",0),m.Xb(2,"div",1),m.Xb(3,"h3",2),m.Xc(4),m.jc(5,"translate"),m.Wb(),m.Wb(),m.Xb(6,"div",1),m.Xb(7,"button",3),m.ec("click",function(){return t.addGoal()}),m.Xc(8),m.jc(9,"translate"),m.Wb(),m.Wb(),m.Wb(),m.Sb(10,"app-patient-goals",4),m.Wb(),m.Sb(11,"br")),2&e&&(m.Db(4),m.Yc(m.kc(5,4,"COMMON.PATIENT_GOALS")),m.Db(4),m.Zc(" ",m.kc(9,6,"COMMON.ADD_NEW")," "),m.Db(2),m.rc("patientId",t.patientId)("blueprintId",t.blueprintId))},directives:[I.a,O.c,O.a,T.a,mt.a,Ct.a,A.a,gc],pipes:[Q.a],styles:[""]}),e})();var vc=n("KAwd");function mc(e,t){if(1&e&&(m.Xb(0,"tr",6),m.Xb(1,"td",7),m.Xc(2),m.Wb(),m.Xb(3,"td"),m.Xc(4),m.jc(5,"titlecase"),m.Wb(),m.Xb(6,"td"),m.Xc(7),m.Wb(),m.Xb(8,"td"),m.Xc(9),m.Wb(),m.Xb(10,"td"),m.Xc(11),m.jc(12,"date"),m.Wb(),m.Xb(13,"td"),m.Xc(14),m.Wb(),m.Wb()),2&e){const e=t.$implicit;m.tc("routerLink","/form/evalforms/view/",null==e?null:e._id,""),m.Db(1),m.sc("nzTooltipTitle",null==e||null==e.schema?null:e.schema.description),m.Db(1),m.Zc(" ",null==e||null==e.schema?null:e.schema.title," "),m.Db(2),m.Yc("SCORED_ASSESSMENT"===(null==e||null==e.schema?null:e.schema.type)?"Scored Assessment":m.kc(5,8,null==e||null==e.schema?null:e.schema.type)),m.Db(3),m.Yc("SCORED_ASSESSMENT"===(null==e||null==e.schema?null:e.schema.type)?null==e?null:e.evaluatedScore:"NA"),m.Db(2),m.Yc("SCORED_ASSESSMENT"===(null==e||null==e.schema?null:e.schema.type)?null==e?null:e.identifiedRisk:"NA"),m.Db(2),m.Yc(m.lc(12,10,null==e?null:e.assessedOn,"medium")),m.Db(3),m.Yc((null==e||null==e.careplan?null:e.careplan.name)||"N/A")}}let Cc=(()=>{class e{constructor(e){this._formsService=e}ngOnInit(){this.getAssessedFormsForPatients()}getAssessedFormsForPatients(e=0){this._formsService.getPatientEvalForms(this.patientId,e,10).subscribe(e=>{var t,n,i,s;this.forms=null===(n=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.answers)||void 0===n?void 0:n.obj,this.count=null===(s=null===(i=null==e?void 0:e.data)||void 0===i?void 0:i.answers)||void 0===s?void 0:s.total})}}return e.\u0275fac=function(t){return new(t||e)(m.Rb(to.a))},e.\u0275cmp=m.Lb({type:e,selectors:[["app-poc-assessed-forms"]],inputs:{patientId:"patientId"},decls:31,vars:24,consts:[["nz-row","","nzJustify","space-between"],["nz-col",""],["nz-typography",""],[3,"nzData","nzTotal"],["formsTable",""],[3,"routerLink",4,"ngFor","ngForOf"],[3,"routerLink"],["nz-tooltip","",3,"nzTooltipTitle"]],template:function(e,t){if(1&e&&(m.Xb(0,"nz-card"),m.Xb(1,"div",0),m.Xb(2,"div",1),m.Xb(3,"h3",2),m.Xc(4),m.jc(5,"translate"),m.Wb(),m.Wb(),m.Wb(),m.Xb(6,"nz-table",3,4),m.Xb(8,"thead"),m.Xb(9,"tr"),m.Xb(10,"th"),m.Xc(11),m.jc(12,"translate"),m.Wb(),m.Xb(13,"th"),m.Xc(14),m.jc(15,"translate"),m.Wb(),m.Xb(16,"th"),m.Xc(17),m.jc(18,"translate"),m.Wb(),m.Xb(19,"th"),m.Xc(20),m.jc(21,"translate"),m.Wb(),m.Xb(22,"th"),m.Xc(23),m.jc(24,"translate"),m.Wb(),m.Xb(25,"th"),m.Xc(26),m.jc(27,"translate"),m.Wb(),m.Wb(),m.Wb(),m.Xb(28,"tbody"),m.Vc(29,mc,15,13,"tr",5),m.Wb(),m.Wb(),m.Wb(),m.Sb(30,"br")),2&e){const e=m.Ic(7);m.Db(4),m.Yc(m.kc(5,10,"COMMON.CARE_PLAN_ASSESSMENT")),m.Db(2),m.rc("nzData",t.forms)("nzTotal",t.count),m.Db(5),m.Yc(m.kc(12,12,"COMMON.NAME")),m.Db(3),m.Yc(m.kc(15,14,"PURPOSE")),m.Db(3),m.Yc(m.kc(18,16,"SCORE")),m.Db(3),m.Yc(m.kc(21,18,"RISK_CATEGORY")),m.Db(3),m.Yc(m.kc(24,20,"COMMON.DATE")),m.Db(3),m.Yc(m.kc(27,22,"CARE_PLAN")),m.Db(3),m.rc("ngForOf",null==e?null:e.data)}},directives:[I.a,O.c,O.a,T.a,ts.f,ts.n,ts.o,ts.e,ts.l,ts.i,s.p,C.h,je.d],pipes:[Q.a,s.A,s.e],styles:[""]}),e})();function Dc(e,t){if(1&e&&(m.Xb(0,"tr",6),m.Xb(1,"td",7),m.Xc(2),m.Wb(),m.Xb(3,"td"),m.Xc(4),m.jc(5,"titlecase"),m.Wb(),m.Xb(6,"td"),m.Xc(7),m.Wb(),m.Xb(8,"td"),m.Xc(9),m.Wb(),m.Xb(10,"td"),m.Xc(11),m.jc(12,"date"),m.Wb(),m.Wb()),2&e){const e=t.$implicit;m.tc("routerLink","/form/directevalforms/view/",null==e?null:e._id,""),m.Db(1),m.sc("nzTooltipTitle",null==e||null==e.schema?null:e.schema.description),m.Db(1),m.Zc(" ",null==e||null==e.schema?null:e.schema.title," "),m.Db(2),m.Yc("SCORED_ASSESSMENT"===(null==e||null==e.schema?null:e.schema.type)?"Scored Assessment":m.kc(5,7,null==e||null==e.schema?null:e.schema.type)),m.Db(3),m.Yc("SCORED_ASSESSMENT"===(null==e||null==e.schema?null:e.schema.type)?null==e?null:e.evaluatedScore:"NA"),m.Db(2),m.Yc("SCORED_ASSESSMENT"===(null==e||null==e.schema?null:e.schema.type)?null==e?null:e.identifiedRisk:"NA"),m.Db(2),m.Yc(m.lc(12,9,null==e?null:e.assessedOn,"medium"))}}let Sc=(()=>{class e{constructor(e){this._formsService=e}ngOnInit(){this.getDirectFormsForPatients()}getDirectFormsForPatients(e=0){this._formsService.getPatientDirectForms(this.patientId,e,10).subscribe(e=>{var t,n,i,s;this.forms=null===(n=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.answers)||void 0===n?void 0:n.obj,this.count=null===(s=null===(i=null==e?void 0:e.data)||void 0===i?void 0:i.answers)||void 0===s?void 0:s.total})}}return e.\u0275fac=function(t){return new(t||e)(m.Rb(to.a))},e.\u0275cmp=m.Lb({type:e,selectors:[["app-episode-direct-forms"]],inputs:{patientId:"patientId"},decls:28,vars:21,consts:[["nz-row","","nzJustify","space-between"],["nz-col",""],["nz-typography",""],[3,"nzData","nzTotal"],["formsTable",""],[3,"routerLink",4,"ngFor","ngForOf"],[3,"routerLink"],["nz-tooltip","",3,"nzTooltipTitle"]],template:function(e,t){if(1&e&&(m.Xb(0,"nz-card"),m.Xb(1,"div",0),m.Xb(2,"div",1),m.Xb(3,"h3",2),m.Xc(4),m.jc(5,"translate"),m.Wb(),m.Wb(),m.Wb(),m.Xb(6,"nz-table",3,4),m.Xb(8,"thead"),m.Xb(9,"tr"),m.Xb(10,"th"),m.Xc(11),m.jc(12,"translate"),m.Wb(),m.Xb(13,"th"),m.Xc(14),m.jc(15,"translate"),m.Wb(),m.Xb(16,"th"),m.Xc(17),m.jc(18,"translate"),m.Wb(),m.Xb(19,"th"),m.Xc(20),m.jc(21,"translate"),m.Wb(),m.Xb(22,"th"),m.Xc(23),m.jc(24,"translate"),m.Wb(),m.Wb(),m.Wb(),m.Xb(25,"tbody"),m.Vc(26,Dc,13,12,"tr",5),m.Wb(),m.Wb(),m.Wb(),m.Sb(27,"br")),2&e){const e=m.Ic(7);m.Db(4),m.Yc(m.kc(5,9,"COMMON.CARE_PLAN_ASSESSMENT")),m.Db(2),m.rc("nzData",t.forms)("nzTotal",t.count),m.Db(5),m.Yc(m.kc(12,11,"COMMON.NAME")),m.Db(3),m.Yc(m.kc(15,13,"PURPOSE")),m.Db(3),m.Yc(m.kc(18,15,"SCORE")),m.Db(3),m.Yc(m.kc(21,17,"RISK_CATEGORY")),m.Db(3),m.Yc(m.kc(24,19,"COMMON.DATE")),m.Db(3),m.rc("ngForOf",null==e?null:e.data)}},directives:[I.a,O.c,O.a,T.a,ts.f,ts.n,ts.o,ts.e,ts.l,ts.i,s.p,C.h,je.d],pipes:[Q.a,s.A,s.e],styles:[""]}),e})();function Ec(e,t){if(1&e&&m.Sb(0,"app-poc-assessed-forms",20),2&e){const e=m.ic(2);m.rc("patientId",e.patientId)("blueprintId",e.blueprintId)}}function Oc(e,t){if(1&e&&m.Sb(0,"app-episode-direct-forms",20),2&e){const e=m.ic(2);m.rc("patientId",e.patientId)("blueprintId",e.blueprintId)}}function Ic(e,t){1&e&&(m.Xb(0,"button",21),m.Sb(1,"app-icons",22),m.Wb())}const _c=function(){return[24,24]};function Xc(e,t){if(1&e){const e=m.Yb();m.Vb(0),m.Xb(1,"div",2),m.Sb(2,"app-patient-details",3),m.Xb(3,"div",4),m.Xb(4,"div",5),m.Xb(5,"span",6),m.Xc(6),m.jc(7,"translate"),m.Wb(),m.Wb(),m.Xb(8,"div",5),m.Xb(9,"span",7),m.ec("click",function(){return m.Lc(e),m.ic().scrollTo("staff-details")}),m.Xc(10),m.jc(11,"translate"),m.Wb(),m.Wb(),m.Xb(12,"div",8),m.Xb(13,"span",7),m.ec("click",function(){return m.Lc(e),m.ic().scrollTo("home-community")}),m.Xc(14),m.jc(15,"translate"),m.Wb(),m.Wb(),m.Xb(16,"div",8),m.Xb(17,"span",7),m.ec("click",function(){return m.Lc(e),m.ic().scrollTo("patient-forms")}),m.Xc(18),m.jc(19,"translate"),m.Wb(),m.Wb(),m.Xb(20,"div",8),m.Xb(21,"span",7),m.ec("click",function(){return m.Lc(e),m.ic().scrollTo("health-screening")}),m.Xc(22),m.jc(23,"translate"),m.Wb(),m.Wb(),m.Xb(24,"div",8),m.Xb(25,"span",7),m.ec("click",function(){return m.Lc(e),m.ic().scrollTo("poc")}),m.Xc(26),m.jc(27,"translate"),m.Wb(),m.Wb(),m.Xb(28,"div",9),m.Xb(29,"span",7),m.ec("click",function(){return m.Lc(e),m.ic().scrollTo("goals")}),m.Xc(30),m.jc(31,"translate"),m.Wb(),m.Wb(),m.Wb(),m.Sb(32,"app-problem-list",10),m.Sb(33,"app-staff-details",11),m.Sb(34,"app-careplan-home-community",12),m.Xb(35,"div",13),m.Vc(36,Ec,1,2,"app-poc-assessed-forms",14),m.Vc(37,Oc,1,2,"app-episode-direct-forms",14),m.Wb(),m.Sb(38,"app-health-screenings",15),m.Xb(39,"app-conditions-management",16),m.ec("refresh",function(){return m.Lc(e),m.ic().getEpisodeData()}),m.Wb(),m.Sb(40,"app-careplan-patient-goals",17),m.Vb(41),m.Xb(42,"nz-back-top",18),m.Vc(43,Ic,2,0,"ng-template",null,19,m.Wc),m.Wb(),m.Ub(),m.Wb(),m.Ub()}if(2&e){const e=m.Ic(44),t=m.ic();m.Db(2),m.rc("patientDetails",t.patient)("episodeDetails",t.episodeDetails),m.Db(1),m.rc("nzGutter",m.xc(41,_c)),m.Db(3),m.Yc(m.kc(7,27,"COMMON.PROBLEM_LIST")),m.Db(4),m.Yc(m.kc(11,29,"COMMON.PATIENT_CARE_TEAM")),m.Db(4),m.Yc(m.kc(15,31,"COMMON.HOME_COMMUNITY_RESOURCE")),m.Db(4),m.Yc(m.kc(19,33,"COMMON.CARE_PLAN_ASSESSMENT")),m.Db(4),m.Yc(m.kc(23,35,"COMMON.HEALTH_SCREENING")),m.Db(4),m.Yc(m.kc(27,37,"COMMON.CONDITION_MANAGEMENT")),m.Db(4),m.Yc(m.kc(31,39,"COMMON.PATIENT_GOALS")),m.Db(2),m.rc("icdCodes",null==t.patient||null==t.patient.healthInfo?null:t.patient.healthInfo.dxCodes),m.Db(1),m.rc("staffs",t.staffs)("primaryIds",t.primaryIds)("patientId",t.patientId)("blueprintId",t.blueprintId),m.Db(1),m.rc("patientId",t.patientId)("blueprintId",t.blueprintId),m.Db(2),m.rc("ngIf",t.isCareplanEnabled),m.Db(1),m.rc("ngIf",!t.isCareplanEnabled),m.Db(1),m.rc("patientId",t.patientId)("blueprintId",t.blueprintId),m.Db(1),m.rc("patientId",t.patientId)("episodeDetails",t.episodeDetails)("patient",t.patient),m.Db(1),m.rc("patientId",t.patientId)("blueprintId",t.blueprintId),m.Db(2),m.rc("nzTemplate",e)}}const Tc=[{path:"form/:mode/:patientId",component:Ue},{path:"consent/sms/:patientId/:episodeType/:episodeId/:actionItemId",component:Ha},{path:"consent/sms/submitted/:status",component:Ja},{path:"details/:patientId/:episodeId",data:{privileges:[xa.a.VIEW_EPISODE],showTenantToggle:!1},component:La,canActivate:[ka.a,Va.a]},{path:"ccm/careplan/:patientId/:episodeId/:blueprintId",data:{privileges:[xa.a.VIEW_EPISODE],showTenantToggle:!1},component:(()=>{class e extends h.a{constructor(e,t,n,i,s,a,o,l,r){super(),this._episodesService=e,this._activatedRoute=t,this._dataSharingService=n,this._notificationsService=i,this._patientsService=s,this._staffService=a,this._careplanService=o,this._router=l,this.scroller=r,this.scroller.setOffset([0,150])}ngOnInit(){this.getDataFromURL(),this.getTenantConfig(),this.getEpisodeData(),this.getStaffDetails(this.patientId)}getDataFromURL(){this.patientId=this._activatedRoute.snapshot.params.patientId,this.episodeId=this._activatedRoute.snapshot.params.episodeId,this.blueprintId=this._activatedRoute.snapshot.params.blueprintId}getTenantConfig(){this._dataSharingService.tenantSettings.pipe(Object(f.a)(this.unsubscribed)).subscribe(e=>{this.tenantSettings=e})}getEpisodeData(){this._episodesService.fetchEpisodeDetails(this.episodeId).subscribe(e=>{this.episodeDetails&&JSON.stringify(e)===JSON.stringify(this.episodeDetails)||(this.episodeDetails=void 0,setTimeout(()=>{var t;this.episodeDetails=e,this.isCareplanEnabled=(null===(t=null==e?void 0:e.activeCarePlans)||void 0===t?void 0:t.length)>0},50))})}getUserDetails(e){this._patientsService.fetchPatientById(e).subscribe(e=>this.patient=e)}getStaffDetails(e){this._staffService.fetchStaffMemberById(e).subscribe(e=>{var t;this.patient=e.user,this.primaryIds=[],null===(t=this.patient.assignedStaffs)||void 0===t||t.forEach(e=>{"PRIMARY"==(null==e?void 0:e.assignedStaffType)&&this.primaryIds.push(e.staffId)}),this.staffs=[],null!=e.assignedUsers&&null!=e.assignedUsers[d.a.MONITORING_STAFF]&&this.staffs.push(...e.assignedUsers[d.a.MONITORING_STAFF]),null!=e.assignedUsers&&null!=e.assignedUsers[d.a.PHYSICIAN]&&this.staffs.push(...e.assignedUsers[d.a.PHYSICIAN])})}scrollTo(e){this.scroller.scrollToAnchor(e)}}return e.\u0275fac=function(t){return new(t||e)(m.Rb(u.a),m.Rb(C.a),m.Rb(H.a),m.Rb(D.b),m.Rb(p.a),m.Rb(l.a),m.Rb(xo.a),m.Rb(C.g),m.Rb(s.D))},e.\u0275cmp=m.Lb({type:e,selectors:[["app-episode-careplan-details"]],features:[m.Ab],decls:2,vars:5,consts:[["title","episodeForm",3,"defaultTitle","isSearchEnabled","isActionEnabled"],[4,"ngIf"],[1,"container"],[3,"patientDetails","episodeDetails"],["nz-row","","nzJustify","start","nzAlign","middle",1,"pad-20",3,"nzGutter"],["nz-col","",1,"vertical-divider"],[1,"inactive-title"],[1,"active-title",3,"click"],["nz-col","",1,"vertical-divider","text-center"],["nz-col","",1,"text-center"],[3,"icdCodes"],["id","staff-details",3,"staffs","primaryIds","patientId","blueprintId"],["id","home-community",3,"patientId","blueprintId"],["id","patient-forms"],[3,"patientId","blueprintId",4,"ngIf"],["id","health-screening",3,"patientId","blueprintId"],["id","poc",3,"patientId","episodeDetails","patient","refresh"],["id","goals",3,"patientId","blueprintId"],[3,"nzTemplate"],["backUp",""],[3,"patientId","blueprintId"],["nz-button","","nzType","primary","nzShape","circle",1,"scrollup"],["name","up","color","#ffffff","size","20",2,"margin","0px"]],template:function(e,t){1&e&&(m.Sb(0,"app-header",0),m.Vc(1,Xc,45,42,"ng-container",1)),2&e&&(m.uc("defaultTitle","",null==t.patient?null:t.patient.fullName," | ",null==t.episodeDetails?null:t.episodeDetails.name,""),m.rc("isSearchEnabled",!1)("isActionEnabled",!1),m.Db(1),m.rc("ngIf",t.tenantSettings&&t.episodeDetails))},directives:[we.a,s.q,Zl,O.c,O.a,Kl,pr,Er,Nr,Jr,fc,vc.a,Cc,Sc,mt.a,Ct.a,A.a,oe.a],pipes:[Q.a],styles:['.scrollup[_ngcontent-%COMP%]{height:43px;width:43px;font-size:16px}[_nghost-%COMP%]     .ant-back-top{bottom:48px;right:48px}.vertical-divider[_ngcontent-%COMP%]{content:""}.vertical-divider[_ngcontent-%COMP%]:before{border-right:2px solid #000;height:40%;position:absolute;right:0;bottom:12px;top:14px;content:""}.text-center[_ngcontent-%COMP%]{text-align:center}.active-title[_ngcontent-%COMP%]{color:var(--primary-color);cursor:pointer}.active-title[_ngcontent-%COMP%], .inactive-title[_ngcontent-%COMP%]{font-weight:700;font-size:14px;margin-left:16px;margin-right:16px}.inactive-title[_ngcontent-%COMP%]{color:#000}.pad-20[_ngcontent-%COMP%]{padding:10px 10px 40px}']}),e})(),canActivate:[ka.a,Va.a]},{path:"consentCertificate/:episodeId",data:{showTenantToggle:!1},component:Ya},{path:"plan-of-care/:patientId/:episodeId",component:j,data:eo.PlanOfCare},{path:"plan-of-care/edit/:planOfCareId/:patientId/:episodeId",component:j,data:eo.PlanOfCare},{path:"plan-of-care/details/:patientId/:episodeId",component:fo,data:eo.PlanOfCareTimeline},{path:"billing-rate",component:Lo,data:eo.EpisodeBillingRate}];let Nc=(()=>{class e{}return e.\u0275mod=m.Pb({type:e}),e.\u0275inj=m.Ob({factory:function(t){return new(t||e)},imports:[[C.k.forChild(Tc)],C.k]}),e})();var zc=n("KZX/"),Mc=n("UFn0"),yc=n("SHZf"),Ac=n("rbUg");let Pc=(()=>{class e{constructor(e){this.translationService=e,e.setLanguage()}}return e.\u0275mod=m.Pb({type:e}),e.\u0275inj=m.Ob({factory:function(t){return new(t||e)(m.bc(G.a))},imports:[[s.c,Nc,zc.a,Mc.a,c.o,c.B,i.a,W.b,Ac.a,yc.a.forRoot(),Mo.a.forRoot({apiKey:"AIzaSyCkujBUnFmDto5Ui2EKj4AcpWXMrizEDRc",libraries:["places"]})]]}),e})()},wpKq:function(e,t,n){"use strict";n.d(t,"a",function(){return T});var i=n("ighe"),s=n("fXoL"),a=n("dEAy"),o=n("eHCX"),l=n("bE2y"),r=n("3Pt+"),c=n("PTRe"),d=n("B+r4"),b=n("OzZK"),p=n("RwU8"),u=n("C2AL");let h=(()=>{class e{constructor(e,t){this._episodesService=e,this._modalRef=t}suspendEpisode(){var e;const t={episodeId:this.episodeId,reason:"Other"!==this.suspendReason?this.suspendReason+((null===(e=this.otherReason)||void 0===e?void 0:e.trim().length)>0?` : ${this.otherReason}`:""):this.otherReason};this._episodesService.suspendEpisodeNew(t).subscribe(e=>{this._modalRef.close(!0)})}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(i.a),s.Rb(a.e))},e.\u0275cmp=s.Lb({type:e,selectors:[["app-suspender"]],inputs:{episodeId:"episodeId"},decls:17,vars:3,consts:[["nz-typography",""],[3,"ngModel","ngModelChange"],["nz-radio","","nzValue","Patient is hospitalized"],["nz-radio","","nzValue","Moved to a different service area"],["nz-radio","","nzValue","Poor medical condition"],["nz-radio","","nzValue","Other"],["rows","4","nz-input","","placeholder","Add additional notes...",3,"ngModel","ngModelChange"],["nz-row","","nzGutter","32","nzJustify","center"],["nz-col","","nzSpan","14"],["nz-button","","nzSize","large","nzType","primary",1,"suspender",3,"disabled","click"]],template:function(e,t){1&e&&(s.Xb(0,"h3",0),s.Xc(1,"This episode is being suspended because..."),s.Wb(),s.Xb(2,"nz-radio-group",1),s.ec("ngModelChange",function(e){return t.suspendReason=e}),s.Xb(3,"label",2),s.Xc(4,"Patient is hospitalized"),s.Wb(),s.Xb(5,"label",3),s.Xc(6,"Moved to a different service area"),s.Wb(),s.Xb(7,"label",4),s.Xc(8,"Poor medical condition"),s.Wb(),s.Xb(9,"label",5),s.Xc(10,"Other"),s.Wb(),s.Wb(),s.Xb(11,"textarea",6),s.ec("ngModelChange",function(e){return t.otherReason=e}),s.Wb(),s.Xb(12,"div",7),s.Xb(13,"div",8),s.Sb(14,"br"),s.Xb(15,"button",9),s.ec("click",function(){return t.suspendEpisode()}),s.Xc(16," Suspend Episode "),s.Wb(),s.Wb(),s.Wb()),2&e&&(s.Db(2),s.rc("ngModel",t.suspendReason),s.Db(9),s.rc("ngModel",t.otherReason),s.Db(4),s.rc("disabled",!(null!=t.suspendReason&&t.suspendReason.length||null!=t.otherReason&&t.otherReason.length)))},directives:[o.a,l.c,r.u,r.x,l.b,c.b,r.d,d.c,d.a,b.a,p.a,u.a],styles:["h3[_ngcontent-%COMP%]{color:#0f2015;margin-bottom:15px;letter-spacing:0;font:normal normal 700 20px/27px Nunito}.suspender[_ngcontent-%COMP%]{width:100%;margin-top:10px}[_nghost-%COMP%]     .ant-modal-content{border-radius:20px}[nz-radio][_ngcontent-%COMP%]{display:block;height:32px;line-height:32px}textarea[_ngcontent-%COMP%]{background:#f6f6f6 0 0 no-repeat padding-box;border-radius:5px;margin-top:10px}"]}),e})();n("cauy");var g=n("zAKX"),f=n("ofXK"),v=n("FwiY"),m=n("dRHE");function C(e,t){1&e&&(s.Xb(0,"span",16),s.Sb(1,"span",17),s.Xc(2," Primary "),s.Wb())}function D(e,t){if(1&e&&(s.Vb(0),s.Xb(1,"nz-option",12),s.Xb(2,"span",13),s.Xb(3,"span",14),s.Xc(4),s.Wb(),s.Vc(5,C,3,0,"span",15),s.Wb(),s.Wb(),s.Ub()),2&e){const e=t.$implicit,n=s.ic();s.Db(1),s.sc("nzLabel",e.value),s.rc("nzValue",e.key),s.Db(3),s.Zc(" ",e.value," "),s.Db(1),s.rc("ngIf",n.primaryStaff.has(e.key))}}function S(e,t){1&e&&(s.Xb(0,"label",18),s.Xc(1,"Required"),s.Wb())}function E(e,t){if(1&e&&s.Sb(0,"nz-option",19),2&e){const e=t.$implicit;s.rc("nzLabel",e.name+" - "+e.brandName)("nzValue",e.model)}}function O(e,t){1&e&&(s.Xb(0,"label",18),s.Xc(1,"Required"),s.Wb())}const I=function(){return[32,32]},_=function(){return[","]};let X=(()=>{class e{constructor(e){this._modalRef=e,this.primaryStaff=new Set}ngOnInit(){this.patient.monitoringStaffs.primaryStaff.forEach(e=>this.primaryStaff.add(e)),this.patient.physicianStaffs.primaryStaff.forEach(e=>this.primaryStaff.add(e))}onStaffSelect(e){this.selectedStaff=e}assignTasks(){var e;this.staffError=!1,this.deviceError=!1,this.selectedStaff||(this.staffError=!0),(null===(e=this.selectedDevices)||void 0===e?void 0:e.length)||(this.deviceError=!0),this.staffError||this.deviceError||this.close({scheduledTime:Date.now(),caretakerId:this.selectedStaff,deviceModelsForEducation:this.selectedDevices,tenantId:localStorage.getItem("loggedInTenant")})}close(e){this._modalRef.close(e)}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(a.e))},e.\u0275cmp=s.Lb({type:e,selectors:[["app-device-setup-assigner"]],inputs:{monitoringStaff:"monitoringStaff",devices:"devices",patient:"patient"},decls:25,vars:24,consts:[[1,"container"],["nz-typography",""],["nz-row","",3,"nzGutter"],["nz-col","","nzSpan","24"],["nzShowSearch","","nzAllowClear","","nzPlaceHolder","Select Monitoring Staff","ngModel","",3,"ngModelChange"],[4,"ngFor","ngForOf"],["nz-typography","","nzType","danger",4,"ngIf"],["nzMode","tags",3,"nzTokenSeparators","ngModel","ngModelChange"],[3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["nz-row","","nzJustify","end",3,"nzGutter"],["nz-col","","nzSpan","5"],["nz-button","","nzType","primary",3,"click"],["nzCustomContent","",3,"nzLabel","nzValue"],[2,"display","flex"],[2,"width","70%"],["style","width: 30%; text-align: right; color: var(--primary-color);",4,"ngIf"],[2,"width","30%","text-align","right","color","var(--primary-color)"],["nz-icon","","nzType","crown","nzTheme","outline",2,"font-size","14px"],["nz-typography","","nzType","danger"],[3,"nzLabel","nzValue"]],template:function(e,t){1&e&&(s.Xb(0,"div",0),s.Xb(1,"h3",1),s.Xc(2),s.jc(3,"translate"),s.Wb(),s.Xb(4,"div",2),s.Xb(5,"div",3),s.Xb(6,"label"),s.Xc(7,"Add Monitoring Staff"),s.Wb(),s.Xb(8,"nz-select",4),s.ec("ngModelChange",function(e){return t.onStaffSelect(e)}),s.Vc(9,D,6,4,"ng-container",5),s.jc(10,"keyvalue"),s.Wb(),s.Vc(11,S,2,0,"label",6),s.Wb(),s.Wb(),s.Xb(12,"div",2),s.Xb(13,"div",3),s.Xb(14,"label"),s.Xc(15),s.jc(16,"translate"),s.Wb(),s.Xb(17,"nz-select",7),s.ec("ngModelChange",function(e){return t.selectedDevices=e}),s.Vc(18,E,1,2,"nz-option",8),s.Wb(),s.Vc(19,O,2,0,"label",6),s.Wb(),s.Wb(),s.Xb(20,"div",9),s.Xb(21,"div",10),s.Xb(22,"button",11),s.ec("click",function(){return t.assignTasks()}),s.Xc(23),s.jc(24,"translate"),s.Wb(),s.Wb(),s.Wb(),s.Wb()),2&e&&(s.Db(2),s.Yc(s.kc(3,12,"EPISODE.ADDDEVICE_SETUP_TASK")),s.Db(2),s.rc("nzGutter",s.xc(20,I)),s.Db(5),s.rc("ngForOf",s.kc(10,14,t.monitoringStaff)),s.Db(2),s.rc("ngIf",!t.selectedStaff&&t.staffError),s.Db(1),s.rc("nzGutter",s.xc(21,I)),s.Db(3),s.Yc(s.kc(16,16,"DEVICES.ADD")),s.Db(2),s.rc("nzTokenSeparators",s.xc(22,_))("ngModel",t.selectedDevices),s.Db(1),s.rc("ngForOf",t.devices),s.Db(1),s.rc("ngIf",!(null!=t.selectedDevices&&t.selectedDevices.length)&&t.deviceError),s.Db(1),s.rc("nzGutter",s.xc(23,I)),s.Db(3),s.Zc(" ",s.kc(24,18,"COMMON.SAVE")," "))},directives:[o.a,d.c,d.a,g.d,r.u,r.x,f.p,f.q,b.a,p.a,u.a,g.a,v.a],pipes:[m.a,f.j],styles:["h3[_ngcontent-%COMP%]{margin-bottom:20px}label[_ngcontent-%COMP%]{font:normal normal normal 13px/16px Nunito;color:var(--tertiary-color);margin-top:5px;margin-bottom:5px;display:block}"]}),e})(),T=(()=>{class e{constructor(e){this._modalService=e}createDeviceSetupTaskModal(e,t,n){return this._modalService.create({nzContent:X,nzComponentParams:{monitoringStaff:e,devices:t,patient:n},nzWidth:500,nzFooter:null})}createSuspendModal(e){return this._modalService.create({nzContent:h,nzComponentParams:{episodeId:e},nzStyle:{"border-radius":"20px"},nzWidth:470,nzFooter:null})}}return e.\u0275fac=function(t){return new(t||e)(s.bc(a.f))},e.\u0275prov=s.Nb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},xn8p:function(e,t,n){"use strict";n.d(t,"a",function(){return m});var i=n("fXoL"),s=n("ncdi"),a=n("ofXK"),o=n("B+r4"),l=n("eHCX"),r=n("fhRi");function c(e,t){1&e&&(i.Vb(0),i.Xb(1,"p",8),i.Xc(2,"New"),i.Wb(),i.Ub())}function d(e,t){1&e&&(i.Vb(0),i.Xb(1,"p",9),i.Xc(2,"Ongoing"),i.Wb(),i.Ub())}function b(e,t){1&e&&(i.Vb(0),i.Xb(1,"p",10),i.Xc(2,"Improved"),i.Wb(),i.Ub())}function p(e,t){1&e&&(i.Vb(0),i.Xb(1,"p",11),i.Xc(2,"Worsening"),i.Wb(),i.Ub())}function u(e,t){1&e&&(i.Vb(0),i.Xb(1,"p",10),i.Xc(2,"Resolved"),i.Wb(),i.Ub())}function h(e,t){1&e&&(i.Vb(0),i.Xb(1,"p",10),i.Xc(2,"Low"),i.Wb(),i.Ub())}function g(e,t){1&e&&(i.Vb(0),i.Xb(1,"p",9),i.Xc(2,"Medium"),i.Wb(),i.Ub())}function f(e,t){1&e&&(i.Vb(0),i.Xb(1,"p",11),i.Xc(2,"High"),i.Wb(),i.Ub())}function v(e,t){if(1&e&&(i.Xb(0,"nz-timeline-item"),i.Xb(1,"div",2),i.Xb(2,"div",3),i.Xb(3,"p",4),i.Xc(4,"Event"),i.Wb(),i.Wb(),i.Xb(5,"div",5),i.Xb(6,"p",4),i.Xc(7," Entered on "),i.Xb(8,"strong",4),i.Xc(9),i.jc(10,"utcToLocalTime"),i.Wb(),i.Xc(11," by "),i.Xb(12,"strong",4),i.Xc(13),i.jc(14,"titlecase"),i.Wb(),i.Wb(),i.Wb(),i.Wb(),i.Xb(15,"div",2),i.Xb(16,"div",3),i.Xb(17,"p",4),i.Xc(18,"Outcome"),i.Wb(),i.Wb(),i.Xb(19,"div",5),i.Xb(20,"strong"),i.Vb(21,6),i.Vc(22,c,3,0,"ng-container",7),i.Vc(23,d,3,0,"ng-container",7),i.Vc(24,b,3,0,"ng-container",7),i.Vc(25,p,3,0,"ng-container",7),i.Vc(26,u,3,0,"ng-container",7),i.Ub(),i.Wb(),i.Wb(),i.Wb(),i.Xb(27,"div",2),i.Xb(28,"div",3),i.Xb(29,"p",4),i.Xc(30,"Priority"),i.Wb(),i.Wb(),i.Xb(31,"div",5),i.Xb(32,"strong"),i.Vb(33,6),i.Vc(34,h,3,0,"ng-container",7),i.Vc(35,g,3,0,"ng-container",7),i.Vc(36,f,3,0,"ng-container",7),i.Ub(),i.Wb(),i.Wb(),i.Wb(),i.Wb()),2&e){const e=t.$implicit,n=i.ic();i.Db(9),i.Yc(i.kc(10,12,null==e?null:e.createdAt)),i.Db(4),i.Yc(i.kc(14,14,n.staffMap[null==e?null:e.createdBy])),i.Db(8),i.rc("ngSwitch",null==e?null:e.outcome),i.Db(1),i.rc("ngSwitchCase","NEW"),i.Db(1),i.rc("ngSwitchCase","ONGOING"),i.Db(1),i.rc("ngSwitchCase","IMPROVED"),i.Db(1),i.rc("ngSwitchCase","WORSENING"),i.Db(1),i.rc("ngSwitchCase","RESOLVED"),i.Db(7),i.rc("ngSwitch",null==e?null:e.priority),i.Db(1),i.rc("ngSwitchCase","LOW"),i.Db(1),i.rc("ngSwitchCase","MEDIUM"),i.Db(1),i.rc("ngSwitchCase","HIGH")}}let m=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Lb({type:e,selectors:[["app-event-history"]],inputs:{events:"events",staffMap:"staffMap"},decls:3,vars:1,consts:[[1,"container"],[4,"ngFor","ngForOf"],["nz-row","","nzGutter","16"],["nz-col","","nzSpan","4"],["nz-typography",""],["nz-col","","nzSpan","20"],[3,"ngSwitch"],[4,"ngSwitchCase"],["nz-typography","","nzType","secondary"],["nz-typography","","nzType","warning"],["nz-typography","","nzType","success"],["nz-typography","","nzType","danger"]],template:function(e,t){1&e&&(i.Xb(0,"div",0),i.Xb(1,"nz-timeline"),i.Vc(2,v,37,16,"nz-timeline-item",1),i.Wb(),i.Wb()),2&e&&(i.Db(2),i.rc("ngForOf",t.events))},directives:[s.a,a.p,s.b,o.c,o.a,l.a,a.s,a.t],pipes:[r.a,a.A],styles:["strong[_ngcontent-%COMP%]{font-weight:700!important}"]}),e})()}}]);